"use strict";(()=>{var e={};e.id=847,e.ids=[847],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},80379:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>m,originalPathname:()=>k,patchFetch:()=>g,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>d,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>w});var s={};r.r(s),r.d(s,{POST:()=>l});var o=r(10884),a=r(16132),i=r(21040),n=r(95798),c=r(14197);async function l(e){try{let t=await e.json(),{actionConfig:r}=t;if(!r)return n.Z.json({error:"Action configuration is required"},{status:400});let{type:s}=r;if(!s)return n.Z.json({error:"Action type is required"},{status:400});if("slack"===s&&!r.slackWebhook)return n.Z.json({error:"Slack webhook URL is required"},{status:400});if("email"===s&&!r.emailRecipients)return n.Z.json({error:"Email recipients are required"},{status:400});if("webhook"===s&&!r.webhookUrl)return n.Z.json({error:"Webhook URL is required"},{status:400});let o=await c.u.testAction(r);if(o.success)return n.Z.json({success:!0,message:o.message,timestamp:o.timestamp});return n.Z.json({success:!1,error:o.error||o.message},{status:400})}catch(e){return console.error("Action test failed:",e),n.Z.json({error:e.message||"Action test failed"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/workflow/test-action/route",pathname:"/api/workflow/test-action",filename:"route",bundlePath:"app/api/workflow/test-action/route"},resolvedPagePath:"/Users/trinayhari/SailoGrowth/app/api/workflow/test-action/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:d,headerHooks:m,staticGenerationBailout:w}=u,k="/api/workflow/test-action/route";function g(){return(0,i.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:h})}},14197:(e,t,r)=>{r.d(t,{u:()=>o});class s{async execute(e,t){let r=new Date;try{switch(e.type){case"slack":return await this.sendSlackNotification(e,t,r);case"email":return await this.sendEmailAlert(e,t,r);case"webhook":return await this.triggerWebhook(e,t,r);default:return{success:!1,message:`Unsupported action type: ${e.type}`,timestamp:r}}}catch(e){return{success:!1,message:`Action execution failed: ${e.message}`,timestamp:r,error:e.message}}}async sendSlackNotification(e,t,r){if(!e.slackWebhook)throw Error("Slack webhook URL is required");try{let s=this.replaceTemplateVariables(e.message||"",t),o={text:s,blocks:[{type:"section",text:{type:"mrkdwn",text:s}},{type:"context",elements:[{type:"mrkdwn",text:`_Triggered at ${r.toLocaleString()}_`}]}]},a=await fetch(e.slackWebhook,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(a.ok)return{success:!0,message:"Slack notification sent successfully",timestamp:r};{let e=await a.text();throw Error(`Slack API error: ${e}`)}}catch(e){throw Error(`Failed to send Slack notification: ${e.message}`)}}async sendEmailAlert(e,t,r){if(!e.emailRecipients)throw Error("Email recipients are required");let s=this.replaceTemplateVariables(e.message||"",t),o=e.emailRecipients.split(",").map(e=>e.trim());return console.log("Email would be sent to:",o),console.log("Email content:",s),{success:!0,message:`Email alert queued for ${o.length} recipient(s)`,timestamp:r}}async triggerWebhook(e,t,r){if(!e.webhookUrl)throw Error("Webhook URL is required");try{let s=e.webhookMethod||"POST",o={"Content-Type":"application/json",...e.webhookHeaders},a=e.webhookBody||t,i=await fetch(e.webhookUrl,{method:s,headers:o,body:"GET"!==s?JSON.stringify(a):void 0});if(i.ok)return{success:!0,message:`Webhook triggered successfully (${i.status})`,timestamp:r};throw Error(`Webhook returned ${i.status}: ${i.statusText}`)}catch(e){throw Error(`Failed to trigger webhook: ${e.message}`)}}replaceTemplateVariables(e,t){let r=e;return Object.keys(t).forEach(e=>{let s=RegExp(`{{${e}}}`,"g");r=r.replace(s,String(t[e]))}),t.timestamp||(r=r.replace(/{{timestamp}}/g,new Date().toLocaleString())),r}async testAction(e){let t={condition:"Test condition",value:100,threshold:50,timestamp:new Date().toISOString()};return await this.execute(e,t)}}let o=new s}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[271,107],()=>r(80379));module.exports=s})();