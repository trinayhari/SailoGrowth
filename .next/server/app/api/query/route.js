(()=>{var e={};e.id=423,e.ids=[423],e.modules={30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},90119:(e,t,r)=>{"use strict";let a,s,i,n,FormData,File,ReadableStream,o,l,E,u;r.r(t),r.d(t,{headerHooks:()=>u0,originalPathname:()=>u2,patchFetch:()=>u4,requestAsyncStorage:()=>uJ,routeModule:()=>uq,serverHooks:()=>uQ,staticGenerationAsyncStorage:()=>uz,staticGenerationBailout:()=>u1});var c,T,d,h,A,p,R,S,_,O,I,f,N,m,C,L,y,g,P,b,D,v,M,U,w,G,B,F,H,x,k,Y,V,$,W,j,X,K,Z,q,J,z,Q,ee,et,er,ea,es,ei,en,eo,el,eE,eu,ec,eT,ed,eh,eA,ep,eR,eS,e_,eO,eI,ef,eN,em,eC,eL,ey,eg,eP,eb,eD,ev,eM,eU,ew,eG,eB,eF={};r.r(eF),r.d(eF,{bigquery:()=>n6,db2:()=>oo,db2i:()=>op,duckdb:()=>oC,hive:()=>oU,mariadb:()=>o$,mysql:()=>oQ,n1ql:()=>ln,plsql:()=>lA,postgresql:()=>lm,redshift:()=>lM,singlestoredb:()=>EN,snowflake:()=>Ev,spark:()=>lY,sql:()=>l3,sqlite:()=>lJ,tidb:()=>o8,transactsql:()=>Eh,trino:()=>Ei});var eH={};r.r(eH),r.d(eH,{GET:()=>uZ,POST:()=>uK});var ex=r(10884),ek=r(16132),eY=r(21040),eV=r(95798);let e$="RFC3986",eW={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},ej=(Object.prototype.hasOwnProperty,Array.isArray),eX=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();function eK(e,t){if(ej(e)){let r=[];for(let a=0;a<e.length;a+=1)r.push(t(e[a]));return r}return t(e)}let eZ=Object.prototype.hasOwnProperty,eq={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},eJ=Array.isArray,ez=Array.prototype.push,eQ=function(e,t){ez.apply(e,eJ(t)?t:[t])},e0=Date.prototype.toISOString,e1={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,r,a,s)=>{if(0===e.length)return e;let i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===r)return escape(i).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let n="";for(let e=0;e<i.length;e+=1024){let t=i.length>=1024?i.slice(e,e+1024):i,r=[];for(let e=0;e<t.length;++e){let a=t.charCodeAt(e);if(45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||"RFC1738"===s&&(40===a||41===a)){r[r.length]=t.charAt(e);continue}if(a<128){r[r.length]=eX[a];continue}if(a<2048){r[r.length]=eX[192|a>>6]+eX[128|63&a];continue}if(a<55296||a>=57344){r[r.length]=eX[224|a>>12]+eX[128|a>>6&63]+eX[128|63&a];continue}e+=1,a=65536+((1023&a)<<10|1023&t.charCodeAt(e)),r[r.length]=eX[240|a>>18]+eX[128|a>>12&63]+eX[128|a>>6&63]+eX[128|63&a]}n+=r.join("")}return n},encodeValuesOnly:!1,format:e$,formatter:eW[e$],indices:!1,serializeDate:e=>e0.call(e),skipNulls:!1,strictNullHandling:!1},e2={},e4="4.104.0",e9=!1;var e5=r(12781),e3=r(13685),e6=r(57310),e8=r(85155),e7=r(95687),te=r(59796);let tt=e5.Readable,tr=Symbol("buffer"),ta=Symbol("type");class ts{constructor(){this[ta]="";let e=arguments[0],t=arguments[1],r=[];if(e){let t=Number(e.length);for(let a=0;a<t;a++){let t;let s=e[a];(t=s instanceof Buffer?s:ArrayBuffer.isView(s)?Buffer.from(s.buffer,s.byteOffset,s.byteLength):s instanceof ArrayBuffer?Buffer.from(s):s instanceof ts?s[tr]:Buffer.from("string"==typeof s?s:String(s))).length,r.push(t)}}this[tr]=Buffer.concat(r);let a=t&&void 0!==t.type&&String(t.type).toLowerCase();a&&!/[^\u0020-\u007E]/.test(a)&&(this[ta]=a)}get size(){return this[tr].length}get type(){return this[ta]}text(){return Promise.resolve(this[tr].toString())}arrayBuffer(){let e=this[tr],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){let e=new tt;return e._read=function(){},e.push(this[tr]),e.push(null),e}toString(){return"[object Blob]"}slice(){let e,t;let r=this.size,a=arguments[0],s=arguments[1];e=void 0===a?0:a<0?Math.max(r+a,0):Math.min(a,r),t=void 0===s?r:s<0?Math.max(r+s,0):Math.min(s,r);let i=Math.max(t-e,0),n=this[tr],o=n.slice(e,e+i),l=new ts([],{type:arguments[2]});return l[tr]=o,l}}function ti(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(ts.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(ts.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),ti.prototype=Object.create(Error.prototype),ti.prototype.constructor=ti,ti.prototype.name="FetchError";try{a=require("encoding").convert}catch(e){}let tn=Symbol("Body internals"),to=e5.PassThrough;function tl(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.size,s=r.timeout;null==e?e=null:tu(e)?e=Buffer.from(e.toString()):tc(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof e5||(e=Buffer.from(String(e)))),this[tn]={body:e,disturbed:!1,error:null},this.size=void 0===a?0:a,this.timeout=void 0===s?0:s,e instanceof e5&&e.on("error",function(e){let r="AbortError"===e.name?e:new ti(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[tn].error=r})}function tE(){var e=this;if(this[tn].disturbed)return tl.Promise.reject(TypeError(`body used already for: ${this.url}`));if(this[tn].disturbed=!0,this[tn].error)return tl.Promise.reject(this[tn].error);let t=this.body;if(null===t)return tl.Promise.resolve(Buffer.alloc(0));if(tc(t)&&(t=t.stream()),Buffer.isBuffer(t))return tl.Promise.resolve(t);if(!(t instanceof e5))return tl.Promise.resolve(Buffer.alloc(0));let r=[],a=0,s=!1;return new tl.Promise(function(i,n){let o;e.timeout&&(o=setTimeout(function(){s=!0,n(new ti(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))},e.timeout)),t.on("error",function(t){"AbortError"===t.name?(s=!0,n(t)):n(new ti(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))}),t.on("data",function(t){if(!s&&null!==t){if(e.size&&a+t.length>e.size){s=!0,n(new ti(`content size at ${e.url} over limit: ${e.size}`,"max-size"));return}a+=t.length,r.push(t)}}),t.on("end",function(){if(!s){clearTimeout(o);try{i(Buffer.concat(r,a))}catch(t){n(new ti(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}})})}function tu(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function tc(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function tT(e){let t,r;let a=e.body;if(e.bodyUsed)throw Error("cannot clone body after it is used");return a instanceof e5&&"function"!=typeof a.getBoundary&&(t=new to,r=new to,a.pipe(t),a.pipe(r),e[tn].body=t,a=r),a}function td(e){if(null===e)return null;if("string"==typeof e)return"text/plain;charset=UTF-8";if(tu(e))return"application/x-www-form-urlencoded;charset=UTF-8";if(tc(e))return e.type||null;if(Buffer.isBuffer(e))return null;if("[object ArrayBuffer]"===Object.prototype.toString.call(e))return null;if(ArrayBuffer.isView(e))return null;else if("function"==typeof e.getBoundary)return`multipart/form-data;boundary=${e.getBoundary()}`;else if(e instanceof e5)return null;else return"text/plain;charset=UTF-8"}function th(e){let t=e.body;return null===t?0:tc(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}tl.prototype={get body(){return this[tn].body},get bodyUsed(){return this[tn].disturbed},arrayBuffer(){return tE.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get("content-type")||"";return tE.call(this).then(function(t){return Object.assign(new ts([],{type:e.toLowerCase()}),{[tr]:t})})},json(){var e=this;return tE.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(t){return tl.Promise.reject(new ti(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}})},text(){return tE.call(this).then(function(e){return e.toString()})},buffer(){return tE.call(this)},textConverted(){var e=this;return tE.call(this).then(function(t){return function(e,t){let r,s;if("function"!=typeof a)throw Error("The package `encoding` must be installed to use the textConverted() function");let i=t.get("content-type"),n="utf-8";return i&&(r=/charset=([^;]*)/i.exec(i)),s=e.slice(0,1024).toString(),!r&&s&&(r=/<meta.+?charset=(['"])(.+?)\1/i.exec(s)),!r&&s&&(!(r=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(s))&&(r=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(s))&&r.pop(),r&&(r=/charset=(.*)/i.exec(r.pop()))),!r&&s&&(r=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(s)),r&&("gb2312"===(n=r.pop())||"gbk"===n)&&(n="gb18030"),a(e,"UTF-8",n).toString()}(t,e.headers)})}},Object.defineProperties(tl.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),tl.mixIn=function(e){for(let t of Object.getOwnPropertyNames(tl.prototype))if(!(t in e)){let r=Object.getOwnPropertyDescriptor(tl.prototype,t);Object.defineProperty(e,t,r)}},tl.Promise=global.Promise;let tA=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,tp=/[^\t\x20-\x7e\x80-\xff]/;function tR(e){if(e=`${e}`,tA.test(e)||""===e)throw TypeError(`${e} is not a legal HTTP header name`)}function tS(e){if(e=`${e}`,tp.test(e))throw TypeError(`${e} is not a legal HTTP header value`)}function t_(e,t){for(let r in t=t.toLowerCase(),e)if(r.toLowerCase()===t)return r}let tO=Symbol("map");class tI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[tO]=Object.create(null),e instanceof tI){let t=e.raw(),r=Object.keys(t);for(let e of r)for(let r of t[e])this.append(e,r);return}if(null==e);else if("object"==typeof e){let t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw TypeError("Header pairs must be iterable");let r=[];for(let t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw TypeError("Each header pair must be iterable");r.push(Array.from(t))}for(let e of r){if(2!==e.length)throw TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(let t of Object.keys(e)){let r=e[t];this.append(t,r)}}else throw TypeError("Provided initializer must be an object")}get(e){tR(e=`${e}`);let t=t_(this[tO],e);return void 0===t?null:this[tO][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=tf(this),a=0;for(;a<r.length;){var s=r[a];let i=s[0],n=s[1];e.call(t,n,i,this),r=tf(this),a++}}set(e,t){e=`${e}`,t=`${t}`,tR(e),tS(t);let r=t_(this[tO],e);this[tO][void 0!==r?r:e]=[t]}append(e,t){e=`${e}`,t=`${t}`,tR(e),tS(t);let r=t_(this[tO],e);void 0!==r?this[tO][r].push(t):this[tO][e]=[t]}has(e){return tR(e=`${e}`),void 0!==t_(this[tO],e)}delete(e){tR(e=`${e}`);let t=t_(this[tO],e);void 0!==t&&delete this[tO][t]}raw(){return this[tO]}keys(){return tm(this,"key")}values(){return tm(this,"value")}[Symbol.iterator](){return tm(this,"key+value")}}function tf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value",r=Object.keys(e[tO]).sort();return r.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[tO][t].join(", ")}:function(t){return[t.toLowerCase(),e[tO][t].join(", ")]})}tI.prototype.entries=tI.prototype[Symbol.iterator],Object.defineProperty(tI.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(tI.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});let tN=Symbol("internal");function tm(e,t){let r=Object.create(tC);return r[tN]={target:e,kind:t,index:0},r}let tC=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==tC)throw TypeError("Value of `this` is not a HeadersIterator");var e=this[tN];let t=e.target,r=e.kind,a=e.index,s=tf(t,r),i=s.length;return a>=i?{value:void 0,done:!0}:(this[tN].index=a+1,{value:s[a],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(tC,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});let tL=Symbol("Response internals"),ty=e3.STATUS_CODES;class tg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tl.call(this,e,t);let r=t.status||200,a=new tI(t.headers);if(null!=e&&!a.has("Content-Type")){let t=td(e);t&&a.append("Content-Type",t)}this[tL]={url:t.url,status:r,statusText:t.statusText||ty[r],headers:a,counter:t.counter}}get url(){return this[tL].url||""}get status(){return this[tL].status}get ok(){return this[tL].status>=200&&this[tL].status<300}get redirected(){return this[tL].counter>0}get statusText(){return this[tL].statusText}get headers(){return this[tL].headers}clone(){return new tg(tT(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}tl.mixIn(tg.prototype),Object.defineProperties(tg.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(tg.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});let tP=Symbol("Request internals"),tb=e6.URL||e8.URL,tD=e6.parse,tv=e6.format;function tM(e){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.exec(e)&&(e=new tb(e).toString()),tD(e)}let tU="destroy"in e5.Readable.prototype;function tw(e){return"object"==typeof e&&"object"==typeof e[tP]}class tG{constructor(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tw(e)?t=tM(e.url):(t=e&&e.href?tM(e.href):tM(`${e}`),e={});let a=r.method||e.method||"GET";if(a=a.toUpperCase(),(null!=r.body||tw(e)&&null!==e.body)&&("GET"===a||"HEAD"===a))throw TypeError("Request with GET/HEAD method cannot have body");let s=null!=r.body?r.body:tw(e)&&null!==e.body?tT(e):null;tl.call(this,s,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});let i=new tI(r.headers||e.headers||{});if(null!=s&&!i.has("Content-Type")){let e=td(s);e&&i.append("Content-Type",e)}let n=tw(e)?e.signal:null;if("signal"in r&&(n=r.signal),null!=n&&!function(e){let t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!!(t&&"AbortSignal"===t.constructor.name)}(n))throw TypeError("Expected signal to be an instanceof AbortSignal");this[tP]={method:a,redirect:r.redirect||e.redirect||"follow",headers:i,parsedURL:t,signal:n},this.follow=void 0!==r.follow?r.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==r.compress?r.compress:void 0===e.compress||e.compress,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[tP].method}get url(){return tv(this[tP].parsedURL)}get headers(){return this[tP].headers}get redirect(){return this[tP].redirect}get signal(){return this[tP].signal}clone(){return new tG(this)}}function tB(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}tl.mixIn(tG.prototype),Object.defineProperty(tG.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(tG.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),tB.prototype=Object.create(Error.prototype),tB.prototype.constructor=tB,tB.prototype.name="AbortError";let tF=e6.URL||e8.URL,tH=e5.PassThrough,tx=function(e,t){let r=new tF(t).hostname,a=new tF(e).hostname;return r===a||"."===r[r.length-a.length-1]&&r.endsWith(a)},tk=function(e,t){let r=new tF(t).protocol,a=new tF(e).protocol;return r===a};function tY(e,t){if(!tY.Promise)throw Error("native promise missing, set fetch.Promise to your favorite alternative");return tl.Promise=tY.Promise,new tY.Promise(function(r,a){var s;let i,n;let o=new tG(e,t),l=function(e){let t=e[tP].parsedURL,r=new tI(e[tP].headers);if(r.has("Accept")||r.set("Accept","*/*"),!t.protocol||!t.hostname)throw TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof e5.Readable&&!tU)throw Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let a=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(a="0"),null!=e.body){let t=th(e);"number"==typeof t&&(a=String(t))}a&&r.set("Content-Length",a),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let s=e.agent;return"function"==typeof s&&(s=s(t)),Object.assign({},t,{method:e.method,headers:function(e){let t=Object.assign({__proto__:null},e[tO]),r=t_(e[tO],"Host");return void 0!==r&&(t[r]=t[r][0]),t}(r),agent:s})}(o),E=("https:"===l.protocol?e7:e3).request,u=o.signal,c=null,T=function(){let e=new tB("The user aborted a request.");a(e),o.body&&o.body instanceof e5.Readable&&tV(o.body,e),c&&c.body&&c.body.emit("error",e)};if(u&&u.aborted){T();return}let d=function(){T(),A()},h=E(l);function A(){h.abort(),u&&u.removeEventListener("abort",d),clearTimeout(i)}u&&u.addEventListener("abort",d),o.timeout&&h.once("socket",function(e){i=setTimeout(function(){a(new ti(`network timeout at: ${o.url}`,"request-timeout")),A()},o.timeout)}),h.on("error",function(e){a(new ti(`request to ${o.url} failed, reason: ${e.message}`,"system",e)),c&&c.body&&tV(c.body,e),A()}),s=function(e){(!u||!u.aborted)&&c&&c.body&&tV(c.body,e)},h.on("socket",function(e){n=e}),h.on("response",function(e){let t=e.headers;"chunked"!==t["transfer-encoding"]||t["content-length"]||e.once("close",function(e){let t=n&&n.listenerCount("data")>0;if(t&&!e){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",s(e)}})}),14>parseInt(process.version.substring(1))&&h.on("socket",function(e){e.addListener("close",function(t){let r=e.listenerCount("data")>0;if(c&&r&&!t&&!(u&&u.aborted)){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",c.body.emit("error",e)}})}),h.on("response",function(e){clearTimeout(i);let t=function(e){let t=new tI;for(let r of Object.keys(e))if(!tA.test(r)){if(Array.isArray(e[r]))for(let a of e[r])tp.test(a)||(void 0===t[tO][r]?t[tO][r]=[a]:t[tO][r].push(a));else tp.test(e[r])||(t[tO][r]=[e[r]])}return t}(e.headers);if(tY.isRedirect(e.statusCode)){let s=t.get("Location"),i=null;try{i=null===s?null:new tF(s,o.url).toString()}catch(e){if("manual"!==o.redirect){a(new ti(`uri requested responds with an invalid redirect URL: ${s}`,"invalid-redirect")),A();return}}switch(o.redirect){case"error":a(new ti(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),A();return;case"manual":if(null!==i)try{t.set("Location",i)}catch(e){a(e)}break;case"follow":if(null===i)break;if(o.counter>=o.follow){a(new ti(`maximum redirect reached at: ${o.url}`,"max-redirect")),A();return}let n={headers:new tI(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:o.body,signal:o.signal,timeout:o.timeout,size:o.size};if(!tx(o.url,i)||!tk(o.url,i))for(let e of["authorization","www-authenticate","cookie","cookie2"])n.headers.delete(e);if(303!==e.statusCode&&o.body&&null===th(o)){a(new ti("Cannot follow redirect with body being a readable stream","unsupported-redirect")),A();return}(303===e.statusCode||(301===e.statusCode||302===e.statusCode)&&"POST"===o.method)&&(n.method="GET",n.body=void 0,n.headers.delete("content-length")),r(tY(new tG(i,n))),A();return}}e.once("end",function(){u&&u.removeEventListener("abort",d)});let s=e.pipe(new tH),n={url:o.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:o.size,timeout:o.timeout,counter:o.counter},l=t.get("Content-Encoding");if(!o.compress||"HEAD"===o.method||null===l||204===e.statusCode||304===e.statusCode){r(c=new tg(s,n));return}let E={flush:te.Z_SYNC_FLUSH,finishFlush:te.Z_SYNC_FLUSH};if("gzip"==l||"x-gzip"==l){r(c=new tg(s=s.pipe(te.createGunzip(E)),n));return}if("deflate"==l||"x-deflate"==l){let t=e.pipe(new tH);t.once("data",function(e){r(c=new tg(s=(15&e[0])==8?s.pipe(te.createInflate()):s.pipe(te.createInflateRaw()),n))}),t.on("end",function(){c||r(c=new tg(s,n))});return}if("br"==l&&"function"==typeof te.createBrotliDecompress){r(c=new tg(s=s.pipe(te.createBrotliDecompress()),n));return}r(c=new tg(s,n))}),function(e,t){let r=t.body;null===r?e.end():tc(r)?r.stream().pipe(e):Buffer.isBuffer(r)?(e.write(r),e.end()):r.pipe(e)}(h,o)})}function tV(e,t){e.destroy?e.destroy(t):(e.emit("error",t),e.end())}tY.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},tY.Promise=global.Promise;var t$=r(73837),tW=r(70087),tj=r(68100),tX=r(83785);let tK=e=>e instanceof tX.t;var tZ=r(81883);let tq=(0,t$.deprecate)(()=>{},'Constructor "entries" argument is not spec-compliant and will be removed in next major release.');var tJ=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};class tz{constructor(e){c.add(this),T.set(this,new Map),e&&(tq(),e.forEach(({name:e,value:t,fileName:r})=>this.append(e,t,r)))}static[(T=new WeakMap,c=new WeakSet,Symbol.hasInstance)](e){return!!(e&&(0,tZ.m)(e.constructor)&&"FormData"===e[Symbol.toStringTag]&&(0,tZ.m)(e.append)&&(0,tZ.m)(e.set)&&(0,tZ.m)(e.get)&&(0,tZ.m)(e.getAll)&&(0,tZ.m)(e.has)&&(0,tZ.m)(e.delete)&&(0,tZ.m)(e.entries)&&(0,tZ.m)(e.values)&&(0,tZ.m)(e.keys)&&(0,tZ.m)(e[Symbol.iterator])&&(0,tZ.m)(e.forEach))}append(e,t,r){tJ(this,c,"m",d).call(this,{name:e,fileName:r,append:!0,rawValue:t,argsLength:arguments.length})}set(e,t,r){tJ(this,c,"m",d).call(this,{name:e,fileName:r,append:!1,rawValue:t,argsLength:arguments.length})}get(e){let t=tJ(this,T,"f").get(String(e));return t?t[0]:null}getAll(e){let t=tJ(this,T,"f").get(String(e));return t?t.slice():[]}has(e){return tJ(this,T,"f").has(String(e))}delete(e){tJ(this,T,"f").delete(String(e))}*keys(){for(let e of tJ(this,T,"f").keys())yield e}*entries(){for(let e of this.keys()){let t=this.getAll(e);for(let r of t)yield[e,r]}}*values(){for(let[,e]of this)yield e}[(d=function({name:e,rawValue:t,append:r,fileName:a,argsLength:s}){let i;let n=r?"append":"set";if(s<2)throw TypeError(`Failed to execute '${n}' on 'FormData': 2 arguments required, but only ${s} present.`);if(e=String(e),(0,tj.z)(t))i=void 0===a?t:new tW.$([t],a,{type:t.type,lastModified:t.lastModified});else if(tK(t))i=new tW.$([t],void 0===a?"blob":a,{type:t.type});else if(a)throw TypeError(`Failed to execute '${n}' on 'FormData': parameter 2 is not of type 'Blob'.`);else i=String(t);let o=tJ(this,T,"f").get(e);if(!o||!r)return void tJ(this,T,"f").set(e,[i]);o.push(i)},Symbol.iterator)](){return this.entries()}forEach(e,t){for(let[r,a]of this)e.call(t,a,r,this)}get[Symbol.toStringTag](){return"FormData"}[t$.inspect.custom](){return this[Symbol.toStringTag]}}var tQ=r(36390),t0=r(82158);let t1=require("node:fs"),t2="abcdefghijklmnopqrstuvwxyz0123456789",t4=function(){let e=16,t="";for(;e--;)t+=t2[Math.random()*t2.length<<0];return t},t9=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase(),t5=function(e){if("object"!==t9(e))return!1;let t=Object.getPrototypeOf(e);if(null==t)return!0;let r=t.constructor&&t.constructor.toString();return r===Object.toString()},t3=e=>String(e).replace(/\r|\n/g,(e,t,r)=>"\r"===e&&"\n"!==r[t+1]||"\n"===e&&"\r"!==r[t-1]?"\r\n":e),t6=e=>String(e).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22"),t8=e=>"function"==typeof e,t7=e=>!!(e&&"object"==typeof e&&t8(e.constructor)&&"File"===e[Symbol.toStringTag]&&t8(e.stream)&&null!=e.name&&null!=e.size&&null!=e.lastModified),re=e=>!!(e&&t8(e.constructor)&&"FormData"===e[Symbol.toStringTag]&&t8(e.append)&&t8(e.getAll)&&t8(e.entries)&&t8(e[Symbol.iterator]));var rt=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},rr=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};let ra={enableAdditionalHeaders:!1};class rs{constructor(e,t,r){let a;if(h.add(this),A.set(this,"\r\n"),p.set(this,void 0),R.set(this,void 0),S.set(this,"-".repeat(2)),_.set(this,new TextEncoder),O.set(this,void 0),I.set(this,void 0),f.set(this,void 0),!re(e))throw TypeError("Expected first argument to be a FormData instance.");if(t5(t)?r=t:a=t,a||(a=t4()),"string"!=typeof a)throw TypeError("Expected boundary argument to be a string.");if(r&&!t5(r))throw TypeError("Expected options argument to be an object.");rt(this,I,e,"f"),rt(this,f,{...ra,...r},"f"),rt(this,p,rr(this,_,"f").encode(rr(this,A,"f")),"f"),rt(this,R,rr(this,p,"f").byteLength,"f"),this.boundary=`form-data-boundary-${a}`,this.contentType=`multipart/form-data; boundary=${this.boundary}`,rt(this,O,rr(this,_,"f").encode(`${rr(this,S,"f")}${this.boundary}${rr(this,S,"f")}${rr(this,A,"f").repeat(2)}`),"f"),this.contentLength=String(this.getContentLength()),this.headers=Object.freeze({"Content-Type":this.contentType,"Content-Length":this.contentLength}),Object.defineProperties(this,{boundary:{writable:!1,configurable:!1},contentType:{writable:!1,configurable:!1},contentLength:{writable:!1,configurable:!1},headers:{writable:!1,configurable:!1}})}getContentLength(){let e=0;for(let[t,r]of rr(this,I,"f")){let a=t7(r)?r:rr(this,_,"f").encode(t3(r));e+=rr(this,h,"m",N).call(this,t,a).byteLength+(t7(a)?a.size:a.byteLength)+rr(this,R,"f")}return e+rr(this,O,"f").byteLength}*values(){for(let[e,t]of rr(this,I,"f").entries()){let r=t7(t)?t:rr(this,_,"f").encode(t3(t));yield rr(this,h,"m",N).call(this,e,r),yield r,yield rr(this,p,"f")}yield rr(this,O,"f")}async *encode(){for(let e of this.values())t7(e)?yield*e.stream():yield e}[(A=new WeakMap,p=new WeakMap,R=new WeakMap,S=new WeakMap,_=new WeakMap,O=new WeakMap,I=new WeakMap,f=new WeakMap,h=new WeakSet,N=function(e,t){let r="";return r+=`${rr(this,S,"f")}${this.boundary}${rr(this,A,"f")}Content-Disposition: form-data; name="${t6(e)}"`,t7(t)&&(r+=`; filename="${t6(t.name)}"${rr(this,A,"f")}Content-Type: ${t.type||"application/octet-stream"}`),!0===rr(this,f,"f").enableAdditionalHeaders&&(r+=`${rr(this,A,"f")}Content-Length: ${t7(t)?t.size:t.byteLength}`),rr(this,_,"f").encode(`${r}${rr(this,A,"f").repeat(2)}`)},Symbol.iterator)](){return this.values()}[Symbol.asyncIterator](){return this.encode()}}let ri=require("node:stream");class rn{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}let ro=require("node:stream/web"),rl=!1;async function rE(e,...t){let{fileFromPath:a}=await r.e(868).then(r.bind(r,35868));return rl||(console.warn(`fileFromPath is deprecated; use fs.createReadStream(${JSON.stringify(e)}) instead`),rl=!0),await a(e,...t)}let ru=new tQ({keepAlive:!0,timeout:3e5}),rc=new tQ.HttpsAgent({keepAlive:!0,timeout:3e5});async function rT(e,t){let r=new rs(e),a=ri.Readable.from(r),s=new rn(a),i={...t.headers,...r.headers,"Content-Length":r.contentLength};return{...t,body:s,headers:i}}let rd=()=>{i||function(e,t={auto:!1}){if(e9)throw Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(i)throw Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${i}'\``);e9=t.auto,i=e.kind,n=e.fetch,e.Request,e.Response,e.Headers,FormData=e.FormData,e.Blob,File=e.File,ReadableStream=e.ReadableStream,o=e.getMultipartRequestOptions,l=e.getDefaultAgent,E=e.fileFromPath,u=e.isFsReadStream}(("undefined"==typeof AbortController&&(globalThis.AbortController=t0.AbortController),{kind:"node",fetch:tY,Request:tG,Response:tg,Headers:tI,FormData:tz,Blob:tX.t,File:tW.$,ReadableStream:ro.ReadableStream,getMultipartRequestOptions:rT,getDefaultAgent:e=>e.startsWith("https")?rc:ru,fileFromPath:rE,isFsReadStream:e=>e instanceof t1.ReadStream}),{auto:!0})};rd();class rh extends Error{}class rA extends rh{constructor(e,t,r,a){super(`${rA.makeMessage(e,t,r)}`),this.status=e,this.headers=a,this.request_id=a?.["x-request-id"],this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,r){let a=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,t,r,a){if(!e||!a)return new rR({message:r,cause:an(t)});let s=t?.error;return 400===e?new r_(e,s,r,a):401===e?new rO(e,s,r,a):403===e?new rI(e,s,r,a):404===e?new rf(e,s,r,a):409===e?new rN(e,s,r,a):422===e?new rm(e,s,r,a):429===e?new rC(e,s,r,a):e>=500?new rL(e,s,r,a):new rA(e,s,r,a)}}class rp extends rA{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class rR extends rA{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class rS extends rR{constructor({message:e}={}){super({message:e??"Request timed out."})}}class r_ extends rA{}class rO extends rA{}class rI extends rA{}class rf extends rA{}class rN extends rA{}class rm extends rA{}class rC extends rA{}class rL extends rA{}class ry extends rh{constructor(){super("Could not parse response content as the length limit was reached")}}class rg extends rh{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var rP=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},rb=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};class rD{constructor(){m.set(this,void 0),this.buffer=new Uint8Array,rP(this,m,null,"f")}decode(e){let t;if(null==e)return[];let r=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?new TextEncoder().encode(e):e,a=new Uint8Array(this.buffer.length+r.length);a.set(this.buffer),a.set(r,this.buffer.length),this.buffer=a;let s=[];for(;null!=(t=function(e,t){for(let r=t??0;r<e.length;r++){if(10===e[r])return{preceding:r,index:r+1,carriage:!1};if(13===e[r])return{preceding:r,index:r+1,carriage:!0}}return null}(this.buffer,rb(this,m,"f")));){if(t.carriage&&null==rb(this,m,"f")){rP(this,m,t.index,"f");continue}if(null!=rb(this,m,"f")&&(t.index!==rb(this,m,"f")+1||t.carriage)){s.push(this.decodeText(this.buffer.slice(0,rb(this,m,"f")-1))),this.buffer=this.buffer.slice(rb(this,m,"f")),rP(this,m,null,"f");continue}let e=null!==rb(this,m,"f")?t.preceding-1:t.preceding,r=this.decodeText(this.buffer.slice(0,e));s.push(r),this.buffer=this.buffer.slice(t.index),rP(this,m,null,"f")}return s}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new rh(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new rh(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new rh("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function rv(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}m=new WeakMap,rD.NEWLINE_CHARS=new Set(["\n","\r"]),rD.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class rM{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;return new rM(async function*(){if(r)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(let r of rU(e,t))if(!a){if(r.data.startsWith("[DONE]")){a=!0;continue}if(null===r.event||r.event.startsWith("response.")||r.event.startsWith("transcript.")){let t;try{t=JSON.parse(r.data)}catch(e){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),e}if(t&&t.error)throw new rA(void 0,t.error,void 0,r9(e.headers));yield t}else{let e;try{e=JSON.parse(r.data)}catch(e){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),e}if("error"==r.event)throw new rA(void 0,e.error,e.message,void 0);yield{event:r.event,data:e}}}a=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{a||t.abort()}},t)}static fromReadableStream(e,t){let r=!1;async function*a(){let t=new rD,r=rv(e);for await(let e of r)for(let r of t.decode(e))yield r;for(let e of t.flush())yield e}return new rM(async function*(){if(r)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let e=!1;try{for await(let t of a())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||t.abort()}},t)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],r=this.iterator(),a=a=>({next:()=>{if(0===a.length){let a=r.next();e.push(a),t.push(a)}return a.shift()}});return[new rM(()=>a(e),this.controller),new rM(()=>a(t),this.controller)]}toReadableStream(){let e;let t=this,r=new TextEncoder;return new ReadableStream({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:a,done:s}=await e.next();if(s)return t.close();let i=r.encode(JSON.stringify(a)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*rU(e,t){if(!e.body)throw t.abort(),new rh("Attempted to iterate over a response with no body");let r=new rG,a=new rD,s=rv(e.body);for await(let e of rw(s))for(let t of a.decode(e)){let e=r.decode(t);e&&(yield e)}for(let e of a.flush()){let t=r.decode(e);t&&(yield t)}}async function*rw(e){let t=new Uint8Array;for await(let r of e){let e;if(null==r)continue;let a=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?new TextEncoder().encode(r):r,s=new Uint8Array(t.length+a.length);for(s.set(t),s.set(a,t.length),t=s;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class rG{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,a]=function(e,t){let r=e.indexOf(t);return -1!==r?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}(e,":");return a.startsWith(" ")&&(a=a.substring(1)),"event"===t?this.event=a:"data"===t&&this.data.push(a),null}}let rB=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,rF=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&rH(e),rH=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,rx=e=>rF(e)||rB(e)||u(e);async function rk(e,t,r){var a;if(rF(e=await e))return e;if(rB(e)){let a=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");let s=rH(a)?[await a.arrayBuffer()]:[a];return new File(s,t,r)}let s=await rY(e);if(t||(t=(rV((a=e).name)||rV(a.filename)||rV(a.path)?.split(/[\\/]/).pop())??"unknown_file"),!r?.type){let e=s[0]?.type;"string"==typeof e&&(r={...r,type:e})}return new File(s,t,r)}async function rY(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(rH(e))t.push(await e.arrayBuffer());else if(r$(e))for await(let r of e)t.push(r);else throw Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){let t=Object.getOwnPropertyNames(e);return`[${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`);return t}let rV=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,r$=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],rW=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],rj=async e=>{let t=await rX(e.body);return o(t,e)},rX=async e=>{let t=new FormData;return await Promise.all(Object.entries(e||{}).map(([e,r])=>rZ(t,e,r))),t},rK=e=>{if(rx(e))return!0;if(Array.isArray(e))return e.some(rK);if(e&&"object"==typeof e){for(let t in e)if(rK(e[t]))return!0}return!1},rZ=async(e,t,r)=>{if(void 0!==r){if(null==r)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)e.append(t,String(r));else if(rx(r)){let a=await rk(r);e.append(t,a)}else if(Array.isArray(r))await Promise.all(r.map(r=>rZ(e,t+"[]",r)));else if("object"==typeof r)await Promise.all(Object.entries(r).map(([r,a])=>rZ(e,`${t}[${r}]`,a)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var rq=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},rJ=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};async function rz(e){let{response:t}=e;if(e.options.stream)return(aT("response",t.status,t.url,t.headers,t.body),e.options.__streamClass)?e.options.__streamClass.fromSSEResponse(t,e.controller):rM.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;let r=t.headers.get("content-type"),a=r?.split(";")[0]?.trim(),s=a?.includes("application/json")||a?.endsWith("+json");if(s){let e=await t.json();return aT("response",t.status,t.url,t.headers,e),rQ(e,t)}let i=await t.text();return aT("response",t.status,t.url,t.headers,i),i}function rQ(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}rd();class r0 extends Promise{constructor(e,t=rz){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new r0(this.responsePromise,async t=>rQ(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class r1{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:a,fetch:s}){this.baseURL=e,this.maxRetries=ai("maxRetries",t),this.timeout=ai("timeout",r),this.httpAgent=a,this.fetch=s??n}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...ae(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ad()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async r=>{let a=r&&rH(r?.body)?new DataView(await r.body.arrayBuffer()):r?.body instanceof DataView?r.body:r?.body instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r?.body)?new DataView(r.body.buffer):r?.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){let t=new TextEncoder,r=t.encode(e);return r.length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){let r={...e},{method:a,path:s,query:i,headers:n={}}=r,o=ArrayBuffer.isView(r.body)||r.__binaryRequest&&"string"==typeof r.body?r.body:rW(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,E=this.calculateContentLength(o),u=this.buildURL(s,i);"timeout"in r&&ai("timeout",r.timeout),r.timeout=r.timeout??this.timeout;let c=r.httpAgent??this.httpAgent??l(u),T=r.timeout+1e3;"number"==typeof c?.options?.timeout&&T>(c.options.timeout??0)&&(c.options.timeout=T),this.idempotencyHeader&&"get"!==a&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),n[this.idempotencyHeader]=e.idempotencyKey);let d=this.buildHeaders({options:r,headers:n,contentLength:E,retryCount:t}),h={method:a,...o&&{body:o},headers:d,...c&&{agent:c},signal:r.signal??null};return{req:h,url:u,timeout:r.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:a}){let s={};r&&(s["content-length"]=r);let n=this.defaultHeaders(e);return au(s,n),au(s,t),rW(e.body)&&"node"!==i&&delete s["content-type"],void 0===ap(n,"x-stainless-retry-count")&&void 0===ap(t,"x-stainless-retry-count")&&(s["x-stainless-retry-count"]=String(a)),void 0===ap(n,"x-stainless-timeout")&&void 0===ap(t,"x-stainless-timeout")&&e.timeout&&(s["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,r,a){return rA.generate(e,t,r,a)}request(e,t=null){return new r0(this.makeRequest(e,t))}async makeRequest(e,t){let r=await e,a=r.maxRetries??this.maxRetries;null==t&&(t=a),await this.prepareOptions(r);let{req:s,url:i,timeout:n}=this.buildRequest(r,{retryCount:a-t});if(await this.prepareRequest(s,{url:i,options:r}),aT("request",i,r,s.headers),r.signal?.aborted)throw new rp;let o=new AbortController,l=await this.fetchWithTimeout(i,s,n,o).catch(an);if(l instanceof Error){if(r.signal?.aborted)throw new rp;if(t)return this.retryRequest(r,t);if("AbortError"===l.name)throw new rS;throw new rR({cause:l})}let E=r9(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){let e=`retrying, ${t} attempts remaining`;return aT(`response (error; ${e})`,l.status,i,E),this.retryRequest(r,t,E)}let e=await l.text().catch(e=>an(e).message),a=at(e),s=a?void 0:e,n=t?"(error; no more retries left)":"(error; not retryable)";aT(`response (error; ${n})`,l.status,i,E,s);let o=this.makeStatusError(l.status,a,s,E);throw o}return{response:l,options:r,controller:o}}requestAPIList(e,t){let r=this.makeRequest(t,null);return new r4(this,r,e)}buildURL(e,t){let r=new URL(aa(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return al(a)||(t={...a,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new rh(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,a){let{signal:s,...i}=t||{};s&&s.addEventListener("abort",()=>a.abort());let n=setTimeout(()=>a.abort(),r),o={signal:a.signal,...i};return o.method&&(o.method=o.method.toUpperCase()),this.fetch.call(void 0,e,o).finally(()=>{clearTimeout(n)})}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,r){let a;let s=r?.["retry-after-ms"];if(s){let e=parseFloat(s);Number.isNaN(e)||(a=e)}let i=r?.["retry-after"];if(i&&!a){let e=parseFloat(i);a=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(a&&0<=a&&a<6e4)){let r=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,r)}return await as(a),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${e4}`}}class r2{constructor(e,t,r,a){C.set(this,void 0),rq(this,C,e,"f"),this.options=a,this.response=t,this.body=r}hasNextPage(){let e=this.getPaginatedItems();return!!e.length&&null!=this.nextPageInfo()}async getNextPage(){let e=this.nextPageInfo();if(!e)throw new rh("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){let r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(let[t,a]of r)e.url.searchParams.set(t,a);t.query=void 0,t.path=e.url.toString()}return await rJ(this,C,"f").requestAPIList(this.constructor,t)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(C=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class r4 extends r0{constructor(e,t,r){super(t,async t=>new r(e,t.response,await rz(t),t.options))}async *[Symbol.asyncIterator](){let e=await this;for await(let t of e)yield t}}let r9=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){let r=t.toString();return e[r.toLowerCase()]||e[r]}}),r5={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},r3=e=>"object"==typeof e&&null!==e&&!al(e)&&Object.keys(e).every(e=>aE(r5,e)),r6=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e4,"X-Stainless-OS":r7(Deno.build.os),"X-Stainless-Arch":r8(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e4,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e4,"X-Stainless-OS":r7(process.platform),"X-Stainless-Arch":r8(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};let e=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let r=t.exec(navigator.userAgent);if(r){let t=r[1]||0,a=r[2]||0,s=r[3]||0;return{browser:e,version:`${t}.${a}.${s}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e4,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e4,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},r8=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",r7=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",ae=()=>s??(s=r6()),at=e=>{try{return JSON.parse(e)}catch(e){return}},ar=/^[a-z][a-z0-9+.-]*:/i,aa=e=>ar.test(e),as=e=>new Promise(t=>setTimeout(t,e)),ai=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new rh(`${e} must be an integer`);if(t<0)throw new rh(`${e} must be a positive integer`);return t},an=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return Error(JSON.stringify(e))}catch{}return Error(e)},ao=e=>"undefined"!=typeof process?process.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function al(e){if(!e)return!0;for(let t in e)return!1;return!0}function aE(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function au(e,t){for(let r in t){if(!aE(t,r))continue;let a=r.toLowerCase();if(!a)continue;let s=t[r];null===s?delete e[a]:void 0!==s&&(e[a]=s)}}let ac=new Set(["authorization","api-key"]);function aT(e,...t){if("undefined"!=typeof process&&process?.env?.DEBUG==="true"){let r=t.map(e=>{if(!e)return e;if(e.headers){let t={...e,headers:{...e.headers}};for(let r in e.headers)ac.has(r.toLowerCase())&&(t.headers[r]="REDACTED");return t}let t=null;for(let r in e)ac.has(r.toLowerCase())&&(t??(t={...e}),t[r]="REDACTED");return t??e});console.log(`OpenAI:DEBUG:${e}`,...r)}}let ad=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),ah=()=>!1,aA=e=>"function"==typeof e?.get,ap=(e,t)=>{let r=t.toLowerCase();if(aA(e)){let a=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,(e,t,r)=>t+r.toUpperCase());for(let s of[t,r,t.toUpperCase(),a]){let t=e.get(s);if(t)return t}}for(let[a,s]of Object.entries(e))if(a.toLowerCase()===r){if(Array.isArray(s)){if(s.length<=1)return s[0];return console.warn(`Received ${s.length} entries for the ${t} header, using the first entry.`),s[0]}return s}},aR=e=>{if("undefined"!=typeof Buffer){let t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),r=t.length,a=new Uint8Array(r);for(let e=0;e<r;e++)a[e]=t.charCodeAt(e);return Array.from(new Float32Array(a.buffer))}};function aS(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}class a_{constructor(e){this._client=e}}class aO extends a_{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class aI extends a_{list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,aL,{query:t,...r})}}class af extends r2{constructor(e,t,r,a){super(e,t,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class aN extends r2{constructor(e,t,r,a){super(e,t,r,a),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){let e=this.getPaginatedItems();if(!e.length)return null;let t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class am extends a_{constructor(){super(...arguments),this.messages=new aI(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/chat/completions",aC,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}class aC extends aN{}class aL extends aN{}am.ChatCompletionsPage=aC,am.Messages=aI;class ay extends a_{constructor(){super(...arguments),this.completions=new am(this._client)}}ay.Completions=am,ay.ChatCompletionsPage=aC;class ag extends a_{create(e,t){let r=!!e.encoding_format,a=r?e.encoding_format:"base64";r&&aT("Request","User defined encoding_format:",e.encoding_format);let s=this._client.post("/embeddings",{body:{...e,encoding_format:a},...t});return r?s:(aT("response","Decoding base64 embeddings to float32 array"),s._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=aR(t)}),e)))}}class aP extends a_{create(e,t){return this._client.post("/files",rj({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/files",ab,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=18e5}={}){let a=new Set(["processed","error","deleted"]),s=Date.now(),i=await this.retrieve(e);for(;!i.status||!a.has(i.status);)if(await as(t),i=await this.retrieve(e),Date.now()-s>r)throw new rS({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return i}}class ab extends aN{}aP.FileObjectsPage=ab;class aD extends a_{createVariation(e,t){return this._client.post("/images/variations",rj({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",rj({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class av extends a_{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}class aM extends a_{create(e,t){return this._client.post("/audio/transcriptions",rj({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class aU extends a_{create(e,t){return this._client.post("/audio/translations",rj({body:e,...t,__metadata:{model:e.model}}))}}class Audio extends a_{constructor(){super(...arguments),this.transcriptions=new aM(this._client),this.translations=new aU(this._client),this.speech=new av(this._client)}}Audio.Transcriptions=aM,Audio.Translations=aU,Audio.Speech=av;class aw extends a_{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class aG extends a_{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",aB,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class aB extends af{}aG.ModelsPage=aB;class aF extends a_{}class aH extends a_{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class ax extends a_{constructor(){super(...arguments),this.graders=new aH(this._client)}}ax.Graders=aH;class Permissions extends a_{create(e,t,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,ak,{body:t,method:"post",...r})}retrieve(e,t={},r){return r3(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}del(e,t,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,r)}}class ak extends af{}Permissions.PermissionCreateResponsesPage=ak;class aY extends a_{constructor(){super(...arguments),this.permissions=new Permissions(this._client)}}aY.Permissions=Permissions,aY.PermissionCreateResponsesPage=ak;class aV extends a_{list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,a$,{query:t,...r})}}class a$ extends aN{}aV.FineTuningJobCheckpointsPage=a$;class aW extends a_{constructor(){super(...arguments),this.checkpoints=new aV(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",aj,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return r3(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,aX,{query:t,...r})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class aj extends aN{}class aX extends aN{}aW.FineTuningJobsPage=aj,aW.FineTuningJobEventsPage=aX,aW.Checkpoints=aV,aW.FineTuningJobCheckpointsPage=a$;class aK extends a_{constructor(){super(...arguments),this.methods=new aF(this._client),this.jobs=new aW(this._client),this.checkpoints=new aY(this._client),this.alpha=new ax(this._client)}}aK.Methods=aF,aK.Jobs=aW,aK.FineTuningJobsPage=aj,aK.FineTuningJobEventsPage=aX,aK.Checkpoints=aY,aK.Alpha=ax;class aZ extends a_{}class aq extends a_{constructor(){super(...arguments),this.graderModels=new aZ(this._client)}}aq.GraderModels=aZ;let aJ=async e=>{let t=await Promise.allSettled(e),r=t.filter(e=>"rejected"===e.status);if(r.length){for(let e of r)console.error(e.reason);throw Error(`${r.length} promise(s) failed - see the above errors`)}let a=[];for(let e of t)"fulfilled"===e.status&&a.push(e.value);return a};class az extends a_{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,a){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,aQ,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){let a=await this.create(e,t,r);return await this.poll(e,a.id,r)}async poll(e,t,r){let a={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){let s=await this.retrieve(e,t,{...r,headers:a}).withResponse(),i=s.data;switch(i.status){case"in_progress":let n=5e3;if(r?.pollIntervalMs)n=r.pollIntervalMs;else{let e=s.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(n=t)}}await as(n);break;case"failed":case"completed":return i}}}async upload(e,t,r){let a=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:a.id},r)}async uploadAndPoll(e,t,r){let a=await this.upload(e,t,r);return await this.poll(e,a.id,r)}content(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,a0,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class aQ extends aN{}class a0 extends af{}az.VectorStoreFilesPage=aQ,az.FileContentResponsesPage=a0;class a1 extends a_{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){let a=await this.create(e,t);return await this.poll(e,a.id,r)}listFiles(e,t,r={},a){return r3(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,aQ,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}async poll(e,t,r){let a={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){let{data:s,response:i}=await this.retrieve(e,t,{...r,headers:a}).withResponse();switch(s.status){case"in_progress":let n=5e3;if(r?.pollIntervalMs)n=r.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(n=t)}}await as(n);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},a){if(null==t||0==t.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let s=a?.maxConcurrency??5,i=Math.min(s,t.length),n=this._client,o=t.values(),l=[...r];async function E(e){for(let t of e){let e=await n.files.create({file:t,purpose:"assistants"},a);l.push(e.id)}}let u=Array(i).fill(o).map(E);return await aJ(u),await this.createAndPoll(e,{file_ids:l})}}class a2 extends a_{constructor(){super(...arguments),this.files=new az(this._client),this.fileBatches=new a1(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/vector_stores",a4,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/search`,a9,{body:t,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class a4 extends aN{}class a9 extends af{}a2.VectorStoresPage=a4,a2.VectorStoreSearchResponsesPage=a9,a2.Files=az,a2.VectorStoreFilesPage=aQ,a2.FileContentResponsesPage=a0,a2.FileBatches=a1;class a5 extends a_{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/assistants",a3,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class a3 extends aN{}function a6(e){return"function"==typeof e.parse}a5.AssistantsPage=a3;let a8=e=>e?.role==="assistant",a7=e=>e?.role==="function",se=e=>e?.role==="tool";var st=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},sr=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};class sa{constructor(){L.add(this),this.controller=new AbortController,y.set(this,void 0),g.set(this,()=>{}),P.set(this,()=>{}),b.set(this,void 0),D.set(this,()=>{}),v.set(this,()=>{}),M.set(this,{}),U.set(this,!1),w.set(this,!1),G.set(this,!1),B.set(this,!1),st(this,y,new Promise((e,t)=>{st(this,g,e,"f"),st(this,P,t,"f")}),"f"),st(this,b,new Promise((e,t)=>{st(this,D,e,"f"),st(this,v,t,"f")}),"f"),sr(this,y,"f").catch(()=>{}),sr(this,b,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},sr(this,L,"m",F).bind(this))},0)}_connected(){this.ended||(sr(this,g,"f").call(this),this._emit("connect"))}get ended(){return sr(this,U,"f")}get errored(){return sr(this,w,"f")}get aborted(){return sr(this,G,"f")}abort(){this.controller.abort()}on(e,t){let r=sr(this,M,"f")[e]||(sr(this,M,"f")[e]=[]);return r.push({listener:t}),this}off(e,t){let r=sr(this,M,"f")[e];if(!r)return this;let a=r.findIndex(e=>e.listener===t);return a>=0&&r.splice(a,1),this}once(e,t){let r=sr(this,M,"f")[e]||(sr(this,M,"f")[e]=[]);return r.push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{st(this,B,!0,"f"),"error"!==e&&this.once("error",r),this.once(e,t)})}async done(){st(this,B,!0,"f"),await sr(this,b,"f")}_emit(e,...t){if(sr(this,U,"f"))return;"end"===e&&(st(this,U,!0,"f"),sr(this,D,"f").call(this));let r=sr(this,M,"f")[e];if(r&&(sr(this,M,"f")[e]=r.filter(e=>!e.once),r.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];sr(this,B,"f")||r?.length||Promise.reject(e),sr(this,P,"f").call(this,e),sr(this,v,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];sr(this,B,"f")||r?.length||Promise.reject(e),sr(this,P,"f").call(this,e),sr(this,v,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function ss(e){return e?.$brand==="auto-parseable-response-format"}function si(e){return e?.$brand==="auto-parseable-tool"}function sn(e,t){let r=e.choices.map(e=>{if("length"===e.finish_reason)throw new ry;if("content_filter"===e.finish_reason)throw new rg;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map(e=>(function(e,t){let r=e.tools?.find(e=>e.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:si(r)?r.$parseRaw(t.function.arguments):r?.function.strict?JSON.parse(t.function.arguments):null}}})(t,e))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?function(e,t){if(e.response_format?.type!=="json_schema")return null;if(e.response_format?.type==="json_schema"){if("$parseRaw"in e.response_format){let r=e.response_format;return r.$parseRaw(t)}return JSON.parse(t)}return null}(t,e.message.content):null}}});return{...e,choices:r}}function so(e){return!!ss(e.response_format)||(e.tools?.some(e=>si(e)||"function"===e.type&&!0===e.function.strict)??!1)}y=new WeakMap,g=new WeakMap,P=new WeakMap,b=new WeakMap,D=new WeakMap,v=new WeakMap,M=new WeakMap,U=new WeakMap,w=new WeakMap,G=new WeakMap,B=new WeakMap,L=new WeakSet,F=function(e){if(st(this,w,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new rp),e instanceof rp)return st(this,G,!0,"f"),this._emit("abort",e);if(e instanceof rh)return this._emit("error",e);if(e instanceof Error){let t=new rh(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new rh(String(e)))};var sl=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};class sE extends sa{constructor(){super(...arguments),H.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(a7(e)||se(e))&&e.content)this._emit("functionCallResult",e.content);else if(a8(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(a8(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new rh("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),sl(this,H,"m",x).call(this)}async finalMessage(){return await this.done(),sl(this,H,"m",k).call(this)}async finalFunctionCall(){return await this.done(),sl(this,H,"m",Y).call(this)}async finalFunctionCallResult(){return await this.done(),sl(this,H,"m",V).call(this)}async totalUsage(){return await this.done(),sl(this,H,"m",$).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=sl(this,H,"m",k).call(this);t&&this._emit("finalMessage",t);let r=sl(this,H,"m",x).call(this);r&&this._emit("finalContent",r);let a=sl(this,H,"m",Y).call(this);a&&this._emit("finalFunctionCall",a);let s=sl(this,H,"m",V).call(this);null!=s&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",sl(this,H,"m",$).call(this))}async _createChatCompletion(e,t,r){let a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),sl(this,H,"m",W).call(this,t);let s=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(sn(s,t))}async _runChatCompletion(e,t,r){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){let a="function",{function_call:s="auto",stream:i,...n}=t,o="string"!=typeof s&&s?.name,{maxChatCompletions:l=10}=r||{},E={};for(let e of t.functions)E[e.name||e.function.name]=e;let u=t.functions.map(e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description}));for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t;let i=await this._createChatCompletion(e,{...n,function_call:s,functions:u,messages:[...this.messages]},r),l=i.choices[0]?.message;if(!l)throw new rh("missing message in ChatCompletion response");if(!l.function_call)return;let{name:c,arguments:T}=l.function_call,d=E[c];if(d){if(o&&o!==c){let e=`Invalid function_call: ${JSON.stringify(c)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:a,name:c,content:e});continue}}else{let e=`Invalid function_call: ${JSON.stringify(c)}. Available options are: ${u.map(e=>JSON.stringify(e.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:c,content:e});continue}try{t=a6(d)?await d.parse(T):T}catch(e){this._addMessage({role:a,name:c,content:e instanceof Error?e.message:String(e)});continue}let h=await d.function(t,this),A=sl(this,H,"m",j).call(this,h);if(this._addMessage({role:a,name:c,content:A}),o)return}}async _runTools(e,t,r){let a="tool",{tool_choice:s="auto",stream:i,...n}=t,o="string"!=typeof s&&s?.function?.name,{maxChatCompletions:l=10}=r||{},E=t.tools.map(e=>{if(si(e)){if(!e.$callback)throw new rh("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),u={};for(let e of E)"function"===e.type&&(u[e.function.name||e.function.function.name]=e.function);let c="tools"in t?E.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t=await this._createChatCompletion(e,{...n,tool_choice:s,tools:c,messages:[...this.messages]},r),i=t.choices[0]?.message;if(!i)throw new rh("missing message in ChatCompletion response");if(!i.tool_calls?.length)break;for(let e of i.tool_calls){let t;if("function"!==e.type)continue;let r=e.id,{name:s,arguments:i}=e.function,n=u[s];if(n){if(o&&o!==s){let e=`Invalid tool_call: ${JSON.stringify(s)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:a,tool_call_id:r,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(s)}. Available options are: ${Object.keys(u).map(e=>JSON.stringify(e)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:r,content:e});continue}try{t=a6(n)?await n.parse(i):i}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:a,tool_call_id:r,content:e});continue}let l=await n.function(t,this),E=sl(this,H,"m",j).call(this,l);if(this._addMessage({role:a,tool_call_id:r,content:E}),o)return}}}}H=new WeakSet,x=function(){return sl(this,H,"m",k).call(this).content??null},k=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(a8(t)){let{function_call:e,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return e&&(a.function_call=e),a}}throw new rh("stream ended without producing a ChatCompletionMessage with role=assistant")},Y=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(a8(t)&&t?.function_call)return t.function_call;if(a8(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},V=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(a7(t)&&null!=t.content||se(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},$=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},W=function(e){if(null!=e.n&&e.n>1)throw new rh("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},j=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class su extends sE{static runFunctions(e,t,r){let a=new su,s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(e,t,s)),a}static runTools(e,t,r){let a=new su,s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,t,s)),a}_addMessage(e,t=!0){super._addMessage(e,t),a8(e)&&e.content&&this._emit("content",e.content)}}let sc={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,ALL:511};class sT extends Error{}class sd extends Error{}let sh=(e,t)=>{let r=e.length,a=0,s=e=>{throw new sT(`${e} at position ${a}`)},i=e=>{throw new sd(`${e} at position ${a}`)},n=()=>(c(),a>=r&&s("Unexpected end of input"),'"'===e[a])?o():"{"===e[a]?l():"["===e[a]?E():"null"===e.substring(a,a+4)||sc.NULL&t&&r-a<4&&"null".startsWith(e.substring(a))?(a+=4,null):"true"===e.substring(a,a+4)||sc.BOOL&t&&r-a<4&&"true".startsWith(e.substring(a))?(a+=4,!0):"false"===e.substring(a,a+5)||sc.BOOL&t&&r-a<5&&"false".startsWith(e.substring(a))?(a+=5,!1):"Infinity"===e.substring(a,a+8)||sc.INFINITY&t&&r-a<8&&"Infinity".startsWith(e.substring(a))?(a+=8,1/0):"-Infinity"===e.substring(a,a+9)||sc.MINUS_INFINITY&t&&1<r-a&&r-a<9&&"-Infinity".startsWith(e.substring(a))?(a+=9,-1/0):"NaN"===e.substring(a,a+3)||sc.NAN&t&&r-a<3&&"NaN".startsWith(e.substring(a))?(a+=3,NaN):u(),o=()=>{let n=a,o=!1;for(a++;a<r&&('"'!==e[a]||o&&"\\"===e[a-1]);)o="\\"===e[a]&&!o,a++;if('"'==e.charAt(a))try{return JSON.parse(e.substring(n,++a-Number(o)))}catch(e){i(String(e))}else if(sc.STR&t)try{return JSON.parse(e.substring(n,a-Number(o))+'"')}catch(t){return JSON.parse(e.substring(n,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{a++,c();let i={};try{for(;"}"!==e[a];){if(c(),a>=r&&sc.OBJ&t)return i;let s=o();c(),a++;try{let e=n();Object.defineProperty(i,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(sc.OBJ&t)return i;throw e}c(),","===e[a]&&a++}}catch(e){if(sc.OBJ&t)return i;s("Expected '}' at end of object")}return a++,i},E=()=>{a++;let r=[];try{for(;"]"!==e[a];)r.push(n()),c(),","===e[a]&&a++}catch(e){if(sc.ARR&t)return r;s("Expected ']' at end of array")}return a++,r},u=()=>{if(0===a){"-"===e&&sc.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(r){if(sc.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}i(String(r))}}let n=a;for("-"===e[a]&&a++;e[a]&&!",]}".includes(e[a]);)a++;a!=r||sc.NUM&t||s("Unterminated number literal");try{return JSON.parse(e.substring(n,a))}catch(r){"-"===e.substring(n,a)&&sc.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e.substring(n,e.lastIndexOf("e")))}catch(e){i(String(e))}}},c=()=>{for(;a<r&&" \n\r	".includes(e[a]);)a++};return n()},sA=e=>(function(e,t=sc.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return sh(e.trim(),t)})(e,sc.ALL^sc.NUM);var sp=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},sR=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};class sS extends sE{constructor(e){super(),X.add(this),K.set(this,void 0),Z.set(this,void 0),q.set(this,void 0),sp(this,K,e,"f"),sp(this,Z,[],"f")}get currentChatCompletionSnapshot(){return sR(this,q,"f")}static fromReadableStream(e){let t=new sS(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){let a=new sS(t);return a._run(()=>a._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,t,r){super._createChatCompletion;let a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),sR(this,X,"m",J).call(this);let s=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});for await(let e of(this._connected(),s))sR(this,X,"m",Q).call(this,e);if(s.controller.signal?.aborted)throw new rp;return this._addChatCompletion(sR(this,X,"m",er).call(this))}async _fromReadableStream(e,t){let r;let a=t?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),sR(this,X,"m",J).call(this),this._connected();let s=rM.fromReadableStream(e,this.controller);for await(let e of s)r&&r!==e.id&&this._addChatCompletion(sR(this,X,"m",er).call(this)),sR(this,X,"m",Q).call(this,e),r=e.id;if(s.controller.signal?.aborted)throw new rp;return this._addChatCompletion(sR(this,X,"m",er).call(this))}[(K=new WeakMap,Z=new WeakMap,q=new WeakMap,X=new WeakSet,J=function(){this.ended||sp(this,q,void 0,"f")},z=function(e){let t=sR(this,Z,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},sR(this,Z,"f")[e.index]=t),t},Q=function(e){if(this.ended)return;let t=sR(this,X,"m",es).call(this,e);for(let r of(this._emit("chunk",e,t),e.choices)){let e=t.choices[r.index];null!=r.delta.content&&e.message?.role==="assistant"&&e.message?.content&&(this._emit("content",r.delta.content,e.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=r.delta.refusal&&e.message?.role==="assistant"&&e.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:e.message.refusal}),r.logprobs?.content!=null&&e.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:e.logprobs?.content??[]}),r.logprobs?.refusal!=null&&e.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});let a=sR(this,X,"m",z).call(this,e);for(let t of(e.finish_reason&&(sR(this,X,"m",et).call(this,e),null!=a.current_tool_call_index&&sR(this,X,"m",ee).call(this,e,a.current_tool_call_index)),r.delta.tool_calls??[]))a.current_tool_call_index!==t.index&&(sR(this,X,"m",et).call(this,e),null!=a.current_tool_call_index&&sR(this,X,"m",ee).call(this,e,a.current_tool_call_index)),a.current_tool_call_index=t.index;for(let t of r.delta.tool_calls??[]){let r=e.message.tool_calls?.[t.index];r?.type&&(r?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:r.function?.name,index:t.index,arguments:r.function.arguments,parsed_arguments:r.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):r?.type)}}},ee=function(e,t){let r=sR(this,X,"m",z).call(this,e);if(r.done_tool_calls.has(t))return;let a=e.message.tool_calls?.[t];if(!a)throw Error("no tool call snapshot");if(!a.type)throw Error("tool call snapshot missing `type`");if("function"===a.type){let e=sR(this,K,"f")?.tools?.find(e=>"function"===e.type&&e.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:t,arguments:a.function.arguments,parsed_arguments:si(e)?e.$parseRaw(a.function.arguments):e?.function.strict?JSON.parse(a.function.arguments):null})}else a.type},et=function(e){let t=sR(this,X,"m",z).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;let r=sR(this,X,"m",ea).call(this);this._emit("content.done",{content:e.message.content,parsed:r?r.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},er=function(){if(this.ended)throw new rh("stream has ended, this shouldn't happen");let e=sR(this,q,"f");if(!e)throw new rh("request ended without sending any chunks");return sp(this,q,void 0,"f"),sp(this,Z,[],"f"),function(e,t){let{id:r,choices:a,created:s,model:i,system_fingerprint:n,...o}=e,l={...o,id:r,choices:a.map(({message:t,finish_reason:r,index:a,logprobs:s,...i})=>{if(!r)throw new rh(`missing finish_reason for choice ${a}`);let{content:n=null,function_call:o,tool_calls:l,...E}=t,u=t.role;if(!u)throw new rh(`missing role for choice ${a}`);if(o){let{arguments:e,name:l}=o;if(null==e)throw new rh(`missing function_call.arguments for choice ${a}`);if(!l)throw new rh(`missing function_call.name for choice ${a}`);return{...i,message:{content:n,function_call:{arguments:e,name:l},role:u,refusal:t.refusal??null},finish_reason:r,index:a,logprobs:s}}return l?{...i,index:a,finish_reason:r,logprobs:s,message:{...E,role:u,content:n,refusal:t.refusal??null,tool_calls:l.map((t,r)=>{let{function:s,type:i,id:n,...o}=t,{arguments:l,name:E,...u}=s||{};if(null==n)throw new rh(`missing choices[${a}].tool_calls[${r}].id
${s_(e)}`);if(null==i)throw new rh(`missing choices[${a}].tool_calls[${r}].type
${s_(e)}`);if(null==E)throw new rh(`missing choices[${a}].tool_calls[${r}].function.name
${s_(e)}`);if(null==l)throw new rh(`missing choices[${a}].tool_calls[${r}].function.arguments
${s_(e)}`);return{...o,id:n,type:i,function:{...u,name:E,arguments:l}}})}}:{...i,message:{...E,content:n,role:u,refusal:t.refusal??null},finish_reason:r,index:a,logprobs:s}}),created:s,model:i,object:"chat.completion",...n?{system_fingerprint:n}:{}};return t&&so(t)?sn(l,t):{...l,choices:l.choices.map(e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}}(e,sR(this,K,"f"))},ea=function(){let e=sR(this,K,"f")?.response_format;return ss(e)?e:null},es=function(e){var t,r,a,s;let i=sR(this,q,"f"),{choices:n,...o}=e;for(let{delta:n,finish_reason:l,index:E,logprobs:u=null,...c}of(i?Object.assign(i,o):i=sp(this,q,{...o,choices:[]},"f"),e.choices)){let e=i.choices[E];if(e||(e=i.choices[E]={finish_reason:l,index:E,message:{},logprobs:u,...c}),u){if(e.logprobs){let{content:a,refusal:s,...i}=u;Object.assign(e.logprobs,i),a&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...a)),s&&((r=e.logprobs).refusal??(r.refusal=[]),e.logprobs.refusal.push(...s))}else e.logprobs=Object.assign({},u)}if(l&&(e.finish_reason=l,sR(this,K,"f")&&so(sR(this,K,"f")))){if("length"===l)throw new ry;if("content_filter"===l)throw new rg}if(Object.assign(e,c),!n)continue;let{content:o,refusal:T,function_call:d,role:h,tool_calls:A,...p}=n;if(Object.assign(e.message,p),T&&(e.message.refusal=(e.message.refusal||"")+T),h&&(e.message.role=h),d&&(e.message.function_call?(d.name&&(e.message.function_call.name=d.name),d.arguments&&((a=e.message.function_call).arguments??(a.arguments=""),e.message.function_call.arguments+=d.arguments)):e.message.function_call=d),o&&(e.message.content=(e.message.content||"")+o,!e.message.refusal&&sR(this,X,"m",ea).call(this)&&(e.message.parsed=sA(e.message.content))),A)for(let{index:t,id:r,type:a,function:i,...n}of(e.message.tool_calls||(e.message.tool_calls=[]),A)){let o=(s=e.message.tool_calls)[t]??(s[t]={});Object.assign(o,n),r&&(o.id=r),a&&(o.type=a),i&&(o.function??(o.function={name:i.name??"",arguments:""})),i?.name&&(o.function.name=i.name),i?.arguments&&(o.function.arguments+=i.arguments,function(e,t){if(!e)return!1;let r=e.tools?.find(e=>e.function?.name===t.function.name);return si(r)||r?.function.strict||!1}(sR(this,K,"f"),o)&&(o.function.parsed_arguments=sA(o.function.arguments)))}}return i},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("chunk",r=>{let a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let a of(r=!0,t))a.reject(e);t.length=0}),this.on("error",e=>{for(let a of(r=!0,t))a.reject(e);t.length=0}),{next:async()=>{if(!e.length)return r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let a=e.shift();return{value:a,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){let e=new rM(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}}function s_(e){return JSON.stringify(e)}class sO extends sS{static fromReadableStream(e){let t=new sO(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){let a=new sO(null),s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(e,t,s)),a}static runTools(e,t,r){let a=new sO(t),s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,t,s)),a}}class sI extends a_{parse(e,t){return function(e){for(let t of e??[]){if("function"!==t.type)throw new rh(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new rh(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(t=>sn(t,e))}runFunctions(e,t){return e.stream?sO.runFunctions(this._client,e,t):su.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?sO.runTools(this._client,e,t):su.runTools(this._client,e,t)}stream(e,t){return sS.createChatCompletion(this._client,e,t)}}class sf extends a_{constructor(){super(...arguments),this.completions=new sI(this._client)}}(sf||(sf={})).Completions=sI;class sN extends a_{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class sm extends a_{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class sC extends a_{constructor(){super(...arguments),this.sessions=new sN(this._client),this.transcriptionSessions=new sm(this._client)}}sC.Sessions=sN,sC.TranscriptionSessions=sm;var sL=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)},sy=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r};class sg extends sa{constructor(){super(...arguments),ei.add(this),en.set(this,[]),eo.set(this,{}),el.set(this,{}),eE.set(this,void 0),eu.set(this,void 0),ec.set(this,void 0),eT.set(this,void 0),ed.set(this,void 0),eh.set(this,void 0),eA.set(this,void 0),ep.set(this,void 0),eR.set(this,void 0)}[(en=new WeakMap,eo=new WeakMap,el=new WeakMap,eE=new WeakMap,eu=new WeakMap,ec=new WeakMap,eT=new WeakMap,ed=new WeakMap,eh=new WeakMap,eA=new WeakMap,ep=new WeakMap,eR=new WeakMap,ei=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let a of(r=!0,t))a.reject(e);t.length=0}),this.on("error",e=>{for(let a of(r=!0,t))a.reject(e);t.length=0}),{next:async()=>{if(!e.length)return r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let a=e.shift();return{value:a,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new sg;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();let a=rM.fromReadableStream(e,this.controller);for await(let e of a)sL(this,ei,"m",eS).call(this,e);if(a.controller.signal?.aborted)throw new rp;return this._addRun(sL(this,ei,"m",e_).call(this))}toReadableStream(){let e=new rM(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}static createToolAssistantStream(e,t,r,a,s){let i=new sg;return i._run(()=>i._runToolAssistantStream(e,t,r,a,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,r,a,s){let i=s?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let n={...a,stream:!0},o=await e.submitToolOutputs(t,r,n,{...s,signal:this.controller.signal});for await(let e of(this._connected(),o))sL(this,ei,"m",eS).call(this,e);if(o.controller.signal?.aborted)throw new rp;return this._addRun(sL(this,ei,"m",e_).call(this))}static createThreadAssistantStream(e,t,r){let a=new sg;return a._run(()=>a._threadAssistantStream(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,t,r,a){let s=new sg;return s._run(()=>s._runAssistantStream(e,t,r,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return sL(this,eA,"f")}currentRun(){return sL(this,ep,"f")}currentMessageSnapshot(){return sL(this,eE,"f")}currentRunStepSnapshot(){return sL(this,eR,"f")}async finalRunSteps(){return await this.done(),Object.values(sL(this,eo,"f"))}async finalMessages(){return await this.done(),Object.values(sL(this,el,"f"))}async finalRun(){if(await this.done(),!sL(this,eu,"f"))throw Error("Final run was not received.");return sL(this,eu,"f")}async _createThreadAssistantStream(e,t,r){let a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));let s={...t,stream:!0},i=await e.createAndRun(s,{...r,signal:this.controller.signal});for await(let e of(this._connected(),i))sL(this,ei,"m",eS).call(this,e);if(i.controller.signal?.aborted)throw new rp;return this._addRun(sL(this,ei,"m",e_).call(this))}async _createAssistantStream(e,t,r,a){let s=a?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let i={...r,stream:!0},n=await e.create(t,i,{...a,signal:this.controller.signal});for await(let e of(this._connected(),n))sL(this,ei,"m",eS).call(this,e);if(n.controller.signal?.aborted)throw new rp;return this._addRun(sL(this,ei,"m",e_).call(this))}static accumulateDelta(e,t){for(let[r,a]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=a;continue}let t=e[r];if(null==t||"index"===r||"type"===r){e[r]=a;continue}if("string"==typeof t&&"string"==typeof a)t+=a;else if("number"==typeof t&&"number"==typeof a)t+=a;else if(aS(t)&&aS(a))t=this.accumulateDelta(t,a);else if(Array.isArray(t)&&Array.isArray(a)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...a);continue}for(let e of a){if(!aS(e))throw Error(`Expected array delta entry to be an object but got: ${e}`);let r=e.index;if(null==r)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof r)throw Error(`Expected array delta entry \`index\` property to be a number but got ${r}`);let a=t[r];null==a?t.push(e):t[r]=this.accumulateDelta(a,e)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${t}`);e[r]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,a){return await this._createAssistantStream(t,e,r,a)}async _runToolAssistantStream(e,t,r,a,s){return await this._createToolAssistantStream(r,e,t,a,s)}}eS=function(e){if(!this.ended)switch(sy(this,eA,e,"f"),sL(this,ei,"m",ef).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":sL(this,ei,"m",eL).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":sL(this,ei,"m",eI).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":sL(this,ei,"m",eO).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},e_=function(){if(this.ended)throw new rh("stream has ended, this shouldn't happen");if(!sL(this,eu,"f"))throw Error("Final run has not been received");return sL(this,eu,"f")},eO=function(e){let[t,r]=sL(this,ei,"m",em).call(this,e,sL(this,eE,"f"));for(let e of(sy(this,eE,t,"f"),sL(this,el,"f")[t.id]=t,r)){let r=t.content[e.index];r?.type=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let r of e.data.delta.content){if("text"==r.type&&r.text){let e=r.text,a=t.content[r.index];if(a&&"text"==a.type)this._emit("textDelta",e,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=sL(this,ec,"f")){if(sL(this,eT,"f"))switch(sL(this,eT,"f").type){case"text":this._emit("textDone",sL(this,eT,"f").text,sL(this,eE,"f"));break;case"image_file":this._emit("imageFileDone",sL(this,eT,"f").image_file,sL(this,eE,"f"))}sy(this,ec,r.index,"f")}sy(this,eT,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==sL(this,ec,"f")){let t=e.data.content[sL(this,ec,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,sL(this,eE,"f"));break;case"text":this._emit("textDone",t.text,sL(this,eE,"f"))}}sL(this,eE,"f")&&this._emit("messageDone",e.data),sy(this,eE,void 0,"f")}},eI=function(e){let t=sL(this,ei,"m",eN).call(this,e);switch(sy(this,eR,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let r=e.data.delta;if(r.step_details&&"tool_calls"==r.step_details.type&&r.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of r.step_details.tool_calls)e.index==sL(this,ed,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(sL(this,eh,"f")&&this._emit("toolCallDone",sL(this,eh,"f")),sy(this,ed,e.index,"f"),sy(this,eh,t.step_details.tool_calls[e.index],"f"),sL(this,eh,"f")&&this._emit("toolCallCreated",sL(this,eh,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":sy(this,eR,void 0,"f");let a=e.data.step_details;"tool_calls"==a.type&&sL(this,eh,"f")&&(this._emit("toolCallDone",sL(this,eh,"f")),sy(this,eh,void 0,"f")),this._emit("runStepDone",e.data,t)}},ef=function(e){sL(this,en,"f").push(e),this._emit("event",e)},eN=function(e){switch(e.event){case"thread.run.step.created":return sL(this,eo,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=sL(this,eo,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){let a=sg.accumulateDelta(t,r.delta);sL(this,eo,"f")[e.data.id]=a}return sL(this,eo,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":sL(this,eo,"f")[e.data.id]=e.data}if(sL(this,eo,"f")[e.data.id])return sL(this,eo,"f")[e.data.id];throw Error("No snapshot available")},em=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(let e of a.delta.content)if(e.index in t.content){let r=t.content[e.index];t.content[e.index]=sL(this,ei,"m",eC).call(this,e,r)}else t.content[e.index]=e,r.push(e);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},eC=function(e,t){return sg.accumulateDelta(t,e)},eL=function(e){switch(sy(this,ep,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":sy(this,eu,e.data,"f"),sL(this,eh,"f")&&(this._emit("toolCallDone",sL(this,eh,"f")),sy(this,eh,void 0,"f"))}};class sP extends a_{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,a){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,sb,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class sb extends aN{}sP.MessagesPage=sb;class sD extends a_{retrieve(e,t,r,a={},s){return r3(a)?this.retrieve(e,t,r,{},a):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:a,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t,r={},a){return r3(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,sv,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}}class sv extends aN{}sD.RunStepsPage=sv;class sM extends a_{constructor(){super(...arguments),this.steps=new sD(this._client)}create(e,t,r){let{include:a,...s}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:a},body:s,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,a){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,sU,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){let a=await this.create(e,t,r);return await this.poll(e,a.id,r)}createAndStream(e,t,r){return sg.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){let a={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){let{data:s,response:i}=await this.retrieve(e,t,{...r,headers:{...r?.headers,...a}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let n=5e3;if(r?.pollIntervalMs)n=r.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(n=t)}}await as(n);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,r){return sg.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,a){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,a){let s=await this.submitToolOutputs(e,t,r,a);return await this.poll(e,s.id,a)}submitToolOutputsStream(e,t,r,a){return sg.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,a)}}class sU extends aN{}sM.RunsPage=sU,sM.Steps=sD,sM.RunStepsPage=sv;class sw extends a_{constructor(){super(...arguments),this.runs=new sM(this._client),this.messages=new sP(this._client)}create(e={},t){return r3(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){let r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return sg.createThreadAssistantStream(e,this._client.beta.threads,t)}}sw.Runs=sM,sw.RunsPage=sU,sw.Messages=sP,sw.MessagesPage=sb;class sG extends a_{constructor(){super(...arguments),this.realtime=new sC(this._client),this.chat=new sf(this._client),this.assistants=new a5(this._client),this.threads=new sw(this._client)}}sG.Realtime=sC,sG.Assistants=a5,sG.AssistantsPage=a3,sG.Threads=sw;class sB extends a_{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/batches",sF,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class sF extends aN{}sB.BatchesPage=sF;class sH extends a_{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,rj({body:t,...r}))}}class sx extends a_{constructor(){super(...arguments),this.parts=new sH(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}function sk(e,t){let r=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){var r,a,s;let i=(r=e.tools??[],a=t.name,r.find(e=>"function"===e.type&&e.name===a));return{...t,...t,parsed_arguments:(s=i,s?.$brand==="auto-parseable-tool")?i.$parseRaw(t.arguments):i?.strict?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let r=e.content.map(e=>"output_text"===e.type?{...e,parsed:function(e,t){if(e.text?.format?.type!=="json_schema")return null;if("$parseRaw"in e.text?.format){let r=e.text?.format;return r.$parseRaw(t)}return JSON.parse(t)}(t,e.text)}:e);return{...e,content:r}}return e}),a=Object.assign({},e,{output:r});return Object.getOwnPropertyDescriptor(e,"output_text")||sY(a),Object.defineProperty(a,"output_parsed",{enumerable:!0,get(){for(let e of a.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),a}function sY(e){let t=[];for(let r of e.output)if("message"===r.type)for(let e of r.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}sx.Parts=sH;class sV extends a_{list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,sK,{query:t,...r})}}var s$=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},sW=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};class sj extends sa{constructor(e){super(),ey.add(this),eg.set(this,void 0),eP.set(this,void 0),eb.set(this,void 0),s$(this,eg,e,"f")}static createResponse(e,t,r){let a=new sj(t);return a._run(()=>a._createOrRetrieveResponse(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,t,r){let a;let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),sW(this,ey,"m",eD).call(this);let i=null;for await(let s of("response_id"in t?(a=await e.responses.retrieve(t.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),i=t.starting_after??null):a=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal}),this._connected(),a))sW(this,ey,"m",ev).call(this,s,i);if(a.controller.signal?.aborted)throw new rp;return sW(this,ey,"m",eM).call(this)}[(eg=new WeakMap,eP=new WeakMap,eb=new WeakMap,ey=new WeakSet,eD=function(){this.ended||s$(this,eP,void 0,"f")},ev=function(e,t){if(this.ended)return;let r=(e,r)=>{(null==t||r.sequence_number>t)&&this._emit(e,r)},a=sW(this,ey,"m",eU).call(this,e);switch(r("event",e),e.type){case"response.output_text.delta":{let t=a.output[e.output_index];if(!t)throw new rh(`missing output at index ${e.output_index}`);if("message"===t.type){let a=t.content[e.content_index];if(!a)throw new rh(`missing content at index ${e.content_index}`);if("output_text"!==a.type)throw new rh(`expected content to be 'output_text', got ${a.type}`);r("response.output_text.delta",{...e,snapshot:a.text})}break}case"response.function_call_arguments.delta":{let t=a.output[e.output_index];if(!t)throw new rh(`missing output at index ${e.output_index}`);"function_call"===t.type&&r("response.function_call_arguments.delta",{...e,snapshot:t.arguments});break}default:r(e.type,e)}},eM=function(){if(this.ended)throw new rh("stream has ended, this shouldn't happen");let e=sW(this,eP,"f");if(!e)throw new rh("request ended without sending any events");s$(this,eP,void 0,"f");let t=function(e,t){return t&&ss(t.text?.format)?sk(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}}(e,sW(this,eg,"f"));return s$(this,eb,t,"f"),t},eU=function(e){let t=sW(this,eP,"f");if(!t){if("response.created"!==e.type)throw new rh(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return s$(this,eP,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let r=t.output[e.output_index];if(!r)throw new rh(`missing output at index ${e.output_index}`);"message"===r.type&&r.content.push(e.part);break}case"response.output_text.delta":{let r=t.output[e.output_index];if(!r)throw new rh(`missing output at index ${e.output_index}`);if("message"===r.type){let t=r.content[e.content_index];if(!t)throw new rh(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new rh(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{let r=t.output[e.output_index];if(!r)throw new rh(`missing output at index ${e.output_index}`);"function_call"===r.type&&(r.arguments+=e.delta);break}case"response.completed":s$(this,eP,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let a of(r=!0,t))a.reject(e);t.length=0}),this.on("error",e=>{for(let a of(r=!0,t))a.reject(e);t.length=0}),{next:async()=>{if(!e.length)return r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let a=e.shift();return{value:a,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=sW(this,eb,"f");if(!e)throw new rh("stream ended without producing a ChatCompletion");return e}}class sX extends a_{constructor(){super(...arguments),this.inputItems=new sV(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&sY(e),e))}retrieve(e,t={},r){return this._client.get(`/responses/${e}`,{query:t,...r,stream:t?.stream??!1})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>sk(t,e))}stream(e,t){return sj.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(`/responses/${e}/cancel`,{...t,headers:{Accept:"*/*",...t?.headers}})}}class sK extends aN{}sX.InputItems=sV;class sZ extends a_{retrieve(e,t,r,a){return this._client.get(`/evals/${e}/runs/${t}/output_items/${r}`,a)}list(e,t,r={},a){return r3(r)?this.list(e,t,{},r):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,sq,{query:r,...a})}}class sq extends aN{}sZ.OutputItemListResponsesPage=sq;class sJ extends a_{constructor(){super(...arguments),this.outputItems=new sZ(this._client)}create(e,t,r){return this._client.post(`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){return this._client.get(`/evals/${e}/runs/${t}`,r)}list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,sz,{query:t,...r})}del(e,t,r){return this._client.delete(`/evals/${e}/runs/${t}`,r)}cancel(e,t,r){return this._client.post(`/evals/${e}/runs/${t}`,r)}}class sz extends aN{}sJ.RunListResponsesPage=sz,sJ.OutputItems=sZ,sJ.OutputItemListResponsesPage=sq;class sQ extends a_{constructor(){super(...arguments),this.runs=new sJ(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,r){return this._client.post(`/evals/${e}`,{body:t,...r})}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/evals",s0,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class s0 extends aN{}sQ.EvalListResponsesPage=s0,sQ.Runs=sJ,sQ.RunListResponsesPage=sz;class s1 extends a_{retrieve(e,t,r){return this._client.get(`/containers/${e}/files/${t}/content`,{...r,headers:{Accept:"application/binary",...r?.headers},__binaryResponse:!0})}}class s2 extends a_{constructor(){super(...arguments),this.content=new s1(this._client)}create(e,t,r){return this._client.post(`/containers/${e}/files`,rj({body:t,...r}))}retrieve(e,t,r){return this._client.get(`/containers/${e}/files/${t}`,r)}list(e,t={},r){return r3(t)?this.list(e,{},t):this._client.getAPIList(`/containers/${e}/files`,s4,{query:t,...r})}del(e,t,r){return this._client.delete(`/containers/${e}/files/${t}`,{...r,headers:{Accept:"*/*",...r?.headers}})}}class s4 extends aN{}s2.FileListResponsesPage=s4,s2.Content=s1;class s9 extends a_{constructor(){super(...arguments),this.files=new s2(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(`/containers/${e}`,t)}list(e={},t){return r3(e)?this.list({},e):this._client.getAPIList("/containers",s5,{query:e,...t})}del(e,t){return this._client.delete(`/containers/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}}class s5 extends aN{}s9.ContainerListResponsesPage=s5,s9.Files=s2,s9.FileListResponsesPage=s4;class s3 extends r1{constructor({baseURL:e=ao("OPENAI_BASE_URL"),apiKey:t=ao("OPENAI_API_KEY"),organization:r=ao("OPENAI_ORG_ID")??null,project:a=ao("OPENAI_PROJECT_ID")??null,...s}={}){if(void 0===t)throw new rh("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let i={apiKey:t,organization:r,project:a,...s,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&ah())throw new rh("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new aO(this),this.chat=new ay(this),this.embeddings=new ag(this),this.files=new aP(this),this.images=new aD(this),this.audio=new Audio(this),this.moderations=new aw(this),this.models=new aG(this),this.fineTuning=new aK(this),this.graders=new aq(this),this.vectorStores=new a2(this),this.beta=new sG(this),this.batches=new sB(this),this.uploads=new sx(this),this.responses=new sX(this),this.evals=new sQ(this),this.containers=new s9(this),this._options=i,this.apiKey=t,this.organization=r,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return function(e,t={}){let r,a=e,s=function(e=e1){let t;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");let r=e.charset||e1.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let a=e$;if(void 0!==e.format){if(!eZ.call(eW,e.format))throw TypeError("Unknown format option provided.");a=e.format}let s=eW[a],i=e1.filter;if(("function"==typeof e.filter||eJ(e.filter))&&(i=e.filter),t=e.arrayFormat&&e.arrayFormat in eq?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":e1.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let n=void 0===e.allowDots?!0==!!e.encodeDotInKeys||e1.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:e1.addQueryPrefix,allowDots:n,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:e1.allowEmptyArrays,arrayFormat:t,charset:r,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:e1.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?e1.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:e1.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:e1.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:e1.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:e1.encodeValuesOnly,filter:i,format:a,formatter:s,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:e1.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:e1.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:e1.strictNullHandling}}(t);"function"==typeof s.filter?a=(0,s.filter)("",a):eJ(s.filter)&&(r=s.filter);let i=[];if("object"!=typeof a||null===a)return"";let n=eq[s.arrayFormat],o="comma"===n&&s.commaRoundTrip;r||(r=Object.keys(a)),s.sort&&r.sort(s.sort);let l=new WeakMap;for(let e=0;e<r.length;++e){let t=r[e];s.skipNulls&&null===a[t]||eQ(i,function e(t,r,a,s,i,n,o,l,E,u,c,T,d,h,A,p,R,S){var _,O;let I,f=t,N=S,m=0,C=!1;for(;void 0!==(N=N.get(e2))&&!C;){let e=N.get(t);if(m+=1,void 0!==e){if(e===m)throw RangeError("Cyclic object value");C=!0}void 0===N.get(e2)&&(m=0)}if("function"==typeof u?f=u(r,f):f instanceof Date?f=d?.(f):"comma"===a&&eJ(f)&&(f=eK(f,function(e){return e instanceof Date?d?.(e):e})),null===f){if(n)return E&&!p?E(r,e1.encoder,R,"key",h):r;f=""}if("string"==typeof(_=f)||"number"==typeof _||"boolean"==typeof _||"symbol"==typeof _||"bigint"==typeof _||(O=f)&&"object"==typeof O&&O.constructor&&O.constructor.isBuffer&&O.constructor.isBuffer(O)){if(E){let e=p?r:E(r,e1.encoder,R,"key",h);return[A?.(e)+"="+A?.(E(f,e1.encoder,R,"value",h))]}return[A?.(r)+"="+A?.(String(f))]}let L=[];if(void 0===f)return L;if("comma"===a&&eJ(f))p&&E&&(f=eK(f,E)),I=[{value:f.length>0?f.join(",")||null:void 0}];else if(eJ(u))I=u;else{let e=Object.keys(f);I=c?e.sort(c):e}let y=l?String(r).replace(/\./g,"%2E"):String(r),g=s&&eJ(f)&&1===f.length?y+"[]":y;if(i&&eJ(f)&&0===f.length)return g+"[]";for(let r=0;r<I.length;++r){let _=I[r],O="object"==typeof _&&void 0!==_.value?_.value:f[_];if(o&&null===O)continue;let N=T&&l?_.replace(/\./g,"%2E"):_,C=eJ(f)?"function"==typeof a?a(g,N):g:g+(T?"."+N:"["+N+"]");S.set(t,m);let y=new WeakMap;y.set(e2,S),eQ(L,e(O,C,a,s,i,n,o,l,"comma"===a&&p&&eJ(f)?null:E,u,c,T,d,h,A,p,R,y))}return L}(a[t],t,n,o,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}let E=i.join(s.delimiter),u=!0===s.addQueryPrefix?"?":"";return s.charsetSentinel&&("iso-8859-1"===s.charset?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),E.length>0?u+E:""}(e,{arrayFormat:"brackets"})}}s3.OpenAI=s3,s3.DEFAULT_TIMEOUT=6e5,s3.OpenAIError=rh,s3.APIError=rA,s3.APIConnectionError=rR,s3.APIConnectionTimeoutError=rS,s3.APIUserAbortError=rp,s3.NotFoundError=rf,s3.ConflictError=rN,s3.RateLimitError=rC,s3.BadRequestError=r_,s3.AuthenticationError=rO,s3.InternalServerError=rL,s3.PermissionDeniedError=rI,s3.UnprocessableEntityError=rm,s3.toFile=rk,s3.fileFromPath=E,s3.Completions=aO,s3.Chat=ay,s3.ChatCompletionsPage=aC,s3.Embeddings=ag,s3.Files=aP,s3.FileObjectsPage=ab,s3.Images=aD,s3.Audio=Audio,s3.Moderations=aw,s3.Models=aG,s3.ModelsPage=aB,s3.FineTuning=aK,s3.Graders=aq,s3.VectorStores=a2,s3.VectorStoresPage=a4,s3.VectorStoreSearchResponsesPage=a9,s3.Beta=sG,s3.Batches=sB,s3.BatchesPage=sF,s3.Uploads=sx,s3.Responses=sX,s3.Evals=sQ,s3.EvalListResponsesPage=s0,s3.Containers=s9,s3.ContainerListResponsesPage=s5;var s6=r(54519),s8=r(40247),s7=r(35387),ie=r(2576),it=r(48548),ir=r(74311);class ia extends it.qV{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptions(e){let[t,r]=super._separateRunnableConfigFromCallOptions(e);return r?.timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout)),[t,r]}async invoke(e,t){let r=ia._convertInputToPromptValue(e),a=await this.generatePrompt([r],t,t?.callbacks),s=a.generations[0][0];return s.message}async *_streamResponseChunks(e,t,r){throw Error("Not implemented.")}async *_streamIterator(e,t){if(this._streamResponseChunks===ia.prototype._streamResponseChunks)yield this.invoke(e,t);else{let r;let a=ia._convertInputToPromptValue(e),s=a.toChatMessages(),[i,n]=this._separateRunnableConfigFromCallOptions(t),o=await ir.Ye.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),l={options:n,invocation_params:this?.invocationParams(n),batch_size:1},E=await o?.handleChatModelStart(this.toJSON(),[s],i.runId,void 0,l,void 0,void 0,i.runName);try{for await(let e of this._streamResponseChunks(s,n,E?.[0]))e.message.response_metadata={...e.generationInfo,...e.message.response_metadata},yield e.message,r=r?r.concat(e):e}catch(e){throw await Promise.all((E??[]).map(t=>t?.handleLLMError(e))),e}await Promise.all((E??[]).map(e=>e?.handleLLMEnd({generations:[[r]]})))}}async _generateUncached(e,t,r){let a=e.map(e=>e.map(ie.E1)),s=await ir.Ye.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),i={options:t,invocation_params:this?.invocationParams(t),batch_size:1},n=await s?.handleChatModelStart(this.toJSON(),a,r.runId,void 0,i,void 0,void 0,r.runName),o=await Promise.allSettled(a.map((e,r)=>this._generate(e,{...t,promptIndex:r},n?.[r]))),l=[],E=[];await Promise.all(o.map(async(e,t)=>{if("fulfilled"!==e.status)return await n?.[t]?.handleLLMError(e.reason),Promise.reject(e.reason);{let r=e.value;for(let e of r.generations)e.message.response_metadata={...e.generationInfo,...e.message.response_metadata};return 1===r.generations.length&&(r.generations[0].message.response_metadata={...r.llmOutput,...r.generations[0].message.response_metadata}),l[t]=r.generations,E[t]=r.llmOutput,n?.[t]?.handleLLMEnd({generations:[r.generations],llmOutput:r.llmOutput})}}));let u={generations:l,llmOutput:E.length?this._combineLLMOutput?.(...E):void 0};return Object.defineProperty(u,s8.WH,{value:n?{runIds:n?.map(e=>e.runId)}:void 0,configurable:!0}),u}async _generateCached({messages:e,cache:t,llmStringKey:r,parsedOptions:a,handledOptions:s}){let i=e.map(e=>e.map(ie.E1)),n=await ir.Ye.configure(s.callbacks,this.callbacks,s.tags,this.tags,s.metadata,this.metadata,{verbose:this.verbose}),o={options:a,invocation_params:this?.invocationParams(a),batch_size:1,cached:!0},l=await n?.handleChatModelStart(this.toJSON(),i,s.runId,void 0,o,void 0,void 0,s.runName),E=[],u=await Promise.allSettled(i.map(async(e,a)=>{let s=ia._convertInputToPromptValue(e).toString(),i=await t.lookup(s,r);return null==i&&E.push(a),i})),c=u.map((e,t)=>({result:e,runManager:l?.[t]})).filter(({result:e})=>"fulfilled"===e.status&&null!=e.value||"rejected"===e.status),T=[];await Promise.all(c.map(async({result:e,runManager:t},r)=>{if("fulfilled"!==e.status)return await t?.handleLLMError(e.reason),Promise.reject(e.reason);{let a=e.value;return T[r]=a,a.length&&await t?.handleLLMNewToken(a[0].text),t?.handleLLMEnd({generations:[a]})}}));let d={generations:T,missingPromptIndices:E};return Object.defineProperty(d,s8.WH,{value:l?{runIds:l?.map(e=>e.runId)}:void 0,configurable:!0}),d}async generate(e,t,r){let a;a=Array.isArray(t)?{stop:t}:t;let s=e.map(e=>e.map(ie.E1)),[i,n]=this._separateRunnableConfigFromCallOptions(a);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(s,n,i);let{cache:o}=this,l=this._getSerializedCacheKeyParametersForCall(n),{generations:E,missingPromptIndices:u}=await this._generateCached({messages:s,cache:o,llmStringKey:l,parsedOptions:n,handledOptions:i}),c={};if(u.length>0){let e=await this._generateUncached(u.map(e=>s[e]),n,i);await Promise.all(e.generations.map(async(e,t)=>{let r=u[t];E[r]=e;let a=ia._convertInputToPromptValue(s[r]).toString();return o.update(a,l,e)})),c=e.llmOutput??{}}return{generations:E,llmOutput:c}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,r){let a=e.map(e=>e.toChatMessages());return this.generate(a,t,r)}async call(e,t,r){let a=await this.generate([e.map(ie.E1)],t,r),s=a.generations;return s[0][0].message}async callPrompt(e,t,r){let a=e.toChatMessages();return this.call(a,t,r)}async predictMessages(e,t,r){return this.call(e,t,r)}async predict(e,t,r){let a=new ie.xk(e),s=await this.call([a],t,r);if("string"!=typeof s.content)throw Error("Cannot use predict when output is not a string.");return s.content}}var is=r(38066);function ii(e){return void 0!==e&&Array.isArray(e.lc_namespace)?{type:"function",function:{name:e.name,description:e.description,parameters:(0,is.Y_)(e.schema)}}:e}function io(e,t){let r=[];for(let[a,s]of Object.entries(e.properties??{}))s.description&&t<2&&r.push(`// ${s.description}`),e.required?.includes(a)?r.push(`${a}: ${il(s,t)},`):r.push(`${a}?: ${il(s,t)},`);return r.map(e=>" ".repeat(t)+e).join("\n")}function il(e,t){if(void 0!==e.anyOf&&Array.isArray(e.anyOf))return e.anyOf.map(e=>il(e,t)).join(" | ");switch(e.type){case"string":if(e.enum)return e.enum.map(e=>`"${e}"`).join(" | ");return"string";case"number":if(e.enum)return e.enum.map(e=>`${e}`).join(" | ");return"number";case"integer":if(e.enum)return e.enum.map(e=>`${e}`).join(" | ");return"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",io(e,t+2),"}"].join("\n");case"array":if(e.items)return`${il(e.items,t)}[]`;return"any[]";default:return""}}function iE(e){let t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":if(!s6.J.isInstance(e))throw Error("Invalid generic chat message");return"system"!==e.role&&"assistant"!==e.role&&"user"!==e.role&&"function"!==e.role&&"tool"!==e.role&&console.warn(`Unknown message role: ${e.role}`),e.role;default:throw Error(`Unknown message type: ${t}`)}}function iu(e){return e.map(e=>({role:iE(e),content:e.content,name:e.name,function_call:e.additional_kwargs.function_call,tool_calls:e.additional_kwargs.tool_calls,tool_call_id:e.tool_call_id}))}class ic extends ia{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.openAIApiKey??(0,s7.lS)("OPENAI_API_KEY"),this.azureOpenAIApiKey=e?.azureOpenAIApiKey??(0,s7.lS)("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,s7.lS)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=e?.azureOpenAIApiDeploymentName??(0,s7.lS)("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??(0,s7.lS)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,s7.lS)("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??(0,s7.lS)("OPENAI_ORGANIZATION"),this.modelName=e?.modelName??this.modelName,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.maxTokens=e?.maxTokens,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stop,this.user=e?.user,this.streaming=e?.streaming??!1,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw Error("Azure OpenAI API version not found");this.openAIApiKey=this.openAIApiKey??""}this.clientConfig={apiKey:this.openAIApiKey,organization:this.organization,baseURL:t?.basePath??e?.configuration?.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:t?.baseOptions?.headers??e?.configuration?.baseOptions?.headers,defaultQuery:t?.baseOptions?.params??e?.configuration?.baseOptions?.params,...t,...e?.configuration}}invocationParams(e){var t;let r={model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:-1===this.maxTokens?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stop,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:void 0!==(t=e?.tools)&&t.every(e=>Array.isArray(e.lc_namespace))?e?.tools.map(ii):e?.tools,tool_choice:e?.tool_choice,response_format:e?.response_format,seed:e?.seed,...this.modelKwargs};return r}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}async *_streamResponseChunks(e,t,r){let a;let s=iu(e),i={...this.invocationParams(t),messages:s,stream:!0},n=await this.completionWithRetry(i,t);for await(let e of n){let s=e?.choices[0];if(!s)continue;let{delta:i}=s;if(!i)continue;let n=function(e,t){let r;let a=e.role??t,s=e.content??"";return(r=e.function_call?{function_call:e.function_call}:e.tool_calls?{tool_calls:e.tool_calls}:{},"user"===a)?new s6.ro({content:s}):"assistant"===a?new s6.GC({content:s,additional_kwargs:r}):"system"===a?new s6.xq({content:s}):"function"===a?new s6.Cr({content:s,additional_kwargs:r,name:e.name}):"tool"===a?new s6.Xz({content:s,additional_kwargs:r,tool_call_id:e.tool_call_id}):new s6.HD({content:s,role:a})}(i,a);a=i.role??a;let o={prompt:t.promptIndex??0,completion:s.index??0};if("string"!=typeof n.content){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}let l=new s8.Ls({message:n,text:n.content,generationInfo:o});yield l,r?.handleLLMNewToken(l.text??"",o,void 0,void 0,void 0,{chunk:l})}if(t.signal?.aborted)throw Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,t,r){let a={},s=this.invocationParams(t),i=iu(e);if(s.stream){let s=this._streamResponseChunks(e,t,r),i={};for await(let e of s){let t=e.generationInfo?.completion??0;void 0===i[t]?i[t]=e:i[t]=i[t].concat(e)}let n=Object.entries(i).sort(([e],[t])=>parseInt(e,10)-parseInt(t,10)).map(([e,t])=>t),{functions:o,function_call:l}=this.invocationParams(t),E=await this.getEstimatedTokenCountFromPrompt(e,o,l),u=await this.getNumTokensFromGenerations(n);return a.promptTokens=E,a.completionTokens=u,a.totalTokens=E+u,{generations:n,llmOutput:{estimatedTokenUsage:a}}}{let e=await this.completionWithRetry({...s,stream:!1,messages:i},{signal:t?.signal,...t?.options}),{completion_tokens:r,prompt_tokens:o,total_tokens:l}=e?.usage??{};r&&(a.completionTokens=(a.completionTokens??0)+r),o&&(a.promptTokens=(a.promptTokens??0)+o),l&&(a.totalTokens=(a.totalTokens??0)+l);let E=[];for(let t of e?.choices??[]){var n;let e=t.message?.content??"",r={text:e,message:"assistant"===(n=t.message??{role:"assistant"}).role?new s6.gY(n.content||"",{function_call:n.function_call,tool_calls:n.tool_calls}):new s6.J(n.content||"",n.role??"unknown")};r.generationInfo={...t.finish_reason?{finish_reason:t.finish_reason}:{},...t.logprobs?{logprobs:t.logprobs}:{}},E.push(r)}return{generations:E,llmOutput:{tokenUsage:a}}}}async getEstimatedTokenCountFromPrompt(e,t,r){let a=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&"auto"!==r){let e=function(e){let t=["namespace functions {",""];for(let r of e)r.description&&t.push(`// ${r.description}`),Object.keys(r.parameters.properties??{}).length>0?(t.push(`type ${r.name} = (_: {`),t.push(io(r.parameters,0)),t.push("}) => any;")):t.push(`type ${r.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join("\n")}(t);a+=await this.getNumTokens(e)+9}return t&&e.find(e=>"system"===e._getType())&&(a-=4),"none"===r?a+=1:"object"==typeof r&&(a+=await this.getNumTokens(r.name)+4),a}async getNumTokensFromGenerations(e){let t=await Promise.all(e.map(async e=>e.message.additional_kwargs?.function_call?(await this.getNumTokensFromMessages([e.message])).countPerMessage[0]:await this.getNumTokens(e.message.content)));return t.reduce((e,t)=>e+t,0)}async getNumTokensFromMessages(e){let t=0,r=0,a=0;"gpt-3.5-turbo-0301"===this.modelName?(r=4,a=-1):(r=3,a=1);let s=await Promise.all(e.map(async e=>{let s=await this.getNumTokens(e.content),i=await this.getNumTokens(iE(e)),n=void 0!==e.name?a+await this.getNumTokens(e.name):0,o=s+r+i+n;return"function"===e._getType()&&(o-=2),e.additional_kwargs?.function_call&&(o+=3),e?.additional_kwargs.function_call?.name&&(o+=await this.getNumTokens(e.additional_kwargs.function_call?.name)),e.additional_kwargs.function_call?.arguments&&(o+=await this.getNumTokens(JSON.stringify(JSON.parse(e.additional_kwargs.function_call?.arguments)))),t+=o,o}));return{totalCount:t+=3,countPerMessage:s}}async completionWithRetry(e,t){let r=this._getClientOptions(t);return this.caller.call(async()=>{try{let t=await this.client.chat.completions.create(e,r);return t}catch(r){let e;let t=(r.constructor.name===rS.name?(e=Error(r.message)).name="TimeoutError":r.constructor.name===rp.name?(e=Error(r.message)).name="AbortError":e=r,e);throw t}})}_getClientOptions(e){if(!this.client){let e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},t=function(e){let{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:r,azureOpenAIApiKey:a,azureOpenAIBasePath:s,baseURL:i}=e;if(a&&s&&t)return`${s}/${t}`;if(a){if(!r)throw Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${r}.openai.azure.com/openai/deployments/${t}`}return i}(e),r={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};r.baseURL||delete r.baseURL,this.client=new s3(r)}let t={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),t}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((e,t)=>(t&&t.tokenUsage&&(e.tokenUsage.completionTokens+=t.tokenUsage.completionTokens??0,e.tokenUsage.promptTokens+=t.tokenUsage.promptTokens??0,e.tokenUsage.totalTokens+=t.tokenUsage.totalTokens??0),e),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}}r(72100),r(66188);var iT=r(27831);r(66249);var id=r(94579);/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function ih(e){return null==e}r(95961),r(34707),r(1308),r(48511),r(38884),r(34003),r(44349),r(26504),r(31278),r(73096),r(52234),r(57383),r(29742),r(24075),r(71470);var iA={isNothing:ih,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:ih(e)?[]:[e]},repeat:function(e,t){var r,a="";for(r=0;r<t;r+=1)a+=e;return a},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var r,a,s,i;if(t)for(r=0,a=(i=Object.keys(t)).length;r<a;r+=1)e[s=i[r]]=t[s];return e}};function ip(e,t){var r="",a=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+="\n\n"+e.mark.snippet),a+" "+r):a}function iR(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=ip(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack||""}function iS(e,t,r,a,s){var i="",n="",o=Math.floor(s/2)-1;return a-t>o&&(t=a-o+(i=" ... ").length),r-a>o&&(r=a+o-(n=" ...").length),{str:i+e.slice(t,r).replace(/\t/g,"")+n,pos:a-t+i.length}}function i_(e,t){return iA.repeat(" ",t-e.length)+e}iR.prototype=Object.create(Error.prototype),iR.prototype.constructor=iR,iR.prototype.toString=function(e){return this.name+": "+ip(this,e)};var iO=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,a=[0],s=[],i=-1;n=r.exec(e.buffer);)s.push(n.index),a.push(n.index+n[0].length),e.position<=n.index&&i<0&&(i=a.length-2);i<0&&(i=a.length-1);var n,o,l,E="",u=Math.min(e.line+t.linesAfter,s.length).toString().length,c=t.maxLength-(t.indent+u+3);for(o=1;o<=t.linesBefore&&!(i-o<0);o++)l=iS(e.buffer,a[i-o],s[i-o],e.position-(a[i]-a[i-o]),c),E=iA.repeat(" ",t.indent)+i_((e.line-o+1).toString(),u)+" | "+l.str+"\n"+E;for(l=iS(e.buffer,a[i],s[i],e.position,c),E+=iA.repeat(" ",t.indent)+i_((e.line+1).toString(),u)+" | "+l.str+"\n"+iA.repeat("-",t.indent+u+3+l.pos)+"^\n",o=1;o<=t.linesAfter&&!(i+o>=s.length);o++)l=iS(e.buffer,a[i+o],s[i+o],e.position-(a[i]-a[i+o]),c),E+=iA.repeat(" ",t.indent)+i_((e.line+o+1).toString(),u)+" | "+l.str+"\n";return E.replace(/\n$/,"")},iI=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],iN=["scalar","sequence","mapping"],im=function(e,t){var r,a;if(Object.keys(t=t||{}).forEach(function(t){if(-1===iI.indexOf(t))throw new iR('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(r=t.styleAliases||null,a={},null!==r&&Object.keys(r).forEach(function(e){r[e].forEach(function(t){a[String(t)]=e})}),a),-1===iN.indexOf(this.kind))throw new iR('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function iC(e,t){var r=[];return e[t].forEach(function(e){var t=r.length;r.forEach(function(r,a){r.tag===e.tag&&r.kind===e.kind&&r.multi===e.multi&&(t=a)}),r[t]=e}),r}function iL(e){return this.extend(e)}iL.prototype.extend=function(e){var t=[],r=[];if(e instanceof im)r.push(e);else if(Array.isArray(e))r=r.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(r=r.concat(e.explicit));else throw new iR("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(e){if(!(e instanceof im))throw new iR("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new iR("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new iR("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(e){if(!(e instanceof im))throw new iR("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(iL.prototype);return a.implicit=(this.implicit||[]).concat(t),a.explicit=(this.explicit||[]).concat(r),a.compiledImplicit=iC(a,"implicit"),a.compiledExplicit=iC(a,"explicit"),a.compiledTypeMap=function(){var e,t,r={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function a(e){e.multi?(r.multi[e.kind].push(e),r.multi.fallback.push(e)):r[e.kind][e.tag]=r.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(a);return r}(a.compiledImplicit,a.compiledExplicit),a};var iy=new iL({explicit:[new im("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new im("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new im("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]}),ig=new im("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),iP=new im("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"}),ib=new im("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,a,s,i=e.length,n=0,o=!1;if(!i)return!1;if(("-"===(s=e[n])||"+"===s)&&(s=e[++n]),"0"===s){if(n+1===i)return!0;if("b"===(s=e[++n])){for(n++;n<i;n++)if("_"!==(s=e[n])){if("0"!==s&&"1"!==s)return!1;o=!0}return o&&"_"!==s}if("x"===s){for(n++;n<i;n++)if("_"!==(s=e[n])){if(!(48<=(t=e.charCodeAt(n))&&t<=57||65<=t&&t<=70||97<=t&&t<=102))return!1;o=!0}return o&&"_"!==s}if("o"===s){for(n++;n<i;n++)if("_"!==(s=e[n])){if(!(48<=(r=e.charCodeAt(n))&&r<=55))return!1;o=!0}return o&&"_"!==s}}if("_"===s)return!1;for(;n<i;n++)if("_"!==(s=e[n])){if(!(48<=(a=e.charCodeAt(n))&&a<=57))return!1;o=!0}return!!o&&"_"!==s},construct:function(e){var t,r=e,a=1;if(-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),("-"===(t=r[0])||"+"===t)&&("-"===t&&(a=-1),t=(r=r.slice(1))[0]),"0"===r)return 0;if("0"===t){if("b"===r[1])return a*parseInt(r.slice(2),2);if("x"===r[1])return a*parseInt(r.slice(2),16);if("o"===r[1])return a*parseInt(r.slice(2),8)}return a*parseInt(r,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!iA.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),iD=RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),iv=/^[-+]?[0-9]+e/,iM=new im("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return!!(null!==e&&iD.test(e)&&"_"!==e[e.length-1])},construct:function(e){var t,r;return(r="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t)?1===r?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:r*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||iA.isNegativeZero(e))},represent:function(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(iA.isNegativeZero(e))return"-0.0";return r=e.toString(10),iv.test(r)?r.replace("e",".e"):r},defaultStyle:"lowercase"}),iU=iy.extend({implicit:[ig,iP,ib,iM]}),iw=RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),iG=RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),iB=new im("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==iw.exec(e)||null!==iG.exec(e))},construct:function(e){var t,r,a,s,i,n,o,l,E=0,u=null;if(null===(t=iw.exec(e))&&(t=iG.exec(e)),null===t)throw Error("Date resolve error");if(r=+t[1],a=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(r,a,s));if(i=+t[4],n=+t[5],o=+t[6],t[7]){for(E=t[7].slice(0,3);E.length<3;)E+="0";E=+E}return t[9]&&(u=(60*+t[10]+ +(t[11]||0))*6e4,"-"===t[9]&&(u=-u)),l=new Date(Date.UTC(r,a,s,i,n,o,E)),u&&l.setTime(l.getTime()-u),l},instanceOf:Date,represent:function(e){return e.toISOString()}}),iF=new im("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),iH="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",ix=new im("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,a=0,s=e.length;for(r=0;r<s;r++)if(!((t=iH.indexOf(e.charAt(r)))>64)){if(t<0)return!1;a+=6}return a%8==0},construct:function(e){var t,r,a=e.replace(/[\r\n=]/g,""),s=a.length,i=0,n=[];for(t=0;t<s;t++)t%4==0&&t&&(n.push(i>>16&255),n.push(i>>8&255),n.push(255&i)),i=i<<6|iH.indexOf(a.charAt(t));return 0==(r=s%4*6)?(n.push(i>>16&255),n.push(i>>8&255),n.push(255&i)):18===r?(n.push(i>>10&255),n.push(i>>2&255)):12===r&&n.push(i>>4&255),new Uint8Array(n)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,r,a="",s=0,i=e.length;for(t=0;t<i;t++)t%3==0&&t&&(a+=iH[s>>18&63]+iH[s>>12&63]+iH[s>>6&63]+iH[63&s]),s=(s<<8)+e[t];return 0==(r=i%3)?a+=iH[s>>18&63]+iH[s>>12&63]+iH[s>>6&63]+iH[63&s]:2===r?a+=iH[s>>10&63]+iH[s>>4&63]+iH[s<<2&63]+iH[64]:1===r&&(a+=iH[s>>2&63]+iH[s<<4&63]+iH[64]+iH[64]),a}}),ik=Object.prototype.hasOwnProperty,iY=Object.prototype.toString,iV=new im("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,r,a,s,i,n=[];for(t=0,r=e.length;t<r;t+=1){if(a=e[t],i=!1,"[object Object]"!==iY.call(a))return!1;for(s in a)if(ik.call(a,s)){if(i)return!1;i=!0}if(!i||-1!==n.indexOf(s))return!1;n.push(s)}return!0},construct:function(e){return null!==e?e:[]}}),i$=Object.prototype.toString,iW=new im("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){var t,r,a,s,i;if(null===e)return!0;for(t=0,i=Array(e.length),r=e.length;t<r;t+=1){if(a=e[t],"[object Object]"!==i$.call(a)||1!==(s=Object.keys(a)).length)return!1;i[t]=[s[0],a[s[0]]]}return!0},construct:function(e){var t,r,a,s,i;if(null===e)return[];for(t=0,i=Array(e.length),r=e.length;t<r;t+=1)s=Object.keys(a=e[t]),i[t]=[s[0],a[s[0]]];return i}}),ij=Object.prototype.hasOwnProperty,iX=new im("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){var t;if(null===e)return!0;for(t in e)if(ij.call(e,t)&&null!==e[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),iK=iU.extend({implicit:[iB,iF],explicit:[ix,iV,iW,iX]}),iZ=Object.prototype.hasOwnProperty,iq=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,iJ=/[\x85\u2028\u2029]/,iz=/[,\[\]\{\}]/,iQ=/^(?:!|!!|![a-z\-]+!)$/i,i0=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function i1(e){return Object.prototype.toString.call(e)}function i2(e){return 10===e||13===e}function i4(e){return 9===e||32===e}function i9(e){return 9===e||32===e||10===e||13===e}function i5(e){return 44===e||91===e||93===e||123===e||125===e}function i3(e){return 48===e?"\x00":97===e?"\x07":98===e?"\b":116===e?"	":9===e?"	":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"\x1b":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"\x85":95===e?"\xa0":76===e?"\u2028":80===e?"\u2029":""}for(var i6=Array(256),i8=Array(256),i7=0;i7<256;i7++)i6[i7]=i3(i7)?1:0,i8[i7]=i3(i7);function ne(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||iK,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function nt(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=iO(r),new iR(t,r)}function nr(e,t){throw nt(e,t)}function na(e,t){e.onWarning&&e.onWarning.call(null,nt(e,t))}var ns={YAML:function(e,t,r){var a,s,i;null!==e.version&&nr(e,"duplication of %YAML directive"),1!==r.length&&nr(e,"YAML directive accepts exactly one argument"),null===(a=/^([0-9]+)\.([0-9]+)$/.exec(r[0]))&&nr(e,"ill-formed argument of the YAML directive"),s=parseInt(a[1],10),i=parseInt(a[2],10),1!==s&&nr(e,"unacceptable YAML version of the document"),e.version=r[0],e.checkLineBreaks=i<2,1!==i&&2!==i&&na(e,"unsupported YAML version of the document")},TAG:function(e,t,r){var a,s;2!==r.length&&nr(e,"TAG directive accepts exactly two arguments"),a=r[0],s=r[1],iQ.test(a)||nr(e,"ill-formed tag handle (first argument) of the TAG directive"),iZ.call(e.tagMap,a)&&nr(e,'there is a previously declared suffix for "'+a+'" tag handle'),i0.test(s)||nr(e,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch(t){nr(e,"tag prefix is malformed: "+s)}e.tagMap[a]=s}};function ni(e,t,r,a){var s,i,n,o;if(t<r){if(o=e.input.slice(t,r),a)for(s=0,i=o.length;s<i;s+=1)9===(n=o.charCodeAt(s))||32<=n&&n<=1114111||nr(e,"expected valid JSON character");else iq.test(o)&&nr(e,"the stream contains non-printable characters");e.result+=o}}function nn(e,t,r,a){var s,i,n,o;for(iA.isObject(r)||nr(e,"cannot merge mappings; the provided source object is unacceptable"),n=0,o=(s=Object.keys(r)).length;n<o;n+=1)i=s[n],iZ.call(t,i)||(t[i]=r[i],a[i]=!0)}function no(e,t,r,a,s,i,n,o,l){var E,u;if(Array.isArray(s))for(E=0,u=(s=Array.prototype.slice.call(s)).length;E<u;E+=1)Array.isArray(s[E])&&nr(e,"nested arrays are not supported inside keys"),"object"==typeof s&&"[object Object]"===i1(s[E])&&(s[E]="[object Object]");if("object"==typeof s&&"[object Object]"===i1(s)&&(s="[object Object]"),s=String(s),null===t&&(t={}),"tag:yaml.org,2002:merge"===a){if(Array.isArray(i))for(E=0,u=i.length;E<u;E+=1)nn(e,t,i[E],r);else nn(e,t,i,r)}else!e.json&&!iZ.call(r,s)&&iZ.call(t,s)&&(e.line=n||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,nr(e,"duplicated mapping key")),"__proto__"===s?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete r[s];return t}function nl(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):nr(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function nE(e,t,r){for(var a=0,s=e.input.charCodeAt(e.position);0!==s;){for(;i4(s);)9===s&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&35===s)do s=e.input.charCodeAt(++e.position);while(10!==s&&13!==s&&0!==s);if(i2(s))for(nl(e),s=e.input.charCodeAt(e.position),a++,e.lineIndent=0;32===s;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return -1!==r&&0!==a&&e.lineIndent<r&&na(e,"deficient indentation"),a}function nu(e){var t,r=e.position;return!!((45===(t=e.input.charCodeAt(r))||46===t)&&t===e.input.charCodeAt(r+1)&&t===e.input.charCodeAt(r+2)&&(r+=3,0===(t=e.input.charCodeAt(r))||i9(t)))}function nc(e,t){1===t?e.result+=" ":t>1&&(e.result+=iA.repeat("\n",t-1))}function nT(e,t){var r,a,s=e.tag,i=e.anchor,n=[],o=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=n),a=e.input.charCodeAt(e.position);0!==a&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,nr(e,"tab characters must not be used in indentation")),45===a&&i9(e.input.charCodeAt(e.position+1)));){if(o=!0,e.position++,nE(e,!0,-1)&&e.lineIndent<=t){n.push(null),a=e.input.charCodeAt(e.position);continue}if(r=e.line,nd(e,t,3,!1,!0),n.push(e.result),nE(e,!0,-1),a=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&0!==a)nr(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return!!o&&(e.tag=s,e.anchor=i,e.kind="sequence",e.result=n,!0)}function nd(e,t,r,a,s){var i,n,o,l,E,u,c,T,d,h=1,A=!1,p=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=n=o=4===r||3===r,a&&nE(e,!0,-1)&&(A=!0,e.lineIndent>t?h=1:e.lineIndent===t?h=0:e.lineIndent<t&&(h=-1)),1===h)for(;function(e){var t,r,a,s,i=!1,n=!1;if(33!==(s=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&nr(e,"duplication of a tag property"),60===(s=e.input.charCodeAt(++e.position))?(i=!0,s=e.input.charCodeAt(++e.position)):33===s?(n=!0,r="!!",s=e.input.charCodeAt(++e.position)):r="!",t=e.position,i){do s=e.input.charCodeAt(++e.position);while(0!==s&&62!==s);e.position<e.length?(a=e.input.slice(t,e.position),s=e.input.charCodeAt(++e.position)):nr(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!i9(s);)33===s&&(n?nr(e,"tag suffix cannot contain exclamation marks"):(r=e.input.slice(t-1,e.position+1),iQ.test(r)||nr(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),s=e.input.charCodeAt(++e.position);a=e.input.slice(t,e.position),iz.test(a)&&nr(e,"tag suffix cannot contain flow indicator characters")}a&&!i0.test(a)&&nr(e,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch(t){nr(e,"tag name is malformed: "+a)}return i?e.tag=a:iZ.call(e.tagMap,r)?e.tag=e.tagMap[r]+a:"!"===r?e.tag="!"+a:"!!"===r?e.tag="tag:yaml.org,2002:"+a:nr(e,'undeclared tag handle "'+r+'"'),!0}(e)||function(e){var t,r;if(38!==(r=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&nr(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!i9(r)&&!i5(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&nr(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}(e);)nE(e,!0,-1)?(A=!0,o=i,e.lineIndent>t?h=1:e.lineIndent===t?h=0:e.lineIndent<t&&(h=-1)):o=!1;if(o&&(o=A||s),(1===h||4===r)&&(T=1===r||2===r?t:t+1,d=e.position-e.lineStart,1===h?o&&(nT(e,d)||function(e,t,r){var a,s,i,n,o,l,E,u=e.tag,c=e.anchor,T={},d=Object.create(null),h=null,A=null,p=null,R=!1,S=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=T),E=e.input.charCodeAt(e.position);0!==E;){if(R||-1===e.firstTabInLine||(e.position=e.firstTabInLine,nr(e,"tab characters must not be used in indentation")),a=e.input.charCodeAt(e.position+1),i=e.line,(63===E||58===E)&&i9(a))63===E?(R&&(no(e,T,d,h,A,null,n,o,l),h=A=p=null),S=!0,R=!0,s=!0):R?(R=!1,s=!0):nr(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,E=a;else{if(n=e.line,o=e.lineStart,l=e.position,!nd(e,r,2,!1,!0))break;if(e.line===i){for(E=e.input.charCodeAt(e.position);i4(E);)E=e.input.charCodeAt(++e.position);if(58===E)i9(E=e.input.charCodeAt(++e.position))||nr(e,"a whitespace character is expected after the key-value separator within a block mapping"),R&&(no(e,T,d,h,A,null,n,o,l),h=A=p=null),S=!0,R=!1,s=!1,h=e.tag,A=e.result;else{if(!S)return e.tag=u,e.anchor=c,!0;nr(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!S)return e.tag=u,e.anchor=c,!0;nr(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}if((e.line===i||e.lineIndent>t)&&(R&&(n=e.line,o=e.lineStart,l=e.position),nd(e,t,4,!0,s)&&(R?A=e.result:p=e.result),R||(no(e,T,d,h,A,p,n,o,l),h=A=p=null),nE(e,!0,-1),E=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&0!==E)nr(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return R&&no(e,T,d,h,A,null,n,o,l),S&&(e.tag=u,e.anchor=c,e.kind="mapping",e.result=T),S}(e,d,T))||function(e,t){var r,a,s,i,n,o,l,E,u,c,T,d,h=!0,A=e.tag,p=e.anchor,R=Object.create(null);if(91===(d=e.input.charCodeAt(e.position)))n=93,E=!1,i=[];else{if(123!==d)return!1;n=125,E=!0,i={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=i),d=e.input.charCodeAt(++e.position);0!==d;){if(nE(e,!0,t),(d=e.input.charCodeAt(e.position))===n)return e.position++,e.tag=A,e.anchor=p,e.kind=E?"mapping":"sequence",e.result=i,!0;h?44===d&&nr(e,"expected the node content, but found ','"):nr(e,"missed comma between flow collection entries"),c=u=T=null,o=l=!1,63===d&&i9(e.input.charCodeAt(e.position+1))&&(o=l=!0,e.position++,nE(e,!0,t)),r=e.line,a=e.lineStart,s=e.position,nd(e,t,1,!1,!0),c=e.tag,u=e.result,nE(e,!0,t),d=e.input.charCodeAt(e.position),(l||e.line===r)&&58===d&&(o=!0,d=e.input.charCodeAt(++e.position),nE(e,!0,t),nd(e,t,1,!1,!0),T=e.result),E?no(e,i,R,c,u,T,r,a,s):o?i.push(no(e,null,R,c,u,T,r,a,s)):i.push(u),nE(e,!0,t),44===(d=e.input.charCodeAt(e.position))?(h=!0,d=e.input.charCodeAt(++e.position)):h=!1}nr(e,"unexpected end of the stream within a flow collection")}(e,T)?p=!0:(n&&function(e,t){var r,a,s,i,n,o=1,l=!1,E=!1,u=t,c=0,T=!1;if(124===(n=e.input.charCodeAt(e.position)))s=!1;else{if(62!==n)return!1;s=!0}for(e.kind="scalar",e.result="";0!==n;)if(43===(n=e.input.charCodeAt(++e.position))||45===n)1===o?o=43===n?3:2:nr(e,"repeat of a chomping mode identifier");else if((i=48<=(r=n)&&r<=57?r-48:-1)>=0)0===i?nr(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):E?nr(e,"repeat of an indentation width identifier"):(u=t+i-1,E=!0);else break;if(i4(n)){do n=e.input.charCodeAt(++e.position);while(i4(n));if(35===n)do n=e.input.charCodeAt(++e.position);while(!i2(n)&&0!==n)}for(;0!==n;){for(nl(e),e.lineIndent=0,n=e.input.charCodeAt(e.position);(!E||e.lineIndent<u)&&32===n;)e.lineIndent++,n=e.input.charCodeAt(++e.position);if(!E&&e.lineIndent>u&&(u=e.lineIndent),i2(n)){c++;continue}if(e.lineIndent<u){3===o?e.result+=iA.repeat("\n",l?1+c:c):1===o&&l&&(e.result+="\n");break}for(s?i4(n)?(T=!0,e.result+=iA.repeat("\n",l?1+c:c)):T?(T=!1,e.result+=iA.repeat("\n",c+1)):0===c?l&&(e.result+=" "):e.result+=iA.repeat("\n",c):e.result+=iA.repeat("\n",l?1+c:c),l=!0,E=!0,c=0,a=e.position;!i2(n)&&0!==n;)n=e.input.charCodeAt(++e.position);ni(e,a,e.position,!1)}return!0}(e,T)||function(e,t){var r,a,s;if(39!==(r=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,a=s=e.position;0!==(r=e.input.charCodeAt(e.position));)if(39===r){if(ni(e,a,e.position,!0),39!==(r=e.input.charCodeAt(++e.position)))return!0;a=e.position,e.position++,s=e.position}else i2(r)?(ni(e,a,s,!0),nc(e,nE(e,!1,t)),a=s=e.position):e.position===e.lineStart&&nu(e)?nr(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);nr(e,"unexpected end of the stream within a single quoted scalar")}(e,T)||function(e,t){var r,a,s,i,n,o,l,E;if(34!==(o=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=a=e.position;0!==(o=e.input.charCodeAt(e.position));){if(34===o)return ni(e,r,e.position,!0),e.position++,!0;if(92===o){if(ni(e,r,e.position,!0),i2(o=e.input.charCodeAt(++e.position)))nE(e,!1,t);else if(o<256&&i6[o])e.result+=i8[o],e.position++;else if((n=120===(l=o)?2:117===l?4:85===l?8:0)>0){for(s=n,i=0;s>0;s--)(n=function(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}(o=e.input.charCodeAt(++e.position)))>=0?i=(i<<4)+n:nr(e,"expected hexadecimal character");e.result+=(E=i)<=65535?String.fromCharCode(E):String.fromCharCode((E-65536>>10)+55296,(E-65536&1023)+56320),e.position++}else nr(e,"unknown escape sequence");r=a=e.position}else i2(o)?(ni(e,r,a,!0),nc(e,nE(e,!1,t)),r=a=e.position):e.position===e.lineStart&&nu(e)?nr(e,"unexpected end of the document within a double quoted scalar"):(e.position++,a=e.position)}nr(e,"unexpected end of the stream within a double quoted scalar")}(e,T)?p=!0:function(e){var t,r,a;if(42!==(a=e.input.charCodeAt(e.position)))return!1;for(a=e.input.charCodeAt(++e.position),t=e.position;0!==a&&!i9(a)&&!i5(a);)a=e.input.charCodeAt(++e.position);return e.position===t&&nr(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),iZ.call(e.anchorMap,r)||nr(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],nE(e,!0,-1),!0}(e)?(p=!0,(null!==e.tag||null!==e.anchor)&&nr(e,"alias node should not have any properties")):function(e,t,r){var a,s,i,n,o,l,E,u,c=e.kind,T=e.result;if(i9(u=e.input.charCodeAt(e.position))||i5(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u||(63===u||45===u)&&(i9(a=e.input.charCodeAt(e.position+1))||r&&i5(a)))return!1;for(e.kind="scalar",e.result="",s=i=e.position,n=!1;0!==u;){if(58===u){if(i9(a=e.input.charCodeAt(e.position+1))||r&&i5(a))break}else if(35===u){if(i9(e.input.charCodeAt(e.position-1)))break}else if(e.position===e.lineStart&&nu(e)||r&&i5(u))break;else if(i2(u)){if(o=e.line,l=e.lineStart,E=e.lineIndent,nE(e,!1,-1),e.lineIndent>=t){n=!0,u=e.input.charCodeAt(e.position);continue}e.position=i,e.line=o,e.lineStart=l,e.lineIndent=E;break}n&&(ni(e,s,i,!1),nc(e,e.line-o),s=i=e.position,n=!1),i4(u)||(i=e.position+1),u=e.input.charCodeAt(++e.position)}return ni(e,s,i,!1),!!e.result||(e.kind=c,e.result=T,!1)}(e,T,1===r)&&(p=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===h&&(p=o&&nT(e,d))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&nr(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,E=e.implicitTypes.length;l<E;l+=1)if((c=e.implicitTypes[l]).resolve(e.result)){e.result=c.construct(e.result),e.tag=c.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(iZ.call(e.typeMap[e.kind||"fallback"],e.tag))c=e.typeMap[e.kind||"fallback"][e.tag];else for(l=0,c=null,E=(u=e.typeMap.multi[e.kind||"fallback"]).length;l<E;l+=1)if(e.tag.slice(0,u[l].tag.length)===u[l].tag){c=u[l];break}c||nr(e,"unknown tag !<"+e.tag+">"),null!==e.result&&c.kind!==e.kind&&nr(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+c.kind+'", not "'+e.kind+'"'),c.resolve(e.result,e.tag)?(e.result=c.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):nr(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||p}function nh(e,t){e=String(e),t=t||{},0!==e.length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var r=new ne(e,t),a=e.indexOf("\x00");for(-1!==a&&(r.position=a,nr(r,"null byte is not allowed in input")),r.input+="\x00";32===r.input.charCodeAt(r.position);)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)!function(e){var t,r,a,s,i=e.position,n=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(s=e.input.charCodeAt(e.position))&&(nE(e,!0,-1),s=e.input.charCodeAt(e.position),!(e.lineIndent>0)&&37===s);){for(n=!0,s=e.input.charCodeAt(++e.position),t=e.position;0!==s&&!i9(s);)s=e.input.charCodeAt(++e.position);for(r=e.input.slice(t,e.position),a=[],r.length<1&&nr(e,"directive name must not be less than one character in length");0!==s;){for(;i4(s);)s=e.input.charCodeAt(++e.position);if(35===s){do s=e.input.charCodeAt(++e.position);while(0!==s&&!i2(s));break}if(i2(s))break;for(t=e.position;0!==s&&!i9(s);)s=e.input.charCodeAt(++e.position);a.push(e.input.slice(t,e.position))}0!==s&&nl(e),iZ.call(ns,r)?ns[r](e,r,a):na(e,'unknown document directive "'+r+'"')}if(nE(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,nE(e,!0,-1)):n&&nr(e,"directives end mark is expected"),nd(e,e.lineIndent-1,4,!1,!0),nE(e,!0,-1),e.checkLineBreaks&&iJ.test(e.input.slice(i,e.position))&&na(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&nu(e)){46===e.input.charCodeAt(e.position)&&(e.position+=3,nE(e,!0,-1));return}e.position<e.length-1&&nr(e,"end of the stream or a document separator is expected")}(r);return r.documents}var nA={loadAll:function(e,t,r){null!==t&&"object"==typeof t&&void 0===r&&(r=t,t=null);var a=nh(e,r);if("function"!=typeof t)return a;for(var s=0,i=a.length;s<i;s+=1)t(a[s])},load:function(e,t){var r=nh(e,t);if(0!==r.length){if(1===r.length)return r[0];throw new iR("expected a single document in the stream, but found more")}}},np=Object.prototype.toString,nR=Object.prototype.hasOwnProperty,nS={};nS[0]="\\0",nS[7]="\\a",nS[8]="\\b",nS[9]="\\t",nS[10]="\\n",nS[11]="\\v",nS[12]="\\f",nS[13]="\\r",nS[27]="\\e",nS[34]='\\"',nS[92]="\\\\",nS[133]="\\N",nS[160]="\\_",nS[8232]="\\L",nS[8233]="\\P";var n_=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],nO=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function nI(e,t){for(var r,a=iA.repeat(" ",t),s=0,i=-1,n="",o=e.length;s<o;)-1===(i=e.indexOf("\n",s))?(r=e.slice(s),s=o):(r=e.slice(s,i+1),s=i+1),r.length&&"\n"!==r&&(n+=a),n+=r;return n}function nf(e,t){return"\n"+iA.repeat(" ",e.indent*t)}function nN(e){return 32===e||9===e}function nm(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&65279!==e||65536<=e&&e<=1114111}function nC(e){return nm(e)&&65279!==e&&13!==e&&10!==e}function nL(e,t,r){var a=nC(e),s=a&&!nN(e);return(r?a:a&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e)&&35!==e&&!(58===t&&!s)||nC(t)&&!nN(t)&&35===e||58===t&&s}function ny(e,t){var r,a=e.charCodeAt(t);return a>=55296&&a<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1))>=56320&&r<=57343?(a-55296)*1024+r-56320+65536:a}function ng(e){return/^\n* /.test(e)}function nP(e,t){var r=ng(e)?String(t):"",a="\n"===e[e.length-1];return r+(a&&("\n"===e[e.length-2]||"\n"===e)?"+":a?"":"-")+"\n"}function nb(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function nD(e,t){if(""===e||" "===e[0])return e;for(var r,a,s=/ [^ ]/g,i=0,n=0,o=0,l="";r=s.exec(e);)(o=r.index)-i>t&&(a=n>i?n:o,l+="\n"+e.slice(i,a),i=a+1),n=o;return l+="\n",e.length-i>t&&n>i?l+=e.slice(i,n)+"\n"+e.slice(n+1):l+=e.slice(i),l.slice(1)}function nv(e,t,r,a){var s,i,n,o="",l=e.tag;for(s=0,i=r.length;s<i;s+=1)n=r[s],e.replacer&&(n=e.replacer.call(r,String(s),n)),(nU(e,t+1,n,!0,!0,!1,!0)||void 0===n&&nU(e,t+1,null,!0,!0,!1,!0))&&(a&&""===o||(o+=nf(e,t)),e.dump&&10===e.dump.charCodeAt(0)?o+="-":o+="- ",o+=e.dump);e.tag=l,e.dump=o||"[]"}function nM(e,t,r){var a,s,i,n,o,l;for(i=0,n=(s=r?e.explicitTypes:e.implicitTypes).length;i<n;i+=1)if(((o=s[i]).instanceOf||o.predicate)&&(!o.instanceOf||"object"==typeof t&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(r?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,"[object Function]"===np.call(o.represent))a=o.represent(t,l);else if(nR.call(o.represent,l))a=o.represent[l](t,l);else throw new iR("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=a}return!0}return!1}function nU(e,t,r,a,s,i,n){e.tag=null,e.dump=r,nM(e,r,!1)||nM(e,r,!0);var o,l=np.call(e.dump),E=a;a&&(a=e.flowLevel<0||e.flowLevel>t);var u,c,T,d="[object Object]"===l||"[object Array]"===l;if(d&&(T=-1!==(c=e.duplicates.indexOf(r))),(null!==e.tag&&"?"!==e.tag||T||2!==e.indent&&t>0)&&(s=!1),T&&e.usedDuplicates[c])e.dump="*ref_"+c;else{if(d&&T&&!e.usedDuplicates[c]&&(e.usedDuplicates[c]=!0),"[object Object]"===l)a&&0!==Object.keys(e.dump).length?(function(e,t,r,a){var s,i,n,o,l,E,u="",c=e.tag,T=Object.keys(r);if(!0===e.sortKeys)T.sort();else if("function"==typeof e.sortKeys)T.sort(e.sortKeys);else if(e.sortKeys)throw new iR("sortKeys must be a boolean or a function");for(s=0,i=T.length;s<i;s+=1)E="",a&&""===u||(E+=nf(e,t)),o=r[n=T[s]],e.replacer&&(o=e.replacer.call(r,n,o)),nU(e,t+1,n,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?E+="?":E+="? "),E+=e.dump,l&&(E+=nf(e,t)),nU(e,t+1,o,!0,l)&&(e.dump&&10===e.dump.charCodeAt(0)?E+=":":E+=": ",E+=e.dump,u+=E));e.tag=c,e.dump=u||"{}"}(e,t,e.dump,s),T&&(e.dump="&ref_"+c+e.dump)):(function(e,t,r){var a,s,i,n,o,l="",E=e.tag,u=Object.keys(r);for(a=0,s=u.length;a<s;a+=1)o="",""!==l&&(o+=", "),e.condenseFlow&&(o+='"'),n=r[i=u[a]],e.replacer&&(n=e.replacer.call(r,i,n)),nU(e,t,i,!1,!1)&&(e.dump.length>1024&&(o+="? "),o+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),nU(e,t,n,!1,!1)&&(o+=e.dump,l+=o));e.tag=E,e.dump="{"+l+"}"}(e,t,e.dump),T&&(e.dump="&ref_"+c+" "+e.dump));else if("[object Array]"===l)a&&0!==e.dump.length?(e.noArrayIndent&&!n&&t>0?nv(e,t-1,e.dump,s):nv(e,t,e.dump,s),T&&(e.dump="&ref_"+c+e.dump)):(function(e,t,r){var a,s,i,n="",o=e.tag;for(a=0,s=r.length;a<s;a+=1)i=r[a],e.replacer&&(i=e.replacer.call(r,String(a),i)),(nU(e,t,i,!1,!1)||void 0===i&&nU(e,t,null,!1,!1))&&(""!==n&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=o,e.dump="["+n+"]"}(e,t,e.dump),T&&(e.dump="&ref_"+c+" "+e.dump));else if("[object String]"===l)"?"!==e.tag&&(o=e.dump,e.dump=function(){if(0===o.length)return 2===e.quotingType?'""':"''";if(!e.noCompatMode&&(-1!==n_.indexOf(o)||nO.test(o)))return 2===e.quotingType?'"'+o+'"':"'"+o+"'";var r=e.indent*Math.max(1,t),a=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-r);switch(function(e,t,r,a,s,i,n,o){var l,E,u,c=0,T=null,d=!1,h=!1,A=-1!==a,p=-1,R=nm(l=ny(e,0))&&65279!==l&&!nN(l)&&45!==l&&63!==l&&58!==l&&44!==l&&91!==l&&93!==l&&123!==l&&125!==l&&35!==l&&38!==l&&42!==l&&33!==l&&124!==l&&61!==l&&62!==l&&39!==l&&34!==l&&37!==l&&64!==l&&96!==l&&!nN(E=ny(e,e.length-1))&&58!==E;if(t||n)for(u=0;u<e.length;c>=65536?u+=2:u++){if(!nm(c=ny(e,u)))return 5;R=R&&nL(c,T,o),T=c}else{for(u=0;u<e.length;c>=65536?u+=2:u++){if(10===(c=ny(e,u)))d=!0,A&&(h=h||u-p-1>a&&" "!==e[p+1],p=u);else if(!nm(c))return 5;R=R&&nL(c,T,o),T=c}h=h||A&&u-p-1>a&&" "!==e[p+1]}return d||h?r>9&&ng(e)?5:n?2===i?5:2:h?4:3:!R||n||s(e)?2===i?5:2:1}(o,i||e.flowLevel>-1&&t>=e.flowLevel,e.indent,a,function(t){return function(e,t){var r,a;for(r=0,a=e.implicitTypes.length;r<a;r+=1)if(e.implicitTypes[r].resolve(t))return!0;return!1}(e,t)},e.quotingType,e.forceQuotes&&!i,E)){case 1:return o;case 2:return"'"+o.replace(/'/g,"''")+"'";case 3:return"|"+nP(o,e.indent)+nb(nI(o,r));case 4:return">"+nP(o,e.indent)+nb(nI(function(e,t){for(var r,a,s,i=/(\n+)([^\n]*)/g,n=(r=-1!==(r=e.indexOf("\n"))?r:e.length,i.lastIndex=r,nD(e.slice(0,r),t)),o="\n"===e[0]||" "===e[0];s=i.exec(e);){var l=s[1],E=s[2];a=" "===E[0],n+=l+(o||a||""===E?"":"\n")+nD(E,t),o=a}return n}(o,a),r));case 5:return'"'+function(e){for(var t,r="",a=0,s=0;s<e.length;a>=65536?s+=2:s++)!(t=nS[a=ny(e,s)])&&nm(a)?(r+=e[s],a>=65536&&(r+=e[s+1])):r+=t||function(e){var t,r,a;if(t=e.toString(16).toUpperCase(),e<=255)r="x",a=2;else if(e<=65535)r="u",a=4;else if(e<=4294967295)r="U",a=8;else throw new iR("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+iA.repeat("0",a-t.length)+t}(a);return r}(o)+'"';default:throw new iR("impossible error: invalid scalar style")}}());else{if("[object Undefined]"===l||e.skipInvalid)return!1;throw new iR("unacceptable kind of an object to dump "+l)}null!==e.tag&&"?"!==e.tag&&(u=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),u="!"===e.tag[0]?"!"+u:"tag:yaml.org,2002:"===u.slice(0,18)?"!!"+u.slice(18):"!<"+u+">",e.dump=u+" "+e.dump)}return!0}function nw(e,t){return function(){throw Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}nA.load,nA.loadAll,nw("safeLoad","load"),nw("safeLoadAll","loadAll"),nw("safeDump","dump"),r(91178);let nG=e=>e.flatMap(nB),nB=e=>nW(nH(e)).map(nF),nF=e=>e.replace(/ +/g," ").trim(),nH=e=>({type:"mandatory_block",items:nx(e,0)[0]}),nx=(e,t,r)=>{let a=[];for(;e[t];){let[s,i]=nk(e,t);if(a.push(s),"|"===e[t=i])t++;else if("}"===e[t]||"]"===e[t]){if(r!==e[t])throw Error(`Unbalanced parenthesis in: ${e}`);t++;break}else if(t===e.length){if(r)throw Error(`Unbalanced parenthesis in: ${e}`);break}else throw Error(`Unexpected "${e[t]}"`)}return[a,t]},nk=(e,t)=>{let r=[];for(;;){let[a,s]=nY(e,t);if(a)r.push(a),t=s;else break}return 1===r.length?[r[0],t]:[{type:"concatenation",items:r},t]},nY=(e,t)=>{if("{"===e[t])return nV(e,t+1);if("["===e[t])return n$(e,t+1);{let r="";for(;e[t]&&/[A-Za-z0-9_ ]/.test(e[t]);)r+=e[t],t++;return[r,t]}},nV=(e,t)=>{let[r,a]=nx(e,t,"}");return[{type:"mandatory_block",items:r},a]},n$=(e,t)=>{let[r,a]=nx(e,t,"]");return[{type:"optional_block",items:r},a]},nW=e=>{if("string"==typeof e)return[e];if("concatenation"===e.type)return e.items.map(nW).reduce(nj,[""]);if("mandatory_block"===e.type)return e.items.flatMap(nW);if("optional_block"===e.type)return["",...e.items.flatMap(nW)];throw Error(`Unknown node type: ${e}`)},nj=(e,t)=>{let r=[];for(let a of e)for(let e of t)r.push(a+e);return r};!function(e){e.QUOTED_IDENTIFIER="QUOTED_IDENTIFIER",e.IDENTIFIER="IDENTIFIER",e.STRING="STRING",e.VARIABLE="VARIABLE",e.RESERVED_DATA_TYPE="RESERVED_DATA_TYPE",e.RESERVED_PARAMETERIZED_DATA_TYPE="RESERVED_PARAMETERIZED_DATA_TYPE",e.RESERVED_KEYWORD="RESERVED_KEYWORD",e.RESERVED_FUNCTION_NAME="RESERVED_FUNCTION_NAME",e.RESERVED_KEYWORD_PHRASE="RESERVED_KEYWORD_PHRASE",e.RESERVED_DATA_TYPE_PHRASE="RESERVED_DATA_TYPE_PHRASE",e.RESERVED_SET_OPERATION="RESERVED_SET_OPERATION",e.RESERVED_CLAUSE="RESERVED_CLAUSE",e.RESERVED_SELECT="RESERVED_SELECT",e.RESERVED_JOIN="RESERVED_JOIN",e.ARRAY_IDENTIFIER="ARRAY_IDENTIFIER",e.ARRAY_KEYWORD="ARRAY_KEYWORD",e.CASE="CASE",e.END="END",e.WHEN="WHEN",e.ELSE="ELSE",e.THEN="THEN",e.LIMIT="LIMIT",e.BETWEEN="BETWEEN",e.AND="AND",e.OR="OR",e.XOR="XOR",e.OPERATOR="OPERATOR",e.COMMA="COMMA",e.ASTERISK="ASTERISK",e.PROPERTY_ACCESS_OPERATOR="PROPERTY_ACCESS_OPERATOR",e.OPEN_PAREN="OPEN_PAREN",e.CLOSE_PAREN="CLOSE_PAREN",e.LINE_COMMENT="LINE_COMMENT",e.BLOCK_COMMENT="BLOCK_COMMENT",e.DISABLE_COMMENT="DISABLE_COMMENT",e.NUMBER="NUMBER",e.NAMED_PARAMETER="NAMED_PARAMETER",e.QUOTED_PARAMETER="QUOTED_PARAMETER",e.NUMBERED_PARAMETER="NUMBERED_PARAMETER",e.POSITIONAL_PARAMETER="POSITIONAL_PARAMETER",e.CUSTOM_PARAMETER="CUSTOM_PARAMETER",e.DELIMITER="DELIMITER",e.EOF="EOF"}(ew=ew||(ew={}));let nX=e=>({type:ew.EOF,raw:"\xabEOF\xbb",text:"\xabEOF\xbb",start:e}),nK=nX(1/0),nZ=e=>t=>t.type===e.type&&t.text===e.text,nq={ARRAY:nZ({text:"ARRAY",type:ew.RESERVED_DATA_TYPE}),BY:nZ({text:"BY",type:ew.RESERVED_KEYWORD}),SET:nZ({text:"SET",type:ew.RESERVED_CLAUSE}),STRUCT:nZ({text:"STRUCT",type:ew.RESERVED_DATA_TYPE}),WINDOW:nZ({text:"WINDOW",type:ew.RESERVED_CLAUSE}),VALUES:nZ({text:"VALUES",type:ew.RESERVED_CLAUSE})},nJ=e=>e===ew.RESERVED_DATA_TYPE||e===ew.RESERVED_KEYWORD||e===ew.RESERVED_FUNCTION_NAME||e===ew.RESERVED_KEYWORD_PHRASE||e===ew.RESERVED_DATA_TYPE_PHRASE||e===ew.RESERVED_CLAUSE||e===ew.RESERVED_SELECT||e===ew.RESERVED_SET_OPERATION||e===ew.RESERVED_JOIN||e===ew.ARRAY_KEYWORD||e===ew.CASE||e===ew.END||e===ew.WHEN||e===ew.ELSE||e===ew.THEN||e===ew.LIMIT||e===ew.BETWEEN||e===ew.AND||e===ew.OR||e===ew.XOR,nz=e=>e===ew.AND||e===ew.OR||e===ew.XOR,nQ=nG(["SELECT [ALL | DISTINCT] [AS STRUCT | AS VALUE]"]),n0=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY","HAVING","QUALIFY","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","OMIT RECORD IF","INSERT [INTO]","VALUES","SET","MERGE [INTO]","WHEN [NOT] MATCHED [BY SOURCE | BY TARGET] [THEN]","UPDATE SET","CLUSTER BY","FOR SYSTEM_TIME AS OF","WITH CONNECTION","WITH PARTITION COLUMNS","REMOTE WITH CONNECTION"]),n1=nG(["CREATE [OR REPLACE] [TEMP|TEMPORARY|SNAPSHOT|EXTERNAL] TABLE [IF NOT EXISTS]"]),n2=nG(["CREATE [OR REPLACE] [MATERIALIZED] VIEW [IF NOT EXISTS]","UPDATE","DELETE [FROM]","DROP [SNAPSHOT | EXTERNAL] TABLE [IF EXISTS]","ALTER TABLE [IF EXISTS]","ADD COLUMN [IF NOT EXISTS]","DROP COLUMN [IF EXISTS]","RENAME TO","ALTER COLUMN [IF EXISTS]","SET DEFAULT COLLATE","SET OPTIONS","DROP NOT NULL","SET DATA TYPE","ALTER SCHEMA [IF EXISTS]","ALTER [MATERIALIZED] VIEW [IF EXISTS]","ALTER BI_CAPACITY","TRUNCATE TABLE","CREATE SCHEMA [IF NOT EXISTS]","DEFAULT COLLATE","CREATE [OR REPLACE] [TEMP|TEMPORARY|TABLE] FUNCTION [IF NOT EXISTS]","CREATE [OR REPLACE] PROCEDURE [IF NOT EXISTS]","CREATE [OR REPLACE] ROW ACCESS POLICY [IF NOT EXISTS]","GRANT TO","FILTER USING","CREATE CAPACITY","AS JSON","CREATE RESERVATION","CREATE ASSIGNMENT","CREATE SEARCH INDEX [IF NOT EXISTS]","DROP SCHEMA [IF EXISTS]","DROP [MATERIALIZED] VIEW [IF EXISTS]","DROP [TABLE] FUNCTION [IF EXISTS]","DROP PROCEDURE [IF EXISTS]","DROP ROW ACCESS POLICY","DROP ALL ROW ACCESS POLICIES","DROP CAPACITY [IF EXISTS]","DROP RESERVATION [IF EXISTS]","DROP ASSIGNMENT [IF EXISTS]","DROP SEARCH INDEX [IF EXISTS]","DROP [IF EXISTS]","GRANT","REVOKE","DECLARE","EXECUTE IMMEDIATE","LOOP","END LOOP","REPEAT","END REPEAT","WHILE","END WHILE","BREAK","LEAVE","CONTINUE","ITERATE","FOR","END FOR","BEGIN","BEGIN TRANSACTION","COMMIT TRANSACTION","ROLLBACK TRANSACTION","RAISE","RETURN","CALL","ASSERT","EXPORT DATA"]),n4=nG(["UNION {ALL | DISTINCT}","EXCEPT DISTINCT","INTERSECT DISTINCT"]),n9=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN"]),n5=nG(["TABLESAMPLE SYSTEM","ANY TYPE","ALL COLUMNS","NOT DETERMINISTIC","{ROWS | RANGE} BETWEEN","IS [NOT] DISTINCT FROM"]),n3=nG([]),n6={name:"bigquery",tokenizerOptions:{reservedSelect:nQ,reservedClauses:[...n0,...n2,...n1],reservedSetOperations:n4,reservedJoins:n9,reservedKeywordPhrases:n5,reservedDataTypePhrases:n3,reservedKeywords:["ALL","AND","ANY","AS","ASC","ASSERT_ROWS_MODIFIED","AT","BETWEEN","BY","CASE","CAST","COLLATE","CONTAINS","CREATE","CROSS","CUBE","CURRENT","DEFAULT","DEFINE","DESC","DISTINCT","ELSE","END","ENUM","ESCAPE","EXCEPT","EXCLUDE","EXISTS","EXTRACT","FALSE","FETCH","FOLLOWING","FOR","FROM","FULL","GROUP","GROUPING","GROUPS","HASH","HAVING","IF","IGNORE","IN","INNER","INTERSECT","INTO","IS","JOIN","LATERAL","LEFT","LIMIT","LOOKUP","MERGE","NATURAL","NEW","NO","NOT","NULL","NULLS","OF","ON","OR","ORDER","OUTER","OVER","PARTITION","PRECEDING","PROTO","RANGE","RECURSIVE","RESPECT","RIGHT","ROLLUP","ROWS","SELECT","SET","SOME","TABLE","TABLESAMPLE","THEN","TO","TREAT","TRUE","UNBOUNDED","UNION","UNNEST","USING","WHEN","WHERE","WINDOW","WITH","WITHIN","SAFE","LIKE","COPY","CLONE","IN","OUT","INOUT","RETURNS","LANGUAGE","CASCADE","RESTRICT","DETERMINISTIC"],reservedDataTypes:["ARRAY","BOOL","BYTES","DATE","DATETIME","GEOGRAPHY","INTERVAL","INT64","INT","SMALLINT","INTEGER","BIGINT","TINYINT","BYTEINT","NUMERIC","DECIMAL","BIGNUMERIC","BIGDECIMAL","FLOAT64","STRING","STRUCT","TIME","TIMEZONE"],reservedFunctionNames:["KEYS.NEW_KEYSET","KEYS.ADD_KEY_FROM_RAW_BYTES","AEAD.DECRYPT_BYTES","AEAD.DECRYPT_STRING","AEAD.ENCRYPT","KEYS.KEYSET_CHAIN","KEYS.KEYSET_FROM_JSON","KEYS.KEYSET_TO_JSON","KEYS.ROTATE_KEYSET","KEYS.KEYSET_LENGTH","ANY_VALUE","ARRAY_AGG","AVG","CORR","COUNT","COUNTIF","COVAR_POP","COVAR_SAMP","MAX","MIN","ST_CLUSTERDBSCAN","STDDEV_POP","STDDEV_SAMP","STRING_AGG","SUM","VAR_POP","VAR_SAMP","ANY_VALUE","ARRAY_AGG","ARRAY_CONCAT_AGG","AVG","BIT_AND","BIT_OR","BIT_XOR","COUNT","COUNTIF","LOGICAL_AND","LOGICAL_OR","MAX","MIN","STRING_AGG","SUM","APPROX_COUNT_DISTINCT","APPROX_QUANTILES","APPROX_TOP_COUNT","APPROX_TOP_SUM","ARRAY_CONCAT","ARRAY_LENGTH","ARRAY_TO_STRING","GENERATE_ARRAY","GENERATE_DATE_ARRAY","GENERATE_TIMESTAMP_ARRAY","ARRAY_REVERSE","OFFSET","SAFE_OFFSET","ORDINAL","SAFE_ORDINAL","BIT_COUNT","PARSE_BIGNUMERIC","PARSE_NUMERIC","SAFE_CAST","CURRENT_DATE","EXTRACT","DATE","DATE_ADD","DATE_SUB","DATE_DIFF","DATE_TRUNC","DATE_FROM_UNIX_DATE","FORMAT_DATE","LAST_DAY","PARSE_DATE","UNIX_DATE","CURRENT_DATETIME","DATETIME","EXTRACT","DATETIME_ADD","DATETIME_SUB","DATETIME_DIFF","DATETIME_TRUNC","FORMAT_DATETIME","LAST_DAY","PARSE_DATETIME","ERROR","EXTERNAL_QUERY","S2_CELLIDFROMPOINT","S2_COVERINGCELLIDS","ST_ANGLE","ST_AREA","ST_ASBINARY","ST_ASGEOJSON","ST_ASTEXT","ST_AZIMUTH","ST_BOUNDARY","ST_BOUNDINGBOX","ST_BUFFER","ST_BUFFERWITHTOLERANCE","ST_CENTROID","ST_CENTROID_AGG","ST_CLOSESTPOINT","ST_CLUSTERDBSCAN","ST_CONTAINS","ST_CONVEXHULL","ST_COVEREDBY","ST_COVERS","ST_DIFFERENCE","ST_DIMENSION","ST_DISJOINT","ST_DISTANCE","ST_DUMP","ST_DWITHIN","ST_ENDPOINT","ST_EQUALS","ST_EXTENT","ST_EXTERIORRING","ST_GEOGFROM","ST_GEOGFROMGEOJSON","ST_GEOGFROMTEXT","ST_GEOGFROMWKB","ST_GEOGPOINT","ST_GEOGPOINTFROMGEOHASH","ST_GEOHASH","ST_GEOMETRYTYPE","ST_INTERIORRINGS","ST_INTERSECTION","ST_INTERSECTS","ST_INTERSECTSBOX","ST_ISCOLLECTION","ST_ISEMPTY","ST_LENGTH","ST_MAKELINE","ST_MAKEPOLYGON","ST_MAKEPOLYGONORIENTED","ST_MAXDISTANCE","ST_NPOINTS","ST_NUMGEOMETRIES","ST_NUMPOINTS","ST_PERIMETER","ST_POINTN","ST_SIMPLIFY","ST_SNAPTOGRID","ST_STARTPOINT","ST_TOUCHES","ST_UNION","ST_UNION_AGG","ST_WITHIN","ST_X","ST_Y","FARM_FINGERPRINT","MD5","SHA1","SHA256","SHA512","HLL_COUNT.INIT","HLL_COUNT.MERGE","HLL_COUNT.MERGE_PARTIAL","HLL_COUNT.EXTRACT","MAKE_INTERVAL","EXTRACT","JUSTIFY_DAYS","JUSTIFY_HOURS","JUSTIFY_INTERVAL","JSON_EXTRACT","JSON_QUERY","JSON_EXTRACT_SCALAR","JSON_VALUE","JSON_EXTRACT_ARRAY","JSON_QUERY_ARRAY","JSON_EXTRACT_STRING_ARRAY","JSON_VALUE_ARRAY","TO_JSON_STRING","ABS","SIGN","IS_INF","IS_NAN","IEEE_DIVIDE","RAND","SQRT","POW","POWER","EXP","LN","LOG","LOG10","GREATEST","LEAST","DIV","SAFE_DIVIDE","SAFE_MULTIPLY","SAFE_NEGATE","SAFE_ADD","SAFE_SUBTRACT","MOD","ROUND","TRUNC","CEIL","CEILING","FLOOR","COS","COSH","ACOS","ACOSH","SIN","SINH","ASIN","ASINH","TAN","TANH","ATAN","ATANH","ATAN2","RANGE_BUCKET","FIRST_VALUE","LAST_VALUE","NTH_VALUE","LEAD","LAG","PERCENTILE_CONT","PERCENTILE_DISC","NET.IP_FROM_STRING","NET.SAFE_IP_FROM_STRING","NET.IP_TO_STRING","NET.IP_NET_MASK","NET.IP_TRUNC","NET.IPV4_FROM_INT64","NET.IPV4_TO_INT64","NET.HOST","NET.PUBLIC_SUFFIX","NET.REG_DOMAIN","RANK","DENSE_RANK","PERCENT_RANK","CUME_DIST","NTILE","ROW_NUMBER","SESSION_USER","CORR","COVAR_POP","COVAR_SAMP","STDDEV_POP","STDDEV_SAMP","STDDEV","VAR_POP","VAR_SAMP","VARIANCE","ASCII","BYTE_LENGTH","CHAR_LENGTH","CHARACTER_LENGTH","CHR","CODE_POINTS_TO_BYTES","CODE_POINTS_TO_STRING","CONCAT","CONTAINS_SUBSTR","ENDS_WITH","FORMAT","FROM_BASE32","FROM_BASE64","FROM_HEX","INITCAP","INSTR","LEFT","LENGTH","LPAD","LOWER","LTRIM","NORMALIZE","NORMALIZE_AND_CASEFOLD","OCTET_LENGTH","REGEXP_CONTAINS","REGEXP_EXTRACT","REGEXP_EXTRACT_ALL","REGEXP_INSTR","REGEXP_REPLACE","REGEXP_SUBSTR","REPLACE","REPEAT","REVERSE","RIGHT","RPAD","RTRIM","SAFE_CONVERT_BYTES_TO_STRING","SOUNDEX","SPLIT","STARTS_WITH","STRPOS","SUBSTR","SUBSTRING","TO_BASE32","TO_BASE64","TO_CODE_POINTS","TO_HEX","TRANSLATE","TRIM","UNICODE","UPPER","CURRENT_TIME","TIME","EXTRACT","TIME_ADD","TIME_SUB","TIME_DIFF","TIME_TRUNC","FORMAT_TIME","PARSE_TIME","CURRENT_TIMESTAMP","EXTRACT","STRING","TIMESTAMP","TIMESTAMP_ADD","TIMESTAMP_SUB","TIMESTAMP_DIFF","TIMESTAMP_TRUNC","FORMAT_TIMESTAMP","PARSE_TIMESTAMP","TIMESTAMP_SECONDS","TIMESTAMP_MILLIS","TIMESTAMP_MICROS","UNIX_SECONDS","UNIX_MILLIS","UNIX_MICROS","GENERATE_UUID","COALESCE","IF","IFNULL","NULLIF","AVG","BIT_AND","BIT_OR","BIT_XOR","CORR","COUNT","COVAR_POP","COVAR_SAMP","EXACT_COUNT_DISTINCT","FIRST","GROUP_CONCAT","GROUP_CONCAT_UNQUOTED","LAST","MAX","MIN","NEST","NTH","QUANTILES","STDDEV","STDDEV_POP","STDDEV_SAMP","SUM","TOP","UNIQUE","VARIANCE","VAR_POP","VAR_SAMP","BIT_COUNT","BOOLEAN","BYTES","CAST","FLOAT","HEX_STRING","INTEGER","STRING","COALESCE","GREATEST","IFNULL","IS_INF","IS_NAN","IS_EXPLICITLY_DEFINED","LEAST","NVL","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATE","DATE_ADD","DATEDIFF","DAY","DAYOFWEEK","DAYOFYEAR","FORMAT_UTC_USEC","HOUR","MINUTE","MONTH","MSEC_TO_TIMESTAMP","NOW","PARSE_UTC_USEC","QUARTER","SEC_TO_TIMESTAMP","SECOND","STRFTIME_UTC_USEC","TIME","TIMESTAMP","TIMESTAMP_TO_MSEC","TIMESTAMP_TO_SEC","TIMESTAMP_TO_USEC","USEC_TO_TIMESTAMP","UTC_USEC_TO_DAY","UTC_USEC_TO_HOUR","UTC_USEC_TO_MONTH","UTC_USEC_TO_WEEK","UTC_USEC_TO_YEAR","WEEK","YEAR","FORMAT_IP","PARSE_IP","FORMAT_PACKED_IP","PARSE_PACKED_IP","JSON_EXTRACT","JSON_EXTRACT_SCALAR","ABS","ACOS","ACOSH","ASIN","ASINH","ATAN","ATANH","ATAN2","CEIL","COS","COSH","DEGREES","EXP","FLOOR","LN","LOG","LOG2","LOG10","PI","POW","RADIANS","RAND","ROUND","SIN","SINH","SQRT","TAN","TANH","REGEXP_MATCH","REGEXP_EXTRACT","REGEXP_REPLACE","CONCAT","INSTR","LEFT","LENGTH","LOWER","LPAD","LTRIM","REPLACE","RIGHT","RPAD","RTRIM","SPLIT","SUBSTR","UPPER","TABLE_DATE_RANGE","TABLE_DATE_RANGE_STRICT","TABLE_QUERY","HOST","DOMAIN","TLD","AVG","COUNT","MAX","MIN","STDDEV","SUM","CUME_DIST","DENSE_RANK","FIRST_VALUE","LAG","LAST_VALUE","LEAD","NTH_VALUE","NTILE","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","RANK","RATIO_TO_REPORT","ROW_NUMBER","CURRENT_USER","EVERY","FROM_BASE64","HASH","FARM_FINGERPRINT","IF","POSITION","SHA1","SOME","TO_BASE64","BQ.JOBS.CANCEL","BQ.REFRESH_MATERIALIZED_VIEW","OPTIONS","PIVOT","UNPIVOT"],extraParens:["[]"],stringTypes:[{quote:'""".."""',prefixes:["R","B","RB","BR"]},{quote:"'''..'''",prefixes:["R","B","RB","BR"]},'""-bs',"''-bs",{quote:'""-raw',prefixes:["R","B","RB","BR"],requirePrefix:!0},{quote:"''-raw",prefixes:["R","B","RB","BR"],requirePrefix:!0}],identTypes:["``"],identChars:{dashes:!0},paramTypes:{positional:!0,named:["@"],quoted:["@"]},variableTypes:[{regex:String.raw`@@\w+`}],lineCommentTypes:["--","#"],operators:["&","|","^","~",">>","<<","||","=>"],postProcess:function(e){var t;let r;return t=function(e){var t;let r=[];for(let a=0;a<e.length;a++){let s=e[a];if((nq.ARRAY(s)||nq.STRUCT(s))&&(null===(t=e[a+1])||void 0===t?void 0:t.text)==="<"){let t=function(e,t){let r=0;for(let a=t;a<e.length;a++){let t=e[a];if("<"===t.text?r++:">"===t.text?r--:">>"===t.text&&(r-=2),0===r)return a}return e.length-1}(e,a+1),i=e.slice(a,t+1);r.push({type:ew.IDENTIFIER,raw:i.map(n8("raw")).join(""),text:i.map(n8("text")).join(""),start:s.start}),a=t}else r.push(s)}return r}(e),r=nK,t.map(e=>"OFFSET"===e.text&&"["===r.text?(r=e,Object.assign(Object.assign({},e),{type:ew.RESERVED_FUNCTION_NAME})):(r=e,e))}},formatOptions:{onelineClauses:[...n1,...n2],tabularOnelineClauses:n2}},n8=e=>t=>t.type===ew.IDENTIFIER||t.type===ew.COMMA?t[e]+" ":t[e],n7=nG(["SELECT [ALL | DISTINCT]"]),oe=nG(["WITH","FROM","WHERE","GROUP BY","HAVING","PARTITION BY","ORDER BY [INPUT SEQUENCE]","LIMIT","OFFSET","FETCH NEXT","FOR UPDATE [OF]","FOR {READ | FETCH} ONLY","FOR {RR | CS | UR | RS} [USE AND KEEP {SHARE | UPDATE | EXCLUSIVE} LOCKS]","WAIT FOR OUTCOME","SKIP LOCKED DATA","INTO","INSERT INTO","VALUES","SET","MERGE INTO","WHEN [NOT] MATCHED [THEN]","UPDATE SET","INSERT"]),ot=nG(["CREATE [GLOBAL TEMPORARY | EXTERNAL] TABLE [IF NOT EXISTS]"]),or=nG(["CREATE [OR REPLACE] VIEW","UPDATE","WHERE CURRENT OF","WITH {RR | RS | CS | UR}","DELETE FROM","DROP TABLE [IF EXISTS]","ALTER TABLE","ADD [COLUMN]","DROP [COLUMN]","RENAME COLUMN","ALTER [COLUMN]","SET DATA TYPE","SET NOT NULL","DROP {DEFAULT | GENERATED | NOT NULL}","TRUNCATE [TABLE]","ALLOCATE","ALTER AUDIT POLICY","ALTER BUFFERPOOL","ALTER DATABASE PARTITION GROUP","ALTER DATABASE","ALTER EVENT MONITOR","ALTER FUNCTION","ALTER HISTOGRAM TEMPLATE","ALTER INDEX","ALTER MASK","ALTER METHOD","ALTER MODULE","ALTER NICKNAME","ALTER PACKAGE","ALTER PERMISSION","ALTER PROCEDURE","ALTER SCHEMA","ALTER SECURITY LABEL COMPONENT","ALTER SECURITY POLICY","ALTER SEQUENCE","ALTER SERVER","ALTER SERVICE CLASS","ALTER STOGROUP","ALTER TABLESPACE","ALTER THRESHOLD","ALTER TRIGGER","ALTER TRUSTED CONTEXT","ALTER TYPE","ALTER USAGE LIST","ALTER USER MAPPING","ALTER VIEW","ALTER WORK ACTION SET","ALTER WORK CLASS SET","ALTER WORKLOAD","ALTER WRAPPER","ALTER XSROBJECT","ALTER STOGROUP","ALTER TABLESPACE","ALTER TRIGGER","ALTER TRUSTED CONTEXT","ALTER VIEW","ASSOCIATE [RESULT SET] {LOCATOR | LOCATORS}","AUDIT","BEGIN DECLARE SECTION","CALL","CLOSE","COMMENT ON","COMMIT [WORK]","CONNECT","CREATE [OR REPLACE] [PUBLIC] ALIAS","CREATE AUDIT POLICY","CREATE BUFFERPOOL","CREATE DATABASE PARTITION GROUP","CREATE EVENT MONITOR","CREATE [OR REPLACE] FUNCTION","CREATE FUNCTION MAPPING","CREATE HISTOGRAM TEMPLATE","CREATE [UNIQUE] INDEX","CREATE INDEX EXTENSION","CREATE [OR REPLACE] MASK","CREATE [SPECIFIC] METHOD","CREATE [OR REPLACE] MODULE","CREATE [OR REPLACE] NICKNAME","CREATE [OR REPLACE] PERMISSION","CREATE [OR REPLACE] PROCEDURE","CREATE ROLE","CREATE SCHEMA","CREATE SECURITY LABEL [COMPONENT]","CREATE SECURITY POLICY","CREATE [OR REPLACE] SEQUENCE","CREATE SERVICE CLASS","CREATE SERVER","CREATE STOGROUP","CREATE SYNONYM","CREATE [LARGE | REGULAR | {SYSTEM | USER} TEMPORARY] TABLESPACE","CREATE THRESHOLD","CREATE {TRANSFORM | TRANSFORMS} FOR","CREATE [OR REPLACE] TRIGGER","CREATE TRUSTED CONTEXT","CREATE [OR REPLACE] TYPE","CREATE TYPE MAPPING","CREATE USAGE LIST","CREATE USER MAPPING FOR","CREATE [OR REPLACE] VARIABLE","CREATE WORK ACTION SET","CREATE WORK CLASS SET","CREATE WORKLOAD","CREATE WRAPPER","DECLARE","DECLARE GLOBAL TEMPORARY TABLE","DESCRIBE [INPUT | OUTPUT]","DISCONNECT","DROP [PUBLIC] ALIAS","DROP AUDIT POLICY","DROP BUFFERPOOL","DROP DATABASE PARTITION GROUP","DROP EVENT MONITOR","DROP [SPECIFIC] FUNCTION","DROP FUNCTION MAPPING","DROP HISTOGRAM TEMPLATE","DROP INDEX [EXTENSION]","DROP MASK","DROP [SPECIFIC] METHOD","DROP MODULE","DROP NICKNAME","DROP PACKAGE","DROP PERMISSION","DROP [SPECIFIC] PROCEDURE","DROP ROLE","DROP SCHEMA","DROP SECURITY LABEL [COMPONENT]","DROP SECURITY POLICY","DROP SEQUENCE","DROP SERVER","DROP SERVICE CLASS","DROP STOGROUP","DROP TABLE HIERARCHY","DROP {TABLESPACE | TABLESPACES}","DROP {TRANSFORM | TRANSFORMS}","DROP THRESHOLD","DROP TRIGGER","DROP TRUSTED CONTEXT","DROP TYPE [MAPPING]","DROP USAGE LIST","DROP USER MAPPING FOR","DROP VARIABLE","DROP VIEW [HIERARCHY]","DROP WORK {ACTION | CLASS} SET","DROP WORKLOAD","DROP WRAPPER","DROP XSROBJECT","END DECLARE SECTION","EXECUTE [IMMEDIATE]","EXPLAIN {PLAN [SECTION] | ALL}","FETCH [FROM]","FLUSH {BUFFERPOOL | BUFFERPOOLS} ALL","FLUSH EVENT MONITOR","FLUSH FEDERATED CACHE","FLUSH OPTIMIZATION PROFILE CACHE","FLUSH PACKAGE CACHE [DYNAMIC]","FLUSH AUTHENTICATION CACHE [FOR ALL]","FREE LOCATOR","GET DIAGNOSTICS","GOTO","GRANT","INCLUDE","ITERATE","LEAVE","LOCK TABLE","LOOP","OPEN","PIPE","PREPARE","REFRESH TABLE","RELEASE","RELEASE [TO] SAVEPOINT","RENAME [TABLE | INDEX | STOGROUP | TABLESPACE]","REPEAT","RESIGNAL","RETURN","REVOKE","ROLLBACK [WORK] [TO SAVEPOINT]","SAVEPOINT","SET COMPILATION ENVIRONMENT","SET CONNECTION","SET CURRENT","SET ENCRYPTION PASSWORD","SET EVENT MONITOR STATE","SET INTEGRITY","SET PASSTHRU","SET PATH","SET ROLE","SET SCHEMA","SET SERVER OPTION","SET {SESSION AUTHORIZATION | SESSION_USER}","SET USAGE LIST","SIGNAL","TRANSFER OWNERSHIP OF","WHENEVER {NOT FOUND | SQLERROR | SQLWARNING}","WHILE"]),oa=nG(["UNION [ALL]","EXCEPT [ALL]","INTERSECT [ALL]"]),os=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN"]),oi=nG(["ON DELETE","ON UPDATE","SET NULL","{ROWS | RANGE} BETWEEN"]),on=nG([]),oo={name:"db2",tokenizerOptions:{reservedSelect:n7,reservedClauses:[...oe,...ot,...or],reservedSetOperations:oa,reservedJoins:os,reservedKeywordPhrases:oi,reservedDataTypePhrases:on,reservedKeywords:["ACTIVATE","ADD","AFTER","ALIAS","ALL","ALLOCATE","ALLOW","ALTER","AND","ANY","AS","ASENSITIVE","ASSOCIATE","ASUTIME","AT","ATTRIBUTES","AUDIT","AUTHORIZATION","AUX","AUXILIARY","BEFORE","BEGIN","BETWEEN","BINARY","BUFFERPOOL","BY","CACHE","CALL","CALLED","CAPTURE","CARDINALITY","CASCADED","CASE","CAST","CHECK","CLONE","CLOSE","CLUSTER","COLLECTION","COLLID","COLUMN","COMMENT","COMMIT","CONCAT","CONDITION","CONNECT","CONNECTION","CONSTRAINT","CONTAINS","CONTINUE","COUNT","COUNT_BIG","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_LC_CTYPE","CURRENT_PATH","CURRENT_SCHEMA","CURRENT_SERVER","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_USER","CURSOR","CYCLE","DATA","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DAY","DAYS","DB2GENERAL","DB2GENRL","DB2SQL","DBINFO","DBPARTITIONNAME","DBPARTITIONNUM","DEALLOCATE","DECLARE","DEFAULT","DEFAULTS","DEFINITION","DELETE","DENSERANK","DENSE_RANK","DESCRIBE","DESCRIPTOR","DETERMINISTIC","DIAGNOSTICS","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DO","DOCUMENT","DROP","DSSIZE","DYNAMIC","EACH","EDITPROC","ELSE","ELSEIF","ENABLE","ENCODING","ENCRYPTION","END","END-EXEC","ENDING","ERASE","ESCAPE","EVERY","EXCEPT","EXCEPTION","EXCLUDING","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXPLAIN","EXTENDED","EXTERNAL","EXTRACT","FENCED","FETCH","FIELDPROC","FILE","FINAL","FIRST1","FOR","FOREIGN","FREE","FROM","FULL","FUNCTION","GENERAL","GENERATED","GET","GLOBAL","GO","GOTO","GRANT","GRAPHIC","GROUP","HANDLER","HASH","HASHED_VALUE","HAVING","HINT","HOLD","HOUR","HOURS","IDENTITY","IF","IMMEDIATE","IMPORT","IN","INCLUDING","INCLUSIVE","INCREMENT","INDEX","INDICATOR","INDICATORS","INF","INFINITY","INHERIT","INNER","INOUT","INSENSITIVE","INSERT","INTEGRITY","INTERSECT","INTO","IS","ISNULL","ISOBID","ISOLATION","ITERATE","JAR","JAVA","JOIN","KEEP","KEY","LABEL","LANGUAGE","LAST3","LATERAL","LC_CTYPE","LEAVE","LEFT","LIKE","LIMIT","LINKTYPE","LOCAL","LOCALDATE","LOCALE","LOCALTIME","LOCALTIMESTAMP","LOCATOR","LOCATORS","LOCK","LOCKMAX","LOCKSIZE","LOOP","MAINTAINED","MATERIALIZED","MAXVALUE","MICROSECOND","MICROSECONDS","MINUTE","MINUTES","MINVALUE","MODE","MODIFIES","MONTH","MONTHS","NAN","NEW","NEW_TABLE","NEXTVAL","NO","NOCACHE","NOCYCLE","NODENAME","NODENUMBER","NOMAXVALUE","NOMINVALUE","NONE","NOORDER","NORMALIZED","NOT2","NOTNULL","NULL","NULLS","NUMPARTS","OBID","OF","OFF","OFFSET","OLD","OLD_TABLE","ON","OPEN","OPTIMIZATION","OPTIMIZE","OPTION","OR","ORDER","OUT","OUTER","OVER","OVERRIDING","PACKAGE","PADDED","PAGESIZE","PARAMETER","PART","PARTITION","PARTITIONED","PARTITIONING","PARTITIONS","PASSWORD","PATH","PERCENT","PIECESIZE","PLAN","POSITION","PRECISION","PREPARE","PREVVAL","PRIMARY","PRIQTY","PRIVILEGES","PROCEDURE","PROGRAM","PSID","PUBLIC","QUERY","QUERYNO","RANGE","RANK","READ","READS","RECOVERY","REFERENCES","REFERENCING","REFRESH","RELEASE","RENAME","REPEAT","RESET","RESIGNAL","RESTART","RESTRICT","RESULT","RESULT_SET_LOCATOR","RETURN","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROUND_CEILING","ROUND_DOWN","ROUND_FLOOR","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_HALF_UP","ROUND_UP","ROUTINE","ROW","ROWNUMBER","ROWS","ROWSET","ROW_NUMBER","RRN","RUN","SAVEPOINT","SCHEMA","SCRATCHPAD","SCROLL","SEARCH","SECOND","SECONDS","SECQTY","SECURITY","SELECT","SENSITIVE","SEQUENCE","SESSION","SESSION_USER","SET","SIGNAL","SIMPLE","SNAN","SOME","SOURCE","SPECIFIC","SQL","SQLID","STACKED","STANDARD","START","STARTING","STATEMENT","STATIC","STATMENT","STAY","STOGROUP","STORES","STYLE","SUBSTRING","SUMMARY","SYNONYM","SYSFUN","SYSIBM","SYSPROC","SYSTEM","SYSTEM_USER","TABLE","TABLESPACE","THEN","TO","TRANSACTION","TRIGGER","TRIM","TRUNCATE","TYPE","UNDO","UNION","UNIQUE","UNTIL","UPDATE","USAGE","USER","USING","VALIDPROC","VALUE","VALUES","VARIABLE","VARIANT","VCAT","VERSION","VIEW","VOLATILE","VOLUMES","WHEN","WHENEVER","WHERE","WHILE","WITH","WITHOUT","WLM","WRITE","XMLELEMENT","XMLEXISTS","XMLNAMESPACES","YEAR","YEARS"],reservedDataTypes:["ARRAY","BIGINT","BINARY","BLOB","BOOLEAN","CCSID","CHAR","CHARACTER","CLOB","DATE","DATETIME","DBCLOB","DEC","DECIMAL","DOUBLE","DOUBLE PRECISION","FLOAT","FLOAT4","FLOAT8","GRAPHIC","INT","INT2","INT4","INT8","INTEGER","INTERVAL","LONG VARCHAR","LONG VARGRAPHIC","NCHAR","NCHR","NCLOB","NVARCHAR","NUMERIC","SMALLINT","REAL","TIME","TIMESTAMP","VARBINARY","VARCHAR","VARGRAPHIC"],reservedFunctionNames:["ARRAY_AGG","AVG","CORRELATION","COUNT","COUNT_BIG","COVARIANCE","COVARIANCE_SAMP","CUME_DIST","GROUPING","LISTAGG","MAX","MEDIAN","MIN","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_ICPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","STDDEV","STDDEV_SAMP","SUM","VARIANCE","VARIANCE_SAMP","XMLAGG","XMLGROUP","ABS","ABSVAL","ACOS","ADD_DAYS","ADD_HOURS","ADD_MINUTES","ADD_MONTHS","ADD_SECONDS","ADD_YEARS","AGE","ARRAY_DELETE","ARRAY_FIRST","ARRAY_LAST","ARRAY_NEXT","ARRAY_PRIOR","ASCII","ASCII_STR","ASIN","ATAN","ATAN2","ATANH","BITAND","BITANDNOT","BITOR","BITXOR","BITNOT","BPCHAR","BSON_TO_JSON","BTRIM","CARDINALITY","CEILING","CEIL","CHARACTER_LENGTH","CHR","COALESCE","COLLATION_KEY","COLLATION_KEY_BIT","COMPARE_DECFLOAT","CONCAT","COS","COSH","COT","CURSOR_ROWCOUNT","DATAPARTITIONNUM","DATE_PART","DATE_TRUNC","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DAYOFWEEK_ISO","DAYOFYEAR","DAYS","DAYS_BETWEEN","DAYS_TO_END_OF_MONTH","DBPARTITIONNUM","DECFLOAT","DECFLOAT_FORMAT","DECODE","DECRYPT_BIN","DECRYPT_CHAR","DEGREES","DEREF","DIFFERENCE","DIGITS","DOUBLE_PRECISION","EMPTY_BLOB","EMPTY_CLOB","EMPTY_DBCLOB","EMPTY_NCLOB","ENCRYPT","EVENT_MON_STATE","EXP","EXTRACT","FIRST_DAY","FLOOR","FROM_UTC_TIMESTAMP","GENERATE_UNIQUE","GETHINT","GREATEST","HASH","HASH4","HASH8","HASHEDVALUE","HEX","HEXTORAW","HOUR","HOURS_BETWEEN","IDENTITY_VAL_LOCAL","IFNULL","INITCAP","INSERT","INSTR","INSTR2","INSTR4","INSTRB","INTNAND","INTNOR","INTNXOR","INTNNOT","ISNULL","JSON_ARRAY","JSON_OBJECT","JSON_QUERY","JSON_TO_BSON","JSON_VALUE","JULIAN_DAY","LAST_DAY","LCASE","LEAST","LEFT","LENGTH","LENGTH2","LENGTH4","LENGTHB","LN","LOCATE","LOCATE_IN_STRING","LOG10","LONG_VARCHAR","LONG_VARGRAPHIC","LOWER","LPAD","LTRIM","MAX","MAX_CARDINALITY","MICROSECOND","MIDNIGHT_SECONDS","MIN","MINUTE","MINUTES_BETWEEN","MOD","MONTH","MONTHNAME","MONTHS_BETWEEN","MULTIPLY_ALT","NEXT_DAY","NEXT_MONTH","NEXT_QUARTER","NEXT_WEEK","NEXT_YEAR","NORMALIZE_DECFLOAT","NOW","NULLIF","NVL","NVL2","OCTET_LENGTH","OVERLAY","PARAMETER","POSITION","POSSTR","POW","POWER","QUANTIZE","QUARTER","QUOTE_IDENT","QUOTE_LITERAL","RADIANS","RAISE_ERROR","RAND","RANDOM","RAWTOHEX","REC2XML","REGEXP_COUNT","REGEXP_EXTRACT","REGEXP_INSTR","REGEXP_LIKE","REGEXP_MATCH_COUNT","REGEXP_REPLACE","REGEXP_SUBSTR","REPEAT","REPLACE","RID","RID_BIT","RIGHT","ROUND","ROUND_TIMESTAMP","RPAD","RTRIM","SECLABEL","SECLABEL_BY_NAME","SECLABEL_TO_CHAR","SECOND","SECONDS_BETWEEN","SIGN","SIN","SINH","SOUNDEX","SPACE","SQRT","STRIP","STRLEFT","STRPOS","STRRIGHT","SUBSTR","SUBSTR2","SUBSTR4","SUBSTRB","SUBSTRING","TABLE_NAME","TABLE_SCHEMA","TAN","TANH","THIS_MONTH","THIS_QUARTER","THIS_WEEK","THIS_YEAR","TIMESTAMP_FORMAT","TIMESTAMP_ISO","TIMESTAMPDIFF","TIMEZONE","TO_CHAR","TO_CLOB","TO_DATE","TO_HEX","TO_MULTI_BYTE","TO_NCHAR","TO_NCLOB","TO_NUMBER","TO_SINGLE_BYTE","TO_TIMESTAMP","TO_UTC_TIMESTAMP","TOTALORDER","TRANSLATE","TRIM","TRIM_ARRAY","TRUNC_TIMESTAMP","TRUNCATE","TRUNC","TYPE_ID","TYPE_NAME","TYPE_SCHEMA","UCASE","UNICODE_STR","UPPER","VALUE","VARCHAR_BIT_FORMAT","VARCHAR_FORMAT","VARCHAR_FORMAT_BIT","VERIFY_GROUP_FOR_USER","VERIFY_ROLE_FOR_USER","VERIFY_TRUSTED_CONTEXT_ROLE_FOR_USER","WEEK","WEEK_ISO","WEEKS_BETWEEN","WIDTH_BUCKET","XMLATTRIBUTES","XMLCOMMENT","XMLCONCAT","XMLDOCUMENT","XMLELEMENT","XMLFOREST","XMLNAMESPACES","XMLPARSE","XMLPI","XMLQUERY","XMLROW","XMLSERIALIZE","XMLTEXT","XMLVALIDATE","XMLXSROBJECTID","XSLTRANSFORM","YEAR","YEARS_BETWEEN","YMD_BETWEEN","BASE_TABLE","JSON_TABLE","UNNEST","XMLTABLE","RANK","DENSE_RANK","NTILE","LAG","LEAD","ROW_NUMBER","FIRST_VALUE","LAST_VALUE","NTH_VALUE","RATIO_TO_REPORT","CAST"],extraParens:["[]"],stringTypes:[{quote:"''-qq",prefixes:["G","N","U&"]},{quote:"''-raw",prefixes:["X","BX","GX","UX"],requirePrefix:!0}],identTypes:['""-qq'],identChars:{first:"@#$",rest:"@#$"},paramTypes:{positional:!0,named:[":"]},paramChars:{first:"@#$",rest:"@#$"},operators:["**","%","|","&","^","~","\xac=","\xac>","\xac<","!>","!<","^=","^>","^<","||","->","=>"]},formatOptions:{onelineClauses:[...ot,...or],tabularOnelineClauses:or}},ol=nG(["SELECT [ALL | DISTINCT]"]),oE=nG(["WITH [RECURSIVE]","INTO","FROM","WHERE","GROUP BY","HAVING","PARTITION BY","ORDER [SIBLINGS] BY [INPUT SEQUENCE]","LIMIT","OFFSET","FETCH {FIRST | NEXT}","FOR UPDATE [OF]","FOR READ ONLY","OPTIMIZE FOR","INSERT INTO","VALUES","SET","MERGE INTO","WHEN [NOT] MATCHED [THEN]","UPDATE SET","DELETE","INSERT","FOR SYSTEM NAME"]),ou=nG(["CREATE [OR REPLACE] TABLE"]),oc=nG(["CREATE [OR REPLACE] [RECURSIVE] VIEW","UPDATE","WHERE CURRENT OF","WITH {NC | RR | RS | CS | UR}","DELETE FROM","DROP TABLE","ALTER TABLE","ADD [COLUMN]","ALTER [COLUMN]","DROP [COLUMN]","SET DATA TYPE","SET {GENERATED ALWAYS | GENERATED BY DEFAULT}","SET NOT NULL","SET {NOT HIDDEN | IMPLICITLY HIDDEN}","SET FIELDPROC","DROP {DEFAULT | NOT NULL | GENERATED | IDENTITY | ROW CHANGE TIMESTAMP | FIELDPROC}","TRUNCATE [TABLE]","SET [CURRENT] SCHEMA","SET CURRENT_SCHEMA","ALLOCATE CURSOR","ALLOCATE [SQL] DESCRIPTOR [LOCAL | GLOBAL] SQL","ALTER [SPECIFIC] {FUNCTION | PROCEDURE}","ALTER {MASK | PERMISSION | SEQUENCE | TRIGGER}","ASSOCIATE [RESULT SET] {LOCATOR | LOCATORS}","BEGIN DECLARE SECTION","CALL","CLOSE","COMMENT ON {ALIAS | COLUMN | CONSTRAINT | INDEX | MASK | PACKAGE | PARAMETER | PERMISSION | SEQUENCE | TABLE | TRIGGER | VARIABLE | XSROBJECT}","COMMENT ON [SPECIFIC] {FUNCTION | PROCEDURE | ROUTINE}","COMMENT ON PARAMETER SPECIFIC {FUNCTION | PROCEDURE | ROUTINE}","COMMENT ON [TABLE FUNCTION] RETURN COLUMN","COMMENT ON [TABLE FUNCTION] RETURN COLUMN SPECIFIC [PROCEDURE | ROUTINE]","COMMIT [WORK] [HOLD]","CONNECT [TO | RESET] USER","CREATE [OR REPLACE] {ALIAS | FUNCTION | MASK | PERMISSION | PROCEDURE | SEQUENCE | TRIGGER | VARIABLE}","CREATE [ENCODED VECTOR] INDEX","CREATE UNIQUE [WHERE NOT NULL] INDEX","CREATE SCHEMA","CREATE TYPE","DEALLOCATE [SQL] DESCRIPTOR [LOCAL | GLOBAL]","DECLARE CURSOR","DECLARE GLOBAL TEMPORARY TABLE","DECLARE","DESCRIBE CURSOR","DESCRIBE INPUT","DESCRIBE [OUTPUT]","DESCRIBE {PROCEDURE | ROUTINE}","DESCRIBE TABLE","DISCONNECT ALL [SQL]","DISCONNECT [CURRENT]","DROP {ALIAS | INDEX | MASK | PACKAGE | PERMISSION | SCHEMA | SEQUENCE | TABLE | TYPE | VARIABLE | XSROBJECT} [IF EXISTS]","DROP [SPECIFIC] {FUNCTION | PROCEDURE | ROUTINE} [IF EXISTS]","END DECLARE SECTION","EXECUTE [IMMEDIATE]","FREE LOCATOR","GET [SQL] DESCRIPTOR [LOCAL | GLOBAL]","GET [CURRENT | STACKED] DIAGNOSTICS","GRANT {ALL [PRIVILEGES] | ALTER | EXECUTE} ON {FUNCTION | PROCEDURE | ROUTINE | PACKAGE | SCHEMA | SEQUENCE | TABLE | TYPE | VARIABLE | XSROBJECT}","HOLD LOCATOR","INCLUDE","LABEL ON {ALIAS | COLUMN | CONSTRAINT | INDEX | MASK | PACKAGE | PERMISSION | SEQUENCE | TABLE | TRIGGER | VARIABLE | XSROBJECT}","LABEL ON [SPECIFIC] {FUNCTION | PROCEDURE | ROUTINE}","LOCK TABLE","OPEN","PREPARE","REFRESH TABLE","RELEASE","RELEASE [TO] SAVEPOINT","RENAME [TABLE | INDEX] TO","REVOKE {ALL [PRIVILEGES] | ALTER | EXECUTE} ON {FUNCTION | PROCEDURE | ROUTINE | PACKAGE | SCHEMA | SEQUENCE | TABLE | TYPE | VARIABLE | XSROBJECT}","ROLLBACK [WORK] [HOLD | TO SAVEPOINT]","SAVEPOINT","SET CONNECTION","SET CURRENT {DEBUG MODE | DECFLOAT ROUNDING MODE | DEGREE | IMPLICIT XMLPARSE OPTION | TEMPORAL SYSTEM_TIME}","SET [SQL] DESCRIPTOR [LOCAL | GLOBAL]","SET ENCRYPTION PASSWORD","SET OPTION","SET {[CURRENT [FUNCTION]] PATH | CURRENT_PATH}","SET RESULT SETS [WITH RETURN [TO CALLER | TO CLIENT]]","SET SESSION AUTHORIZATION","SET SESSION_USER","SET TRANSACTION","SIGNAL SQLSTATE [VALUE]","TAG","TRANSFER OWNERSHIP OF","WHENEVER {NOT FOUND | SQLERROR | SQLWARNING}"]),oT=nG(["UNION [ALL]","EXCEPT [ALL]","INTERSECT [ALL]"]),od=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","[LEFT | RIGHT] EXCEPTION JOIN","{INNER | CROSS} JOIN"]),oh=nG(["ON DELETE","ON UPDATE","SET NULL","{ROWS | RANGE} BETWEEN"]),oA=nG([]),op={name:"db2i",tokenizerOptions:{reservedSelect:ol,reservedClauses:[...oE,...ou,...oc],reservedSetOperations:oT,reservedJoins:od,reservedKeywordPhrases:oh,reservedDataTypePhrases:oA,reservedKeywords:["ABSENT","ACCORDING","ACCTNG","ACTION","ACTIVATE","ADD","ALIAS","ALL","ALLOCATE","ALLOW","ALTER","AND","ANY","APPEND","APPLNAME","ARRAY","ARRAY_AGG","ARRAY_TRIM","AS","ASC","ASENSITIVE","ASSOCIATE","ATOMIC","ATTACH","ATTRIBUTES","AUTHORIZATION","AUTONOMOUS","BEFORE","BEGIN","BETWEEN","BIND","BSON","BUFFERPOOL","BY","CACHE","CALL","CALLED","CARDINALITY","CASE","CAST","CHECK","CL","CLOSE","CLUSTER","COLLECT","COLLECTION","COLUMN","COMMENT","COMMIT","COMPACT","COMPARISONS","COMPRESS","CONCAT","CONCURRENT","CONDITION","CONNECT","CONNECT_BY_ROOT","CONNECTION","CONSTANT","CONSTRAINT","CONTAINS","CONTENT","CONTINUE","COPY","COUNT","COUNT_BIG","CREATE","CREATEIN","CROSS","CUBE","CUME_DIST","CURRENT","CURRENT_DATE","CURRENT_PATH","CURRENT_SCHEMA","CURRENT_SERVER","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_USER","CURSOR","CYCLE","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DAY","DAYS","DB2GENERAL","DB2GENRL","DB2SQL","DBINFO","DBPARTITIONNAME","DBPARTITIONNUM","DEACTIVATE","DEALLOCATE","DECLARE","DEFAULT","DEFAULTS","DEFER","DEFINE","DEFINITION","DELETE","DELETING","DENSE_RANK","DENSERANK","DESC","DESCRIBE","DESCRIPTOR","DETACH","DETERMINISTIC","DIAGNOSTICS","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DO","DOCUMENT","DROP","DYNAMIC","EACH","ELSE","ELSEIF","EMPTY","ENABLE","ENCODING","ENCRYPTION","END","END-EXEC","ENDING","ENFORCED","ERROR","ESCAPE","EVERY","EXCEPT","EXCEPTION","EXCLUDING","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTEND","EXTERNAL","EXTRACT","FALSE","FENCED","FETCH","FIELDPROC","FILE","FINAL","FIRST_VALUE","FOR","FOREIGN","FORMAT","FREE","FREEPAGE","FROM","FULL","FUNCTION","GBPCACHE","GENERAL","GENERATED","GET","GLOBAL","GO","GOTO","GRANT","GROUP","HANDLER","HASH","HASH_ROW","HASHED_VALUE","HAVING","HINT","HOLD","HOUR","HOURS","IDENTITY","IF","IGNORE","IMMEDIATE","IMPLICITLY","IN","INCLUDE","INCLUDING","INCLUSIVE","INCREMENT","INDEX","INDEXBP","INDICATOR","INF","INFINITY","INHERIT","INLINE","INNER","INOUT","INSENSITIVE","INSERT","INSERTING","INTEGRITY","INTERPRET","INTERSECT","INTO","IS","ISNULL","ISOLATION","ITERATE","JAVA","JOIN","JSON","JSON_ARRAY","JSON_ARRAYAGG","JSON_EXISTS","JSON_OBJECT","JSON_OBJECTAGG","JSON_QUERY","JSON_TABLE","JSON_VALUE","KEEP","KEY","KEYS","LABEL","LAG","LANGUAGE","LAST_VALUE","LATERAL","LEAD","LEAVE","LEFT","LEVEL2","LIKE","LIMIT","LINKTYPE","LISTAGG","LOCAL","LOCALDATE","LOCALTIME","LOCALTIMESTAMP","LOCATION","LOCATOR","LOCK","LOCKSIZE","LOG","LOGGED","LOOP","MAINTAINED","MASK","MATCHED","MATERIALIZED","MAXVALUE","MERGE","MICROSECOND","MICROSECONDS","MINPCTUSED","MINUTE","MINUTES","MINVALUE","MIRROR","MIXED","MODE","MODIFIES","MONTH","MONTHS","NAMESPACE","NAN","NATIONAL","NCHAR","NCLOB","NESTED","NEW","NEW_TABLE","NEXTVAL","NO","NOCACHE","NOCYCLE","NODENAME","NODENUMBER","NOMAXVALUE","NOMINVALUE","NONE","NOORDER","NORMALIZED","NOT","NOTNULL","NTH_VALUE","NTILE","NULL","NULLS","NVARCHAR","OBID","OBJECT","OF","OFF","OFFSET","OLD","OLD_TABLE","OMIT","ON","ONLY","OPEN","OPTIMIZE","OPTION","OR","ORDER","ORDINALITY","ORGANIZE","OUT","OUTER","OVER","OVERLAY","OVERRIDING","PACKAGE","PADDED","PAGE","PAGESIZE","PARAMETER","PART","PARTITION","PARTITIONED","PARTITIONING","PARTITIONS","PASSING","PASSWORD","PATH","PCTFREE","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","PERIOD","PERMISSION","PIECESIZE","PIPE","PLAN","POSITION","PREPARE","PREVVAL","PRIMARY","PRIOR","PRIQTY","PRIVILEGES","PROCEDURE","PROGRAM","PROGRAMID","QUERY","RANGE","RANK","RATIO_TO_REPORT","RCDFMT","READ","READS","RECOVERY","REFERENCES","REFERENCING","REFRESH","REGEXP_LIKE","RELEASE","RENAME","REPEAT","RESET","RESIGNAL","RESTART","RESULT","RESULT_SET_LOCATOR","RETURN","RETURNING","RETURNS","REVOKE","RID","RIGHT","ROLLBACK","ROLLUP","ROUTINE","ROW","ROW_NUMBER","ROWNUMBER","ROWS","RRN","RUN","SAVEPOINT","SBCS","SCALAR","SCHEMA","SCRATCHPAD","SCROLL","SEARCH","SECOND","SECONDS","SECQTY","SECURED","SELECT","SENSITIVE","SEQUENCE","SESSION","SESSION_USER","SET","SIGNAL","SIMPLE","SKIP","SNAN","SOME","SOURCE","SPECIFIC","SQL","SQLID","SQLIND_DEFAULT","SQLIND_UNASSIGNED","STACKED","START","STARTING","STATEMENT","STATIC","STOGROUP","SUBSTRING","SUMMARY","SYNONYM","SYSTEM_TIME","SYSTEM_USER","TABLE","TABLESPACE","TABLESPACES","TAG","THEN","THREADSAFE","TO","TRANSACTION","TRANSFER","TRIGGER","TRIM","TRIM_ARRAY","TRUE","TRUNCATE","TRY_CAST","TYPE","UNDO","UNION","UNIQUE","UNIT","UNKNOWN","UNNEST","UNTIL","UPDATE","UPDATING","URI","USAGE","USE","USER","USERID","USING","VALUE","VALUES","VARIABLE","VARIANT","VCAT","VERSION","VERSIONING","VIEW","VOLATILE","WAIT","WHEN","WHENEVER","WHERE","WHILE","WITH","WITHIN","WITHOUT","WRAPPED","WRAPPER","WRITE","WRKSTNNAME","XMLAGG","XMLATTRIBUTES","XMLCAST","XMLCOMMENT","XMLCONCAT","XMLDOCUMENT","XMLELEMENT","XMLFOREST","XMLGROUP","XMLNAMESPACES","XMLPARSE","XMLPI","XMLROW","XMLSERIALIZE","XMLTABLE","XMLTEXT","XMLVALIDATE","XSLTRANSFORM","XSROBJECT","YEAR","YEARS","YES","ZONE"],reservedDataTypes:["ARRAY","BIGINT","BINARY","BIT","BLOB","BOOLEAN","CCSID","CHAR","CHARACTER","CLOB","DATA","DATALINK","DATE","DBCLOB","DECFLOAT","DECIMAL","DEC","DOUBLE","DOUBLE PRECISION","FLOAT","GRAPHIC","INT","INTEGER","LONG","NUMERIC","REAL","ROWID","SMALLINT","TIME","TIMESTAMP","VARBINARY","VARCHAR","VARGRAPHIC","XML"],reservedFunctionNames:["ARRAY_AGG","AVG","CORR","CORRELATION","COUNT","COUNT_BIG","COVAR_POP","COVARIANCE","COVAR","COVAR_SAMP","COVARIANCE_SAMP","EVERY","GROUPING","JSON_ARRAYAGG","JSON_OBJECTAGG","LISTAGG","MAX","MEDIAN","MIN","PERCENTILE_CONT","PERCENTILE_DISC","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","SOME","STDDEV_POP","STDDEV","STDDEV_SAMP","SUM","VAR_POP","VARIANCE","VAR","VAR_SAMP","VARIANCE_SAMP","XMLAGG","XMLGROUP","ABS","ABSVAL","ACOS","ADD_DAYS","ADD_HOURS","ADD_MINUTES","ADD_MONTHS","ADD_SECONDS","ADD_YEARS","ANTILOG","ARRAY_MAX_CARDINALITY","ARRAY_TRIM","ASCII","ASIN","ATAN","ATAN2","ATANH","BASE64_DECODE","BASE64_ENCODE","BIT_LENGTH","BITAND","BITANDNOT","BITNOT","BITOR","BITXOR","BSON_TO_JSON","CARDINALITY","CEIL","CEILING","CHAR_LENGTH","CHARACTER_LENGTH","CHR","COALESCE","COMPARE_DECFLOAT","CONCAT","CONTAINS","COS","COSH","COT","CURDATE","CURTIME","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK_ISO","DAYOFWEEK","DAYOFYEAR","DAYS","DBPARTITIONNAME","DBPARTITIONNUM","DECFLOAT_FORMAT","DECFLOAT_SORTKEY","DECRYPT_BINARY","DECRYPT_BIT","DECRYPT_CHAR","DECRYPT_DB","DEGREES","DIFFERENCE","DIGITS","DLCOMMENT","DLLINKTYPE","DLURLCOMPLETE","DLURLPATH","DLURLPATHONLY","DLURLSCHEME","DLURLSERVER","DLVALUE","DOUBLE_PRECISION","DOUBLE","ENCRPYT","ENCRYPT_AES","ENCRYPT_AES256","ENCRYPT_RC2","ENCRYPT_TDES","EXP","EXTRACT","FIRST_DAY","FLOOR","GENERATE_UNIQUE","GET_BLOB_FROM_FILE","GET_CLOB_FROM_FILE","GET_DBCLOB_FROM_FILE","GET_XML_FILE","GETHINT","GREATEST","HASH_MD5","HASH_ROW","HASH_SHA1","HASH_SHA256","HASH_SHA512","HASH_VALUES","HASHED_VALUE","HEX","HEXTORAW","HOUR","HTML_ENTITY_DECODE","HTML_ENTITY_ENCODE","HTTP_DELETE_BLOB","HTTP_DELETE","HTTP_GET_BLOB","HTTP_GET","HTTP_PATCH_BLOB","HTTP_PATCH","HTTP_POST_BLOB","HTTP_POST","HTTP_PUT_BLOB","HTTP_PUT","IDENTITY_VAL_LOCAL","IFNULL","INSERT","INSTR","INTERPRET","ISFALSE","ISNOTFALSE","ISNOTTRUE","ISTRUE","JSON_ARRAY","JSON_OBJECT","JSON_QUERY","JSON_TO_BSON","JSON_UPDATE","JSON_VALUE","JULIAN_DAY","LAND","LAST_DAY","LCASE","LEAST","LEFT","LENGTH","LN","LNOT","LOCATE_IN_STRING","LOCATE","LOG10","LOR","LOWER","LPAD","LTRIM","MAX_CARDINALITY","MAX","MICROSECOND","MIDNIGHT_SECONDS","MIN","MINUTE","MOD","MONTH","MONTHNAME","MONTHS_BETWEEN","MQREAD","MQREADCLOB","MQRECEIVE","MQRECEIVECLOB","MQSEND","MULTIPLY_ALT","NEXT_DAY","NORMALIZE_DECFLOAT","NOW","NULLIF","NVL","OCTET_LENGTH","OVERLAY","PI","POSITION","POSSTR","POW","POWER","QUANTIZE","QUARTER","RADIANS","RAISE_ERROR","RANDOM","RAND","REGEXP_COUNT","REGEXP_INSTR","REGEXP_REPLACE","REGEXP_SUBSTR","REPEAT","REPLACE","RID","RIGHT","ROUND_TIMESTAMP","ROUND","RPAD","RRN","RTRIM","SCORE","SECOND","SIGN","SIN","SINH","SOUNDEX","SPACE","SQRT","STRIP","STRLEFT","STRPOS","STRRIGHT","SUBSTR","SUBSTRING","TABLE_NAME","TABLE_SCHEMA","TAN","TANH","TIMESTAMP_FORMAT","TIMESTAMP_ISO","TIMESTAMPDIFF_BIG","TIMESTAMPDIFF","TO_CHAR","TO_CLOB","TO_DATE","TO_NUMBER","TO_TIMESTAMP","TOTALORDER","TRANSLATE","TRIM_ARRAY","TRIM","TRUNC_TIMESTAMP","TRUNC","TRUNCATE","UCASE","UPPER","URL_DECODE","URL_ENCODE","VALUE","VARBINARY_FORMAT","VARCHAR_BIT_FORMAT","VARCHAR_FORMAT_BINARY","VARCHAR_FORMAT","VERIFY_GROUP_FOR_USER","WEEK_ISO","WEEK","WRAP","XMLATTRIBUTES","XMLCOMMENT","XMLCONCAT","XMLDOCUMENT","XMLELEMENT","XMLFOREST","XMLNAMESPACES","XMLPARSE","XMLPI","XMLROW","XMLSERIALIZE","XMLTEXT","XMLVALIDATE","XOR","XSLTRANSFORM","YEAR","ZONED","BASE_TABLE","HTTP_DELETE_BLOB_VERBOSE","HTTP_DELETE_VERBOSE","HTTP_GET_BLOB_VERBOSE","HTTP_GET_VERBOSE","HTTP_PATCH_BLOB_VERBOSE","HTTP_PATCH_VERBOSE","HTTP_POST_BLOB_VERBOSE","HTTP_POST_VERBOSE","HTTP_PUT_BLOB_VERBOSE","HTTP_PUT_VERBOSE","JSON_TABLE","MQREADALL","MQREADALLCLOB","MQRECEIVEALL","MQRECEIVEALLCLOB","XMLTABLE","UNPACK","CUME_DIST","DENSE_RANK","FIRST_VALUE","LAG","LAST_VALUE","LEAD","NTH_VALUE","NTILE","PERCENT_RANK","RANK","RATIO_TO_REPORT","ROW_NUMBER","CAST"],nestedBlockComments:!0,extraParens:["[]"],stringTypes:[{quote:"''-qq",prefixes:["G","N"]},{quote:"''-raw",prefixes:["X","BX","GX","UX"],requirePrefix:!0}],identTypes:['""-qq'],identChars:{first:"@#$",rest:"@#$"},paramTypes:{positional:!0,named:[":"]},paramChars:{first:"@#$",rest:"@#$"},operators:["**","\xac=","\xac>","\xac<","!>","!<","||","=>"]},formatOptions:{onelineClauses:[...ou,...oc],tabularOnelineClauses:oc}},oR=nG(["SELECT [ALL | DISTINCT]"]),oS=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY [ALL]","HAVING","WINDOW","PARTITION BY","ORDER BY [ALL]","LIMIT","OFFSET","USING SAMPLE","QUALIFY","INSERT [OR REPLACE] INTO","VALUES","DEFAULT VALUES","SET","RETURNING"]),o_=nG(["CREATE [OR REPLACE] [TEMPORARY | TEMP] TABLE [IF NOT EXISTS]"]),oO=nG(["UPDATE","ON CONFLICT","DELETE FROM","DROP TABLE [IF EXISTS]","TRUNCATE","ALTER TABLE","ADD [COLUMN] [IF NOT EXISTS]","ADD PRIMARY KEY","DROP [COLUMN] [IF EXISTS]","ALTER [COLUMN]","RENAME [COLUMN]","RENAME TO","SET [DATA] TYPE","{SET | DROP} DEFAULT","{SET | DROP} NOT NULL","CREATE [OR REPLACE] [TEMPORARY | TEMP] {MACRO | FUNCTION}","DROP MACRO [TABLE] [IF EXISTS]","DROP FUNCTION [IF EXISTS]","CREATE [UNIQUE] INDEX [IF NOT EXISTS]","DROP INDEX [IF EXISTS]","CREATE [OR REPLACE] SCHEMA [IF NOT EXISTS]","DROP SCHEMA [IF EXISTS]","CREATE [OR REPLACE] [PERSISTENT | TEMPORARY] SECRET [IF NOT EXISTS]","DROP [PERSISTENT | TEMPORARY] SECRET [IF EXISTS]","CREATE [OR REPLACE] [TEMPORARY | TEMP] SEQUENCE","DROP SEQUENCE [IF EXISTS]","CREATE [OR REPLACE] [TEMPORARY | TEMP] VIEW [IF NOT EXISTS]","DROP VIEW [IF EXISTS]","ALTER VIEW","CREATE TYPE","DROP TYPE [IF EXISTS]","ANALYZE","ATTACH [DATABASE] [IF NOT EXISTS]","DETACH [DATABASE] [IF EXISTS]","CALL","[FORCE] CHECKPOINT","COMMENT ON [TABLE | COLUMN | VIEW | INDEX | SEQUENCE | TYPE | MACRO | MACRO TABLE]","COPY [FROM DATABASE]","DESCRIBE","EXPORT DATABASE","IMPORT DATABASE","INSTALL","LOAD","PIVOT","PIVOT_WIDER","UNPIVOT","EXPLAIN [ANALYZE]","SET {LOCAL | SESSION | GLOBAL}","RESET [LOCAL | SESSION | GLOBAL]","{SET | RESET} VARIABLE","SUMMARIZE","BEGIN TRANSACTION","ROLLBACK","COMMIT","ABORT","USE","VACUUM [ANALYZE]","PREPARE","EXECUTE","DEALLOCATE [PREPARE]"]),oI=nG(["UNION [ALL | BY NAME]","EXCEPT [ALL]","INTERSECT [ALL]"]),of=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","{NATURAL | ASOF} [INNER] JOIN","{NATURAL | ASOF} {LEFT | RIGHT | FULL} [OUTER] JOIN","POSITIONAL JOIN","ANTI JOIN","SEMI JOIN"]),oN=nG(["{ROWS | RANGE | GROUPS} BETWEEN","SIMILAR TO","IS [NOT] DISTINCT FROM"]),om=nG(["TIMESTAMP WITH TIME ZONE"]),oC={name:"duckdb",tokenizerOptions:{reservedSelect:oR,reservedClauses:[...oS,...o_,...oO],reservedSetOperations:oI,reservedJoins:of,reservedKeywordPhrases:oN,reservedDataTypePhrases:om,supportsXor:!0,reservedKeywords:["ALL","ANALYSE","ANALYZE","AND","ANY","AS","ASC","ATTACH","ASYMMETRIC","BOTH","CASE","CAST","CHECK","COLLATE","COLUMN","CONSTRAINT","CREATE","DEFAULT","DEFERRABLE","DESC","DESCRIBE","DETACH","DISTINCT","DO","ELSE","END","EXCEPT","FALSE","FETCH","FOR","FOREIGN","FROM","GRANT","GROUP","HAVING","IN","INITIALLY","INTERSECT","INTO","IS","LATERAL","LEADING","LIMIT","NOT","NULL","OFFSET","ON","ONLY","OR","ORDER","PIVOT","PIVOT_LONGER","PIVOT_WIDER","PLACING","PRIMARY","REFERENCES","RETURNING","SELECT","SHOW","SOME","SUMMARIZE","SYMMETRIC","TABLE","THEN","TO","TRAILING","TRUE","UNION","UNIQUE","UNPIVOT","USING","VARIADIC","WHEN","WHERE","WINDOW","WITH"],reservedDataTypes:["ARRAY","BIGINT","BINARY","BIT","BITSTRING","BLOB","BOOL","BOOLEAN","BPCHAR","BYTEA","CHAR","DATE","DATETIME","DEC","DECIMAL","DOUBLE","ENUM","FLOAT","FLOAT4","FLOAT8","GUID","HUGEINT","INET","INT","INT1","INT128","INT16","INT2","INT32","INT4","INT64","INT8","INTEGER","INTEGRAL","INTERVAL","JSON","LIST","LOGICAL","LONG","MAP","NUMERIC","NVARCHAR","OID","REAL","ROW","SHORT","SIGNED","SMALLINT","STRING","STRUCT","TEXT","TIME","TIMESTAMP_MS","TIMESTAMP_NS","TIMESTAMP_S","TIMESTAMP_US","TIMESTAMP","TIMESTAMPTZ","TIMETZ","TINYINT","UBIGINT","UHUGEINT","UINT128","UINT16","UINT32","UINT64","UINT8","UINTEGER","UNION","USMALLINT","UTINYINT","UUID","VARBINARY","VARCHAR"],reservedFunctionNames:["ABS","ACOS","ADD","ADD_PARQUET_KEY","AGE","AGGREGATE","ALIAS","ALL_PROFILING_OUTPUT","ANY_VALUE","APPLY","APPROX_COUNT_DISTINCT","APPROX_QUANTILE","ARBITRARY","ARGMAX","ARGMIN","ARG_MAX","ARG_MAX_NULL","ARG_MIN","ARG_MIN_NULL","ARRAY_AGG","ARRAY_AGGR","ARRAY_AGGREGATE","ARRAY_APPEND","ARRAY_APPLY","ARRAY_CAT","ARRAY_CONCAT","ARRAY_CONTAINS","ARRAY_COSINE_SIMILARITY","ARRAY_CROSS_PRODUCT","ARRAY_DISTANCE","ARRAY_DISTINCT","ARRAY_DOT_PRODUCT","ARRAY_EXTRACT","ARRAY_FILTER","ARRAY_GRADE_UP","ARRAY_HAS","ARRAY_HAS_ALL","ARRAY_HAS_ANY","ARRAY_INDEXOF","ARRAY_INNER_PRODUCT","ARRAY_INTERSECT","ARRAY_LENGTH","ARRAY_POP_BACK","ARRAY_POP_FRONT","ARRAY_POSITION","ARRAY_PREPEND","ARRAY_PUSH_BACK","ARRAY_PUSH_FRONT","ARRAY_REDUCE","ARRAY_RESIZE","ARRAY_REVERSE","ARRAY_REVERSE_SORT","ARRAY_SELECT","ARRAY_SLICE","ARRAY_SORT","ARRAY_TO_JSON","ARRAY_TO_STRING","ARRAY_TRANSFORM","ARRAY_UNIQUE","ARRAY_VALUE","ARRAY_WHERE","ARRAY_ZIP","ARROW_SCAN","ARROW_SCAN_DUMB","ASCII","ASIN","ATAN","ATAN2","AVG","BASE64","BIN","BITSTRING","BITSTRING_AGG","BIT_AND","BIT_COUNT","BIT_LENGTH","BIT_OR","BIT_POSITION","BIT_XOR","BOOL_AND","BOOL_OR","CARDINALITY","CBRT","CEIL","CEILING","CENTURY","CHECKPOINT","CHR","COLLATIONS","COL_DESCRIPTION","COMBINE","CONCAT","CONCAT_WS","CONSTANT_OR_NULL","CONTAINS","COPY_DATABASE","CORR","COS","COT","COUNT","COUNT_IF","COUNT_STAR","COVAR_POP","COVAR_SAMP","CREATE_SORT_KEY","CURRENT_CATALOG","CURRENT_DATABASE","CURRENT_DATE","CURRENT_LOCALTIME","CURRENT_LOCALTIMESTAMP","CURRENT_QUERY","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SCHEMAS","CURRENT_SETTING","CURRENT_USER","CURRVAL","DAMERAU_LEVENSHTEIN","DATABASE_LIST","DATABASE_SIZE","DATEDIFF","DATEPART","DATESUB","DATETRUNC","DATE_ADD","DATE_DIFF","DATE_PART","DATE_SUB","DATE_TRUNC","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DAYOFYEAR","DECADE","DECODE","DEGREES","DISABLE_CHECKPOINT_ON_SHUTDOWN","DISABLE_OBJECT_CACHE","DISABLE_OPTIMIZER","DISABLE_PRINT_PROGRESS_BAR","DISABLE_PROFILE","DISABLE_PROFILING","DISABLE_PROGRESS_BAR","DISABLE_VERIFICATION","DISABLE_VERIFY_EXTERNAL","DISABLE_VERIFY_FETCH_ROW","DISABLE_VERIFY_PARALLELISM","DISABLE_VERIFY_SERIALIZER","DIVIDE","DUCKDB_COLUMNS","DUCKDB_CONSTRAINTS","DUCKDB_DATABASES","DUCKDB_DEPENDENCIES","DUCKDB_EXTENSIONS","DUCKDB_FUNCTIONS","DUCKDB_INDEXES","DUCKDB_KEYWORDS","DUCKDB_MEMORY","DUCKDB_OPTIMIZERS","DUCKDB_SCHEMAS","DUCKDB_SECRETS","DUCKDB_SEQUENCES","DUCKDB_SETTINGS","DUCKDB_TABLES","DUCKDB_TEMPORARY_FILES","DUCKDB_TYPES","DUCKDB_VIEWS","EDIT","EDITDIST3","ELEMENT_AT","ENABLE_CHECKPOINT_ON_SHUTDOWN","ENABLE_OBJECT_CACHE","ENABLE_OPTIMIZER","ENABLE_PRINT_PROGRESS_BAR","ENABLE_PROFILE","ENABLE_PROFILING","ENABLE_PROGRESS_BAR","ENABLE_VERIFICATION","ENCODE","ENDS_WITH","ENTROPY","ENUM_CODE","ENUM_FIRST","ENUM_LAST","ENUM_RANGE","ENUM_RANGE_BOUNDARY","EPOCH","EPOCH_MS","EPOCH_NS","EPOCH_US","ERA","ERROR","EVEN","EXP","FACTORIAL","FAVG","FDIV","FILTER","FINALIZE","FIRST","FLATTEN","FLOOR","FMOD","FORCE_CHECKPOINT","FORMAT","FORMATREADABLEDECIMALSIZE","FORMATREADABLESIZE","FORMAT_BYTES","FORMAT_PG_TYPE","FORMAT_TYPE","FROM_BASE64","FROM_BINARY","FROM_HEX","FROM_JSON","FROM_JSON_STRICT","FSUM","FUNCTIONS","GAMMA","GCD","GENERATE_SERIES","GENERATE_SUBSCRIPTS","GEN_RANDOM_UUID","GEOMEAN","GEOMETRIC_MEAN","GETENV","GET_BIT","GET_BLOCK_SIZE","GET_CURRENT_TIME","GET_CURRENT_TIMESTAMP","GLOB","GRADE_UP","GREATEST","GREATEST_COMMON_DIVISOR","GROUP_CONCAT","HAMMING","HASH","HAS_ANY_COLUMN_PRIVILEGE","HAS_COLUMN_PRIVILEGE","HAS_DATABASE_PRIVILEGE","HAS_FOREIGN_DATA_WRAPPER_PRIVILEGE","HAS_FUNCTION_PRIVILEGE","HAS_LANGUAGE_PRIVILEGE","HAS_SCHEMA_PRIVILEGE","HAS_SEQUENCE_PRIVILEGE","HAS_SERVER_PRIVILEGE","HAS_TABLESPACE_PRIVILEGE","HAS_TABLE_PRIVILEGE","HEX","HISTOGRAM","HOUR","ICU_CALENDAR_NAMES","ICU_SORT_KEY","ILIKE_ESCAPE","IMPORT_DATABASE","INDEX_SCAN","INET_CLIENT_ADDR","INET_CLIENT_PORT","INET_SERVER_ADDR","INET_SERVER_PORT","INSTR","IN_SEARCH_PATH","ISFINITE","ISINF","ISNAN","ISODOW","ISOYEAR","JACCARD","JARO_SIMILARITY","JARO_WINKLER_SIMILARITY","JSON_ARRAY","JSON_ARRAY_LENGTH","JSON_CONTAINS","JSON_DESERIALIZE_SQL","JSON_EXECUTE_SERIALIZED_SQL","JSON_EXTRACT","JSON_EXTRACT_PATH","JSON_EXTRACT_PATH_TEXT","JSON_EXTRACT_STRING","JSON_GROUP_ARRAY","JSON_GROUP_OBJECT","JSON_GROUP_STRUCTURE","JSON_KEYS","JSON_MERGE_PATCH","JSON_OBJECT","JSON_QUOTE","JSON_SERIALIZE_PLAN","JSON_SERIALIZE_SQL","JSON_STRUCTURE","JSON_TRANSFORM","JSON_TRANSFORM_STRICT","JSON_TYPE","JSON_VALID","JULIAN","KAHAN_SUM","KURTOSIS","KURTOSIS_POP","LAST","LAST_DAY","LCASE","LCM","LEAST","LEAST_COMMON_MULTIPLE","LEFT","LEFT_GRAPHEME","LEN","LENGTH","LENGTH_GRAPHEME","LEVENSHTEIN","LGAMMA","LIKE_ESCAPE","LIST","LISTAGG","LIST_AGGR","LIST_AGGREGATE","LIST_ANY_VALUE","LIST_APPEND","LIST_APPLY","LIST_APPROX_COUNT_DISTINCT","LIST_AVG","LIST_BIT_AND","LIST_BIT_OR","LIST_BIT_XOR","LIST_BOOL_AND","LIST_BOOL_OR","LIST_CAT","LIST_CONCAT","LIST_CONTAINS","LIST_COSINE_SIMILARITY","LIST_COUNT","LIST_DISTANCE","LIST_DISTINCT","LIST_DOT_PRODUCT","LIST_ELEMENT","LIST_ENTROPY","LIST_EXTRACT","LIST_FILTER","LIST_FIRST","LIST_GRADE_UP","LIST_HAS","LIST_HAS_ALL","LIST_HAS_ANY","LIST_HISTOGRAM","LIST_INDEXOF","LIST_INNER_PRODUCT","LIST_INTERSECT","LIST_KURTOSIS","LIST_KURTOSIS_POP","LIST_LAST","LIST_MAD","LIST_MAX","LIST_MEDIAN","LIST_MIN","LIST_MODE","LIST_PACK","LIST_POSITION","LIST_PREPEND","LIST_PRODUCT","LIST_REDUCE","LIST_RESIZE","LIST_REVERSE","LIST_REVERSE_SORT","LIST_SELECT","LIST_SEM","LIST_SKEWNESS","LIST_SLICE","LIST_SORT","LIST_STDDEV_POP","LIST_STDDEV_SAMP","LIST_STRING_AGG","LIST_SUM","LIST_TRANSFORM","LIST_UNIQUE","LIST_VALUE","LIST_VAR_POP","LIST_VAR_SAMP","LIST_WHERE","LIST_ZIP","LN","LOG","LOG10","LOG2","LOWER","LPAD","LSMODE","LTRIM","MAD","MAKE_DATE","MAKE_TIME","MAKE_TIMESTAMP","MAKE_TIMESTAMPTZ","MAP","MAP_CONCAT","MAP_ENTRIES","MAP_EXTRACT","MAP_FROM_ENTRIES","MAP_KEYS","MAP_VALUES","MAX","MAX_BY","MD5","MD5_NUMBER","MD5_NUMBER_LOWER","MD5_NUMBER_UPPER","MEAN","MEDIAN","METADATA_INFO","MICROSECOND","MILLENNIUM","MILLISECOND","MIN","MINUTE","MIN_BY","MISMATCHES","MOD","MODE","MONTH","MONTHNAME","MULTIPLY","NEXTAFTER","NEXTVAL","NFC_NORMALIZE","NOT_ILIKE_ESCAPE","NOT_LIKE_ESCAPE","NOW","NULLIF","OBJ_DESCRIPTION","OCTET_LENGTH","ORD","PARQUET_FILE_METADATA","PARQUET_KV_METADATA","PARQUET_METADATA","PARQUET_SCAN","PARQUET_SCHEMA","PARSE_DIRNAME","PARSE_DIRPATH","PARSE_FILENAME","PARSE_PATH","PG_COLLATION_IS_VISIBLE","PG_CONF_LOAD_TIME","PG_CONVERSION_IS_VISIBLE","PG_FUNCTION_IS_VISIBLE","PG_GET_CONSTRAINTDEF","PG_GET_EXPR","PG_GET_VIEWDEF","PG_HAS_ROLE","PG_IS_OTHER_TEMP_SCHEMA","PG_MY_TEMP_SCHEMA","PG_OPCLASS_IS_VISIBLE","PG_OPERATOR_IS_VISIBLE","PG_OPFAMILY_IS_VISIBLE","PG_POSTMASTER_START_TIME","PG_SIZE_PRETTY","PG_TABLE_IS_VISIBLE","PG_TIMEZONE_NAMES","PG_TS_CONFIG_IS_VISIBLE","PG_TS_DICT_IS_VISIBLE","PG_TS_PARSER_IS_VISIBLE","PG_TS_TEMPLATE_IS_VISIBLE","PG_TYPEOF","PG_TYPE_IS_VISIBLE","PI","PLATFORM","POSITION","POW","POWER","PRAGMA_COLLATIONS","PRAGMA_DATABASE_SIZE","PRAGMA_METADATA_INFO","PRAGMA_PLATFORM","PRAGMA_SHOW","PRAGMA_STORAGE_INFO","PRAGMA_TABLE_INFO","PRAGMA_USER_AGENT","PRAGMA_VERSION","PREFIX","PRINTF","PRODUCT","QUANTILE","QUANTILE_CONT","QUANTILE_DISC","QUARTER","RADIANS","RANDOM","RANGE","READFILE","READ_BLOB","READ_CSV","READ_CSV_AUTO","READ_JSON","READ_JSON_AUTO","READ_JSON_OBJECTS","READ_JSON_OBJECTS_AUTO","READ_NDJSON","READ_NDJSON_AUTO","READ_NDJSON_OBJECTS","READ_PARQUET","READ_TEXT","REDUCE","REGEXP_ESCAPE","REGEXP_EXTRACT","REGEXP_EXTRACT_ALL","REGEXP_FULL_MATCH","REGEXP_MATCHES","REGEXP_REPLACE","REGEXP_SPLIT_TO_ARRAY","REGEXP_SPLIT_TO_TABLE","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","REPEAT","REPEAT_ROW","REPLACE","RESERVOIR_QUANTILE","REVERSE","RIGHT","RIGHT_GRAPHEME","ROUND","ROUNDBANKERS","ROUND_EVEN","ROW","ROW_TO_JSON","RPAD","RTRIM","SECOND","SEM","SEQ_SCAN","SESSION_USER","SETSEED","SET_BIT","SHA256","SHA3","SHELL_ADD_SCHEMA","SHELL_ESCAPE_CRNL","SHELL_IDQUOTE","SHELL_MODULE_SCHEMA","SHELL_PUTSNL","SHOBJ_DESCRIPTION","SHOW","SHOW_DATABASES","SHOW_TABLES","SHOW_TABLES_EXPANDED","SIGN","SIGNBIT","SIN","SKEWNESS","SNIFF_CSV","SPLIT","SPLIT_PART","SQL_AUTO_COMPLETE","SQRT","STARTS_WITH","STATS","STDDEV","STDDEV_POP","STDDEV_SAMP","STORAGE_INFO","STRFTIME","STRING_AGG","STRING_SPLIT","STRING_SPLIT_REGEX","STRING_TO_ARRAY","STRIP_ACCENTS","STRLEN","STRPOS","STRPTIME","STRUCT_EXTRACT","STRUCT_INSERT","STRUCT_PACK","STR_SPLIT","STR_SPLIT_REGEX","SUBSTR","SUBSTRING","SUBSTRING_GRAPHEME","SUBTRACT","SUFFIX","SUM","SUMKAHAN","SUMMARY","SUM_NO_OVERFLOW","TABLE_INFO","TAN","TEST_ALL_TYPES","TEST_VECTOR_TYPES","TIMEZONE","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIME_BUCKET","TODAY","TO_BASE","TO_BASE64","TO_BINARY","TO_CENTURIES","TO_DAYS","TO_DECADES","TO_HEX","TO_HOURS","TO_JSON","TO_MICROSECONDS","TO_MILLENNIA","TO_MILLISECONDS","TO_MINUTES","TO_MONTHS","TO_SECONDS","TO_TIMESTAMP","TO_WEEKS","TO_YEARS","TRANSACTION_TIMESTAMP","TRANSLATE","TRIM","TRUNC","TRY_STRPTIME","TXID_CURRENT","TYPEOF","UCASE","UNBIN","UNHEX","UNICODE","UNION_EXTRACT","UNION_TAG","UNION_VALUE","UNNEST","UNPIVOT_LIST","UPPER","USER","USER_AGENT","UUID","VARIANCE","VAR_POP","VAR_SAMP","VECTOR_TYPE","VERIFY_EXTERNAL","VERIFY_FETCH_ROW","VERIFY_PARALLELISM","VERIFY_SERIALIZER","VERSION","WEEK","WEEKDAY","WEEKOFYEAR","WHICH_SECRET","WRITEFILE","XOR","YEAR","YEARWEEK","CAST","COALESCE","RANK","ROW_NUMBER"],nestedBlockComments:!0,extraParens:["[]","{}"],underscoresInNumbers:!0,stringTypes:["$$","''-qq",{quote:"''-qq-bs",prefixes:["E"],requirePrefix:!0},{quote:"''-raw",prefixes:["B","X"],requirePrefix:!0}],identTypes:['""-qq'],identChars:{rest:"$"},paramTypes:{positional:!0,numbered:["$"],quoted:["$"]},operators:["//","%","**","^","!","&","|","~","<<",">>","::","==","->","->>",":",":=","=>","~~","!~~","~~*","!~~*","~~~","~","!~","~*","!~*","^@","||",">>=","<<="]},formatOptions:{alwaysDenseOperators:["::"],onelineClauses:[...o_,...oO],tabularOnelineClauses:oO}},oL=nG(["SELECT [ALL | DISTINCT]"]),oy=nG(["WITH","FROM","WHERE","GROUP BY","HAVING","WINDOW","PARTITION BY","ORDER BY","SORT BY","CLUSTER BY","DISTRIBUTE BY","LIMIT","INSERT INTO [TABLE]","VALUES","SET","MERGE INTO","WHEN [NOT] MATCHED [THEN]","UPDATE SET","INSERT [VALUES]","INSERT OVERWRITE [LOCAL] DIRECTORY","LOAD DATA [LOCAL] INPATH","[OVERWRITE] INTO TABLE"]),og=nG(["CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS]"]),oP=nG(["CREATE [MATERIALIZED] VIEW [IF NOT EXISTS]","UPDATE","DELETE FROM","DROP TABLE [IF EXISTS]","ALTER TABLE","RENAME TO","TRUNCATE [TABLE]","ALTER","CREATE","USE","DESCRIBE","DROP","FETCH","SHOW","STORED AS","STORED BY","ROW FORMAT"]),ob=nG(["UNION [ALL | DISTINCT]"]),oD=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","LEFT SEMI JOIN"]),ov=nG(["{ROWS | RANGE} BETWEEN"]),oM=nG([]),oU={name:"hive",tokenizerOptions:{reservedSelect:oL,reservedClauses:[...oy,...og,...oP],reservedSetOperations:ob,reservedJoins:oD,reservedKeywordPhrases:ov,reservedDataTypePhrases:oM,reservedKeywords:["ADD","ADMIN","AFTER","ANALYZE","ARCHIVE","ASC","BEFORE","BUCKET","BUCKETS","CASCADE","CHANGE","CLUSTER","CLUSTERED","CLUSTERSTATUS","COLLECTION","COLUMNS","COMMENT","COMPACT","COMPACTIONS","COMPUTE","CONCATENATE","CONTINUE","DATA","DATABASES","DATETIME","DAY","DBPROPERTIES","DEFERRED","DEFINED","DELIMITED","DEPENDENCY","DESC","DIRECTORIES","DIRECTORY","DISABLE","DISTRIBUTE","ELEM_TYPE","ENABLE","ESCAPED","EXCLUSIVE","EXPLAIN","EXPORT","FIELDS","FILE","FILEFORMAT","FIRST","FORMAT","FORMATTED","FUNCTIONS","HOLD_DDLTIME","HOUR","IDXPROPERTIES","IGNORE","INDEX","INDEXES","INPATH","INPUTDRIVER","INPUTFORMAT","ITEMS","JAR","KEYS","KEY_TYPE","LIMIT","LINES","LOAD","LOCATION","LOCK","LOCKS","LOGICAL","LONG","MAPJOIN","MATERIALIZED","METADATA","MINUS","MINUTE","MONTH","MSCK","NOSCAN","NO_DROP","OFFLINE","OPTION","OUTPUTDRIVER","OUTPUTFORMAT","OVERWRITE","OWNER","PARTITIONED","PARTITIONS","PLUS","PRETTY","PRINCIPALS","PROTECTION","PURGE","READ","READONLY","REBUILD","RECORDREADER","RECORDWRITER","RELOAD","RENAME","REPAIR","REPLACE","REPLICATION","RESTRICT","REWRITE","ROLE","ROLES","SCHEMA","SCHEMAS","SECOND","SEMI","SERDE","SERDEPROPERTIES","SERVER","SETS","SHARED","SHOW","SHOW_DATABASE","SKEWED","SORT","SORTED","SSL","STATISTICS","STORED","STREAMTABLE","STRING","TABLES","TBLPROPERTIES","TEMPORARY","TERMINATED","TINYINT","TOUCH","TRANSACTIONS","UNARCHIVE","UNDO","UNIONTYPE","UNLOCK","UNSET","UNSIGNED","URI","USE","UTC","UTCTIMESTAMP","VALUE_TYPE","VIEW","WHILE","YEAR","AUTOCOMMIT","ISOLATION","LEVEL","OFFSET","SNAPSHOT","TRANSACTION","WORK","WRITE","ABORT","KEY","LAST","NORELY","NOVALIDATE","NULLS","RELY","VALIDATE","DETAIL","DOW","EXPRESSION","OPERATOR","QUARTER","SUMMARY","VECTORIZATION","WEEK","YEARS","MONTHS","WEEKS","DAYS","HOURS","MINUTES","SECONDS","TIMESTAMPTZ","ZONE","ALL","ALTER","AND","AS","AUTHORIZATION","BETWEEN","BOTH","BY","CASE","CAST","COLUMN","CONF","CREATE","CROSS","CUBE","CURRENT","CURRENT_DATE","CURRENT_TIMESTAMP","CURSOR","DATABASE","DELETE","DESCRIBE","DISTINCT","DROP","ELSE","END","EXCHANGE","EXISTS","EXTENDED","EXTERNAL","FALSE","FETCH","FOLLOWING","FOR","FROM","FULL","FUNCTION","GRANT","GROUP","GROUPING","HAVING","IF","IMPORT","IN","INNER","INSERT","INTERSECT","INTO","IS","JOIN","LATERAL","LEFT","LESS","LIKE","LOCAL","MACRO","MORE","NONE","NOT","NULL","OF","ON","OR","ORDER","OUT","OUTER","OVER","PARTIALSCAN","PARTITION","PERCENT","PRECEDING","PRESERVE","PROCEDURE","RANGE","READS","REDUCE","REVOKE","RIGHT","ROLLUP","ROW","ROWS","SELECT","SET","TABLE","TABLESAMPLE","THEN","TO","TRANSFORM","TRIGGER","TRUE","TRUNCATE","UNBOUNDED","UNION","UNIQUEJOIN","UPDATE","USER","USING","UTC_TMESTAMP","VALUES","WHEN","WHERE","WINDOW","WITH","COMMIT","ONLY","REGEXP","RLIKE","ROLLBACK","START","CACHE","CONSTRAINT","FOREIGN","PRIMARY","REFERENCES","DAYOFWEEK","EXTRACT","FLOOR","VIEWS","TIME","SYNC","TEXTFILE","SEQUENCEFILE","ORC","CSV","TSV","PARQUET","AVRO","RCFILE","JSONFILE","INPUTFORMAT","OUTPUTFORMAT"],reservedDataTypes:["ARRAY","BIGINT","BINARY","BOOLEAN","CHAR","DATE","DECIMAL","DOUBLE","FLOAT","INT","INTEGER","INTERVAL","MAP","NUMERIC","PRECISION","SMALLINT","STRUCT","TIMESTAMP","VARCHAR"],reservedFunctionNames:["ABS","ACOS","ASIN","ATAN","BIN","BROUND","CBRT","CEIL","CEILING","CONV","COS","DEGREES","EXP","FACTORIAL","FLOOR","GREATEST","HEX","LEAST","LN","LOG","LOG10","LOG2","NEGATIVE","PI","PMOD","POSITIVE","POW","POWER","RADIANS","RAND","ROUND","SHIFTLEFT","SHIFTRIGHT","SHIFTRIGHTUNSIGNED","SIGN","SIN","SQRT","TAN","UNHEX","WIDTH_BUCKET","ARRAY_CONTAINS","MAP_KEYS","MAP_VALUES","SIZE","SORT_ARRAY","BINARY","CAST","ADD_MONTHS","DATE","DATE_ADD","DATE_FORMAT","DATE_SUB","DATEDIFF","DAY","DAYNAME","DAYOFMONTH","DAYOFYEAR","EXTRACT","FROM_UNIXTIME","FROM_UTC_TIMESTAMP","HOUR","LAST_DAY","MINUTE","MONTH","MONTHS_BETWEEN","NEXT_DAY","QUARTER","SECOND","TIMESTAMP","TO_DATE","TO_UTC_TIMESTAMP","TRUNC","UNIX_TIMESTAMP","WEEKOFYEAR","YEAR","ASSERT_TRUE","COALESCE","IF","ISNOTNULL","ISNULL","NULLIF","NVL","ASCII","BASE64","CHARACTER_LENGTH","CHR","CONCAT","CONCAT_WS","CONTEXT_NGRAMS","DECODE","ELT","ENCODE","FIELD","FIND_IN_SET","FORMAT_NUMBER","GET_JSON_OBJECT","IN_FILE","INITCAP","INSTR","LCASE","LENGTH","LEVENSHTEIN","LOCATE","LOWER","LPAD","LTRIM","NGRAMS","OCTET_LENGTH","PARSE_URL","PRINTF","QUOTE","REGEXP_EXTRACT","REGEXP_REPLACE","REPEAT","REVERSE","RPAD","RTRIM","SENTENCES","SOUNDEX","SPACE","SPLIT","STR_TO_MAP","SUBSTR","SUBSTRING","TRANSLATE","TRIM","UCASE","UNBASE64","UPPER","MASK","MASK_FIRST_N","MASK_HASH","MASK_LAST_N","MASK_SHOW_FIRST_N","MASK_SHOW_LAST_N","AES_DECRYPT","AES_ENCRYPT","CRC32","CURRENT_DATABASE","CURRENT_USER","HASH","JAVA_METHOD","LOGGED_IN_USER","MD5","REFLECT","SHA","SHA1","SHA2","SURROGATE_KEY","VERSION","AVG","COLLECT_LIST","COLLECT_SET","CORR","COUNT","COVAR_POP","COVAR_SAMP","HISTOGRAM_NUMERIC","MAX","MIN","NTILE","PERCENTILE","PERCENTILE_APPROX","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","STDDEV_POP","STDDEV_SAMP","SUM","VAR_POP","VAR_SAMP","VARIANCE","EXPLODE","INLINE","JSON_TUPLE","PARSE_URL_TUPLE","POSEXPLODE","STACK","LEAD","LAG","FIRST_VALUE","LAST_VALUE","RANK","ROW_NUMBER","DENSE_RANK","CUME_DIST","PERCENT_RANK","NTILE"],extraParens:["[]"],stringTypes:['""-bs',"''-bs"],identTypes:["``"],variableTypes:[{quote:"{}",prefixes:["$"],requirePrefix:!0}],operators:["%","~","^","|","&","<=>","==","!","||"]},formatOptions:{onelineClauses:[...og,...oP],tabularOnelineClauses:oP}};function ow(e){return e.map((t,r)=>{let a=e[r+1]||nK;if(nq.SET(t)&&"("===a.text)return Object.assign(Object.assign({},t),{type:ew.RESERVED_FUNCTION_NAME});let s=e[r-1]||nK;return nq.VALUES(t)&&"="===s.text?Object.assign(Object.assign({},t),{type:ew.RESERVED_FUNCTION_NAME}):t})}let oG=nG(["SELECT [ALL | DISTINCT | DISTINCTROW]"]),oB=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY","HAVING","PARTITION BY","ORDER BY","LIMIT","OFFSET","FETCH {FIRST | NEXT}","INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE] [INTO]","REPLACE [LOW_PRIORITY | DELAYED] [INTO]","VALUES","ON DUPLICATE KEY UPDATE","SET","RETURNING"]),oF=nG(["CREATE [OR REPLACE] [TEMPORARY] TABLE [IF NOT EXISTS]"]),oH=nG(["CREATE [OR REPLACE] [SQL SECURITY DEFINER | SQL SECURITY INVOKER] VIEW [IF NOT EXISTS]","UPDATE [LOW_PRIORITY] [IGNORE]","DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM","DROP [TEMPORARY] TABLE [IF EXISTS]","ALTER [ONLINE] [IGNORE] TABLE [IF EXISTS]","ADD [COLUMN] [IF NOT EXISTS]","{CHANGE | MODIFY} [COLUMN] [IF EXISTS]","DROP [COLUMN] [IF EXISTS]","RENAME [TO]","RENAME COLUMN","ALTER [COLUMN]","{SET | DROP} DEFAULT","SET {VISIBLE | INVISIBLE}","TRUNCATE [TABLE]","ALTER DATABASE","ALTER DATABASE COMMENT","ALTER EVENT","ALTER FUNCTION","ALTER PROCEDURE","ALTER SCHEMA","ALTER SCHEMA COMMENT","ALTER SEQUENCE","ALTER SERVER","ALTER USER","ALTER VIEW","ANALYZE","ANALYZE TABLE","BACKUP LOCK","BACKUP STAGE","BACKUP UNLOCK","BEGIN","BINLOG","CACHE INDEX","CALL","CHANGE MASTER TO","CHECK TABLE","CHECK VIEW","CHECKSUM TABLE","COMMIT","CREATE AGGREGATE FUNCTION","CREATE DATABASE","CREATE EVENT","CREATE FUNCTION","CREATE INDEX","CREATE PROCEDURE","CREATE ROLE","CREATE SEQUENCE","CREATE SERVER","CREATE SPATIAL INDEX","CREATE TRIGGER","CREATE UNIQUE INDEX","CREATE USER","DEALLOCATE PREPARE","DESCRIBE","DROP DATABASE","DROP EVENT","DROP FUNCTION","DROP INDEX","DROP PREPARE","DROP PROCEDURE","DROP ROLE","DROP SEQUENCE","DROP SERVER","DROP TRIGGER","DROP USER","DROP VIEW","EXECUTE","EXPLAIN","FLUSH","GET DIAGNOSTICS","GET DIAGNOSTICS CONDITION","GRANT","HANDLER","HELP","INSTALL PLUGIN","INSTALL SONAME","KILL","LOAD DATA INFILE","LOAD INDEX INTO CACHE","LOAD XML INFILE","LOCK TABLE","OPTIMIZE TABLE","PREPARE","PURGE BINARY LOGS","PURGE MASTER LOGS","RELEASE SAVEPOINT","RENAME TABLE","RENAME USER","REPAIR TABLE","REPAIR VIEW","RESET MASTER","RESET QUERY CACHE","RESET REPLICA","RESET SLAVE","RESIGNAL","REVOKE","ROLLBACK","SAVEPOINT","SET CHARACTER SET","SET DEFAULT ROLE","SET GLOBAL TRANSACTION","SET NAMES","SET PASSWORD","SET ROLE","SET STATEMENT","SET TRANSACTION","SHOW","SHOW ALL REPLICAS STATUS","SHOW ALL SLAVES STATUS","SHOW AUTHORS","SHOW BINARY LOGS","SHOW BINLOG EVENTS","SHOW BINLOG STATUS","SHOW CHARACTER SET","SHOW CLIENT_STATISTICS","SHOW COLLATION","SHOW COLUMNS","SHOW CONTRIBUTORS","SHOW CREATE DATABASE","SHOW CREATE EVENT","SHOW CREATE FUNCTION","SHOW CREATE PACKAGE","SHOW CREATE PACKAGE BODY","SHOW CREATE PROCEDURE","SHOW CREATE SEQUENCE","SHOW CREATE TABLE","SHOW CREATE TRIGGER","SHOW CREATE USER","SHOW CREATE VIEW","SHOW DATABASES","SHOW ENGINE","SHOW ENGINE INNODB STATUS","SHOW ENGINES","SHOW ERRORS","SHOW EVENTS","SHOW EXPLAIN","SHOW FUNCTION CODE","SHOW FUNCTION STATUS","SHOW GRANTS","SHOW INDEX","SHOW INDEXES","SHOW INDEX_STATISTICS","SHOW KEYS","SHOW LOCALES","SHOW MASTER LOGS","SHOW MASTER STATUS","SHOW OPEN TABLES","SHOW PACKAGE BODY CODE","SHOW PACKAGE BODY STATUS","SHOW PACKAGE STATUS","SHOW PLUGINS","SHOW PLUGINS SONAME","SHOW PRIVILEGES","SHOW PROCEDURE CODE","SHOW PROCEDURE STATUS","SHOW PROCESSLIST","SHOW PROFILE","SHOW PROFILES","SHOW QUERY_RESPONSE_TIME","SHOW RELAYLOG EVENTS","SHOW REPLICA","SHOW REPLICA HOSTS","SHOW REPLICA STATUS","SHOW SCHEMAS","SHOW SLAVE","SHOW SLAVE HOSTS","SHOW SLAVE STATUS","SHOW STATUS","SHOW STORAGE ENGINES","SHOW TABLE STATUS","SHOW TABLES","SHOW TRIGGERS","SHOW USER_STATISTICS","SHOW VARIABLES","SHOW WARNINGS","SHOW WSREP_MEMBERSHIP","SHOW WSREP_STATUS","SHUTDOWN","SIGNAL","START ALL REPLICAS","START ALL SLAVES","START REPLICA","START SLAVE","START TRANSACTION","STOP ALL REPLICAS","STOP ALL SLAVES","STOP REPLICA","STOP SLAVE","UNINSTALL PLUGIN","UNINSTALL SONAME","UNLOCK TABLE","USE","XA BEGIN","XA COMMIT","XA END","XA PREPARE","XA RECOVER","XA ROLLBACK","XA START"]),ox=nG(["UNION [ALL | DISTINCT]","EXCEPT [ALL | DISTINCT]","INTERSECT [ALL | DISTINCT]","MINUS [ALL | DISTINCT]"]),ok=nG(["JOIN","{LEFT | RIGHT} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL JOIN","NATURAL {LEFT | RIGHT} [OUTER] JOIN","STRAIGHT_JOIN"]),oY=nG(["ON {UPDATE | DELETE} [SET NULL | SET DEFAULT]","CHARACTER SET","{ROWS | RANGE} BETWEEN","IDENTIFIED BY"]),oV=nG([]),o$={name:"mariadb",tokenizerOptions:{reservedSelect:oG,reservedClauses:[...oB,...oF,...oH],reservedSetOperations:ox,reservedJoins:ok,reservedKeywordPhrases:oY,reservedDataTypePhrases:oV,supportsXor:!0,reservedKeywords:["ACCESSIBLE","ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CURRENT_DATE","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DECLARE","DEFAULT","DELAYED","DELETE","DELETE_DOMAIN_ID","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DO_DOMAIN_IDS","DROP","DUAL","EACH","ELSE","ELSEIF","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FOR","FORCE","FOREIGN","FROM","FULLTEXT","GENERAL","GRANT","GROUP","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IGNORE_DOMAIN_IDS","IGNORE_SERVER_IDS","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","INTERSECT","INTERVAL","INTO","IS","ITERATE","JOIN","KEY","KEYS","KILL","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LOOP","LOW_PRIORITY","MASTER_HEARTBEAT_PERIOD","MASTER_SSL_VERIFY_SERVER_CERT","MATCH","MAXVALUE","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NULL","OFFSET","ON","OPTIMIZE","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PAGE_CHECKSUM","PARSE_VCOL_EXPR","PARTITION","POSITION","PRIMARY","PROCEDURE","PURGE","RANGE","READ","READS","READ_WRITE","RECURSIVE","REF_SYSTEM_ID","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESIGNAL","RESTRICT","RETURN","RETURNING","REVOKE","RIGHT","RLIKE","ROW_NUMBER","ROWS","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SLOW","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STATS_AUTO_RECALC","STATS_PERSISTENT","STATS_SAMPLE_PAGES","STRAIGHT_JOIN","TABLE","TERMINATED","THEN","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"],reservedDataTypes:["BIGINT","BINARY","BIT","BLOB","CHAR BYTE","CHAR","CHARACTER","DATETIME","DEC","DECIMAL","DOUBLE PRECISION","DOUBLE","ENUM","FIXED","FLOAT","FLOAT4","FLOAT8","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","LONG","LONGBLOB","LONGTEXT","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","NATIONAL CHAR","NATIONAL VARCHAR","NUMERIC","PRECISION","REAL","SMALLINT","TEXT","TIMESTAMP","TINYBLOB","TINYINT","TINYTEXT","VARBINARY","VARCHAR","VARCHARACTER","VARYING","YEAR"],reservedFunctionNames:["ADDDATE","ADD_MONTHS","BIT_AND","BIT_OR","BIT_XOR","CAST","COUNT","CUME_DIST","CURDATE","CURTIME","DATE_ADD","DATE_SUB","DATE_FORMAT","DECODE","DENSE_RANK","EXTRACT","FIRST_VALUE","GROUP_CONCAT","JSON_ARRAYAGG","JSON_OBJECTAGG","LAG","LEAD","MAX","MEDIAN","MID","MIN","NOW","NTH_VALUE","NTILE","POSITION","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","RANK","ROW_NUMBER","SESSION_USER","STD","STDDEV","STDDEV_POP","STDDEV_SAMP","SUBDATE","SUBSTR","SUBSTRING","SUM","SYSTEM_USER","TRIM","TRIM_ORACLE","VARIANCE","VAR_POP","VAR_SAMP","ABS","ACOS","ADDTIME","AES_DECRYPT","AES_ENCRYPT","ASIN","ATAN","ATAN2","BENCHMARK","BIN","BINLOG_GTID_POS","BIT_COUNT","BIT_LENGTH","CEIL","CEILING","CHARACTER_LENGTH","CHAR_LENGTH","CHR","COERCIBILITY","COLUMN_CHECK","COLUMN_EXISTS","COLUMN_LIST","COLUMN_JSON","COMPRESS","CONCAT","CONCAT_OPERATOR_ORACLE","CONCAT_WS","CONNECTION_ID","CONV","CONVERT_TZ","COS","COT","CRC32","DATEDIFF","DAYNAME","DAYOFMONTH","DAYOFWEEK","DAYOFYEAR","DEGREES","DECODE_HISTOGRAM","DECODE_ORACLE","DES_DECRYPT","DES_ENCRYPT","ELT","ENCODE","ENCRYPT","EXP","EXPORT_SET","EXTRACTVALUE","FIELD","FIND_IN_SET","FLOOR","FORMAT","FOUND_ROWS","FROM_BASE64","FROM_DAYS","FROM_UNIXTIME","GET_LOCK","GREATEST","HEX","IFNULL","INSTR","ISNULL","IS_FREE_LOCK","IS_USED_LOCK","JSON_ARRAY","JSON_ARRAY_APPEND","JSON_ARRAY_INSERT","JSON_COMPACT","JSON_CONTAINS","JSON_CONTAINS_PATH","JSON_DEPTH","JSON_DETAILED","JSON_EXISTS","JSON_EXTRACT","JSON_INSERT","JSON_KEYS","JSON_LENGTH","JSON_LOOSE","JSON_MERGE","JSON_MERGE_PATCH","JSON_MERGE_PRESERVE","JSON_QUERY","JSON_QUOTE","JSON_OBJECT","JSON_REMOVE","JSON_REPLACE","JSON_SET","JSON_SEARCH","JSON_TYPE","JSON_UNQUOTE","JSON_VALID","JSON_VALUE","LAST_DAY","LAST_INSERT_ID","LCASE","LEAST","LENGTH","LENGTHB","LN","LOAD_FILE","LOCATE","LOG","LOG10","LOG2","LOWER","LPAD","LPAD_ORACLE","LTRIM","LTRIM_ORACLE","MAKEDATE","MAKETIME","MAKE_SET","MASTER_GTID_WAIT","MASTER_POS_WAIT","MD5","MONTHNAME","NAME_CONST","NVL","NVL2","OCT","OCTET_LENGTH","ORD","PERIOD_ADD","PERIOD_DIFF","PI","POW","POWER","QUOTE","REGEXP_INSTR","REGEXP_REPLACE","REGEXP_SUBSTR","RADIANS","RAND","RELEASE_ALL_LOCKS","RELEASE_LOCK","REPLACE_ORACLE","REVERSE","ROUND","RPAD","RPAD_ORACLE","RTRIM","RTRIM_ORACLE","SEC_TO_TIME","SHA","SHA1","SHA2","SIGN","SIN","SLEEP","SOUNDEX","SPACE","SQRT","STRCMP","STR_TO_DATE","SUBSTR_ORACLE","SUBSTRING_INDEX","SUBTIME","SYS_GUID","TAN","TIMEDIFF","TIME_FORMAT","TIME_TO_SEC","TO_BASE64","TO_CHAR","TO_DAYS","TO_SECONDS","UCASE","UNCOMPRESS","UNCOMPRESSED_LENGTH","UNHEX","UNIX_TIMESTAMP","UPDATEXML","UPPER","UUID","UUID_SHORT","VERSION","WEEKDAY","WEEKOFYEAR","WSREP_LAST_WRITTEN_GTID","WSREP_LAST_SEEN_GTID","WSREP_SYNC_WAIT_UPTO_GTID","YEARWEEK","COALESCE","NULLIF"],stringTypes:['""-qq-bs',"''-qq-bs",{quote:"''-raw",prefixes:["B","X"],requirePrefix:!0}],identTypes:["``"],identChars:{first:"$",rest:"$",allowFirstCharNumber:!0},variableTypes:[{regex:"@@?[A-Za-z0-9_.$]+"},{quote:'""-qq-bs',prefixes:["@"],requirePrefix:!0},{quote:"''-qq-bs",prefixes:["@"],requirePrefix:!0},{quote:"``",prefixes:["@"],requirePrefix:!0}],paramTypes:{positional:!0},lineCommentTypes:["--","#"],operators:["%",":=","&","|","^","~","<<",">>","<=>","&&","||","!","*.*"],postProcess:ow},formatOptions:{onelineClauses:[...oF,...oH],tabularOnelineClauses:oH}},oW=nG(["SELECT [ALL | DISTINCT | DISTINCTROW]"]),oj=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY","HAVING","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE] [INTO]","REPLACE [LOW_PRIORITY | DELAYED] [INTO]","VALUES","ON DUPLICATE KEY UPDATE","SET"]),oX=nG(["CREATE [TEMPORARY] TABLE [IF NOT EXISTS]"]),oK=nG(["CREATE [OR REPLACE] [SQL SECURITY DEFINER | SQL SECURITY INVOKER] VIEW [IF NOT EXISTS]","UPDATE [LOW_PRIORITY] [IGNORE]","DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM","DROP [TEMPORARY] TABLE [IF EXISTS]","ALTER TABLE","ADD [COLUMN]","{CHANGE | MODIFY} [COLUMN]","DROP [COLUMN]","RENAME [TO | AS]","RENAME COLUMN","ALTER [COLUMN]","{SET | DROP} DEFAULT","TRUNCATE [TABLE]","ALTER DATABASE","ALTER EVENT","ALTER FUNCTION","ALTER INSTANCE","ALTER LOGFILE GROUP","ALTER PROCEDURE","ALTER RESOURCE GROUP","ALTER SERVER","ALTER TABLESPACE","ALTER USER","ALTER VIEW","ANALYZE TABLE","BINLOG","CACHE INDEX","CALL","CHANGE MASTER TO","CHANGE REPLICATION FILTER","CHANGE REPLICATION SOURCE TO","CHECK TABLE","CHECKSUM TABLE","CLONE","COMMIT","CREATE DATABASE","CREATE EVENT","CREATE FUNCTION","CREATE FUNCTION","CREATE INDEX","CREATE LOGFILE GROUP","CREATE PROCEDURE","CREATE RESOURCE GROUP","CREATE ROLE","CREATE SERVER","CREATE SPATIAL REFERENCE SYSTEM","CREATE TABLESPACE","CREATE TRIGGER","CREATE USER","DEALLOCATE PREPARE","DESCRIBE","DROP DATABASE","DROP EVENT","DROP FUNCTION","DROP FUNCTION","DROP INDEX","DROP LOGFILE GROUP","DROP PROCEDURE","DROP RESOURCE GROUP","DROP ROLE","DROP SERVER","DROP SPATIAL REFERENCE SYSTEM","DROP TABLESPACE","DROP TRIGGER","DROP USER","DROP VIEW","EXECUTE","EXPLAIN","FLUSH","GRANT","HANDLER","HELP","IMPORT TABLE","INSTALL COMPONENT","INSTALL PLUGIN","KILL","LOAD DATA","LOAD INDEX INTO CACHE","LOAD XML","LOCK INSTANCE FOR BACKUP","LOCK TABLES","MASTER_POS_WAIT","OPTIMIZE TABLE","PREPARE","PURGE BINARY LOGS","RELEASE SAVEPOINT","RENAME TABLE","RENAME USER","REPAIR TABLE","RESET","RESET MASTER","RESET PERSIST","RESET REPLICA","RESET SLAVE","RESTART","REVOKE","ROLLBACK","ROLLBACK TO SAVEPOINT","SAVEPOINT","SET CHARACTER SET","SET DEFAULT ROLE","SET NAMES","SET PASSWORD","SET RESOURCE GROUP","SET ROLE","SET TRANSACTION","SHOW","SHOW BINARY LOGS","SHOW BINLOG EVENTS","SHOW CHARACTER SET","SHOW COLLATION","SHOW COLUMNS","SHOW CREATE DATABASE","SHOW CREATE EVENT","SHOW CREATE FUNCTION","SHOW CREATE PROCEDURE","SHOW CREATE TABLE","SHOW CREATE TRIGGER","SHOW CREATE USER","SHOW CREATE VIEW","SHOW DATABASES","SHOW ENGINE","SHOW ENGINES","SHOW ERRORS","SHOW EVENTS","SHOW FUNCTION CODE","SHOW FUNCTION STATUS","SHOW GRANTS","SHOW INDEX","SHOW MASTER STATUS","SHOW OPEN TABLES","SHOW PLUGINS","SHOW PRIVILEGES","SHOW PROCEDURE CODE","SHOW PROCEDURE STATUS","SHOW PROCESSLIST","SHOW PROFILE","SHOW PROFILES","SHOW RELAYLOG EVENTS","SHOW REPLICA STATUS","SHOW REPLICAS","SHOW SLAVE","SHOW SLAVE HOSTS","SHOW STATUS","SHOW TABLE STATUS","SHOW TABLES","SHOW TRIGGERS","SHOW VARIABLES","SHOW WARNINGS","SHUTDOWN","SOURCE_POS_WAIT","START GROUP_REPLICATION","START REPLICA","START SLAVE","START TRANSACTION","STOP GROUP_REPLICATION","STOP REPLICA","STOP SLAVE","TABLE","UNINSTALL COMPONENT","UNINSTALL PLUGIN","UNLOCK INSTANCE","UNLOCK TABLES","USE","XA","ITERATE","LEAVE","LOOP","REPEAT","RETURN","WHILE"]),oZ=nG(["UNION [ALL | DISTINCT]"]),oq=nG(["JOIN","{LEFT | RIGHT} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT} [OUTER] JOIN","STRAIGHT_JOIN"]),oJ=nG(["ON {UPDATE | DELETE} [SET NULL]","CHARACTER SET","{ROWS | RANGE} BETWEEN","IDENTIFIED BY"]),oz=nG([]),oQ={name:"mysql",tokenizerOptions:{reservedSelect:oW,reservedClauses:[...oj,...oX,...oK],reservedSetOperations:oZ,reservedJoins:oq,reservedKeywordPhrases:oJ,reservedDataTypePhrases:oz,supportsXor:!0,reservedKeywords:["ACCESSIBLE","ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CUBE","CUME_DIST","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DECLARE","DEFAULT","DELAYED","DELETE","DENSE_RANK","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DROP","DUAL","EACH","ELSE","ELSEIF","EMPTY","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FIRST_VALUE","FOR","FORCE","FOREIGN","FROM","FULLTEXT","FUNCTION","GENERATED","GET","GRANT","GROUP","GROUPING","GROUPS","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","IN","INTERSECT","INTERVAL","INTO","IO_AFTER_GTIDS","IO_BEFORE_GTIDS","IS","ITERATE","JOIN","JSON_TABLE","KEY","KEYS","KILL","LAG","LAST_VALUE","LATERAL","LEAD","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LOOP","LOW_PRIORITY","MASTER_BIND","MASTER_SSL_VERIFY_SERVER_CERT","MATCH","MAXVALUE","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NTH_VALUE","NTILE","NULL","OF","ON","OPTIMIZE","OPTIMIZER_COSTS","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PARTITION","PERCENT_RANK","PRIMARY","PROCEDURE","PURGE","RANGE","RANK","READ","READS","READ_WRITE","RECURSIVE","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESIGNAL","RESTRICT","RETURN","REVOKE","RIGHT","RLIKE","ROW","ROWS","ROW_NUMBER","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STORED","STRAIGHT_JOIN","SYSTEM","TABLE","TERMINATED","THEN","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VIRTUAL","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"],reservedDataTypes:["BIGINT","BINARY","BIT","BLOB","BOOL","BOOLEAN","CHAR","CHARACTER","DATE","DATETIME","DEC","DECIMAL","DOUBLE PRECISION","DOUBLE","ENUM","FIXED","FLOAT","FLOAT4","FLOAT8","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","LONGBLOB","LONGTEXT","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","NATIONAL CHAR","NATIONAL VARCHAR","NUMERIC","PRECISION","REAL","SMALLINT","TEXT","TIME","TIMESTAMP","TINYBLOB","TINYINT","TINYTEXT","VARBINARY","VARCHAR","VARCHARACTER","VARYING","YEAR"],reservedFunctionNames:["ABS","ACOS","ADDDATE","ADDTIME","AES_DECRYPT","AES_ENCRYPT","ANY_VALUE","ASCII","ASIN","ATAN","ATAN2","AVG","BENCHMARK","BIN","BIN_TO_UUID","BINARY","BIT_AND","BIT_COUNT","BIT_LENGTH","BIT_OR","BIT_XOR","CAN_ACCESS_COLUMN","CAN_ACCESS_DATABASE","CAN_ACCESS_TABLE","CAN_ACCESS_USER","CAN_ACCESS_VIEW","CAST","CEIL","CEILING","CHAR","CHAR_LENGTH","CHARACTER_LENGTH","CHARSET","COALESCE","COERCIBILITY","COLLATION","COMPRESS","CONCAT","CONCAT_WS","CONNECTION_ID","CONV","CONVERT","CONVERT_TZ","COS","COT","COUNT","CRC32","CUME_DIST","CURDATE","CURRENT_DATE","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURTIME","DATABASE","DATE","DATE_ADD","DATE_FORMAT","DATE_SUB","DATEDIFF","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DAYOFYEAR","DEFAULT","DEGREES","DENSE_RANK","DIV","ELT","EXP","EXPORT_SET","EXTRACT","EXTRACTVALUE","FIELD","FIND_IN_SET","FIRST_VALUE","FLOOR","FORMAT","FORMAT_BYTES","FORMAT_PICO_TIME","FOUND_ROWS","FROM_BASE64","FROM_DAYS","FROM_UNIXTIME","GEOMCOLLECTION","GEOMETRYCOLLECTION","GET_DD_COLUMN_PRIVILEGES","GET_DD_CREATE_OPTIONS","GET_DD_INDEX_SUB_PART_LENGTH","GET_FORMAT","GET_LOCK","GREATEST","GROUP_CONCAT","GROUPING","GTID_SUBSET","GTID_SUBTRACT","HEX","HOUR","ICU_VERSION","IF","IFNULL","INET_ATON","INET_NTOA","INET6_ATON","INET6_NTOA","INSERT","INSTR","INTERNAL_AUTO_INCREMENT","INTERNAL_AVG_ROW_LENGTH","INTERNAL_CHECK_TIME","INTERNAL_CHECKSUM","INTERNAL_DATA_FREE","INTERNAL_DATA_LENGTH","INTERNAL_DD_CHAR_LENGTH","INTERNAL_GET_COMMENT_OR_ERROR","INTERNAL_GET_ENABLED_ROLE_JSON","INTERNAL_GET_HOSTNAME","INTERNAL_GET_USERNAME","INTERNAL_GET_VIEW_WARNING_OR_ERROR","INTERNAL_INDEX_COLUMN_CARDINALITY","INTERNAL_INDEX_LENGTH","INTERNAL_IS_ENABLED_ROLE","INTERNAL_IS_MANDATORY_ROLE","INTERNAL_KEYS_DISABLED","INTERNAL_MAX_DATA_LENGTH","INTERNAL_TABLE_ROWS","INTERNAL_UPDATE_TIME","INTERVAL","IS","IS_FREE_LOCK","IS_IPV4","IS_IPV4_COMPAT","IS_IPV4_MAPPED","IS_IPV6","IS NOT","IS NOT NULL","IS NULL","IS_USED_LOCK","IS_UUID","ISNULL","JSON_ARRAY","JSON_ARRAY_APPEND","JSON_ARRAY_INSERT","JSON_ARRAYAGG","JSON_CONTAINS","JSON_CONTAINS_PATH","JSON_DEPTH","JSON_EXTRACT","JSON_INSERT","JSON_KEYS","JSON_LENGTH","JSON_MERGE","JSON_MERGE_PATCH","JSON_MERGE_PRESERVE","JSON_OBJECT","JSON_OBJECTAGG","JSON_OVERLAPS","JSON_PRETTY","JSON_QUOTE","JSON_REMOVE","JSON_REPLACE","JSON_SCHEMA_VALID","JSON_SCHEMA_VALIDATION_REPORT","JSON_SEARCH","JSON_SET","JSON_STORAGE_FREE","JSON_STORAGE_SIZE","JSON_TABLE","JSON_TYPE","JSON_UNQUOTE","JSON_VALID","JSON_VALUE","LAG","LAST_DAY","LAST_INSERT_ID","LAST_VALUE","LCASE","LEAD","LEAST","LEFT","LENGTH","LIKE","LINESTRING","LN","LOAD_FILE","LOCALTIME","LOCALTIMESTAMP","LOCATE","LOG","LOG10","LOG2","LOWER","LPAD","LTRIM","MAKE_SET","MAKEDATE","MAKETIME","MASTER_POS_WAIT","MATCH","MAX","MBRCONTAINS","MBRCOVEREDBY","MBRCOVERS","MBRDISJOINT","MBREQUALS","MBRINTERSECTS","MBROVERLAPS","MBRTOUCHES","MBRWITHIN","MD5","MEMBER OF","MICROSECOND","MID","MIN","MINUTE","MOD","MONTH","MONTHNAME","MULTILINESTRING","MULTIPOINT","MULTIPOLYGON","NAME_CONST","NOT","NOT IN","NOT LIKE","NOT REGEXP","NOW","NTH_VALUE","NTILE","NULLIF","OCT","OCTET_LENGTH","ORD","PERCENT_RANK","PERIOD_ADD","PERIOD_DIFF","PI","POINT","POLYGON","POSITION","POW","POWER","PS_CURRENT_THREAD_ID","PS_THREAD_ID","QUARTER","QUOTE","RADIANS","RAND","RANDOM_BYTES","RANK","REGEXP","REGEXP_INSTR","REGEXP_LIKE","REGEXP_REPLACE","REGEXP_SUBSTR","RELEASE_ALL_LOCKS","RELEASE_LOCK","REPEAT","REPLACE","REVERSE","RIGHT","RLIKE","ROLES_GRAPHML","ROUND","ROW_COUNT","ROW_NUMBER","RPAD","RTRIM","SCHEMA","SEC_TO_TIME","SECOND","SESSION_USER","SHA1","SHA2","SIGN","SIN","SLEEP","SOUNDEX","SOUNDS LIKE","SOURCE_POS_WAIT","SPACE","SQRT","ST_AREA","ST_ASBINARY","ST_ASGEOJSON","ST_ASTEXT","ST_BUFFER","ST_BUFFER_STRATEGY","ST_CENTROID","ST_COLLECT","ST_CONTAINS","ST_CONVEXHULL","ST_CROSSES","ST_DIFFERENCE","ST_DIMENSION","ST_DISJOINT","ST_DISTANCE","ST_DISTANCE_SPHERE","ST_ENDPOINT","ST_ENVELOPE","ST_EQUALS","ST_EXTERIORRING","ST_FRECHETDISTANCE","ST_GEOHASH","ST_GEOMCOLLFROMTEXT","ST_GEOMCOLLFROMWKB","ST_GEOMETRYN","ST_GEOMETRYTYPE","ST_GEOMFROMGEOJSON","ST_GEOMFROMTEXT","ST_GEOMFROMWKB","ST_HAUSDORFFDISTANCE","ST_INTERIORRINGN","ST_INTERSECTION","ST_INTERSECTS","ST_ISCLOSED","ST_ISEMPTY","ST_ISSIMPLE","ST_ISVALID","ST_LATFROMGEOHASH","ST_LATITUDE","ST_LENGTH","ST_LINEFROMTEXT","ST_LINEFROMWKB","ST_LINEINTERPOLATEPOINT","ST_LINEINTERPOLATEPOINTS","ST_LONGFROMGEOHASH","ST_LONGITUDE","ST_MAKEENVELOPE","ST_MLINEFROMTEXT","ST_MLINEFROMWKB","ST_MPOINTFROMTEXT","ST_MPOINTFROMWKB","ST_MPOLYFROMTEXT","ST_MPOLYFROMWKB","ST_NUMGEOMETRIES","ST_NUMINTERIORRING","ST_NUMPOINTS","ST_OVERLAPS","ST_POINTATDISTANCE","ST_POINTFROMGEOHASH","ST_POINTFROMTEXT","ST_POINTFROMWKB","ST_POINTN","ST_POLYFROMTEXT","ST_POLYFROMWKB","ST_SIMPLIFY","ST_SRID","ST_STARTPOINT","ST_SWAPXY","ST_SYMDIFFERENCE","ST_TOUCHES","ST_TRANSFORM","ST_UNION","ST_VALIDATE","ST_WITHIN","ST_X","ST_Y","STATEMENT_DIGEST","STATEMENT_DIGEST_TEXT","STD","STDDEV","STDDEV_POP","STDDEV_SAMP","STR_TO_DATE","STRCMP","SUBDATE","SUBSTR","SUBSTRING","SUBSTRING_INDEX","SUBTIME","SUM","SYSDATE","SYSTEM_USER","TAN","TIME","TIME_FORMAT","TIME_TO_SEC","TIMEDIFF","TIMESTAMP","TIMESTAMPADD","TIMESTAMPDIFF","TO_BASE64","TO_DAYS","TO_SECONDS","TRIM","TRUNCATE","UCASE","UNCOMPRESS","UNCOMPRESSED_LENGTH","UNHEX","UNIX_TIMESTAMP","UPDATEXML","UPPER","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","UUID","UUID_SHORT","UUID_TO_BIN","VALIDATE_PASSWORD_STRENGTH","VALUES","VAR_POP","VAR_SAMP","VARIANCE","VERSION","WAIT_FOR_EXECUTED_GTID_SET","WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS","WEEK","WEEKDAY","WEEKOFYEAR","WEIGHT_STRING","YEAR","YEARWEEK"],stringTypes:['""-qq-bs',{quote:"''-qq-bs",prefixes:["N"]},{quote:"''-raw",prefixes:["B","X"],requirePrefix:!0}],identTypes:["``"],identChars:{first:"$",rest:"$",allowFirstCharNumber:!0},variableTypes:[{regex:"@@?[A-Za-z0-9_.$]+"},{quote:'""-qq-bs',prefixes:["@"],requirePrefix:!0},{quote:"''-qq-bs",prefixes:["@"],requirePrefix:!0},{quote:"``",prefixes:["@"],requirePrefix:!0}],paramTypes:{positional:!0},lineCommentTypes:["--","#"],operators:["%",":=","&","|","^","~","<<",">>","<=>","->","->>","&&","||","!","*.*"],postProcess:ow},formatOptions:{onelineClauses:[...oX,...oK],tabularOnelineClauses:oK}},o0=nG(["SELECT [ALL | DISTINCT | DISTINCTROW]"]),o1=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY","HAVING","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE] [INTO]","REPLACE [LOW_PRIORITY | DELAYED] [INTO]","VALUES","ON DUPLICATE KEY UPDATE","SET"]),o2=nG(["CREATE [TEMPORARY] TABLE [IF NOT EXISTS]"]),o4=nG(["CREATE [OR REPLACE] [SQL SECURITY DEFINER | SQL SECURITY INVOKER] VIEW [IF NOT EXISTS]","UPDATE [LOW_PRIORITY] [IGNORE]","DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM","DROP [TEMPORARY] TABLE [IF EXISTS]","ALTER TABLE","ADD [COLUMN]","{CHANGE | MODIFY} [COLUMN]","DROP [COLUMN]","RENAME [TO | AS]","RENAME COLUMN","ALTER [COLUMN]","{SET | DROP} DEFAULT","TRUNCATE [TABLE]","ALTER DATABASE","ALTER INSTANCE","ALTER RESOURCE GROUP","ALTER SEQUENCE","ALTER USER","ALTER VIEW","ANALYZE TABLE","CHECK TABLE","CHECKSUM TABLE","COMMIT","CREATE DATABASE","CREATE INDEX","CREATE RESOURCE GROUP","CREATE ROLE","CREATE SEQUENCE","CREATE USER","DEALLOCATE PREPARE","DESCRIBE","DROP DATABASE","DROP INDEX","DROP RESOURCE GROUP","DROP ROLE","DROP TABLESPACE","DROP USER","DROP VIEW","EXPLAIN","FLUSH","GRANT","IMPORT TABLE","INSTALL COMPONENT","INSTALL PLUGIN","KILL","LOAD DATA","LOCK INSTANCE FOR BACKUP","LOCK TABLES","OPTIMIZE TABLE","PREPARE","RELEASE SAVEPOINT","RENAME TABLE","RENAME USER","REPAIR TABLE","RESET","REVOKE","ROLLBACK","ROLLBACK TO SAVEPOINT","SAVEPOINT","SET CHARACTER SET","SET DEFAULT ROLE","SET NAMES","SET PASSWORD","SET RESOURCE GROUP","SET ROLE","SET TRANSACTION","SHOW","SHOW BINARY LOGS","SHOW BINLOG EVENTS","SHOW CHARACTER SET","SHOW COLLATION","SHOW COLUMNS","SHOW CREATE DATABASE","SHOW CREATE TABLE","SHOW CREATE USER","SHOW CREATE VIEW","SHOW DATABASES","SHOW ENGINE","SHOW ENGINES","SHOW ERRORS","SHOW EVENTS","SHOW GRANTS","SHOW INDEX","SHOW MASTER STATUS","SHOW OPEN TABLES","SHOW PLUGINS","SHOW PRIVILEGES","SHOW PROCESSLIST","SHOW PROFILE","SHOW PROFILES","SHOW STATUS","SHOW TABLE STATUS","SHOW TABLES","SHOW TRIGGERS","SHOW VARIABLES","SHOW WARNINGS","TABLE","UNINSTALL COMPONENT","UNINSTALL PLUGIN","UNLOCK INSTANCE","UNLOCK TABLES","USE"]),o9=nG(["UNION [ALL | DISTINCT]"]),o5=nG(["JOIN","{LEFT | RIGHT} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT} [OUTER] JOIN","STRAIGHT_JOIN"]),o3=nG(["ON {UPDATE | DELETE} [SET NULL]","CHARACTER SET","{ROWS | RANGE} BETWEEN","IDENTIFIED BY"]),o6=nG([]),o8={name:"tidb",tokenizerOptions:{reservedSelect:o0,reservedClauses:[...o1,...o2,...o4],reservedSetOperations:o9,reservedJoins:o5,reservedKeywordPhrases:o3,reservedDataTypePhrases:o6,supportsXor:!0,reservedKeywords:["ADD","ALL","ALTER","ANALYZE","AND","ARRAY","AS","ASC","BETWEEN","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHECK","COLLATE","COLUMN","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CURRENT_DATE","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DEFAULT","DELAYED","DELETE","DESC","DESCRIBE","DISTINCT","DISTINCTROW","DIV","DOUBLE","DROP","DUAL","ELSE","ELSEIF","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FOR","FORCE","FOREIGN","FROM","FULLTEXT","GENERATED","GRANT","GROUP","GROUPS","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","ILIKE","IN","INDEX","INFILE","INNER","INOUT","INSERT","INTERSECT","INTERVAL","INTO","IS","ITERATE","JOIN","KEY","KEYS","KILL","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LOW_PRIORITY","MATCH","MAXVALUE","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","NATURAL","NOT","NO_WRITE_TO_BINLOG","NULL","OF","ON","OPTIMIZE","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PARTITION","PRIMARY","PROCEDURE","RANGE","READ","RECURSIVE","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESTRICT","REVOKE","RIGHT","RLIKE","ROW","ROWS","SECOND_MICROSECOND","SELECT","SET","SHOW","SPATIAL","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STATS_EXTENDED","STORED","STRAIGHT_JOIN","TABLE","TABLESAMPLE","TERMINATED","THEN","TO","TRAILING","TRIGGER","TRUE","TiDB_CURRENT_TSO","UNION","UNIQUE","UNLOCK","UNSIGNED","UNTIL","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VIRTUAL","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"],reservedDataTypes:["BIGINT","BINARY","BIT","BLOB","BOOL","BOOLEAN","CHAR","CHARACTER","DATE","DATETIME","DEC","DECIMAL","DOUBLE PRECISION","DOUBLE","ENUM","FIXED","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","LONGBLOB","LONGTEXT","MEDIUMBLOB","MEDIUMINT","MIDDLEINT","NATIONAL CHAR","NATIONAL VARCHAR","NUMERIC","PRECISION","SMALLINT","TEXT","TIME","TIMESTAMP","TINYBLOB","TINYINT","TINYTEXT","VARBINARY","VARCHAR","VARCHARACTER","VARYING","YEAR"],reservedFunctionNames:["ABS","ACOS","ADDDATE","ADDTIME","AES_DECRYPT","AES_ENCRYPT","ANY_VALUE","ASCII","ASIN","ATAN","ATAN2","AVG","BENCHMARK","BIN","BIN_TO_UUID","BIT_AND","BIT_COUNT","BIT_LENGTH","BIT_OR","BIT_XOR","BITAND","BITNEG","BITOR","BITXOR","CASE","CAST","CEIL","CEILING","CHAR_FUNC","CHAR_LENGTH","CHARACTER_LENGTH","CHARSET","COALESCE","COERCIBILITY","COLLATION","COMPRESS","CONCAT","CONCAT_WS","CONNECTION_ID","CONV","CONVERT","CONVERT_TZ","COS","COT","COUNT","CRC32","CUME_DIST","CURDATE","CURRENT_DATE","CURRENT_RESOURCE_GROUP","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURTIME","DATABASE","DATE","DATE_ADD","DATE_FORMAT","DATE_SUB","DATEDIFF","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DAYOFYEAR","DECODE","DEFAULT_FUNC","DEGREES","DENSE_RANK","DES_DECRYPT","DES_ENCRYPT","DIV","ELT","ENCODE","ENCRYPT","EQ","EXP","EXPORT_SET","EXTRACT","FIELD","FIND_IN_SET","FIRST_VALUE","FLOOR","FORMAT","FORMAT_BYTES","FORMAT_NANO_TIME","FOUND_ROWS","FROM_BASE64","FROM_DAYS","FROM_UNIXTIME","GE","GET_FORMAT","GET_LOCK","GETPARAM","GREATEST","GROUP_CONCAT","GROUPING","GT","HEX","HOUR","IF","IFNULL","ILIKE","INET6_ATON","INET6_NTOA","INET_ATON","INET_NTOA","INSERT_FUNC","INSTR","INTDIV","INTERVAL","IS_FREE_LOCK","IS_IPV4","IS_IPV4_COMPAT","IS_IPV4_MAPPED","IS_IPV6","IS_USED_LOCK","IS_UUID","ISFALSE","ISNULL","ISTRUE","JSON_ARRAY","JSON_ARRAYAGG","JSON_ARRAY_APPEND","JSON_ARRAY_INSERT","JSON_CONTAINS","JSON_CONTAINS_PATH","JSON_DEPTH","JSON_EXTRACT","JSON_INSERT","JSON_KEYS","JSON_LENGTH","JSON_MEMBEROF","JSON_MERGE","JSON_MERGE_PATCH","JSON_MERGE_PRESERVE","JSON_OBJECT","JSON_OBJECTAGG","JSON_OVERLAPS","JSON_PRETTY","JSON_QUOTE","JSON_REMOVE","JSON_REPLACE","JSON_SEARCH","JSON_SET","JSON_STORAGE_FREE","JSON_STORAGE_SIZE","JSON_TYPE","JSON_UNQUOTE","JSON_VALID","LAG","LAST_DAY","LAST_INSERT_ID","LAST_VALUE","LASTVAL","LCASE","LE","LEAD","LEAST","LEFT","LEFTSHIFT","LENGTH","LIKE","LN","LOAD_FILE","LOCALTIME","LOCALTIMESTAMP","LOCATE","LOG","LOG10","LOG2","LOWER","LPAD","LT","LTRIM","MAKE_SET","MAKEDATE","MAKETIME","MASTER_POS_WAIT","MAX","MD5","MICROSECOND","MID","MIN","MINUS","MINUTE","MOD","MONTH","MONTHNAME","MUL","NAME_CONST","NE","NEXTVAL","NOT","NOW","NTH_VALUE","NTILE","NULLEQ","OCT","OCTET_LENGTH","OLD_PASSWORD","ORD","PASSWORD_FUNC","PERCENT_RANK","PERIOD_ADD","PERIOD_DIFF","PI","PLUS","POSITION","POW","POWER","QUARTER","QUOTE","RADIANS","RAND","RANDOM_BYTES","RANK","REGEXP","REGEXP_INSTR","REGEXP_LIKE","REGEXP_REPLACE","REGEXP_SUBSTR","RELEASE_ALL_LOCKS","RELEASE_LOCK","REPEAT","REPLACE","REVERSE","RIGHT","RIGHTSHIFT","ROUND","ROW_COUNT","ROW_NUMBER","RPAD","RTRIM","SCHEMA","SEC_TO_TIME","SECOND","SESSION_USER","SETVAL","SETVAR","SHA","SHA1","SHA2","SIGN","SIN","SLEEP","SM3","SPACE","SQRT","STD","STDDEV","STDDEV_POP","STDDEV_SAMP","STR_TO_DATE","STRCMP","SUBDATE","SUBSTR","SUBSTRING","SUBSTRING_INDEX","SUBTIME","SUM","SYSDATE","SYSTEM_USER","TAN","TIDB_BOUNDED_STALENESS","TIDB_CURRENT_TSO","TIDB_DECODE_BINARY_PLAN","TIDB_DECODE_KEY","TIDB_DECODE_PLAN","TIDB_DECODE_SQL_DIGESTS","TIDB_ENCODE_SQL_DIGEST","TIDB_IS_DDL_OWNER","TIDB_PARSE_TSO","TIDB_PARSE_TSO_LOGICAL","TIDB_ROW_CHECKSUM","TIDB_SHARD","TIDB_VERSION","TIME","TIME_FORMAT","TIME_TO_SEC","TIMEDIFF","TIMESTAMP","TIMESTAMPADD","TIMESTAMPDIFF","TO_BASE64","TO_DAYS","TO_SECONDS","TRANSLATE","TRIM","TRUNCATE","UCASE","UNARYMINUS","UNCOMPRESS","UNCOMPRESSED_LENGTH","UNHEX","UNIX_TIMESTAMP","UPPER","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","UUID","UUID_SHORT","UUID_TO_BIN","VALIDATE_PASSWORD_STRENGTH","VAR_POP","VAR_SAMP","VARIANCE","VERSION","VITESS_HASH","WEEK","WEEKDAY","WEEKOFYEAR","WEIGHT_STRING","YEAR","YEARWEEK"],stringTypes:['""-qq-bs',{quote:"''-qq-bs",prefixes:["N"]},{quote:"''-raw",prefixes:["B","X"],requirePrefix:!0}],identTypes:["``"],identChars:{first:"$",rest:"$",allowFirstCharNumber:!0},variableTypes:[{regex:"@@?[A-Za-z0-9_.$]+"},{quote:'""-qq-bs',prefixes:["@"],requirePrefix:!0},{quote:"''-qq-bs",prefixes:["@"],requirePrefix:!0},{quote:"``",prefixes:["@"],requirePrefix:!0}],paramTypes:{positional:!0},lineCommentTypes:["--","#"],operators:["%",":=","&","|","^","~","<<",">>","<=>","->","->>","&&","||","!","*.*"],postProcess:ow},formatOptions:{onelineClauses:[...o2,...o4],tabularOnelineClauses:o4}},o7=nG(["SELECT [ALL | DISTINCT]"]),le=nG(["WITH","FROM","WHERE","GROUP BY","HAVING","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","INSERT INTO","VALUES","SET","MERGE INTO","WHEN [NOT] MATCHED THEN","UPDATE SET","INSERT","NEST","UNNEST","RETURNING"]),lt=nG(["UPDATE","DELETE FROM","SET SCHEMA","ADVISE","ALTER INDEX","BEGIN TRANSACTION","BUILD INDEX","COMMIT TRANSACTION","CREATE COLLECTION","CREATE FUNCTION","CREATE INDEX","CREATE PRIMARY INDEX","CREATE SCOPE","DROP COLLECTION","DROP FUNCTION","DROP INDEX","DROP PRIMARY INDEX","DROP SCOPE","EXECUTE","EXECUTE FUNCTION","EXPLAIN","GRANT","INFER","PREPARE","REVOKE","ROLLBACK TRANSACTION","SAVEPOINT","SET TRANSACTION","UPDATE STATISTICS","UPSERT","LET","SET CURRENT SCHEMA","SHOW","USE [PRIMARY] KEYS"]),lr=nG(["UNION [ALL]","EXCEPT [ALL]","INTERSECT [ALL]"]),la=nG(["JOIN","{LEFT | RIGHT} [OUTER] JOIN","INNER JOIN"]),ls=nG(["{ROWS | RANGE | GROUPS} BETWEEN"]),li=nG([]),ln={name:"n1ql",tokenizerOptions:{reservedSelect:o7,reservedClauses:[...le,...lt],reservedSetOperations:lr,reservedJoins:la,reservedKeywordPhrases:ls,reservedDataTypePhrases:li,supportsXor:!0,reservedKeywords:["ADVISE","ALL","ALTER","ANALYZE","AND","ANY","ARRAY","AS","ASC","AT","BEGIN","BETWEEN","BINARY","BOOLEAN","BREAK","BUCKET","BUILD","BY","CALL","CASE","CAST","CLUSTER","COLLATE","COLLECTION","COMMIT","COMMITTED","CONNECT","CONTINUE","CORRELATED","COVER","CREATE","CURRENT","DATABASE","DATASET","DATASTORE","DECLARE","DECREMENT","DELETE","DERIVED","DESC","DESCRIBE","DISTINCT","DO","DROP","EACH","ELEMENT","ELSE","END","EVERY","EXCEPT","EXCLUDE","EXECUTE","EXISTS","EXPLAIN","FALSE","FETCH","FILTER","FIRST","FLATTEN","FLUSH","FOLLOWING","FOR","FORCE","FROM","FTS","FUNCTION","GOLANG","GRANT","GROUP","GROUPS","GSI","HASH","HAVING","IF","IGNORE","ILIKE","IN","INCLUDE","INCREMENT","INDEX","INFER","INLINE","INNER","INSERT","INTERSECT","INTO","IS","ISOLATION","JAVASCRIPT","JOIN","KEY","KEYS","KEYSPACE","KNOWN","LANGUAGE","LAST","LEFT","LET","LETTING","LEVEL","LIKE","LIMIT","LSM","MAP","MAPPING","MATCHED","MATERIALIZED","MERGE","MINUS","MISSING","NAMESPACE","NEST","NL","NO","NOT","NTH_VALUE","NULL","NULLS","NUMBER","OBJECT","OFFSET","ON","OPTION","OPTIONS","OR","ORDER","OTHERS","OUTER","OVER","PARSE","PARTITION","PASSWORD","PATH","POOL","PRECEDING","PREPARE","PRIMARY","PRIVATE","PRIVILEGE","PROBE","PROCEDURE","PUBLIC","RANGE","RAW","REALM","REDUCE","RENAME","RESPECT","RETURN","RETURNING","REVOKE","RIGHT","ROLE","ROLLBACK","ROW","ROWS","SATISFIES","SAVEPOINT","SCHEMA","SCOPE","SELECT","SELF","SEMI","SET","SHOW","SOME","START","STATISTICS","STRING","SYSTEM","THEN","TIES","TO","TRAN","TRANSACTION","TRIGGER","TRUE","TRUNCATE","UNBOUNDED","UNDER","UNION","UNIQUE","UNKNOWN","UNNEST","UNSET","UPDATE","UPSERT","USE","USER","USING","VALIDATE","VALUE","VALUED","VALUES","VIA","VIEW","WHEN","WHERE","WHILE","WINDOW","WITH","WITHIN","WORK","XOR"],reservedDataTypes:[],reservedFunctionNames:["ABORT","ABS","ACOS","ADVISOR","ARRAY_AGG","ARRAY_AGG","ARRAY_APPEND","ARRAY_AVG","ARRAY_BINARY_SEARCH","ARRAY_CONCAT","ARRAY_CONTAINS","ARRAY_COUNT","ARRAY_DISTINCT","ARRAY_EXCEPT","ARRAY_FLATTEN","ARRAY_IFNULL","ARRAY_INSERT","ARRAY_INTERSECT","ARRAY_LENGTH","ARRAY_MAX","ARRAY_MIN","ARRAY_MOVE","ARRAY_POSITION","ARRAY_PREPEND","ARRAY_PUT","ARRAY_RANGE","ARRAY_REMOVE","ARRAY_REPEAT","ARRAY_REPLACE","ARRAY_REVERSE","ARRAY_SORT","ARRAY_STAR","ARRAY_SUM","ARRAY_SYMDIFF","ARRAY_SYMDIFF1","ARRAY_SYMDIFFN","ARRAY_UNION","ASIN","ATAN","ATAN2","AVG","BASE64","BASE64_DECODE","BASE64_ENCODE","BITAND ","BITCLEAR ","BITNOT ","BITOR ","BITSET ","BITSHIFT ","BITTEST ","BITXOR ","CEIL","CLOCK_LOCAL","CLOCK_MILLIS","CLOCK_STR","CLOCK_TZ","CLOCK_UTC","COALESCE","CONCAT","CONCAT2","CONTAINS","CONTAINS_TOKEN","CONTAINS_TOKEN_LIKE","CONTAINS_TOKEN_REGEXP","COS","COUNT","COUNT","COUNTN","CUME_DIST","CURL","DATE_ADD_MILLIS","DATE_ADD_STR","DATE_DIFF_MILLIS","DATE_DIFF_STR","DATE_FORMAT_STR","DATE_PART_MILLIS","DATE_PART_STR","DATE_RANGE_MILLIS","DATE_RANGE_STR","DATE_TRUNC_MILLIS","DATE_TRUNC_STR","DECODE","DECODE_JSON","DEGREES","DENSE_RANK","DURATION_TO_STR","ENCODED_SIZE","ENCODE_JSON","EXP","FIRST_VALUE","FLOOR","GREATEST","HAS_TOKEN","IFINF","IFMISSING","IFMISSINGORNULL","IFNAN","IFNANORINF","IFNULL","INITCAP","ISARRAY","ISATOM","ISBITSET","ISBOOLEAN","ISNUMBER","ISOBJECT","ISSTRING","LAG","LAST_VALUE","LEAD","LEAST","LENGTH","LN","LOG","LOWER","LTRIM","MAX","MEAN","MEDIAN","META","MILLIS","MILLIS_TO_LOCAL","MILLIS_TO_STR","MILLIS_TO_TZ","MILLIS_TO_UTC","MILLIS_TO_ZONE_NAME","MIN","MISSINGIF","NANIF","NEGINFIF","NOW_LOCAL","NOW_MILLIS","NOW_STR","NOW_TZ","NOW_UTC","NTH_VALUE","NTILE","NULLIF","NVL","NVL2","OBJECT_ADD","OBJECT_CONCAT","OBJECT_INNER_PAIRS","OBJECT_INNER_VALUES","OBJECT_LENGTH","OBJECT_NAMES","OBJECT_PAIRS","OBJECT_PUT","OBJECT_REMOVE","OBJECT_RENAME","OBJECT_REPLACE","OBJECT_UNWRAP","OBJECT_VALUES","PAIRS","PERCENT_RANK","PI","POLY_LENGTH","POSINFIF","POSITION","POWER","RADIANS","RANDOM","RANK","RATIO_TO_REPORT","REGEXP_CONTAINS","REGEXP_LIKE","REGEXP_MATCHES","REGEXP_POSITION","REGEXP_REPLACE","REGEXP_SPLIT","REGEX_CONTAINS","REGEX_LIKE","REGEX_MATCHES","REGEX_POSITION","REGEX_REPLACE","REGEX_SPLIT","REPEAT","REPLACE","REVERSE","ROUND","ROW_NUMBER","RTRIM","SEARCH","SEARCH_META","SEARCH_SCORE","SIGN","SIN","SPLIT","SQRT","STDDEV","STDDEV_POP","STDDEV_SAMP","STR_TO_DURATION","STR_TO_MILLIS","STR_TO_TZ","STR_TO_UTC","STR_TO_ZONE_NAME","SUBSTR","SUFFIXES","SUM","TAN","TITLE","TOARRAY","TOATOM","TOBOOLEAN","TOKENS","TOKENS","TONUMBER","TOOBJECT","TOSTRING","TRIM","TRUNC","UPPER","UUID","VARIANCE","VARIANCE_POP","VARIANCE_SAMP","VAR_POP","VAR_SAMP","WEEKDAY_MILLIS","WEEKDAY_STR","CAST"],stringTypes:['""-bs',"''-bs"],identTypes:["``"],extraParens:["[]","{}"],paramTypes:{positional:!0,numbered:["$"],named:["$"]},lineCommentTypes:["#","--"],operators:["%","==",":","||"]},formatOptions:{onelineClauses:lt}},lo=nG(["SELECT [ALL | DISTINCT | UNIQUE]"]),ll=nG(["WITH","FROM","WHERE","GROUP BY","HAVING","PARTITION BY","ORDER [SIBLINGS] BY","OFFSET","FETCH {FIRST | NEXT}","FOR UPDATE [OF]","INSERT [INTO | ALL INTO]","VALUES","SET","MERGE [INTO]","WHEN [NOT] MATCHED [THEN]","UPDATE SET","RETURNING"]),lE=nG(["CREATE [GLOBAL TEMPORARY | PRIVATE TEMPORARY | SHARDED | DUPLICATED | IMMUTABLE BLOCKCHAIN | BLOCKCHAIN | IMMUTABLE] TABLE"]),lu=nG(["CREATE [OR REPLACE] [NO FORCE | FORCE] [EDITIONING | EDITIONABLE | EDITIONABLE EDITIONING | NONEDITIONABLE] VIEW","CREATE MATERIALIZED VIEW","UPDATE [ONLY]","DELETE FROM [ONLY]","DROP TABLE","ALTER TABLE","ADD","DROP {COLUMN | UNUSED COLUMNS | COLUMNS CONTINUE}","MODIFY","RENAME TO","RENAME COLUMN","TRUNCATE TABLE","SET SCHEMA","BEGIN","CONNECT BY","DECLARE","EXCEPT","EXCEPTION","LOOP","START WITH"]),lc=nG(["UNION [ALL]","MINUS","INTERSECT"]),lT=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT | FULL} [OUTER] JOIN","{CROSS | OUTER} APPLY"]),ld=nG(["ON {UPDATE | DELETE} [SET NULL]","ON COMMIT","{ROWS | RANGE} BETWEEN"]),lh=nG([]),lA={name:"plsql",tokenizerOptions:{reservedSelect:lo,reservedClauses:[...ll,...lE,...lu],reservedSetOperations:lc,reservedJoins:lT,reservedKeywordPhrases:ld,reservedDataTypePhrases:lh,supportsXor:!0,reservedKeywords:["ADD","AGENT","AGGREGATE","ALL","ALTER","AND","ANY","ARROW","AS","ASC","AT","ATTRIBUTE","AUTHID","AVG","BEGIN","BETWEEN","BLOCK","BODY","BOTH","BOUND","BULK","BY","BYTE","CALL","CALLING","CASCADE","CASE","CHARSET","CHARSETFORM","CHARSETID","CHECK","CLOSE","CLUSTER","CLUSTERS","COLAUTH","COLLECT","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPILED","COMPRESS","CONNECT","CONSTANT","CONSTRUCTOR","CONTEXT","CONVERT","COUNT","CRASH","CREATE","CURRENT","CURSOR","CUSTOMDATUM","DANGLING","DATA","DAY","DECLARE","DEFAULT","DEFINE","DELETE","DESC","DETERMINISTIC","DISTINCT","DROP","DURATION","ELEMENT","ELSE","ELSIF","EMPTY","END","ESCAPE","EXCEPT","EXCEPTION","EXCEPTIONS","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTERNAL","FETCH","FINAL","FIXED","FOR","FORALL","FORCE","FORM","FROM","FUNCTION","GENERAL","GOTO","GRANT","GROUP","HASH","HAVING","HEAP","HIDDEN","HOUR","IDENTIFIED","IF","IMMEDIATE","IN","INCLUDING","INDEX","INDEXES","INDICATOR","INDICES","INFINITE","INSERT","INSTANTIABLE","INTERFACE","INTERSECT","INTERVAL","INTO","INVALIDATE","IS","ISOLATION","JAVA","LANGUAGE","LARGE","LEADING","LENGTH","LEVEL","LIBRARY","LIKE","LIKE2","LIKE4","LIKEC","LIMIT","LIMITED","LOCAL","LOCK","LOOP","MAP","MAX","MAXLEN","MEMBER","MERGE","MIN","MINUS","MINUTE","MOD","MODE","MODIFY","MONTH","MULTISET","NAME","NAN","NATIONAL","NATIVE","NEW","NOCOMPRESS","NOCOPY","NOT","NOWAIT","NULL","OBJECT","OCICOLL","OCIDATE","OCIDATETIME","OCIDURATION","OCIINTERVAL","OCILOBLOCATOR","OCINUMBER","OCIRAW","OCIREF","OCIREFCURSOR","OCIROWID","OCISTRING","OCITYPE","OF","ON","ONLY","OPAQUE","OPEN","OPERATOR","OPTION","OR","ORACLE","ORADATA","ORDER","OVERLAPS","ORGANIZATION","ORLANY","ORLVARY","OTHERS","OUT","OVERRIDING","PACKAGE","PARALLEL_ENABLE","PARAMETER","PARAMETERS","PARTITION","PASCAL","PIPE","PIPELINED","PRAGMA","PRIOR","PRIVATE","PROCEDURE","PUBLIC","RAISE","RANGE","READ","RECORD","REF","REFERENCE","REM","REMAINDER","RENAME","RESOURCE","RESULT","RETURN","RETURNING","REVERSE","REVOKE","ROLLBACK","ROW","SAMPLE","SAVE","SAVEPOINT","SB1","SB2","SB4","SECOND","SEGMENT","SELECT","SELF","SEPARATE","SEQUENCE","SERIALIZABLE","SET","SHARE","SHORT","SIZE","SIZE_T","SOME","SPARSE","SQL","SQLCODE","SQLDATA","SQLNAME","SQLSTATE","STANDARD","START","STATIC","STDDEV","STORED","STRING","STRUCT","STYLE","SUBMULTISET","SUBPARTITION","SUBSTITUTABLE","SUBTYPE","SUM","SYNONYM","TABAUTH","TABLE","TDO","THE","THEN","TIME","TIMEZONE_ABBR","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIMEZONE_REGION","TO","TRAILING","TRANSAC","TRANSACTIONAL","TRUSTED","TYPE","UB1","UB2","UB4","UNDER","UNION","UNIQUE","UNSIGNED","UNTRUSTED","UPDATE","USE","USING","VALIST","VALUE","VALUES","VARIABLE","VARIANCE","VARRAY","VIEW","VIEWS","VOID","WHEN","WHERE","WHILE","WITH","WORK","WRAPPED","WRITE","YEAR","ZONE"],reservedDataTypes:["ARRAY","BFILE_BASE","BINARY","BLOB_BASE","CHAR VARYING","CHAR_BASE","CHAR","CHARACTER VARYING","CHARACTER","CLOB_BASE","DATE_BASE","DATE","DECIMAL","DOUBLE","FLOAT","INT","INTERVAL DAY","INTERVAL YEAR","LONG","NATIONAL CHAR VARYING","NATIONAL CHAR","NATIONAL CHARACTER VARYING","NATIONAL CHARACTER","NCHAR VARYING","NCHAR","NCHAR","NUMBER_BASE","NUMBER","NUMBERIC","NVARCHAR","PRECISION","RAW","TIMESTAMP","UROWID","VARCHAR","VARCHAR2"],reservedFunctionNames:["ABS","ACOS","ASIN","ATAN","ATAN2","BITAND","CEIL","COS","COSH","EXP","FLOOR","LN","LOG","MOD","NANVL","POWER","REMAINDER","ROUND","SIGN","SIN","SINH","SQRT","TAN","TANH","TRUNC","WIDTH_BUCKET","CHR","CONCAT","INITCAP","LOWER","LPAD","LTRIM","NLS_INITCAP","NLS_LOWER","NLSSORT","NLS_UPPER","REGEXP_REPLACE","REGEXP_SUBSTR","REPLACE","RPAD","RTRIM","SOUNDEX","SUBSTR","TRANSLATE","TREAT","TRIM","UPPER","NLS_CHARSET_DECL_LEN","NLS_CHARSET_ID","NLS_CHARSET_NAME","ASCII","INSTR","LENGTH","REGEXP_INSTR","ADD_MONTHS","CURRENT_DATE","CURRENT_TIMESTAMP","DBTIMEZONE","EXTRACT","FROM_TZ","LAST_DAY","LOCALTIMESTAMP","MONTHS_BETWEEN","NEW_TIME","NEXT_DAY","NUMTODSINTERVAL","NUMTOYMINTERVAL","ROUND","SESSIONTIMEZONE","SYS_EXTRACT_UTC","SYSDATE","SYSTIMESTAMP","TO_CHAR","TO_TIMESTAMP","TO_TIMESTAMP_TZ","TO_DSINTERVAL","TO_YMINTERVAL","TRUNC","TZ_OFFSET","GREATEST","LEAST","ASCIISTR","BIN_TO_NUM","CAST","CHARTOROWID","COMPOSE","CONVERT","DECOMPOSE","HEXTORAW","NUMTODSINTERVAL","NUMTOYMINTERVAL","RAWTOHEX","RAWTONHEX","ROWIDTOCHAR","ROWIDTONCHAR","SCN_TO_TIMESTAMP","TIMESTAMP_TO_SCN","TO_BINARY_DOUBLE","TO_BINARY_FLOAT","TO_CHAR","TO_CLOB","TO_DATE","TO_DSINTERVAL","TO_LOB","TO_MULTI_BYTE","TO_NCHAR","TO_NCLOB","TO_NUMBER","TO_DSINTERVAL","TO_SINGLE_BYTE","TO_TIMESTAMP","TO_TIMESTAMP_TZ","TO_YMINTERVAL","TO_YMINTERVAL","TRANSLATE","UNISTR","BFILENAME","EMPTY_BLOB,","EMPTY_CLOB","CARDINALITY","COLLECT","POWERMULTISET","POWERMULTISET_BY_CARDINALITY","SET","SYS_CONNECT_BY_PATH","CLUSTER_ID","CLUSTER_PROBABILITY","CLUSTER_SET","FEATURE_ID","FEATURE_SET","FEATURE_VALUE","PREDICTION","PREDICTION_COST","PREDICTION_DETAILS","PREDICTION_PROBABILITY","PREDICTION_SET","APPENDCHILDXML","DELETEXML","DEPTH","EXTRACT","EXISTSNODE","EXTRACTVALUE","INSERTCHILDXML","INSERTXMLBEFORE","PATH","SYS_DBURIGEN","SYS_XMLAGG","SYS_XMLGEN","UPDATEXML","XMLAGG","XMLCDATA","XMLCOLATTVAL","XMLCOMMENT","XMLCONCAT","XMLFOREST","XMLPARSE","XMLPI","XMLQUERY","XMLROOT","XMLSEQUENCE","XMLSERIALIZE","XMLTABLE","XMLTRANSFORM","DECODE","DUMP","ORA_HASH","VSIZE","COALESCE","LNNVL","NULLIF","NVL","NVL2","SYS_CONTEXT","SYS_GUID","SYS_TYPEID","UID","USER","USERENV","AVG","COLLECT","CORR","CORR_S","CORR_K","COUNT","COVAR_POP","COVAR_SAMP","CUME_DIST","DENSE_RANK","FIRST","GROUP_ID","GROUPING","GROUPING_ID","LAST","MAX","MEDIAN","MIN","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","RANK","REGR_SLOPE","REGR_INTERCEPT","REGR_COUNT","REGR_R2","REGR_AVGX","REGR_AVGY","REGR_SXX","REGR_SYY","REGR_SXY","STATS_BINOMIAL_TEST","STATS_CROSSTAB","STATS_F_TEST","STATS_KS_TEST","STATS_MODE","STATS_MW_TEST","STATS_ONE_WAY_ANOVA","STATS_T_TEST_ONE","STATS_T_TEST_PAIRED","STATS_T_TEST_INDEP","STATS_T_TEST_INDEPU","STATS_WSR_TEST","STDDEV","STDDEV_POP","STDDEV_SAMP","SUM","VAR_POP","VAR_SAMP","VARIANCE","FIRST_VALUE","LAG","LAST_VALUE","LEAD","NTILE","RATIO_TO_REPORT","ROW_NUMBER","DEREF","MAKE_REF","REF","REFTOHEX","VALUE","CV","ITERATION_NUMBER","PRESENTNNV","PRESENTV","PREVIOUS"],stringTypes:[{quote:"''-qq",prefixes:["N"]},{quote:"q''",prefixes:["N"]}],identTypes:['""-qq'],identChars:{rest:"$#"},variableTypes:[{regex:"&{1,2}[A-Za-z][A-Za-z0-9_$#]*"}],paramTypes:{numbered:[":"],named:[":"]},operators:["**",":=","%","~=","^=",">>","<<","=>","@","||"],postProcess:function(e){let t=nK;return e.map(e=>nq.SET(e)&&nq.BY(t)?Object.assign(Object.assign({},e),{type:ew.RESERVED_KEYWORD}):(nJ(e.type)&&(t=e),e))}},formatOptions:{alwaysDenseOperators:["@"],onelineClauses:[...lE,...lu],tabularOnelineClauses:lu}},lp=nG(["SELECT [ALL | DISTINCT]"]),lR=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY [ALL | DISTINCT]","HAVING","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","FETCH {FIRST | NEXT}","FOR {UPDATE | NO KEY UPDATE | SHARE | KEY SHARE} [OF]","INSERT INTO","VALUES","DEFAULT VALUES","SET","RETURNING"]),lS=nG(["CREATE [GLOBAL | LOCAL] [TEMPORARY | TEMP | UNLOGGED] TABLE [IF NOT EXISTS]"]),l_=nG(["CREATE [OR REPLACE] [TEMP | TEMPORARY] [RECURSIVE] VIEW","CREATE [MATERIALIZED] VIEW [IF NOT EXISTS]","UPDATE [ONLY]","WHERE CURRENT OF","ON CONFLICT","DELETE FROM [ONLY]","DROP TABLE [IF EXISTS]","ALTER TABLE [IF EXISTS] [ONLY]","ALTER TABLE ALL IN TABLESPACE","RENAME [COLUMN]","RENAME TO","ADD [COLUMN] [IF NOT EXISTS]","DROP [COLUMN] [IF EXISTS]","ALTER [COLUMN]","SET DATA TYPE","{SET | DROP} DEFAULT","{SET | DROP} NOT NULL","TRUNCATE [TABLE] [ONLY]","SET SCHEMA","AFTER","ABORT","ALTER AGGREGATE","ALTER COLLATION","ALTER CONVERSION","ALTER DATABASE","ALTER DEFAULT PRIVILEGES","ALTER DOMAIN","ALTER EVENT TRIGGER","ALTER EXTENSION","ALTER FOREIGN DATA WRAPPER","ALTER FOREIGN TABLE","ALTER FUNCTION","ALTER GROUP","ALTER INDEX","ALTER LANGUAGE","ALTER LARGE OBJECT","ALTER MATERIALIZED VIEW","ALTER OPERATOR","ALTER OPERATOR CLASS","ALTER OPERATOR FAMILY","ALTER POLICY","ALTER PROCEDURE","ALTER PUBLICATION","ALTER ROLE","ALTER ROUTINE","ALTER RULE","ALTER SCHEMA","ALTER SEQUENCE","ALTER SERVER","ALTER STATISTICS","ALTER SUBSCRIPTION","ALTER SYSTEM","ALTER TABLESPACE","ALTER TEXT SEARCH CONFIGURATION","ALTER TEXT SEARCH DICTIONARY","ALTER TEXT SEARCH PARSER","ALTER TEXT SEARCH TEMPLATE","ALTER TRIGGER","ALTER TYPE","ALTER USER","ALTER USER MAPPING","ALTER VIEW","ANALYZE","BEGIN","CALL","CHECKPOINT","CLOSE","CLUSTER","COMMIT","COMMIT PREPARED","COPY","CREATE ACCESS METHOD","CREATE [OR REPLACE] AGGREGATE","CREATE CAST","CREATE COLLATION","CREATE [DEFAULT] CONVERSION","CREATE DATABASE","CREATE DOMAIN","CREATE EVENT TRIGGER","CREATE EXTENSION","CREATE FOREIGN DATA WRAPPER","CREATE FOREIGN TABLE","CREATE [OR REPLACE] FUNCTION","CREATE GROUP","CREATE [UNIQUE] INDEX","CREATE [OR REPLACE] [TRUSTED] [PROCEDURAL] LANGUAGE","CREATE OPERATOR","CREATE OPERATOR CLASS","CREATE OPERATOR FAMILY","CREATE POLICY","CREATE [OR REPLACE] PROCEDURE","CREATE PUBLICATION","CREATE ROLE","CREATE [OR REPLACE] RULE","CREATE SCHEMA [AUTHORIZATION]","CREATE [TEMPORARY | TEMP | UNLOGGED] SEQUENCE","CREATE SERVER","CREATE STATISTICS","CREATE SUBSCRIPTION","CREATE TABLESPACE","CREATE TEXT SEARCH CONFIGURATION","CREATE TEXT SEARCH DICTIONARY","CREATE TEXT SEARCH PARSER","CREATE TEXT SEARCH TEMPLATE","CREATE [OR REPLACE] TRANSFORM","CREATE [OR REPLACE] [CONSTRAINT] TRIGGER","CREATE TYPE","CREATE USER","CREATE USER MAPPING","DEALLOCATE","DECLARE","DISCARD","DROP ACCESS METHOD","DROP AGGREGATE","DROP CAST","DROP COLLATION","DROP CONVERSION","DROP DATABASE","DROP DOMAIN","DROP EVENT TRIGGER","DROP EXTENSION","DROP FOREIGN DATA WRAPPER","DROP FOREIGN TABLE","DROP FUNCTION","DROP GROUP","DROP IDENTITY","DROP INDEX","DROP LANGUAGE","DROP MATERIALIZED VIEW [IF EXISTS]","DROP OPERATOR","DROP OPERATOR CLASS","DROP OPERATOR FAMILY","DROP OWNED","DROP POLICY","DROP PROCEDURE","DROP PUBLICATION","DROP ROLE","DROP ROUTINE","DROP RULE","DROP SCHEMA","DROP SEQUENCE","DROP SERVER","DROP STATISTICS","DROP SUBSCRIPTION","DROP TABLESPACE","DROP TEXT SEARCH CONFIGURATION","DROP TEXT SEARCH DICTIONARY","DROP TEXT SEARCH PARSER","DROP TEXT SEARCH TEMPLATE","DROP TRANSFORM","DROP TRIGGER","DROP TYPE","DROP USER","DROP USER MAPPING","DROP VIEW","EXECUTE","EXPLAIN","FETCH","GRANT","IMPORT FOREIGN SCHEMA","LISTEN","LOAD","LOCK","MOVE","NOTIFY","OVERRIDING SYSTEM VALUE","PREPARE","PREPARE TRANSACTION","REASSIGN OWNED","REFRESH MATERIALIZED VIEW","REINDEX","RELEASE SAVEPOINT","RESET [ALL|ROLE|SESSION AUTHORIZATION]","REVOKE","ROLLBACK","ROLLBACK PREPARED","ROLLBACK TO SAVEPOINT","SAVEPOINT","SECURITY LABEL","SELECT INTO","SET CONSTRAINTS","SET ROLE","SET SESSION AUTHORIZATION","SET TRANSACTION","SHOW","START TRANSACTION","UNLISTEN","VACUUM"]),lO=nG(["UNION [ALL | DISTINCT]","EXCEPT [ALL | DISTINCT]","INTERSECT [ALL | DISTINCT]"]),lI=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT | FULL} [OUTER] JOIN"]),lf=nG(["PRIMARY KEY","GENERATED {ALWAYS | BY DEFAULT} AS IDENTITY","ON {UPDATE | DELETE} [NO ACTION | RESTRICT | CASCADE | SET NULL | SET DEFAULT]","DO {NOTHING | UPDATE}","AS MATERIALIZED","{ROWS | RANGE | GROUPS} BETWEEN","IS [NOT] DISTINCT FROM","NULLS {FIRST | LAST}","WITH ORDINALITY"]),lN=nG(["[TIMESTAMP | TIME] {WITH | WITHOUT} TIME ZONE"]),lm={name:"postgresql",tokenizerOptions:{reservedSelect:lp,reservedClauses:[...lR,...lS,...l_],reservedSetOperations:lO,reservedJoins:lI,reservedKeywordPhrases:lf,reservedDataTypePhrases:lN,reservedKeywords:["ALL","ANALYSE","ANALYZE","AND","ANY","AS","ASC","ASYMMETRIC","AUTHORIZATION","BETWEEN","BINARY","BOTH","CASE","CAST","CHECK","COLLATE","COLLATION","COLUMN","CONCURRENTLY","CONSTRAINT","CREATE","CROSS","CURRENT_CATALOG","CURRENT_DATE","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","DAY","DEFAULT","DEFERRABLE","DESC","DISTINCT","DO","ELSE","END","EXCEPT","EXISTS","FALSE","FETCH","FILTER","FOR","FOREIGN","FREEZE","FROM","FULL","GRANT","GROUP","HAVING","HOUR","ILIKE","IN","INITIALLY","INNER","INOUT","INTERSECT","INTO","IS","ISNULL","JOIN","LATERAL","LEADING","LEFT","LIKE","LIMIT","LOCALTIME","LOCALTIMESTAMP","MINUTE","MONTH","NATURAL","NOT","NOTNULL","NULL","NULLIF","OFFSET","ON","ONLY","OR","ORDER","OUT","OUTER","OVER","OVERLAPS","PLACING","PRIMARY","REFERENCES","RETURNING","RIGHT","ROW","SECOND","SELECT","SESSION_USER","SIMILAR","SOME","SYMMETRIC","TABLE","TABLESAMPLE","THEN","TO","TRAILING","TRUE","UNION","UNIQUE","USER","USING","VALUES","VARIADIC","VERBOSE","WHEN","WHERE","WINDOW","WITH","WITHIN","WITHOUT","YEAR"],reservedDataTypes:["ARRAY","BIGINT","BIT","BIT VARYING","BOOL","BOOLEAN","CHAR","CHARACTER","CHARACTER VARYING","DECIMAL","DEC","DOUBLE","ENUM","FLOAT","INT","INTEGER","INTERVAL","NCHAR","NUMERIC","JSON","JSONB","PRECISION","REAL","SMALLINT","TEXT","TIME","TIMESTAMP","TIMESTAMPTZ","UUID","VARCHAR","XML","ZONE"],reservedFunctionNames:["ABS","ACOS","ACOSD","ACOSH","ASIN","ASIND","ASINH","ATAN","ATAN2","ATAN2D","ATAND","ATANH","CBRT","CEIL","CEILING","COS","COSD","COSH","COT","COTD","DEGREES","DIV","EXP","FACTORIAL","FLOOR","GCD","LCM","LN","LOG","LOG10","MIN_SCALE","MOD","PI","POWER","RADIANS","RANDOM","ROUND","SCALE","SETSEED","SIGN","SIN","SIND","SINH","SQRT","TAN","TAND","TANH","TRIM_SCALE","TRUNC","WIDTH_BUCKET","ABS","ASCII","BIT_LENGTH","BTRIM","CHARACTER_LENGTH","CHAR_LENGTH","CHR","CONCAT","CONCAT_WS","FORMAT","INITCAP","LEFT","LENGTH","LOWER","LPAD","LTRIM","MD5","NORMALIZE","OCTET_LENGTH","OVERLAY","PARSE_IDENT","PG_CLIENT_ENCODING","POSITION","QUOTE_IDENT","QUOTE_LITERAL","QUOTE_NULLABLE","REGEXP_MATCH","REGEXP_MATCHES","REGEXP_REPLACE","REGEXP_SPLIT_TO_ARRAY","REGEXP_SPLIT_TO_TABLE","REPEAT","REPLACE","REVERSE","RIGHT","RPAD","RTRIM","SPLIT_PART","SPRINTF","STARTS_WITH","STRING_AGG","STRING_TO_ARRAY","STRING_TO_TABLE","STRPOS","SUBSTR","SUBSTRING","TO_ASCII","TO_HEX","TRANSLATE","TRIM","UNISTR","UPPER","BIT_COUNT","BIT_LENGTH","BTRIM","CONVERT","CONVERT_FROM","CONVERT_TO","DECODE","ENCODE","GET_BIT","GET_BYTE","LENGTH","LTRIM","MD5","OCTET_LENGTH","OVERLAY","POSITION","RTRIM","SET_BIT","SET_BYTE","SHA224","SHA256","SHA384","SHA512","STRING_AGG","SUBSTR","SUBSTRING","TRIM","BIT_COUNT","BIT_LENGTH","GET_BIT","LENGTH","OCTET_LENGTH","OVERLAY","POSITION","SET_BIT","SUBSTRING","REGEXP_MATCH","REGEXP_MATCHES","REGEXP_REPLACE","REGEXP_SPLIT_TO_ARRAY","REGEXP_SPLIT_TO_TABLE","TO_CHAR","TO_DATE","TO_NUMBER","TO_TIMESTAMP","CLOCK_TIMESTAMP","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATE_BIN","DATE_PART","DATE_TRUNC","EXTRACT","ISFINITE","JUSTIFY_DAYS","JUSTIFY_HOURS","JUSTIFY_INTERVAL","LOCALTIME","LOCALTIMESTAMP","MAKE_DATE","MAKE_INTERVAL","MAKE_TIME","MAKE_TIMESTAMP","MAKE_TIMESTAMPTZ","NOW","PG_SLEEP","PG_SLEEP_FOR","PG_SLEEP_UNTIL","STATEMENT_TIMESTAMP","TIMEOFDAY","TO_TIMESTAMP","TRANSACTION_TIMESTAMP","ENUM_FIRST","ENUM_LAST","ENUM_RANGE","AREA","BOUND_BOX","BOX","CENTER","CIRCLE","DIAGONAL","DIAMETER","HEIGHT","ISCLOSED","ISOPEN","LENGTH","LINE","LSEG","NPOINTS","PATH","PCLOSE","POINT","POLYGON","POPEN","RADIUS","SLOPE","WIDTH","ABBREV","BROADCAST","FAMILY","HOST","HOSTMASK","INET_MERGE","INET_SAME_FAMILY","MACADDR8_SET7BIT","MASKLEN","NETMASK","NETWORK","SET_MASKLEN","TRUNC","ARRAY_TO_TSVECTOR","GET_CURRENT_TS_CONFIG","JSONB_TO_TSVECTOR","JSON_TO_TSVECTOR","LENGTH","NUMNODE","PHRASETO_TSQUERY","PLAINTO_TSQUERY","QUERYTREE","SETWEIGHT","STRIP","TO_TSQUERY","TO_TSVECTOR","TSQUERY_PHRASE","TSVECTOR_TO_ARRAY","TS_DEBUG","TS_DELETE","TS_FILTER","TS_HEADLINE","TS_LEXIZE","TS_PARSE","TS_RANK","TS_RANK_CD","TS_REWRITE","TS_STAT","TS_TOKEN_TYPE","WEBSEARCH_TO_TSQUERY","GEN_RANDOM_UUID","CURSOR_TO_XML","CURSOR_TO_XMLSCHEMA","DATABASE_TO_XML","DATABASE_TO_XMLSCHEMA","DATABASE_TO_XML_AND_XMLSCHEMA","NEXTVAL","QUERY_TO_XML","QUERY_TO_XMLSCHEMA","QUERY_TO_XML_AND_XMLSCHEMA","SCHEMA_TO_XML","SCHEMA_TO_XMLSCHEMA","SCHEMA_TO_XML_AND_XMLSCHEMA","STRING","TABLE_TO_XML","TABLE_TO_XMLSCHEMA","TABLE_TO_XML_AND_XMLSCHEMA","XMLAGG","XMLCOMMENT","XMLCONCAT","XMLELEMENT","XMLEXISTS","XMLFOREST","XMLPARSE","XMLPI","XMLROOT","XMLSERIALIZE","XMLTABLE","XML_IS_WELL_FORMED","XML_IS_WELL_FORMED_CONTENT","XML_IS_WELL_FORMED_DOCUMENT","XPATH","XPATH_EXISTS","ARRAY_TO_JSON","JSONB_AGG","JSONB_ARRAY_ELEMENTS","JSONB_ARRAY_ELEMENTS_TEXT","JSONB_ARRAY_LENGTH","JSONB_BUILD_ARRAY","JSONB_BUILD_OBJECT","JSONB_EACH","JSONB_EACH_TEXT","JSONB_EXTRACT_PATH","JSONB_EXTRACT_PATH_TEXT","JSONB_INSERT","JSONB_OBJECT","JSONB_OBJECT_AGG","JSONB_OBJECT_KEYS","JSONB_PATH_EXISTS","JSONB_PATH_EXISTS_TZ","JSONB_PATH_MATCH","JSONB_PATH_MATCH_TZ","JSONB_PATH_QUERY","JSONB_PATH_QUERY_ARRAY","JSONB_PATH_QUERY_ARRAY_TZ","JSONB_PATH_QUERY_FIRST","JSONB_PATH_QUERY_FIRST_TZ","JSONB_PATH_QUERY_TZ","JSONB_POPULATE_RECORD","JSONB_POPULATE_RECORDSET","JSONB_PRETTY","JSONB_SET","JSONB_SET_LAX","JSONB_STRIP_NULLS","JSONB_TO_RECORD","JSONB_TO_RECORDSET","JSONB_TYPEOF","JSON_AGG","JSON_ARRAY_ELEMENTS","JSON_ARRAY_ELEMENTS_TEXT","JSON_ARRAY_LENGTH","JSON_BUILD_ARRAY","JSON_BUILD_OBJECT","JSON_EACH","JSON_EACH_TEXT","JSON_EXTRACT_PATH","JSON_EXTRACT_PATH_TEXT","JSON_OBJECT","JSON_OBJECT_AGG","JSON_OBJECT_KEYS","JSON_POPULATE_RECORD","JSON_POPULATE_RECORDSET","JSON_STRIP_NULLS","JSON_TO_RECORD","JSON_TO_RECORDSET","JSON_TYPEOF","ROW_TO_JSON","TO_JSON","TO_JSONB","TO_TIMESTAMP","CURRVAL","LASTVAL","NEXTVAL","SETVAL","COALESCE","GREATEST","LEAST","NULLIF","ARRAY_AGG","ARRAY_APPEND","ARRAY_CAT","ARRAY_DIMS","ARRAY_FILL","ARRAY_LENGTH","ARRAY_LOWER","ARRAY_NDIMS","ARRAY_POSITION","ARRAY_POSITIONS","ARRAY_PREPEND","ARRAY_REMOVE","ARRAY_REPLACE","ARRAY_TO_STRING","ARRAY_UPPER","CARDINALITY","STRING_TO_ARRAY","TRIM_ARRAY","UNNEST","ISEMPTY","LOWER","LOWER_INC","LOWER_INF","MULTIRANGE","RANGE_MERGE","UPPER","UPPER_INC","UPPER_INF","ARRAY_AGG","AVG","BIT_AND","BIT_OR","BIT_XOR","BOOL_AND","BOOL_OR","COALESCE","CORR","COUNT","COVAR_POP","COVAR_SAMP","CUME_DIST","DENSE_RANK","EVERY","GROUPING","JSONB_AGG","JSONB_OBJECT_AGG","JSON_AGG","JSON_OBJECT_AGG","MAX","MIN","MODE","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","RANGE_AGG","RANGE_INTERSECT_AGG","RANK","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","STDDEV","STDDEV_POP","STDDEV_SAMP","STRING_AGG","SUM","TO_JSON","TO_JSONB","VARIANCE","VAR_POP","VAR_SAMP","XMLAGG","CUME_DIST","DENSE_RANK","FIRST_VALUE","LAG","LAST_VALUE","LEAD","NTH_VALUE","NTILE","PERCENT_RANK","RANK","ROW_NUMBER","GENERATE_SERIES","GENERATE_SUBSCRIPTS","ACLDEFAULT","ACLEXPLODE","COL_DESCRIPTION","CURRENT_CATALOG","CURRENT_DATABASE","CURRENT_QUERY","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SCHEMAS","CURRENT_USER","FORMAT_TYPE","HAS_ANY_COLUMN_PRIVILEGE","HAS_COLUMN_PRIVILEGE","HAS_DATABASE_PRIVILEGE","HAS_FOREIGN_DATA_WRAPPER_PRIVILEGE","HAS_FUNCTION_PRIVILEGE","HAS_LANGUAGE_PRIVILEGE","HAS_SCHEMA_PRIVILEGE","HAS_SEQUENCE_PRIVILEGE","HAS_SERVER_PRIVILEGE","HAS_TABLESPACE_PRIVILEGE","HAS_TABLE_PRIVILEGE","HAS_TYPE_PRIVILEGE","INET_CLIENT_ADDR","INET_CLIENT_PORT","INET_SERVER_ADDR","INET_SERVER_PORT","MAKEACLITEM","OBJ_DESCRIPTION","PG_BACKEND_PID","PG_BLOCKING_PIDS","PG_COLLATION_IS_VISIBLE","PG_CONF_LOAD_TIME","PG_CONTROL_CHECKPOINT","PG_CONTROL_INIT","PG_CONTROL_SYSTEM","PG_CONVERSION_IS_VISIBLE","PG_CURRENT_LOGFILE","PG_CURRENT_SNAPSHOT","PG_CURRENT_XACT_ID","PG_CURRENT_XACT_ID_IF_ASSIGNED","PG_DESCRIBE_OBJECT","PG_FUNCTION_IS_VISIBLE","PG_GET_CATALOG_FOREIGN_KEYS","PG_GET_CONSTRAINTDEF","PG_GET_EXPR","PG_GET_FUNCTIONDEF","PG_GET_FUNCTION_ARGUMENTS","PG_GET_FUNCTION_IDENTITY_ARGUMENTS","PG_GET_FUNCTION_RESULT","PG_GET_INDEXDEF","PG_GET_KEYWORDS","PG_GET_OBJECT_ADDRESS","PG_GET_OWNED_SEQUENCE","PG_GET_RULEDEF","PG_GET_SERIAL_SEQUENCE","PG_GET_STATISTICSOBJDEF","PG_GET_TRIGGERDEF","PG_GET_USERBYID","PG_GET_VIEWDEF","PG_HAS_ROLE","PG_IDENTIFY_OBJECT","PG_IDENTIFY_OBJECT_AS_ADDRESS","PG_INDEXAM_HAS_PROPERTY","PG_INDEX_COLUMN_HAS_PROPERTY","PG_INDEX_HAS_PROPERTY","PG_IS_OTHER_TEMP_SCHEMA","PG_JIT_AVAILABLE","PG_LAST_COMMITTED_XACT","PG_LISTENING_CHANNELS","PG_MY_TEMP_SCHEMA","PG_NOTIFICATION_QUEUE_USAGE","PG_OPCLASS_IS_VISIBLE","PG_OPERATOR_IS_VISIBLE","PG_OPFAMILY_IS_VISIBLE","PG_OPTIONS_TO_TABLE","PG_POSTMASTER_START_TIME","PG_SAFE_SNAPSHOT_BLOCKING_PIDS","PG_SNAPSHOT_XIP","PG_SNAPSHOT_XMAX","PG_SNAPSHOT_XMIN","PG_STATISTICS_OBJ_IS_VISIBLE","PG_TABLESPACE_DATABASES","PG_TABLESPACE_LOCATION","PG_TABLE_IS_VISIBLE","PG_TRIGGER_DEPTH","PG_TS_CONFIG_IS_VISIBLE","PG_TS_DICT_IS_VISIBLE","PG_TS_PARSER_IS_VISIBLE","PG_TS_TEMPLATE_IS_VISIBLE","PG_TYPEOF","PG_TYPE_IS_VISIBLE","PG_VISIBLE_IN_SNAPSHOT","PG_XACT_COMMIT_TIMESTAMP","PG_XACT_COMMIT_TIMESTAMP_ORIGIN","PG_XACT_STATUS","PQSERVERVERSION","ROW_SECURITY_ACTIVE","SESSION_USER","SHOBJ_DESCRIPTION","TO_REGCLASS","TO_REGCOLLATION","TO_REGNAMESPACE","TO_REGOPER","TO_REGOPERATOR","TO_REGPROC","TO_REGPROCEDURE","TO_REGROLE","TO_REGTYPE","TXID_CURRENT","TXID_CURRENT_IF_ASSIGNED","TXID_CURRENT_SNAPSHOT","TXID_SNAPSHOT_XIP","TXID_SNAPSHOT_XMAX","TXID_SNAPSHOT_XMIN","TXID_STATUS","TXID_VISIBLE_IN_SNAPSHOT","USER","VERSION","BRIN_DESUMMARIZE_RANGE","BRIN_SUMMARIZE_NEW_VALUES","BRIN_SUMMARIZE_RANGE","CONVERT_FROM","CURRENT_SETTING","GIN_CLEAN_PENDING_LIST","PG_ADVISORY_LOCK","PG_ADVISORY_LOCK_SHARED","PG_ADVISORY_UNLOCK","PG_ADVISORY_UNLOCK_ALL","PG_ADVISORY_UNLOCK_SHARED","PG_ADVISORY_XACT_LOCK","PG_ADVISORY_XACT_LOCK_SHARED","PG_BACKUP_START_TIME","PG_CANCEL_BACKEND","PG_COLLATION_ACTUAL_VERSION","PG_COLUMN_COMPRESSION","PG_COLUMN_SIZE","PG_COPY_LOGICAL_REPLICATION_SLOT","PG_COPY_PHYSICAL_REPLICATION_SLOT","PG_CREATE_LOGICAL_REPLICATION_SLOT","PG_CREATE_PHYSICAL_REPLICATION_SLOT","PG_CREATE_RESTORE_POINT","PG_CURRENT_WAL_FLUSH_LSN","PG_CURRENT_WAL_INSERT_LSN","PG_CURRENT_WAL_LSN","PG_DATABASE_SIZE","PG_DROP_REPLICATION_SLOT","PG_EXPORT_SNAPSHOT","PG_FILENODE_RELATION","PG_GET_WAL_REPLAY_PAUSE_STATE","PG_IMPORT_SYSTEM_COLLATIONS","PG_INDEXES_SIZE","PG_IS_IN_BACKUP","PG_IS_IN_RECOVERY","PG_IS_WAL_REPLAY_PAUSED","PG_LAST_WAL_RECEIVE_LSN","PG_LAST_WAL_REPLAY_LSN","PG_LAST_XACT_REPLAY_TIMESTAMP","PG_LOGICAL_EMIT_MESSAGE","PG_LOGICAL_SLOT_GET_BINARY_CHANGES","PG_LOGICAL_SLOT_GET_CHANGES","PG_LOGICAL_SLOT_PEEK_BINARY_CHANGES","PG_LOGICAL_SLOT_PEEK_CHANGES","PG_LOG_BACKEND_MEMORY_CONTEXTS","PG_LS_ARCHIVE_STATUSDIR","PG_LS_DIR","PG_LS_LOGDIR","PG_LS_TMPDIR","PG_LS_WALDIR","PG_PARTITION_ANCESTORS","PG_PARTITION_ROOT","PG_PARTITION_TREE","PG_PROMOTE","PG_READ_BINARY_FILE","PG_READ_FILE","PG_RELATION_FILENODE","PG_RELATION_FILEPATH","PG_RELATION_SIZE","PG_RELOAD_CONF","PG_REPLICATION_ORIGIN_ADVANCE","PG_REPLICATION_ORIGIN_CREATE","PG_REPLICATION_ORIGIN_DROP","PG_REPLICATION_ORIGIN_OID","PG_REPLICATION_ORIGIN_PROGRESS","PG_REPLICATION_ORIGIN_SESSION_IS_SETUP","PG_REPLICATION_ORIGIN_SESSION_PROGRESS","PG_REPLICATION_ORIGIN_SESSION_RESET","PG_REPLICATION_ORIGIN_SESSION_SETUP","PG_REPLICATION_ORIGIN_XACT_RESET","PG_REPLICATION_ORIGIN_XACT_SETUP","PG_REPLICATION_SLOT_ADVANCE","PG_ROTATE_LOGFILE","PG_SIZE_BYTES","PG_SIZE_PRETTY","PG_START_BACKUP","PG_STAT_FILE","PG_STOP_BACKUP","PG_SWITCH_WAL","PG_TABLESPACE_SIZE","PG_TABLE_SIZE","PG_TERMINATE_BACKEND","PG_TOTAL_RELATION_SIZE","PG_TRY_ADVISORY_LOCK","PG_TRY_ADVISORY_LOCK_SHARED","PG_TRY_ADVISORY_XACT_LOCK","PG_TRY_ADVISORY_XACT_LOCK_SHARED","PG_WALFILE_NAME","PG_WALFILE_NAME_OFFSET","PG_WAL_LSN_DIFF","PG_WAL_REPLAY_PAUSE","PG_WAL_REPLAY_RESUME","SET_CONFIG","SUPPRESS_REDUNDANT_UPDATES_TRIGGER","TSVECTOR_UPDATE_TRIGGER","TSVECTOR_UPDATE_TRIGGER_COLUMN","PG_EVENT_TRIGGER_DDL_COMMANDS","PG_EVENT_TRIGGER_DROPPED_OBJECTS","PG_EVENT_TRIGGER_TABLE_REWRITE_OID","PG_EVENT_TRIGGER_TABLE_REWRITE_REASON","PG_GET_OBJECT_ADDRESS","PG_MCV_LIST_ITEMS","CAST"],nestedBlockComments:!0,extraParens:["[]"],underscoresInNumbers:!0,stringTypes:["$$",{quote:"''-qq",prefixes:["U&"]},{quote:"''-qq-bs",prefixes:["E"],requirePrefix:!0},{quote:"''-raw",prefixes:["B","X"],requirePrefix:!0}],identTypes:[{quote:'""-qq',prefixes:["U&"]}],identChars:{rest:"$"},paramTypes:{numbered:["$"]},operators:["%","^","|/","||/","@",":=","&","|","#","~","<<",">>","~>~","~<~","~>=~","~<=~","@-@","@@","##","<->","&&","&<","&>","<<|","&<|","|>>","|&>","<^","^>","?#","?-","?|","?-|","?||","@>","<@","~=","?","@?","?&","->","->>","#>","#>>","#-","=>",">>=","<<=","~~","~~*","!~~","!~~*","~","~*","!~","!~*","-|-","||","@@@","!!","^@","<%","%>","<<%","%>>","<<->","<->>","<<<->","<->>>","::",":","<#>","<=>","<+>","<~>","<%>"],operatorKeyword:!0},formatOptions:{alwaysDenseOperators:["::",":"],onelineClauses:[...lS,...l_],tabularOnelineClauses:l_}},lC=nG(["SELECT [ALL | DISTINCT]"]),lL=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY","HAVING","QUALIFY","PARTITION BY","ORDER BY","LIMIT","OFFSET","INSERT INTO","VALUES","SET"]),ly=nG(["CREATE [TEMPORARY | TEMP | LOCAL TEMPORARY | LOCAL TEMP] TABLE [IF NOT EXISTS]"]),lg=nG(["CREATE [OR REPLACE | MATERIALIZED] VIEW","UPDATE","DELETE [FROM]","DROP TABLE [IF EXISTS]","ALTER TABLE","ALTER TABLE APPEND","ADD [COLUMN]","DROP [COLUMN]","RENAME TO","RENAME COLUMN","ALTER COLUMN","TYPE","ENCODE","TRUNCATE [TABLE]","ABORT","ALTER DATABASE","ALTER DATASHARE","ALTER DEFAULT PRIVILEGES","ALTER GROUP","ALTER MATERIALIZED VIEW","ALTER PROCEDURE","ALTER SCHEMA","ALTER USER","ANALYSE","ANALYZE","ANALYSE COMPRESSION","ANALYZE COMPRESSION","BEGIN","CALL","CANCEL","CLOSE","COMMIT","COPY","CREATE DATABASE","CREATE DATASHARE","CREATE EXTERNAL FUNCTION","CREATE EXTERNAL SCHEMA","CREATE EXTERNAL TABLE","CREATE FUNCTION","CREATE GROUP","CREATE LIBRARY","CREATE MODEL","CREATE PROCEDURE","CREATE SCHEMA","CREATE USER","DEALLOCATE","DECLARE","DESC DATASHARE","DROP DATABASE","DROP DATASHARE","DROP FUNCTION","DROP GROUP","DROP LIBRARY","DROP MODEL","DROP MATERIALIZED VIEW","DROP PROCEDURE","DROP SCHEMA","DROP USER","DROP VIEW","DROP","EXECUTE","EXPLAIN","FETCH","GRANT","LOCK","PREPARE","REFRESH MATERIALIZED VIEW","RESET","REVOKE","ROLLBACK","SELECT INTO","SET SESSION AUTHORIZATION","SET SESSION CHARACTERISTICS","SHOW","SHOW EXTERNAL TABLE","SHOW MODEL","SHOW DATASHARES","SHOW PROCEDURE","SHOW TABLE","SHOW VIEW","START TRANSACTION","UNLOAD","VACUUM"]),lP=nG(["UNION [ALL]","EXCEPT","INTERSECT","MINUS"]),lb=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT | FULL} [OUTER] JOIN"]),lD=nG(["NULL AS","DATA CATALOG","HIVE METASTORE","{ROWS | RANGE} BETWEEN"]),lv=nG([]),lM={name:"redshift",tokenizerOptions:{reservedSelect:lC,reservedClauses:[...lL,...ly,...lg],reservedSetOperations:lP,reservedJoins:lb,reservedKeywordPhrases:lD,reservedDataTypePhrases:lv,reservedKeywords:["AES128","AES256","ALL","ALLOWOVERWRITE","ANY","AS","ASC","AUTHORIZATION","BACKUP","BETWEEN","BINARY","BOTH","CHECK","COLUMN","CONSTRAINT","CREATE","CROSS","DEFAULT","DEFERRABLE","DEFLATE","DEFRAG","DESC","DISABLE","DISTINCT","DO","ENABLE","ENCODE","ENCRYPT","ENCRYPTION","EXPLICIT","FALSE","FOR","FOREIGN","FREEZE","FROM","FULL","GLOBALDICT256","GLOBALDICT64K","GROUP","IDENTITY","IGNORE","ILIKE","IN","INITIALLY","INNER","INTO","IS","ISNULL","LANGUAGE","LEADING","LIKE","LIMIT","LOCALTIME","LOCALTIMESTAMP","LUN","LUNS","MINUS","NATURAL","NEW","NOT","NOTNULL","NULL","NULLS","OFF","OFFLINE","OFFSET","OID","OLD","ON","ONLY","OPEN","ORDER","OUTER","OVERLAPS","PARALLEL","PARTITION","PERCENT","PERMISSIONS","PLACING","PRIMARY","RECOVER","REFERENCES","REJECTLOG","RESORT","RESPECT","RESTORE","SIMILAR","SNAPSHOT","SOME","SYSTEM","TABLE","TAG","TDES","THEN","TIMESTAMP","TO","TOP","TRAILING","TRUE","UNIQUE","USING","VERBOSE","WALLET","WITHOUT","ACCEPTANYDATE","ACCEPTINVCHARS","BLANKSASNULL","DATEFORMAT","EMPTYASNULL","ENCODING","ESCAPE","EXPLICIT_IDS","FILLRECORD","IGNOREBLANKLINES","IGNOREHEADER","REMOVEQUOTES","ROUNDEC","TIMEFORMAT","TRIMBLANKS","TRUNCATECOLUMNS","COMPROWS","COMPUPDATE","MAXERROR","NOLOAD","STATUPDATE","FORMAT","CSV","DELIMITER","FIXEDWIDTH","SHAPEFILE","AVRO","JSON","PARQUET","ORC","ACCESS_KEY_ID","CREDENTIALS","ENCRYPTED","IAM_ROLE","MASTER_SYMMETRIC_KEY","SECRET_ACCESS_KEY","SESSION_TOKEN","BZIP2","GZIP","LZOP","ZSTD","MANIFEST","READRATIO","REGION","SSH","RAW","AZ64","BYTEDICT","DELTA","DELTA32K","LZO","MOSTLY8","MOSTLY16","MOSTLY32","RUNLENGTH","TEXT255","TEXT32K","CATALOG_ROLE","SECRET_ARN","EXTERNAL","AUTO","EVEN","KEY","PREDICATE","COMPRESSION"],reservedDataTypes:["ARRAY","BIGINT","BPCHAR","CHAR","CHARACTER VARYING","CHARACTER","DECIMAL","INT","INT2","INT4","INT8","INTEGER","NCHAR","NUMERIC","NVARCHAR","SMALLINT","TEXT","VARBYTE","VARCHAR"],reservedFunctionNames:["ANY_VALUE","APPROXIMATE PERCENTILE_DISC","AVG","COUNT","LISTAGG","MAX","MEDIAN","MIN","PERCENTILE_CONT","STDDEV_SAMP","STDDEV_POP","SUM","VAR_SAMP","VAR_POP","array_concat","array_flatten","get_array_length","split_to_array","subarray","BIT_AND","BIT_OR","BOOL_AND","BOOL_OR","COALESCE","DECODE","GREATEST","LEAST","NVL","NVL2","NULLIF","ADD_MONTHS","AT TIME ZONE","CONVERT_TIMEZONE","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATE_CMP","DATE_CMP_TIMESTAMP","DATE_CMP_TIMESTAMPTZ","DATE_PART_YEAR","DATEADD","DATEDIFF","DATE_PART","DATE_TRUNC","EXTRACT","GETDATE","INTERVAL_CMP","LAST_DAY","MONTHS_BETWEEN","NEXT_DAY","SYSDATE","TIMEOFDAY","TIMESTAMP_CMP","TIMESTAMP_CMP_DATE","TIMESTAMP_CMP_TIMESTAMPTZ","TIMESTAMPTZ_CMP","TIMESTAMPTZ_CMP_DATE","TIMESTAMPTZ_CMP_TIMESTAMP","TIMEZONE","TO_TIMESTAMP","TRUNC","AddBBox","DropBBox","GeometryType","ST_AddPoint","ST_Angle","ST_Area","ST_AsBinary","ST_AsEWKB","ST_AsEWKT","ST_AsGeoJSON","ST_AsText","ST_Azimuth","ST_Boundary","ST_Collect","ST_Contains","ST_ContainsProperly","ST_ConvexHull","ST_CoveredBy","ST_Covers","ST_Crosses","ST_Dimension","ST_Disjoint","ST_Distance","ST_DistanceSphere","ST_DWithin","ST_EndPoint","ST_Envelope","ST_Equals","ST_ExteriorRing","ST_Force2D","ST_Force3D","ST_Force3DM","ST_Force3DZ","ST_Force4D","ST_GeometryN","ST_GeometryType","ST_GeomFromEWKB","ST_GeomFromEWKT","ST_GeomFromText","ST_GeomFromWKB","ST_InteriorRingN","ST_Intersects","ST_IsPolygonCCW","ST_IsPolygonCW","ST_IsClosed","ST_IsCollection","ST_IsEmpty","ST_IsSimple","ST_IsValid","ST_Length","ST_LengthSphere","ST_Length2D","ST_LineFromMultiPoint","ST_LineInterpolatePoint","ST_M","ST_MakeEnvelope","ST_MakeLine","ST_MakePoint","ST_MakePolygon","ST_MemSize","ST_MMax","ST_MMin","ST_Multi","ST_NDims","ST_NPoints","ST_NRings","ST_NumGeometries","ST_NumInteriorRings","ST_NumPoints","ST_Perimeter","ST_Perimeter2D","ST_Point","ST_PointN","ST_Points","ST_Polygon","ST_RemovePoint","ST_Reverse","ST_SetPoint","ST_SetSRID","ST_Simplify","ST_SRID","ST_StartPoint","ST_Touches","ST_Within","ST_X","ST_XMax","ST_XMin","ST_Y","ST_YMax","ST_YMin","ST_Z","ST_ZMax","ST_ZMin","SupportsBBox","CHECKSUM","FUNC_SHA1","FNV_HASH","MD5","SHA","SHA1","SHA2","HLL","HLL_CREATE_SKETCH","HLL_CARDINALITY","HLL_COMBINE","IS_VALID_JSON","IS_VALID_JSON_ARRAY","JSON_ARRAY_LENGTH","JSON_EXTRACT_ARRAY_ELEMENT_TEXT","JSON_EXTRACT_PATH_TEXT","JSON_PARSE","JSON_SERIALIZE","ABS","ACOS","ASIN","ATAN","ATAN2","CBRT","CEILING","CEIL","COS","COT","DEGREES","DEXP","DLOG1","DLOG10","EXP","FLOOR","LN","LOG","MOD","PI","POWER","RADIANS","RANDOM","ROUND","SIN","SIGN","SQRT","TAN","TO_HEX","TRUNC","EXPLAIN_MODEL","ASCII","BPCHARCMP","BTRIM","BTTEXT_PATTERN_CMP","CHAR_LENGTH","CHARACTER_LENGTH","CHARINDEX","CHR","COLLATE","CONCAT","CRC32","DIFFERENCE","INITCAP","LEFT","RIGHT","LEN","LENGTH","LOWER","LPAD","RPAD","LTRIM","OCTETINDEX","OCTET_LENGTH","POSITION","QUOTE_IDENT","QUOTE_LITERAL","REGEXP_COUNT","REGEXP_INSTR","REGEXP_REPLACE","REGEXP_SUBSTR","REPEAT","REPLACE","REPLICATE","REVERSE","RTRIM","SOUNDEX","SPLIT_PART","STRPOS","STRTOL","SUBSTRING","TEXTLEN","TRANSLATE","TRIM","UPPER","decimal_precision","decimal_scale","is_array","is_bigint","is_boolean","is_char","is_decimal","is_float","is_integer","is_object","is_scalar","is_smallint","is_varchar","json_typeof","AVG","COUNT","CUME_DIST","DENSE_RANK","FIRST_VALUE","LAST_VALUE","LAG","LEAD","LISTAGG","MAX","MEDIAN","MIN","NTH_VALUE","NTILE","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","RANK","RATIO_TO_REPORT","ROW_NUMBER","STDDEV_SAMP","STDDEV_POP","SUM","VAR_SAMP","VAR_POP","CAST","CONVERT","TO_CHAR","TO_DATE","TO_NUMBER","TEXT_TO_INT_ALT","TEXT_TO_NUMERIC_ALT","CHANGE_QUERY_PRIORITY","CHANGE_SESSION_PRIORITY","CHANGE_USER_PRIORITY","CURRENT_SETTING","PG_CANCEL_BACKEND","PG_TERMINATE_BACKEND","REBOOT_CLUSTER","SET_CONFIG","CURRENT_AWS_ACCOUNT","CURRENT_DATABASE","CURRENT_NAMESPACE","CURRENT_SCHEMA","CURRENT_SCHEMAS","CURRENT_USER","CURRENT_USER_ID","HAS_ASSUMEROLE_PRIVILEGE","HAS_DATABASE_PRIVILEGE","HAS_SCHEMA_PRIVILEGE","HAS_TABLE_PRIVILEGE","PG_BACKEND_PID","PG_GET_COLS","PG_GET_GRANTEE_BY_IAM_ROLE","PG_GET_IAM_ROLE_BY_USER","PG_GET_LATE_BINDING_VIEW_COLS","PG_LAST_COPY_COUNT","PG_LAST_COPY_ID","PG_LAST_UNLOAD_ID","PG_LAST_QUERY_ID","PG_LAST_UNLOAD_COUNT","SESSION_USER","SLICE_NUM","USER","VERSION"],extraParens:["[]"],stringTypes:["''-qq"],identTypes:['""-qq'],identChars:{first:"#"},paramTypes:{numbered:["$"]},operators:["^","%","@","|/","||/","&","|","~","<<",">>","||","::"]},formatOptions:{alwaysDenseOperators:["::"],onelineClauses:[...ly,...lg],tabularOnelineClauses:lg}},lU=nG(["SELECT [ALL | DISTINCT]"]),lw=nG(["WITH","FROM","WHERE","GROUP BY","HAVING","WINDOW","PARTITION BY","ORDER BY","SORT BY","CLUSTER BY","DISTRIBUTE BY","LIMIT","INSERT [INTO | OVERWRITE] [TABLE]","VALUES","INSERT OVERWRITE [LOCAL] DIRECTORY","LOAD DATA [LOCAL] INPATH","[OVERWRITE] INTO TABLE"]),lG=nG(["CREATE [EXTERNAL] TABLE [IF NOT EXISTS]"]),lB=nG(["CREATE [OR REPLACE] [GLOBAL TEMPORARY | TEMPORARY] VIEW [IF NOT EXISTS]","DROP TABLE [IF EXISTS]","ALTER TABLE","ADD COLUMNS","DROP {COLUMN | COLUMNS}","RENAME TO","RENAME COLUMN","ALTER COLUMN","TRUNCATE TABLE","LATERAL VIEW","ALTER DATABASE","ALTER VIEW","CREATE DATABASE","CREATE FUNCTION","DROP DATABASE","DROP FUNCTION","DROP VIEW","REPAIR TABLE","USE DATABASE","TABLESAMPLE","PIVOT","TRANSFORM","EXPLAIN","ADD FILE","ADD JAR","ANALYZE TABLE","CACHE TABLE","CLEAR CACHE","DESCRIBE DATABASE","DESCRIBE FUNCTION","DESCRIBE QUERY","DESCRIBE TABLE","LIST FILE","LIST JAR","REFRESH","REFRESH TABLE","REFRESH FUNCTION","RESET","SHOW COLUMNS","SHOW CREATE TABLE","SHOW DATABASES","SHOW FUNCTIONS","SHOW PARTITIONS","SHOW TABLE EXTENDED","SHOW TABLES","SHOW TBLPROPERTIES","SHOW VIEWS","UNCACHE TABLE"]),lF=nG(["UNION [ALL | DISTINCT]","EXCEPT [ALL | DISTINCT]","INTERSECT [ALL | DISTINCT]"]),lH=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT | FULL} [OUTER] JOIN","[LEFT] {ANTI | SEMI} JOIN","NATURAL [LEFT] {ANTI | SEMI} JOIN"]),lx=nG(["ON DELETE","ON UPDATE","CURRENT ROW","{ROWS | RANGE} BETWEEN"]),lk=nG([]),lY={name:"spark",tokenizerOptions:{reservedSelect:lU,reservedClauses:[...lw,...lG,...lB],reservedSetOperations:lF,reservedJoins:lH,reservedKeywordPhrases:lx,reservedDataTypePhrases:lk,supportsXor:!0,reservedKeywords:["ADD","AFTER","ALL","ALTER","ANALYZE","AND","ANTI","ANY","ARCHIVE","AS","ASC","AT","AUTHORIZATION","BETWEEN","BOTH","BUCKET","BUCKETS","BY","CACHE","CASCADE","CAST","CHANGE","CHECK","CLEAR","CLUSTER","CLUSTERED","CODEGEN","COLLATE","COLLECTION","COLUMN","COLUMNS","COMMENT","COMMIT","COMPACT","COMPACTIONS","COMPUTE","CONCATENATE","CONSTRAINT","COST","CREATE","CROSS","CUBE","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","DATA","DATABASE","DATABASES","DAY","DBPROPERTIES","DEFINED","DELETE","DELIMITED","DESC","DESCRIBE","DFS","DIRECTORIES","DIRECTORY","DISTINCT","DISTRIBUTE","DIV","DROP","ESCAPE","ESCAPED","EXCEPT","EXCHANGE","EXISTS","EXPORT","EXTENDED","EXTERNAL","EXTRACT","FALSE","FETCH","FIELDS","FILTER","FILEFORMAT","FIRST","FIRST_VALUE","FOLLOWING","FOR","FOREIGN","FORMAT","FORMATTED","FULL","FUNCTION","FUNCTIONS","GLOBAL","GRANT","GROUP","GROUPING","HOUR","IF","IGNORE","IMPORT","IN","INDEX","INDEXES","INNER","INPATH","INPUTFORMAT","INTERSECT","INTO","IS","ITEMS","KEYS","LAST","LAST_VALUE","LATERAL","LAZY","LEADING","LEFT","LIKE","LINES","LIST","LOCAL","LOCATION","LOCK","LOCKS","LOGICAL","MACRO","MATCHED","MERGE","MINUTE","MONTH","MSCK","NAMESPACE","NAMESPACES","NATURAL","NO","NOT","NULL","NULLS","OF","ONLY","OPTION","OPTIONS","OR","ORDER","OUT","OUTER","OUTPUTFORMAT","OVER","OVERLAPS","OVERLAY","OVERWRITE","OWNER","PARTITION","PARTITIONED","PARTITIONS","PERCENT","PLACING","POSITION","PRECEDING","PRIMARY","PRINCIPALS","PROPERTIES","PURGE","QUERY","RANGE","RECORDREADER","RECORDWRITER","RECOVER","REDUCE","REFERENCES","RENAME","REPAIR","REPLACE","RESPECT","RESTRICT","REVOKE","RIGHT","RLIKE","ROLE","ROLES","ROLLBACK","ROLLUP","ROW","ROWS","SCHEMA","SECOND","SELECT","SEMI","SEPARATED","SERDE","SERDEPROPERTIES","SESSION_USER","SETS","SHOW","SKEWED","SOME","SORT","SORTED","START","STATISTICS","STORED","STRATIFY","SUBSTR","SUBSTRING","TABLE","TABLES","TBLPROPERTIES","TEMPORARY","TERMINATED","THEN","TO","TOUCH","TRAILING","TRANSACTION","TRANSACTIONS","TRIM","TRUE","TRUNCATE","UNARCHIVE","UNBOUNDED","UNCACHE","UNIQUE","UNKNOWN","UNLOCK","UNSET","USE","USER","USING","VIEW","WINDOW","YEAR","ANALYSE","ARRAY_ZIP","COALESCE","CONTAINS","CONVERT","DAYS","DAY_HOUR","DAY_MINUTE","DAY_SECOND","DECODE","DEFAULT","DISTINCTROW","ENCODE","EXPLODE","EXPLODE_OUTER","FIXED","GREATEST","GROUP_CONCAT","HOURS","HOUR_MINUTE","HOUR_SECOND","IFNULL","LEAST","LEVEL","MINUTE_SECOND","NULLIF","OFFSET","ON","OPTIMIZE","REGEXP","SEPARATOR","SIZE","TYPE","TYPES","UNSIGNED","VARIABLES","YEAR_MONTH"],reservedDataTypes:["ARRAY","BIGINT","BINARY","BOOLEAN","BYTE","CHAR","DATE","DEC","DECIMAL","DOUBLE","FLOAT","INT","INTEGER","INTERVAL","LONG","MAP","NUMERIC","REAL","SHORT","SMALLINT","STRING","STRUCT","TIMESTAMP_LTZ","TIMESTAMP_NTZ","TIMESTAMP","TINYINT","VARCHAR"],reservedFunctionNames:["APPROX_COUNT_DISTINCT","APPROX_PERCENTILE","AVG","BIT_AND","BIT_OR","BIT_XOR","BOOL_AND","BOOL_OR","COLLECT_LIST","COLLECT_SET","CORR","COUNT","COUNT","COUNT","COUNT_IF","COUNT_MIN_SKETCH","COVAR_POP","COVAR_SAMP","EVERY","FIRST","FIRST_VALUE","GROUPING","GROUPING_ID","KURTOSIS","LAST","LAST_VALUE","MAX","MAX_BY","MEAN","MIN","MIN_BY","PERCENTILE","PERCENTILE","PERCENTILE_APPROX","SKEWNESS","STD","STDDEV","STDDEV_POP","STDDEV_SAMP","SUM","VAR_POP","VAR_SAMP","VARIANCE","CUME_DIST","DENSE_RANK","LAG","LEAD","NTH_VALUE","NTILE","PERCENT_RANK","RANK","ROW_NUMBER","ARRAY","ARRAY_CONTAINS","ARRAY_DISTINCT","ARRAY_EXCEPT","ARRAY_INTERSECT","ARRAY_JOIN","ARRAY_MAX","ARRAY_MIN","ARRAY_POSITION","ARRAY_REMOVE","ARRAY_REPEAT","ARRAY_UNION","ARRAYS_OVERLAP","ARRAYS_ZIP","FLATTEN","SEQUENCE","SHUFFLE","SLICE","SORT_ARRAY","ELEMENT_AT","ELEMENT_AT","MAP_CONCAT","MAP_ENTRIES","MAP_FROM_ARRAYS","MAP_FROM_ENTRIES","MAP_KEYS","MAP_VALUES","STR_TO_MAP","ADD_MONTHS","CURRENT_DATE","CURRENT_DATE","CURRENT_TIMESTAMP","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","DATE_ADD","DATE_FORMAT","DATE_FROM_UNIX_DATE","DATE_PART","DATE_SUB","DATE_TRUNC","DATEDIFF","DAY","DAYOFMONTH","DAYOFWEEK","DAYOFYEAR","EXTRACT","FROM_UNIXTIME","FROM_UTC_TIMESTAMP","HOUR","LAST_DAY","MAKE_DATE","MAKE_DT_INTERVAL","MAKE_INTERVAL","MAKE_TIMESTAMP","MAKE_YM_INTERVAL","MINUTE","MONTH","MONTHS_BETWEEN","NEXT_DAY","NOW","QUARTER","SECOND","SESSION_WINDOW","TIMESTAMP_MICROS","TIMESTAMP_MILLIS","TIMESTAMP_SECONDS","TO_DATE","TO_TIMESTAMP","TO_UNIX_TIMESTAMP","TO_UTC_TIMESTAMP","TRUNC","UNIX_DATE","UNIX_MICROS","UNIX_MILLIS","UNIX_SECONDS","UNIX_TIMESTAMP","WEEKDAY","WEEKOFYEAR","WINDOW","YEAR","FROM_JSON","GET_JSON_OBJECT","JSON_ARRAY_LENGTH","JSON_OBJECT_KEYS","JSON_TUPLE","SCHEMA_OF_JSON","TO_JSON","ABS","ACOS","ACOSH","AGGREGATE","ARRAY_SORT","ASCII","ASIN","ASINH","ASSERT_TRUE","ATAN","ATAN2","ATANH","BASE64","BIN","BIT_COUNT","BIT_GET","BIT_LENGTH","BROUND","BTRIM","CARDINALITY","CBRT","CEIL","CEILING","CHAR_LENGTH","CHARACTER_LENGTH","CHR","CONCAT","CONCAT_WS","CONV","COS","COSH","COT","CRC32","CURRENT_CATALOG","CURRENT_DATABASE","CURRENT_USER","DEGREES","ELT","EXP","EXPM1","FACTORIAL","FIND_IN_SET","FLOOR","FORALL","FORMAT_NUMBER","FORMAT_STRING","FROM_CSV","GETBIT","HASH","HEX","HYPOT","INITCAP","INLINE","INLINE_OUTER","INPUT_FILE_BLOCK_LENGTH","INPUT_FILE_BLOCK_START","INPUT_FILE_NAME","INSTR","ISNAN","ISNOTNULL","ISNULL","JAVA_METHOD","LCASE","LEFT","LENGTH","LEVENSHTEIN","LN","LOCATE","LOG","LOG10","LOG1P","LOG2","LOWER","LPAD","LTRIM","MAP_FILTER","MAP_ZIP_WITH","MD5","MOD","MONOTONICALLY_INCREASING_ID","NAMED_STRUCT","NANVL","NEGATIVE","NVL","NVL2","OCTET_LENGTH","OVERLAY","PARSE_URL","PI","PMOD","POSEXPLODE","POSEXPLODE_OUTER","POSITION","POSITIVE","POW","POWER","PRINTF","RADIANS","RAISE_ERROR","RAND","RANDN","RANDOM","REFLECT","REGEXP_EXTRACT","REGEXP_EXTRACT_ALL","REGEXP_LIKE","REGEXP_REPLACE","REPEAT","REPLACE","REVERSE","RIGHT","RINT","ROUND","RPAD","RTRIM","SCHEMA_OF_CSV","SENTENCES","SHA","SHA1","SHA2","SHIFTLEFT","SHIFTRIGHT","SHIFTRIGHTUNSIGNED","SIGN","SIGNUM","SIN","SINH","SOUNDEX","SPACE","SPARK_PARTITION_ID","SPLIT","SQRT","STACK","SUBSTR","SUBSTRING","SUBSTRING_INDEX","TAN","TANH","TO_CSV","TRANSFORM_KEYS","TRANSFORM_VALUES","TRANSLATE","TRIM","TRY_ADD","TRY_DIVIDE","TYPEOF","UCASE","UNBASE64","UNHEX","UPPER","UUID","VERSION","WIDTH_BUCKET","XPATH","XPATH_BOOLEAN","XPATH_DOUBLE","XPATH_FLOAT","XPATH_INT","XPATH_LONG","XPATH_NUMBER","XPATH_SHORT","XPATH_STRING","XXHASH64","ZIP_WITH","CAST","COALESCE","NULLIF"],extraParens:["[]"],stringTypes:["''-bs",'""-bs',{quote:"''-raw",prefixes:["R","X"],requirePrefix:!0},{quote:'""-raw',prefixes:["R","X"],requirePrefix:!0}],identTypes:["``"],identChars:{allowFirstCharNumber:!0},variableTypes:[{quote:"{}",prefixes:["$"],requirePrefix:!0}],operators:["%","~","^","|","&","<=>","==","!","||","->"],postProcess:function(e){return e.map((t,r)=>{let a=e[r-1]||nK,s=e[r+1]||nK;return nq.WINDOW(t)&&s.type===ew.OPEN_PAREN?Object.assign(Object.assign({},t),{type:ew.RESERVED_FUNCTION_NAME}):"ITEMS"!==t.text||t.type!==ew.RESERVED_KEYWORD||"COLLECTION"===a.text&&"TERMINATED"===s.text?t:Object.assign(Object.assign({},t),{type:ew.IDENTIFIER,text:t.raw})})}},formatOptions:{onelineClauses:[...lG,...lB],tabularOnelineClauses:lB}},lV=nG(["SELECT [ALL | DISTINCT]"]),l$=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY","HAVING","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","INSERT [OR ABORT | OR FAIL | OR IGNORE | OR REPLACE | OR ROLLBACK] INTO","REPLACE INTO","VALUES","SET","RETURNING"]),lW=nG(["CREATE [TEMPORARY | TEMP] TABLE [IF NOT EXISTS]"]),lj=nG(["CREATE [TEMPORARY | TEMP] VIEW [IF NOT EXISTS]","UPDATE [OR ABORT | OR FAIL | OR IGNORE | OR REPLACE | OR ROLLBACK]","ON CONFLICT","DELETE FROM","DROP TABLE [IF EXISTS]","ALTER TABLE","ADD [COLUMN]","DROP [COLUMN]","RENAME [COLUMN]","RENAME TO","SET SCHEMA"]),lX=nG(["UNION [ALL]","EXCEPT","INTERSECT"]),lK=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT | FULL} [OUTER] JOIN"]),lZ=nG(["ON {UPDATE | DELETE} [SET NULL | SET DEFAULT]","{ROWS | RANGE | GROUPS} BETWEEN","DO UPDATE"]),lq=nG([]),lJ={name:"sqlite",tokenizerOptions:{reservedSelect:lV,reservedClauses:[...l$,...lW,...lj],reservedSetOperations:lX,reservedJoins:lK,reservedKeywordPhrases:lZ,reservedDataTypePhrases:lq,reservedKeywords:["ABORT","ACTION","ADD","AFTER","ALL","ALTER","AND","ARE","ALWAYS","ANALYZE","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DO","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUDE","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FILTER","FIRST","FOLLOWING","FOR","FOREIGN","FROM","FULL","GENERATED","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LAST","LEFT","LIKE","LIMIT","MATCH","MATERIALIZED","NATURAL","NO","NOT","NOTHING","NOTNULL","NULL","NULLS","OF","OFFSET","ON","ONLY","OPEN","OR","ORDER","OTHERS","OUTER","OVER","PARTITION","PLAN","PRAGMA","PRECEDING","PRIMARY","QUERY","RAISE","RANGE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RETURNING","RIGHT","ROLLBACK","ROW","ROWS","SAVEPOINT","SELECT","SET","TABLE","TEMP","TEMPORARY","THEN","TIES","TO","TRANSACTION","TRIGGER","UNBOUNDED","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WINDOW","WITH","WITHOUT"],reservedDataTypes:["ANY","ARRAY","BLOB","CHARACTER","DECIMAL","INT","INTEGER","NATIVE CHARACTER","NCHAR","NUMERIC","NVARCHAR","REAL","TEXT","VARCHAR","VARYING CHARACTER"],reservedFunctionNames:["ABS","CHANGES","CHAR","COALESCE","FORMAT","GLOB","HEX","IFNULL","IIF","INSTR","LAST_INSERT_ROWID","LENGTH","LIKE","LIKELIHOOD","LIKELY","LOAD_EXTENSION","LOWER","LTRIM","NULLIF","PRINTF","QUOTE","RANDOM","RANDOMBLOB","REPLACE","ROUND","RTRIM","SIGN","SOUNDEX","SQLITE_COMPILEOPTION_GET","SQLITE_COMPILEOPTION_USED","SQLITE_OFFSET","SQLITE_SOURCE_ID","SQLITE_VERSION","SUBSTR","SUBSTRING","TOTAL_CHANGES","TRIM","TYPEOF","UNICODE","UNLIKELY","UPPER","ZEROBLOB","AVG","COUNT","GROUP_CONCAT","MAX","MIN","SUM","TOTAL","DATE","TIME","DATETIME","JULIANDAY","UNIXEPOCH","STRFTIME","row_number","rank","dense_rank","percent_rank","cume_dist","ntile","lag","lead","first_value","last_value","nth_value","ACOS","ACOSH","ASIN","ASINH","ATAN","ATAN2","ATANH","CEIL","CEILING","COS","COSH","DEGREES","EXP","FLOOR","LN","LOG","LOG","LOG10","LOG2","MOD","PI","POW","POWER","RADIANS","SIN","SINH","SQRT","TAN","TANH","TRUNC","JSON","JSON_ARRAY","JSON_ARRAY_LENGTH","JSON_ARRAY_LENGTH","JSON_EXTRACT","JSON_INSERT","JSON_OBJECT","JSON_PATCH","JSON_REMOVE","JSON_REPLACE","JSON_SET","JSON_TYPE","JSON_TYPE","JSON_VALID","JSON_QUOTE","JSON_GROUP_ARRAY","JSON_GROUP_OBJECT","JSON_EACH","JSON_TREE","CAST"],stringTypes:["''-qq",{quote:"''-raw",prefixes:["X"],requirePrefix:!0}],identTypes:['""-qq',"``","[]"],paramTypes:{positional:!0,numbered:["?"],named:[":","@","$"]},operators:["%","~","&","|","<<",">>","==","->","->>","||"]},formatOptions:{onelineClauses:[...lW,...lj],tabularOnelineClauses:lj}},lz=nG(["SELECT [ALL | DISTINCT]"]),lQ=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY [ALL | DISTINCT]","HAVING","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","FETCH {FIRST | NEXT}","INSERT INTO","VALUES","SET"]),l0=nG(["CREATE [GLOBAL TEMPORARY | LOCAL TEMPORARY] TABLE"]),l1=nG(["CREATE [RECURSIVE] VIEW","UPDATE","WHERE CURRENT OF","DELETE FROM","DROP TABLE","ALTER TABLE","ADD COLUMN","DROP [COLUMN]","RENAME COLUMN","RENAME TO","ALTER [COLUMN]","{SET | DROP} DEFAULT","ADD SCOPE","DROP SCOPE {CASCADE | RESTRICT}","RESTART WITH","TRUNCATE TABLE","SET SCHEMA"]),l2=nG(["UNION [ALL | DISTINCT]","EXCEPT [ALL | DISTINCT]","INTERSECT [ALL | DISTINCT]"]),l4=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT | FULL} [OUTER] JOIN"]),l9=nG(["ON {UPDATE | DELETE} [SET NULL | SET DEFAULT]","{ROWS | RANGE} BETWEEN"]),l5=nG([]),l3={name:"sql",tokenizerOptions:{reservedSelect:lz,reservedClauses:[...lQ,...l0,...l1],reservedSetOperations:l2,reservedJoins:l4,reservedKeywordPhrases:l9,reservedDataTypePhrases:l5,reservedKeywords:["ALL","ALLOCATE","ALTER","ANY","ARE","AS","ASC","ASENSITIVE","ASYMMETRIC","AT","ATOMIC","AUTHORIZATION","BEGIN","BETWEEN","BOTH","BY","CALL","CALLED","CASCADED","CAST","CHECK","CLOSE","COALESCE","COLLATE","COLUMN","COMMIT","CONDITION","CONNECT","CONSTRAINT","CORRESPONDING","CREATE","CROSS","CUBE","CURRENT","CURRENT_CATALOG","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CYCLE","DEALLOCATE","DAY","DECLARE","DEFAULT","DELETE","DEREF","DESC","DESCRIBE","DETERMINISTIC","DISCONNECT","DISTINCT","DROP","DYNAMIC","EACH","ELEMENT","END-EXEC","ESCAPE","EVERY","EXCEPT","EXEC","EXECUTE","EXISTS","EXTERNAL","FALSE","FETCH","FILTER","FOR","FOREIGN","FREE","FROM","FULL","FUNCTION","GET","GLOBAL","GRANT","GROUP","HAVING","HOLD","HOUR","IDENTITY","IN","INDICATOR","INNER","INOUT","INSENSITIVE","INSERT","INTERSECT","INTO","IS","LANGUAGE","LARGE","LATERAL","LEADING","LEFT","LIKE","LIKE_REGEX","LOCAL","MATCH","MEMBER","MERGE","METHOD","MINUTE","MODIFIES","MODULE","MONTH","NATURAL","NEW","NO","NONE","NOT","NULL","NULLIF","OF","OLD","ON","ONLY","OPEN","ORDER","OUT","OUTER","OVER","OVERLAPS","PARAMETER","PARTITION","PRECISION","PREPARE","PRIMARY","PROCEDURE","RANGE","READS","REAL","RECURSIVE","REF","REFERENCES","REFERENCING","RELEASE","RESULT","RETURN","RETURNS","REVOKE","RIGHT","ROLLBACK","ROLLUP","ROW","ROWS","SAVEPOINT","SCOPE","SCROLL","SEARCH","SECOND","SELECT","SENSITIVE","SESSION_USER","SET","SIMILAR","SOME","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","START","STATIC","SUBMULTISET","SYMMETRIC","SYSTEM","SYSTEM_USER","TABLE","TABLESAMPLE","THEN","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TRAILING","TRANSLATION","TREAT","TRIGGER","TRUE","UESCAPE","UNION","UNIQUE","UNKNOWN","UNNEST","UPDATE","USER","USING","VALUE","VALUES","WHENEVER","WINDOW","WITHIN","WITHOUT","YEAR"],reservedDataTypes:["ARRAY","BIGINT","BINARY LARGE OBJECT","BINARY VARYING","BINARY","BLOB","BOOLEAN","CHAR LARGE OBJECT","CHAR VARYING","CHAR","CHARACTER LARGE OBJECT","CHARACTER VARYING","CHARACTER","CLOB","DATE","DEC","DECIMAL","DOUBLE","FLOAT","INT","INTEGER","INTERVAL","MULTISET","NATIONAL CHAR VARYING","NATIONAL CHAR","NATIONAL CHARACTER LARGE OBJECT","NATIONAL CHARACTER VARYING","NATIONAL CHARACTER","NCHAR LARGE OBJECT","NCHAR VARYING","NCHAR","NCLOB","NUMERIC","SMALLINT","TIME","TIMESTAMP","VARBINARY","VARCHAR"],reservedFunctionNames:["GROUPING","RANK","DENSE_RANK","PERCENT_RANK","CUME_DIST","ROW_NUMBER","POSITION","OCCURRENCES_REGEX","POSITION_REGEX","EXTRACT","CHAR_LENGTH","CHARACTER_LENGTH","OCTET_LENGTH","CARDINALITY","ABS","MOD","LN","EXP","POWER","SQRT","FLOOR","CEIL","CEILING","WIDTH_BUCKET","SUBSTRING","SUBSTRING_REGEX","UPPER","LOWER","CONVERT","TRANSLATE","TRANSLATE_REGEX","TRIM","OVERLAY","NORMALIZE","SPECIFICTYPE","CURRENT_DATE","CURRENT_TIME","LOCALTIME","CURRENT_TIMESTAMP","LOCALTIMESTAMP","COUNT","AVG","MAX","MIN","SUM","STDDEV_POP","STDDEV_SAMP","VAR_SAMP","VAR_POP","COLLECT","FUSION","INTERSECTION","COVAR_POP","COVAR_SAMP","CORR","REGR_SLOPE","REGR_INTERCEPT","REGR_COUNT","REGR_R2","REGR_AVGX","REGR_AVGY","REGR_SXX","REGR_SYY","REGR_SXY","PERCENTILE_CONT","PERCENTILE_DISC","CAST","COALESCE","NULLIF","ROUND","SIN","COS","TAN","ASIN","ACOS","ATAN"],stringTypes:[{quote:"''-qq-bs",prefixes:["N","U&"]},{quote:"''-raw",prefixes:["X"],requirePrefix:!0}],identTypes:['""-qq',"``"],paramTypes:{positional:!0},operators:["||"]},formatOptions:{onelineClauses:[...l0,...l1],tabularOnelineClauses:l1}},l6=nG(["SELECT [ALL | DISTINCT]"]),l8=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY [ALL | DISTINCT]","HAVING","WINDOW","PARTITION BY","ORDER BY","LIMIT","OFFSET","FETCH {FIRST | NEXT}","INSERT INTO","VALUES","SET","MATCH_RECOGNIZE","MEASURES","ONE ROW PER MATCH","ALL ROWS PER MATCH","AFTER MATCH","PATTERN","SUBSET","DEFINE"]),l7=nG(["CREATE TABLE [IF NOT EXISTS]"]),Ee=nG(["CREATE [OR REPLACE] [MATERIALIZED] VIEW","UPDATE","DELETE FROM","DROP TABLE [IF EXISTS]","ALTER TABLE [IF EXISTS]","ADD COLUMN [IF NOT EXISTS]","DROP COLUMN [IF EXISTS]","RENAME COLUMN [IF EXISTS]","RENAME TO","SET AUTHORIZATION [USER | ROLE]","SET PROPERTIES","EXECUTE","TRUNCATE TABLE","ALTER SCHEMA","ALTER MATERIALIZED VIEW","ALTER VIEW","CREATE SCHEMA","CREATE ROLE","DROP SCHEMA","DROP MATERIALIZED VIEW","DROP VIEW","DROP ROLE","EXPLAIN","ANALYZE","EXPLAIN ANALYZE","EXPLAIN ANALYZE VERBOSE","USE","DESCRIBE INPUT","DESCRIBE OUTPUT","REFRESH MATERIALIZED VIEW","RESET SESSION","SET SESSION","SET PATH","SET TIME ZONE","SHOW GRANTS","SHOW CREATE TABLE","SHOW CREATE SCHEMA","SHOW CREATE VIEW","SHOW CREATE MATERIALIZED VIEW","SHOW TABLES","SHOW SCHEMAS","SHOW CATALOGS","SHOW COLUMNS","SHOW STATS FOR","SHOW ROLES","SHOW CURRENT ROLES","SHOW ROLE GRANTS","SHOW FUNCTIONS","SHOW SESSION"]),Et=nG(["UNION [ALL | DISTINCT]","EXCEPT [ALL | DISTINCT]","INTERSECT [ALL | DISTINCT]"]),Er=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL [INNER] JOIN","NATURAL {LEFT | RIGHT | FULL} [OUTER] JOIN"]),Ea=nG(["{ROWS | RANGE | GROUPS} BETWEEN","IS [NOT] DISTINCT FROM"]),Es=nG([]),Ei={name:"trino",tokenizerOptions:{reservedSelect:l6,reservedClauses:[...l8,...l7,...Ee],reservedSetOperations:Et,reservedJoins:Er,reservedKeywordPhrases:Ea,reservedDataTypePhrases:Es,reservedKeywords:["ABSENT","ADD","ADMIN","AFTER","ALL","ALTER","ANALYZE","AND","ANY","AS","ASC","AT","AUTHORIZATION","BERNOULLI","BETWEEN","BOTH","BY","CALL","CASCADE","CASE","CATALOGS","COLUMN","COLUMNS","COMMENT","COMMIT","COMMITTED","CONDITIONAL","CONSTRAINT","COPARTITION","CREATE","CROSS","CUBE","CURRENT","CURRENT_PATH","CURRENT_ROLE","DATA","DEALLOCATE","DEFAULT","DEFINE","DEFINER","DELETE","DENY","DESC","DESCRIBE","DESCRIPTOR","DISTINCT","DISTRIBUTED","DOUBLE","DROP","ELSE","EMPTY","ENCODING","END","ERROR","ESCAPE","EXCEPT","EXCLUDING","EXECUTE","EXISTS","EXPLAIN","FALSE","FETCH","FINAL","FIRST","FOLLOWING","FOR","FROM","FULL","FUNCTIONS","GRANT","GRANTED","GRANTS","GRAPHVIZ","GROUP","GROUPING","GROUPS","HAVING","IGNORE","IN","INCLUDING","INITIAL","INNER","INPUT","INSERT","INTERSECT","INTERVAL","INTO","INVOKER","IO","IS","ISOLATION","JOIN","JSON","JSON_ARRAY","JSON_OBJECT","KEEP","KEY","KEYS","LAST","LATERAL","LEADING","LEFT","LEVEL","LIKE","LIMIT","LOCAL","LOGICAL","MATCH","MATCHED","MATCHES","MATCH_RECOGNIZE","MATERIALIZED","MEASURES","NATURAL","NEXT","NFC","NFD","NFKC","NFKD","NO","NONE","NOT","NULL","NULLS","OBJECT","OF","OFFSET","OMIT","ON","ONE","ONLY","OPTION","OR","ORDER","ORDINALITY","OUTER","OUTPUT","OVER","OVERFLOW","PARTITION","PARTITIONS","PASSING","PAST","PATH","PATTERN","PER","PERMUTE","PRECEDING","PRECISION","PREPARE","PRIVILEGES","PROPERTIES","PRUNE","QUOTES","RANGE","READ","RECURSIVE","REFRESH","RENAME","REPEATABLE","RESET","RESPECT","RESTRICT","RETURNING","REVOKE","RIGHT","ROLE","ROLES","ROLLBACK","ROLLUP","ROW","ROWS","RUNNING","SCALAR","SCHEMA","SCHEMAS","SECURITY","SEEK","SELECT","SERIALIZABLE","SESSION","SET","SETS","SHOW","SKIP","SOME","START","STATS","STRING","SUBSET","SYSTEM","TABLE","TABLES","TABLESAMPLE","TEXT","THEN","TIES","TIME","TIMESTAMP","TO","TRAILING","TRANSACTION","TRUE","TYPE","UESCAPE","UNBOUNDED","UNCOMMITTED","UNCONDITIONAL","UNION","UNIQUE","UNKNOWN","UNMATCHED","UNNEST","UPDATE","USE","USER","USING","UTF16","UTF32","UTF8","VALIDATE","VALUE","VALUES","VERBOSE","VIEW","WHEN","WHERE","WINDOW","WITH","WITHIN","WITHOUT","WORK","WRAPPER","WRITE","ZONE"],reservedDataTypes:["BIGINT","INT","INTEGER","SMALLINT","TINYINT","BOOLEAN","DATE","DECIMAL","REAL","DOUBLE","HYPERLOGLOG","QDIGEST","TDIGEST","P4HYPERLOGLOG","INTERVAL","TIMESTAMP","TIME","VARBINARY","VARCHAR","CHAR","ROW","ARRAY","MAP","JSON","JSON2016","IPADDRESS","GEOMETRY","UUID","SETDIGEST","JONIREGEXP","RE2JREGEXP","LIKEPATTERN","COLOR","CODEPOINTS","FUNCTION","JSONPATH"],reservedFunctionNames:["ABS","ACOS","ALL_MATCH","ANY_MATCH","APPROX_DISTINCT","APPROX_MOST_FREQUENT","APPROX_PERCENTILE","APPROX_SET","ARBITRARY","ARRAYS_OVERLAP","ARRAY_AGG","ARRAY_DISTINCT","ARRAY_EXCEPT","ARRAY_INTERSECT","ARRAY_JOIN","ARRAY_MAX","ARRAY_MIN","ARRAY_POSITION","ARRAY_REMOVE","ARRAY_SORT","ARRAY_UNION","ASIN","ATAN","ATAN2","AT_TIMEZONE","AVG","BAR","BETA_CDF","BING_TILE","BING_TILES_AROUND","BING_TILE_AT","BING_TILE_COORDINATES","BING_TILE_POLYGON","BING_TILE_QUADKEY","BING_TILE_ZOOM_LEVEL","BITWISE_AND","BITWISE_AND_AGG","BITWISE_LEFT_SHIFT","BITWISE_NOT","BITWISE_OR","BITWISE_OR_AGG","BITWISE_RIGHT_SHIFT","BITWISE_RIGHT_SHIFT_ARITHMETIC","BITWISE_XOR","BIT_COUNT","BOOL_AND","BOOL_OR","CARDINALITY","CAST","CBRT","CEIL","CEILING","CHAR2HEXINT","CHECKSUM","CHR","CLASSIFY","COALESCE","CODEPOINT","COLOR","COMBINATIONS","CONCAT","CONCAT_WS","CONTAINS","CONTAINS_SEQUENCE","CONVEX_HULL_AGG","CORR","COS","COSH","COSINE_SIMILARITY","COUNT","COUNT_IF","COVAR_POP","COVAR_SAMP","CRC32","CUME_DIST","CURRENT_CATALOG","CURRENT_DATE","CURRENT_GROUPS","CURRENT_SCHEMA","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_USER","DATE","DATE_ADD","DATE_DIFF","DATE_FORMAT","DATE_PARSE","DATE_TRUNC","DAY","DAY_OF_MONTH","DAY_OF_WEEK","DAY_OF_YEAR","DEGREES","DENSE_RANK","DOW","DOY","E","ELEMENT_AT","EMPTY_APPROX_SET","EVALUATE_CLASSIFIER_PREDICTIONS","EVERY","EXP","EXTRACT","FEATURES","FILTER","FIRST_VALUE","FLATTEN","FLOOR","FORMAT","FORMAT_DATETIME","FORMAT_NUMBER","FROM_BASE","FROM_BASE32","FROM_BASE64","FROM_BASE64URL","FROM_BIG_ENDIAN_32","FROM_BIG_ENDIAN_64","FROM_ENCODED_POLYLINE","FROM_GEOJSON_GEOMETRY","FROM_HEX","FROM_IEEE754_32","FROM_IEEE754_64","FROM_ISO8601_DATE","FROM_ISO8601_TIMESTAMP","FROM_ISO8601_TIMESTAMP_NANOS","FROM_UNIXTIME","FROM_UNIXTIME_NANOS","FROM_UTF8","GEOMETRIC_MEAN","GEOMETRY_FROM_HADOOP_SHAPE","GEOMETRY_INVALID_REASON","GEOMETRY_NEAREST_POINTS","GEOMETRY_TO_BING_TILES","GEOMETRY_UNION","GEOMETRY_UNION_AGG","GREATEST","GREAT_CIRCLE_DISTANCE","HAMMING_DISTANCE","HASH_COUNTS","HISTOGRAM","HMAC_MD5","HMAC_SHA1","HMAC_SHA256","HMAC_SHA512","HOUR","HUMAN_READABLE_SECONDS","IF","INDEX","INFINITY","INTERSECTION_CARDINALITY","INVERSE_BETA_CDF","INVERSE_NORMAL_CDF","IS_FINITE","IS_INFINITE","IS_JSON_SCALAR","IS_NAN","JACCARD_INDEX","JSON_ARRAY_CONTAINS","JSON_ARRAY_GET","JSON_ARRAY_LENGTH","JSON_EXISTS","JSON_EXTRACT","JSON_EXTRACT_SCALAR","JSON_FORMAT","JSON_PARSE","JSON_QUERY","JSON_SIZE","JSON_VALUE","KURTOSIS","LAG","LAST_DAY_OF_MONTH","LAST_VALUE","LEAD","LEARN_CLASSIFIER","LEARN_LIBSVM_CLASSIFIER","LEARN_LIBSVM_REGRESSOR","LEARN_REGRESSOR","LEAST","LENGTH","LEVENSHTEIN_DISTANCE","LINE_INTERPOLATE_POINT","LINE_INTERPOLATE_POINTS","LINE_LOCATE_POINT","LISTAGG","LN","LOCALTIME","LOCALTIMESTAMP","LOG","LOG10","LOG2","LOWER","LPAD","LTRIM","LUHN_CHECK","MAKE_SET_DIGEST","MAP","MAP_AGG","MAP_CONCAT","MAP_ENTRIES","MAP_FILTER","MAP_FROM_ENTRIES","MAP_KEYS","MAP_UNION","MAP_VALUES","MAP_ZIP_WITH","MAX","MAX_BY","MD5","MERGE","MERGE_SET_DIGEST","MILLISECOND","MIN","MINUTE","MIN_BY","MOD","MONTH","MULTIMAP_AGG","MULTIMAP_FROM_ENTRIES","MURMUR3","NAN","NGRAMS","NONE_MATCH","NORMALIZE","NORMAL_CDF","NOW","NTH_VALUE","NTILE","NULLIF","NUMERIC_HISTOGRAM","OBJECTID","OBJECTID_TIMESTAMP","PARSE_DATA_SIZE","PARSE_DATETIME","PARSE_DURATION","PERCENT_RANK","PI","POSITION","POW","POWER","QDIGEST_AGG","QUARTER","RADIANS","RAND","RANDOM","RANK","REDUCE","REDUCE_AGG","REGEXP_COUNT","REGEXP_EXTRACT","REGEXP_EXTRACT_ALL","REGEXP_LIKE","REGEXP_POSITION","REGEXP_REPLACE","REGEXP_SPLIT","REGRESS","REGR_INTERCEPT","REGR_SLOPE","RENDER","REPEAT","REPLACE","REVERSE","RGB","ROUND","ROW_NUMBER","RPAD","RTRIM","SECOND","SEQUENCE","SHA1","SHA256","SHA512","SHUFFLE","SIGN","SIMPLIFY_GEOMETRY","SIN","SKEWNESS","SLICE","SOUNDEX","SPATIAL_PARTITIONING","SPATIAL_PARTITIONS","SPLIT","SPLIT_PART","SPLIT_TO_MAP","SPLIT_TO_MULTIMAP","SPOOKY_HASH_V2_32","SPOOKY_HASH_V2_64","SQRT","STARTS_WITH","STDDEV","STDDEV_POP","STDDEV_SAMP","STRPOS","ST_AREA","ST_ASBINARY","ST_ASTEXT","ST_BOUNDARY","ST_BUFFER","ST_CENTROID","ST_CONTAINS","ST_CONVEXHULL","ST_COORDDIM","ST_CROSSES","ST_DIFFERENCE","ST_DIMENSION","ST_DISJOINT","ST_DISTANCE","ST_ENDPOINT","ST_ENVELOPE","ST_ENVELOPEASPTS","ST_EQUALS","ST_EXTERIORRING","ST_GEOMETRIES","ST_GEOMETRYFROMTEXT","ST_GEOMETRYN","ST_GEOMETRYTYPE","ST_GEOMFROMBINARY","ST_INTERIORRINGN","ST_INTERIORRINGS","ST_INTERSECTION","ST_INTERSECTS","ST_ISCLOSED","ST_ISEMPTY","ST_ISRING","ST_ISSIMPLE","ST_ISVALID","ST_LENGTH","ST_LINEFROMTEXT","ST_LINESTRING","ST_MULTIPOINT","ST_NUMGEOMETRIES","ST_NUMINTERIORRING","ST_NUMPOINTS","ST_OVERLAPS","ST_POINT","ST_POINTN","ST_POINTS","ST_POLYGON","ST_RELATE","ST_STARTPOINT","ST_SYMDIFFERENCE","ST_TOUCHES","ST_UNION","ST_WITHIN","ST_X","ST_XMAX","ST_XMIN","ST_Y","ST_YMAX","ST_YMIN","SUBSTR","SUBSTRING","SUM","TAN","TANH","TDIGEST_AGG","TIMESTAMP_OBJECTID","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO_BASE","TO_BASE32","TO_BASE64","TO_BASE64URL","TO_BIG_ENDIAN_32","TO_BIG_ENDIAN_64","TO_CHAR","TO_DATE","TO_ENCODED_POLYLINE","TO_GEOJSON_GEOMETRY","TO_GEOMETRY","TO_HEX","TO_IEEE754_32","TO_IEEE754_64","TO_ISO8601","TO_MILLISECONDS","TO_SPHERICAL_GEOGRAPHY","TO_TIMESTAMP","TO_UNIXTIME","TO_UTF8","TRANSFORM","TRANSFORM_KEYS","TRANSFORM_VALUES","TRANSLATE","TRIM","TRIM_ARRAY","TRUNCATE","TRY","TRY_CAST","TYPEOF","UPPER","URL_DECODE","URL_ENCODE","URL_EXTRACT_FRAGMENT","URL_EXTRACT_HOST","URL_EXTRACT_PARAMETER","URL_EXTRACT_PATH","URL_EXTRACT_PORT","URL_EXTRACT_PROTOCOL","URL_EXTRACT_QUERY","UUID","VALUES_AT_QUANTILES","VALUE_AT_QUANTILE","VARIANCE","VAR_POP","VAR_SAMP","VERSION","WEEK","WEEK_OF_YEAR","WIDTH_BUCKET","WILSON_INTERVAL_LOWER","WILSON_INTERVAL_UPPER","WITH_TIMEZONE","WORD_STEM","XXHASH64","YEAR","YEAR_OF_WEEK","YOW","ZIP","ZIP_WITH","CLASSIFIER","FIRST","LAST","MATCH_NUMBER","NEXT","PERMUTE","PREV"],extraParens:["[]","{}"],stringTypes:[{quote:"''-qq",prefixes:["U&"]},{quote:"''-raw",prefixes:["X"],requirePrefix:!0}],identTypes:['""-qq'],paramTypes:{positional:!0},operators:["%","->","=>",":","||","|","^","$"]},formatOptions:{onelineClauses:[...l7,...Ee],tabularOnelineClauses:Ee}},En=nG(["SELECT [ALL | DISTINCT]"]),Eo=nG(["WITH","INTO","FROM","WHERE","GROUP BY","HAVING","WINDOW","PARTITION BY","ORDER BY","OFFSET","FETCH {FIRST | NEXT}","FOR {BROWSE | XML | JSON}","OPTION","INSERT [INTO]","VALUES","SET","MERGE [INTO]","WHEN [NOT] MATCHED [BY TARGET | BY SOURCE] [THEN]","UPDATE SET"]),El=nG(["CREATE TABLE"]),EE=nG(["CREATE [OR ALTER] [MATERIALIZED] VIEW","UPDATE","WHERE CURRENT OF","DELETE [FROM]","DROP TABLE [IF EXISTS]","ALTER TABLE","ADD","DROP COLUMN [IF EXISTS]","ALTER COLUMN","TRUNCATE TABLE","CREATE [UNIQUE] [CLUSTERED] INDEX","CREATE DATABASE","ALTER DATABASE","DROP DATABASE [IF EXISTS]","CREATE [OR ALTER] [PARTITION] {FUNCTION | PROCEDURE | PROC}","ALTER [PARTITION] {FUNCTION | PROCEDURE | PROC}","DROP [PARTITION] {FUNCTION | PROCEDURE | PROC} [IF EXISTS]","GO","USE","ADD SENSITIVITY CLASSIFICATION","ADD SIGNATURE","AGGREGATE","ANSI_DEFAULTS","ANSI_NULLS","ANSI_NULL_DFLT_OFF","ANSI_NULL_DFLT_ON","ANSI_PADDING","ANSI_WARNINGS","APPLICATION ROLE","ARITHABORT","ARITHIGNORE","ASSEMBLY","ASYMMETRIC KEY","AUTHORIZATION","AVAILABILITY GROUP","BACKUP","BACKUP CERTIFICATE","BACKUP MASTER KEY","BACKUP SERVICE MASTER KEY","BEGIN CONVERSATION TIMER","BEGIN DIALOG CONVERSATION","BROKER PRIORITY","BULK INSERT","CERTIFICATE","CLOSE MASTER KEY","CLOSE SYMMETRIC KEY","COLUMN ENCRYPTION KEY","COLUMN MASTER KEY","COLUMNSTORE INDEX","CONCAT_NULL_YIELDS_NULL","CONTEXT_INFO","CONTRACT","CREDENTIAL","CRYPTOGRAPHIC PROVIDER","CURSOR_CLOSE_ON_COMMIT","DATABASE","DATABASE AUDIT SPECIFICATION","DATABASE ENCRYPTION KEY","DATABASE HADR","DATABASE SCOPED CONFIGURATION","DATABASE SCOPED CREDENTIAL","DATABASE SET","DATEFIRST","DATEFORMAT","DEADLOCK_PRIORITY","DENY","DENY XML","DISABLE TRIGGER","ENABLE TRIGGER","END CONVERSATION","ENDPOINT","EVENT NOTIFICATION","EVENT SESSION","EXECUTE AS","EXTERNAL DATA SOURCE","EXTERNAL FILE FORMAT","EXTERNAL LANGUAGE","EXTERNAL LIBRARY","EXTERNAL RESOURCE POOL","EXTERNAL TABLE","FIPS_FLAGGER","FMTONLY","FORCEPLAN","FULLTEXT CATALOG","FULLTEXT INDEX","FULLTEXT STOPLIST","GET CONVERSATION GROUP","GET_TRANSMISSION_STATUS","GRANT","GRANT XML","IDENTITY_INSERT","IMPLICIT_TRANSACTIONS","INDEX","LANGUAGE","LOCK_TIMEOUT","LOGIN","MASTER KEY","MESSAGE TYPE","MOVE CONVERSATION","NOCOUNT","NOEXEC","NUMERIC_ROUNDABORT","OFFSETS","OPEN MASTER KEY","OPEN SYMMETRIC KEY","PARSEONLY","PARTITION SCHEME","QUERY_GOVERNOR_COST_LIMIT","QUEUE","QUOTED_IDENTIFIER","RECEIVE","REMOTE SERVICE BINDING","REMOTE_PROC_TRANSACTIONS","RESOURCE GOVERNOR","RESOURCE POOL","RESTORE","RESTORE FILELISTONLY","RESTORE HEADERONLY","RESTORE LABELONLY","RESTORE MASTER KEY","RESTORE REWINDONLY","RESTORE SERVICE MASTER KEY","RESTORE VERIFYONLY","REVERT","REVOKE","REVOKE XML","ROLE","ROUTE","ROWCOUNT","RULE","SCHEMA","SEARCH PROPERTY LIST","SECURITY POLICY","SELECTIVE XML INDEX","SEND","SENSITIVITY CLASSIFICATION","SEQUENCE","SERVER AUDIT","SERVER AUDIT SPECIFICATION","SERVER CONFIGURATION","SERVER ROLE","SERVICE","SERVICE MASTER KEY","SETUSER","SHOWPLAN_ALL","SHOWPLAN_TEXT","SHOWPLAN_XML","SIGNATURE","SPATIAL INDEX","STATISTICS","STATISTICS IO","STATISTICS PROFILE","STATISTICS TIME","STATISTICS XML","SYMMETRIC KEY","SYNONYM","TABLE","TABLE IDENTITY","TEXTSIZE","TRANSACTION ISOLATION LEVEL","TRIGGER","TYPE","UPDATE STATISTICS","USER","WORKLOAD GROUP","XACT_ABORT","XML INDEX","XML SCHEMA COLLECTION"]),Eu=nG(["UNION [ALL]","EXCEPT","INTERSECT"]),Ec=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","{CROSS | OUTER} APPLY"]),ET=nG(["ON {UPDATE | DELETE} [SET NULL | SET DEFAULT]","{ROWS | RANGE} BETWEEN"]),Ed=nG([]),Eh={name:"transactsql",tokenizerOptions:{reservedSelect:En,reservedClauses:[...Eo,...El,...EE],reservedSetOperations:Eu,reservedJoins:Ec,reservedKeywordPhrases:ET,reservedDataTypePhrases:Ed,reservedKeywords:["ADD","ALL","ALTER","AND","ANY","AS","ASC","AUTHORIZATION","BACKUP","BEGIN","BETWEEN","BREAK","BROWSE","BULK","BY","CASCADE","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COALESCE","COLLATE","COLUMN","COMMIT","COMPUTE","CONSTRAINT","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DBCC","DEALLOCATE","DECLARE","DEFAULT","DELETE","DENY","DESC","DISK","DISTINCT","DISTRIBUTED","DROP","DUMP","ERRLVL","ESCAPE","EXEC","EXECUTE","EXISTS","EXIT","EXTERNAL","FETCH","FILE","FILLFACTOR","FOR","FOREIGN","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GOTO","GRANT","GROUP","HAVING","HOLDLOCK","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IN","INDEX","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KILL","LEFT","LIKE","LINENO","LOAD","MERGE","NOCHECK","NONCLUSTERED","NOT","NULL","NULLIF","OF","OFF","OFFSETS","ON","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OUTER","OVER","PERCENT","PIVOT","PLAN","PRIMARY","PRINT","PROC","PROCEDURE","PUBLIC","RAISERROR","READ","READTEXT","RECONFIGURE","REFERENCES","REPLICATION","RESTORE","RESTRICT","RETURN","REVERT","REVOKE","RIGHT","ROLLBACK","ROWCOUNT","ROWGUIDCOL","RULE","SAVE","SCHEMA","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SESSION_USER","SET","SETUSER","SHUTDOWN","SOME","STATISTICS","SYSTEM_USER","TABLE","TABLESAMPLE","TEXTSIZE","THEN","TO","TOP","TRAN","TRANSACTION","TRIGGER","TRUNCATE","TRY_CONVERT","TSEQUAL","UNION","UNIQUE","UNPIVOT","UPDATE","UPDATETEXT","USE","USER","VALUES","VIEW","WAITFOR","WHERE","WHILE","WITH","WITHIN GROUP","WRITETEXT","$ACTION"],reservedDataTypes:["BINARY","BIT","CHAR","CHAR","CHARACTER","DATE","DATETIME2","DATETIMEOFFSET","DEC","DECIMAL","DOUBLE","FLOAT","INT","INTEGER","NATIONAL","NCHAR","NUMERIC","NVARCHAR","PRECISION","REAL","SMALLINT","TIME","TIMESTAMP","VARBINARY","VARCHAR"],reservedFunctionNames:["APPROX_COUNT_DISTINCT","AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","STDEV","STDEVP","SUM","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","Collation - COLLATIONPROPERTY","Collation - TERTIARY_WEIGHTS","@@DBTS","@@LANGID","@@LANGUAGE","@@LOCK_TIMEOUT","@@MAX_CONNECTIONS","@@MAX_PRECISION","@@NESTLEVEL","@@OPTIONS","@@REMSERVER","@@SERVERNAME","@@SERVICENAME","@@SPID","@@TEXTSIZE","@@VERSION","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","@@CURSOR_ROWS","@@FETCH_STATUS","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","@@DATEFIRST","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_TIMEZONE_ID","DATEADD","DATEDIFF","DATEDIFF_BIG","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","JSON","ISJSON","JSON_VALUE","JSON_QUERY","JSON_MODIFY","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","CHOOSE","GREATEST","IIF","LEAST","@@PROCID","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FILEPROPERTYEX","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","NEXT VALUE FOR","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","DATABASE_PRINCIPAL_ID","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHARINDEX","CONCAT","CONCAT_WS","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STRING_AGG","STRING_ESCAPE","STUFF","SUBSTRING","TRANSLATE","TRIM","UNICODE","UPPER","$PARTITION","@@ERROR","@@IDENTITY","@@PACK_RECEIVED","@@ROWCOUNT","@@TRANCOUNT","BINARY_CHECKSUM","CHECKSUM","COMPRESS","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","CURRENT_TRANSACTION_ID","DECOMPRESS","ERROR_LINE","ERROR_MESSAGE","ERROR_NUMBER","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GET_FILESTREAM_TRANSACTION_CONTEXT","GETANSINULL","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","SESSION_CONTEXT","XACT_STATE","@@CONNECTIONS","@@CPU_BUSY","@@IDLE","@@IO_BUSY","@@PACK_SENT","@@PACKET_ERRORS","@@TIMETICKS","@@TOTAL_ERRORS","@@TOTAL_READ","@@TOTAL_WRITE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","COALESCE","NULLIF"],nestedBlockComments:!0,stringTypes:[{quote:"''-qq",prefixes:["N"]},"{}"],identTypes:['""-qq',"[]"],identChars:{first:"#@",rest:"#@$"},paramTypes:{named:["@"],quoted:["@"]},operators:["%","&","|","^","~","!<","!>","+=","-=","*=","/=","%=","|=","&=","^=","::",":"],propertyAccessOperators:[".."]},formatOptions:{alwaysDenseOperators:["::"],onelineClauses:[...El,...EE],tabularOnelineClauses:EE}},EA=nG(["SELECT [ALL | DISTINCT | DISTINCTROW]"]),Ep=nG(["WITH","FROM","WHERE","GROUP BY","HAVING","PARTITION BY","ORDER BY","LIMIT","OFFSET","INSERT [IGNORE] [INTO]","VALUES","REPLACE [INTO]","ON DUPLICATE KEY UPDATE","SET","CREATE [OR REPLACE] [TEMPORARY] PROCEDURE [IF NOT EXISTS]","CREATE [OR REPLACE] [EXTERNAL] FUNCTION"]),ER=nG(["CREATE [ROWSTORE] [REFERENCE | TEMPORARY | GLOBAL TEMPORARY] TABLE [IF NOT EXISTS]"]),ES=nG(["CREATE VIEW","UPDATE","DELETE [FROM]","DROP [TEMPORARY] TABLE [IF EXISTS]","ALTER [ONLINE] TABLE","ADD [COLUMN]","ADD [UNIQUE] {INDEX | KEY}","DROP [COLUMN]","MODIFY [COLUMN]","CHANGE","RENAME [TO | AS]","TRUNCATE [TABLE]","ADD AGGREGATOR","ADD LEAF","AGGREGATOR SET AS MASTER","ALTER DATABASE","ALTER PIPELINE","ALTER RESOURCE POOL","ALTER USER","ALTER VIEW","ANALYZE TABLE","ATTACH DATABASE","ATTACH LEAF","ATTACH LEAF ALL","BACKUP DATABASE","BINLOG","BOOTSTRAP AGGREGATOR","CACHE INDEX","CALL","CHANGE","CHANGE MASTER TO","CHANGE REPLICATION FILTER","CHANGE REPLICATION SOURCE TO","CHECK BLOB CHECKSUM","CHECK TABLE","CHECKSUM TABLE","CLEAR ORPHAN DATABASES","CLONE","COMMIT","CREATE DATABASE","CREATE GROUP","CREATE INDEX","CREATE LINK","CREATE MILESTONE","CREATE PIPELINE","CREATE RESOURCE POOL","CREATE ROLE","CREATE USER","DEALLOCATE PREPARE","DESCRIBE","DETACH DATABASE","DETACH PIPELINE","DROP DATABASE","DROP FUNCTION","DROP INDEX","DROP LINK","DROP PIPELINE","DROP PROCEDURE","DROP RESOURCE POOL","DROP ROLE","DROP USER","DROP VIEW","EXECUTE","EXPLAIN","FLUSH","FORCE","GRANT","HANDLER","HELP","KILL CONNECTION","KILLALL QUERIES","LOAD DATA","LOAD INDEX INTO CACHE","LOAD XML","LOCK INSTANCE FOR BACKUP","LOCK TABLES","MASTER_POS_WAIT","OPTIMIZE TABLE","PREPARE","PURGE BINARY LOGS","REBALANCE PARTITIONS","RELEASE SAVEPOINT","REMOVE AGGREGATOR","REMOVE LEAF","REPAIR TABLE","REPLACE","REPLICATE DATABASE","RESET","RESET MASTER","RESET PERSIST","RESET REPLICA","RESET SLAVE","RESTART","RESTORE DATABASE","RESTORE REDUNDANCY","REVOKE","ROLLBACK","ROLLBACK TO SAVEPOINT","SAVEPOINT","SET CHARACTER SET","SET DEFAULT ROLE","SET NAMES","SET PASSWORD","SET RESOURCE GROUP","SET ROLE","SET TRANSACTION","SHOW","SHOW CHARACTER SET","SHOW COLLATION","SHOW COLUMNS","SHOW CREATE DATABASE","SHOW CREATE FUNCTION","SHOW CREATE PIPELINE","SHOW CREATE PROCEDURE","SHOW CREATE TABLE","SHOW CREATE USER","SHOW CREATE VIEW","SHOW DATABASES","SHOW ENGINE","SHOW ENGINES","SHOW ERRORS","SHOW FUNCTION CODE","SHOW FUNCTION STATUS","SHOW GRANTS","SHOW INDEX","SHOW MASTER STATUS","SHOW OPEN TABLES","SHOW PLUGINS","SHOW PRIVILEGES","SHOW PROCEDURE CODE","SHOW PROCEDURE STATUS","SHOW PROCESSLIST","SHOW PROFILE","SHOW PROFILES","SHOW RELAYLOG EVENTS","SHOW REPLICA STATUS","SHOW REPLICAS","SHOW SLAVE","SHOW SLAVE HOSTS","SHOW STATUS","SHOW TABLE STATUS","SHOW TABLES","SHOW VARIABLES","SHOW WARNINGS","SHUTDOWN","SNAPSHOT DATABASE","SOURCE_POS_WAIT","START GROUP_REPLICATION","START PIPELINE","START REPLICA","START SLAVE","START TRANSACTION","STOP GROUP_REPLICATION","STOP PIPELINE","STOP REPLICA","STOP REPLICATING","STOP SLAVE","TEST PIPELINE","UNLOCK INSTANCE","UNLOCK TABLES","USE","XA","ITERATE","LEAVE","LOOP","REPEAT","RETURN","WHILE"]),E_=nG(["UNION [ALL | DISTINCT]","EXCEPT","INTERSECT","MINUS"]),EO=nG(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","NATURAL {LEFT | RIGHT} [OUTER] JOIN","STRAIGHT_JOIN"]),EI=nG(["ON DELETE","ON UPDATE","CHARACTER SET","{ROWS | RANGE} BETWEEN","IDENTIFIED BY"]),Ef=nG([]),EN={name:"singlestoredb",tokenizerOptions:{reservedSelect:EA,reservedClauses:[...Ep,...ER,...ES],reservedSetOperations:E_,reservedJoins:EO,reservedKeywordPhrases:EI,reservedDataTypePhrases:Ef,reservedKeywords:["ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","_BINARY","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DECLARE","DEFAULT","DELAYED","DELETE","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DROP","DUAL","EACH","ELSE","ELSEIF","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","EXTRA_JOIN","FALSE","FETCH","FOR","FORCE","FORCE_COMPILED_MODE","FORCE_INTERPRETER_MODE","FOREIGN","FROM","FULL","FULLTEXT","GRANT","GROUP","HAVING","HEARTBEAT_NO_LOGGING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","IN","_INTERNAL_DYNAMIC_TYPECAST","INTERSECT","INTERVAL","INTO","ITERATE","JOIN","KEY","KEYS","KILL","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LOOP","LOW_PRIORITY","MATCH","MAXVALUE","MINUS","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NO_QUERY_REWRITE","NOT","NO_WRITE_TO_BINLOG","NO_QUERY_REWRITE","NULL","ON","OPTIMIZE","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PRIMARY","PROCEDURE","PURGE","RANGE","READ","READS","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESTRICT","RETURN","REVOKE","RIGHT","RIGHT_ANTI_JOIN","RIGHT_SEMI_JOIN","RIGHT_STRAIGHT_JOIN","RLIKE","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SEMI_JOIN","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SPATIAL","SPECIFIC","SQL","SQL_BIG_RESULT","SQL_BUFFER_RESULT","SQL_CACHE","SQL_CALC_FOUND_ROWS","SQLEXCEPTION","SQL_NO_CACHE","SQL_NO_LOGGING","SQL_SMALL_RESULT","SQLSTATE","SQLWARNING","STRAIGHT_JOIN","TABLE","TERMINATED","THEN","TO","TRAILING","TRIGGER","TRUE","UNBOUNDED","UNDO","UNION","UNIQUE","UNLOCK","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","_UTF8","VALUES","WHEN","WHERE","WHILE","WINDOW","WITH","WITHIN","WRITE","XOR","YEAR_MONTH","ZEROFILL"],reservedDataTypes:["BIGINT","BINARY","BIT","BLOB","CHAR","CHARACTER","DATETIME","DEC","DECIMAL","DOUBLE PRECISION","DOUBLE","ENUM","FIXED","FLOAT","FLOAT4","FLOAT8","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","LONG","LONGBLOB","LONGTEXT","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","NATIONAL CHAR","NATIONAL VARCHAR","NUMERIC","PRECISION","REAL","SMALLINT","TEXT","TIME","TIMESTAMP","TINYBLOB","TINYINT","TINYTEXT","UNSIGNED","VARBINARY","VARCHAR","VARCHARACTER","YEAR"],reservedFunctionNames:["ABS","ACOS","ADDDATE","ADDTIME","AES_DECRYPT","AES_ENCRYPT","ANY_VALUE","APPROX_COUNT_DISTINCT","APPROX_COUNT_DISTINCT_ACCUMULATE","APPROX_COUNT_DISTINCT_COMBINE","APPROX_COUNT_DISTINCT_ESTIMATE","APPROX_GEOGRAPHY_INTERSECTS","APPROX_PERCENTILE","ASCII","ASIN","ATAN","ATAN2","AVG","BIN","BINARY","BIT_AND","BIT_COUNT","BIT_OR","BIT_XOR","CAST","CEIL","CEILING","CHAR","CHARACTER_LENGTH","CHAR_LENGTH","CHARSET","COALESCE","COERCIBILITY","COLLATION","COLLECT","CONCAT","CONCAT_WS","CONNECTION_ID","CONV","CONVERT","CONVERT_TZ","COS","COT","COUNT","CUME_DIST","CURDATE","CURRENT_DATE","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURTIME","DATABASE","DATE","DATE_ADD","DATEDIFF","DATE_FORMAT","DATE_SUB","DATE_TRUNC","DAY","DAYNAME","DAYOFMONTH","DAYOFWEEK","DAYOFYEAR","DECODE","DEFAULT","DEGREES","DENSE_RANK","DIV","DOT_PRODUCT","ELT","EUCLIDEAN_DISTANCE","EXP","EXTRACT","FIELD","FIRST","FIRST_VALUE","FLOOR","FORMAT","FOUND_ROWS","FROM_BASE64","FROM_DAYS","FROM_UNIXTIME","GEOGRAPHY_AREA","GEOGRAPHY_CONTAINS","GEOGRAPHY_DISTANCE","GEOGRAPHY_INTERSECTS","GEOGRAPHY_LATITUDE","GEOGRAPHY_LENGTH","GEOGRAPHY_LONGITUDE","GEOGRAPHY_POINT","GEOGRAPHY_WITHIN_DISTANCE","GEOMETRY_AREA","GEOMETRY_CONTAINS","GEOMETRY_DISTANCE","GEOMETRY_FILTER","GEOMETRY_INTERSECTS","GEOMETRY_LENGTH","GEOMETRY_POINT","GEOMETRY_WITHIN_DISTANCE","GEOMETRY_X","GEOMETRY_Y","GREATEST","GROUPING","GROUP_CONCAT","HEX","HIGHLIGHT","HOUR","ICU_VERSION","IF","IFNULL","INET_ATON","INET_NTOA","INET6_ATON","INET6_NTOA","INITCAP","INSERT","INSTR","INTERVAL","IS","IS NULL","JSON_AGG","JSON_ARRAY_CONTAINS_DOUBLE","JSON_ARRAY_CONTAINS_JSON","JSON_ARRAY_CONTAINS_STRING","JSON_ARRAY_PUSH_DOUBLE","JSON_ARRAY_PUSH_JSON","JSON_ARRAY_PUSH_STRING","JSON_DELETE_KEY","JSON_EXTRACT_DOUBLE","JSON_EXTRACT_JSON","JSON_EXTRACT_STRING","JSON_EXTRACT_BIGINT","JSON_GET_TYPE","JSON_LENGTH","JSON_SET_DOUBLE","JSON_SET_JSON","JSON_SET_STRING","JSON_SPLICE_DOUBLE","JSON_SPLICE_JSON","JSON_SPLICE_STRING","LAG","LAST_DAY","LAST_VALUE","LCASE","LEAD","LEAST","LEFT","LENGTH","LIKE","LN","LOCALTIME","LOCALTIMESTAMP","LOCATE","LOG","LOG10","LOG2","LPAD","LTRIM","MATCH","MAX","MD5","MEDIAN","MICROSECOND","MIN","MINUTE","MOD","MONTH","MONTHNAME","MONTHS_BETWEEN","NOT","NOW","NTH_VALUE","NTILE","NULLIF","OCTET_LENGTH","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","PI","PIVOT","POSITION","POW","POWER","QUARTER","QUOTE","RADIANS","RAND","RANK","REGEXP","REPEAT","REPLACE","REVERSE","RIGHT","RLIKE","ROUND","ROW_COUNT","ROW_NUMBER","RPAD","RTRIM","SCALAR","SCHEMA","SEC_TO_TIME","SHA1","SHA2","SIGMOID","SIGN","SIN","SLEEP","SPLIT","SOUNDEX","SOUNDS LIKE","SOURCE_POS_WAIT","SPACE","SQRT","STDDEV","STDDEV_POP","STDDEV_SAMP","STR_TO_DATE","SUBDATE","SUBSTR","SUBSTRING","SUBSTRING_INDEX","SUM","SYS_GUID","TAN","TIME","TIMEDIFF","TIME_BUCKET","TIME_FORMAT","TIMESTAMP","TIMESTAMPADD","TIMESTAMPDIFF","TIME_TO_SEC","TO_BASE64","TO_CHAR","TO_DAYS","TO_JSON","TO_NUMBER","TO_SECONDS","TO_TIMESTAMP","TRIM","TRUNC","TRUNCATE","UCASE","UNHEX","UNIX_TIMESTAMP","UPDATEXML","UPPER","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","UUID","VALUES","VARIANCE","VAR_POP","VAR_SAMP","VECTOR_SUB","VERSION","WEEK","WEEKDAY","WEEKOFYEAR","YEAR"],stringTypes:['""-qq-bs',"''-qq-bs",{quote:"''-raw",prefixes:["B","X"],requirePrefix:!0}],identTypes:["``"],identChars:{first:"$",rest:"$",allowFirstCharNumber:!0},variableTypes:[{regex:"@@?[A-Za-z0-9_$]+"},{quote:"``",prefixes:["@"],requirePrefix:!0}],lineCommentTypes:["--","#"],operators:[":=","&","|","^","~","<<",">>","<=>","&&","||","::","::$","::%",":>","!:>","*.*"],postProcess:ow},formatOptions:{alwaysDenseOperators:["::","::$","::%"],onelineClauses:[...ER,...ES],tabularOnelineClauses:ES}},Em=nG(["SELECT [ALL | DISTINCT]"]),EC=nG(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY","HAVING","PARTITION BY","ORDER BY","QUALIFY","LIMIT","OFFSET","FETCH [FIRST | NEXT]","INSERT [OVERWRITE] [ALL INTO | INTO | ALL | FIRST]","{THEN | ELSE} INTO","VALUES","SET","CLUSTER BY","[WITH] {MASKING POLICY | TAG | ROW ACCESS POLICY}","COPY GRANTS","USING TEMPLATE","MERGE INTO","WHEN MATCHED [AND]","THEN {UPDATE SET | DELETE}","WHEN NOT MATCHED THEN INSERT"]),EL=nG(["CREATE [OR REPLACE] [VOLATILE] TABLE [IF NOT EXISTS]","CREATE [OR REPLACE] [LOCAL | GLOBAL] {TEMP|TEMPORARY} TABLE [IF NOT EXISTS]"]),Ey=nG(["CREATE [OR REPLACE] [SECURE] [RECURSIVE] VIEW [IF NOT EXISTS]","UPDATE","DELETE FROM","DROP TABLE [IF EXISTS]","ALTER TABLE [IF EXISTS]","RENAME TO","SWAP WITH","[SUSPEND | RESUME] RECLUSTER","DROP CLUSTERING KEY","ADD [COLUMN]","RENAME COLUMN","{ALTER | MODIFY} [COLUMN]","DROP [COLUMN]","{ADD | ALTER | MODIFY | DROP} [CONSTRAINT]","RENAME CONSTRAINT","{ADD | DROP} SEARCH OPTIMIZATION","{SET | UNSET} TAG","{ADD | DROP} ROW ACCESS POLICY","DROP ALL ROW ACCESS POLICIES","{SET | DROP} DEFAULT","{SET | DROP} NOT NULL","SET DATA TYPE","UNSET COMMENT","{SET | UNSET} MASKING POLICY","TRUNCATE [TABLE] [IF EXISTS]","ALTER ACCOUNT","ALTER API INTEGRATION","ALTER CONNECTION","ALTER DATABASE","ALTER EXTERNAL TABLE","ALTER FAILOVER GROUP","ALTER FILE FORMAT","ALTER FUNCTION","ALTER INTEGRATION","ALTER MASKING POLICY","ALTER MATERIALIZED VIEW","ALTER NETWORK POLICY","ALTER NOTIFICATION INTEGRATION","ALTER PIPE","ALTER PROCEDURE","ALTER REPLICATION GROUP","ALTER RESOURCE MONITOR","ALTER ROLE","ALTER ROW ACCESS POLICY","ALTER SCHEMA","ALTER SECURITY INTEGRATION","ALTER SEQUENCE","ALTER SESSION","ALTER SESSION POLICY","ALTER SHARE","ALTER STAGE","ALTER STORAGE INTEGRATION","ALTER STREAM","ALTER TAG","ALTER TASK","ALTER USER","ALTER VIEW","ALTER WAREHOUSE","BEGIN","CALL","COMMIT","COPY INTO","CREATE ACCOUNT","CREATE API INTEGRATION","CREATE CONNECTION","CREATE DATABASE","CREATE EXTERNAL FUNCTION","CREATE EXTERNAL TABLE","CREATE FAILOVER GROUP","CREATE FILE FORMAT","CREATE FUNCTION","CREATE INTEGRATION","CREATE MANAGED ACCOUNT","CREATE MASKING POLICY","CREATE MATERIALIZED VIEW","CREATE NETWORK POLICY","CREATE NOTIFICATION INTEGRATION","CREATE PIPE","CREATE PROCEDURE","CREATE REPLICATION GROUP","CREATE RESOURCE MONITOR","CREATE ROLE","CREATE ROW ACCESS POLICY","CREATE SCHEMA","CREATE SECURITY INTEGRATION","CREATE SEQUENCE","CREATE SESSION POLICY","CREATE SHARE","CREATE STAGE","CREATE STORAGE INTEGRATION","CREATE STREAM","CREATE TAG","CREATE TASK","CREATE USER","CREATE WAREHOUSE","DELETE","DESCRIBE DATABASE","DESCRIBE EXTERNAL TABLE","DESCRIBE FILE FORMAT","DESCRIBE FUNCTION","DESCRIBE INTEGRATION","DESCRIBE MASKING POLICY","DESCRIBE MATERIALIZED VIEW","DESCRIBE NETWORK POLICY","DESCRIBE PIPE","DESCRIBE PROCEDURE","DESCRIBE RESULT","DESCRIBE ROW ACCESS POLICY","DESCRIBE SCHEMA","DESCRIBE SEQUENCE","DESCRIBE SESSION POLICY","DESCRIBE SHARE","DESCRIBE STAGE","DESCRIBE STREAM","DESCRIBE TABLE","DESCRIBE TASK","DESCRIBE TRANSACTION","DESCRIBE USER","DESCRIBE VIEW","DESCRIBE WAREHOUSE","DROP CONNECTION","DROP DATABASE","DROP EXTERNAL TABLE","DROP FAILOVER GROUP","DROP FILE FORMAT","DROP FUNCTION","DROP INTEGRATION","DROP MANAGED ACCOUNT","DROP MASKING POLICY","DROP MATERIALIZED VIEW","DROP NETWORK POLICY","DROP PIPE","DROP PROCEDURE","DROP REPLICATION GROUP","DROP RESOURCE MONITOR","DROP ROLE","DROP ROW ACCESS POLICY","DROP SCHEMA","DROP SEQUENCE","DROP SESSION POLICY","DROP SHARE","DROP STAGE","DROP STREAM","DROP TAG","DROP TASK","DROP USER","DROP VIEW","DROP WAREHOUSE","EXECUTE IMMEDIATE","EXECUTE TASK","EXPLAIN","GET","GRANT OWNERSHIP","GRANT ROLE","INSERT","LIST","MERGE","PUT","REMOVE","REVOKE ROLE","ROLLBACK","SHOW COLUMNS","SHOW CONNECTIONS","SHOW DATABASES","SHOW DATABASES IN FAILOVER GROUP","SHOW DATABASES IN REPLICATION GROUP","SHOW DELEGATED AUTHORIZATIONS","SHOW EXTERNAL FUNCTIONS","SHOW EXTERNAL TABLES","SHOW FAILOVER GROUPS","SHOW FILE FORMATS","SHOW FUNCTIONS","SHOW GLOBAL ACCOUNTS","SHOW GRANTS","SHOW INTEGRATIONS","SHOW LOCKS","SHOW MANAGED ACCOUNTS","SHOW MASKING POLICIES","SHOW MATERIALIZED VIEWS","SHOW NETWORK POLICIES","SHOW OBJECTS","SHOW ORGANIZATION ACCOUNTS","SHOW PARAMETERS","SHOW PIPES","SHOW PRIMARY KEYS","SHOW PROCEDURES","SHOW REGIONS","SHOW REPLICATION ACCOUNTS","SHOW REPLICATION DATABASES","SHOW REPLICATION GROUPS","SHOW RESOURCE MONITORS","SHOW ROLES","SHOW ROW ACCESS POLICIES","SHOW SCHEMAS","SHOW SEQUENCES","SHOW SESSION POLICIES","SHOW SHARES","SHOW SHARES IN FAILOVER GROUP","SHOW SHARES IN REPLICATION GROUP","SHOW STAGES","SHOW STREAMS","SHOW TABLES","SHOW TAGS","SHOW TASKS","SHOW TRANSACTIONS","SHOW USER FUNCTIONS","SHOW USERS","SHOW VARIABLES","SHOW VIEWS","SHOW WAREHOUSES","TRUNCATE MATERIALIZED VIEW","UNDROP DATABASE","UNDROP SCHEMA","UNDROP TABLE","UNDROP TAG","UNSET","USE DATABASE","USE ROLE","USE SCHEMA","USE SECONDARY ROLES","USE WAREHOUSE"]),Eg=nG(["UNION [ALL]","MINUS","EXCEPT","INTERSECT"]),EP=nG(["[INNER] JOIN","[NATURAL] {LEFT | RIGHT | FULL} [OUTER] JOIN","{CROSS | NATURAL} JOIN"]),Eb=nG(["{ROWS | RANGE} BETWEEN","ON {UPDATE | DELETE} [SET NULL | SET DEFAULT]"]),ED=nG([]),Ev={name:"snowflake",tokenizerOptions:{reservedSelect:Em,reservedClauses:[...EC,...EL,...Ey],reservedSetOperations:Eg,reservedJoins:EP,reservedKeywordPhrases:Eb,reservedDataTypePhrases:ED,reservedKeywords:["ACCOUNT","ALL","ALTER","AND","ANY","AS","BETWEEN","BY","CASE","CAST","CHECK","COLUMN","CONNECT","CONNECTION","CONSTRAINT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","DATABASE","DELETE","DISTINCT","DROP","ELSE","EXISTS","FALSE","FOLLOWING","FOR","FROM","FULL","GRANT","GROUP","GSCLUSTER","HAVING","ILIKE","IN","INCREMENT","INNER","INSERT","INTERSECT","INTO","IS","ISSUE","JOIN","LATERAL","LEFT","LIKE","LOCALTIME","LOCALTIMESTAMP","MINUS","NATURAL","NOT","NULL","OF","ON","OR","ORDER","ORGANIZATION","QUALIFY","REGEXP","REVOKE","RIGHT","RLIKE","ROW","ROWS","SAMPLE","SCHEMA","SELECT","SET","SOME","START","TABLE","TABLESAMPLE","THEN","TO","TRIGGER","TRUE","TRY_CAST","UNION","UNIQUE","UPDATE","USING","VALUES","VIEW","WHEN","WHENEVER","WHERE","WITH","COMMENT"],reservedDataTypes:["NUMBER","DECIMAL","NUMERIC","INT","INTEGER","BIGINT","SMALLINT","TINYINT","BYTEINT","FLOAT","FLOAT4","FLOAT8","DOUBLE","DOUBLE PRECISION","REAL","VARCHAR","CHAR","CHARACTER","STRING","TEXT","BINARY","VARBINARY","BOOLEAN","DATE","DATETIME","TIME","TIMESTAMP","TIMESTAMP_LTZ","TIMESTAMP_NTZ","TIMESTAMP","TIMESTAMP_TZ","VARIANT","OBJECT","ARRAY","GEOGRAPHY","GEOMETRY"],reservedFunctionNames:["ABS","ACOS","ACOSH","ADD_MONTHS","ALL_USER_NAMES","ANY_VALUE","APPROX_COUNT_DISTINCT","APPROX_PERCENTILE","APPROX_PERCENTILE_ACCUMULATE","APPROX_PERCENTILE_COMBINE","APPROX_PERCENTILE_ESTIMATE","APPROX_TOP_K","APPROX_TOP_K_ACCUMULATE","APPROX_TOP_K_COMBINE","APPROX_TOP_K_ESTIMATE","APPROXIMATE_JACCARD_INDEX","APPROXIMATE_SIMILARITY","ARRAY_AGG","ARRAY_APPEND","ARRAY_CAT","ARRAY_COMPACT","ARRAY_CONSTRUCT","ARRAY_CONSTRUCT_COMPACT","ARRAY_CONTAINS","ARRAY_INSERT","ARRAY_INTERSECTION","ARRAY_POSITION","ARRAY_PREPEND","ARRAY_SIZE","ARRAY_SLICE","ARRAY_TO_STRING","ARRAY_UNION_AGG","ARRAY_UNIQUE_AGG","ARRAYS_OVERLAP","AS_ARRAY","AS_BINARY","AS_BOOLEAN","AS_CHAR","AS_VARCHAR","AS_DATE","AS_DECIMAL","AS_NUMBER","AS_DOUBLE","AS_REAL","AS_INTEGER","AS_OBJECT","AS_TIME","AS_TIMESTAMP_LTZ","AS_TIMESTAMP_NTZ","AS_TIMESTAMP_TZ","ASCII","ASIN","ASINH","ATAN","ATAN2","ATANH","AUTO_REFRESH_REGISTRATION_HISTORY","AUTOMATIC_CLUSTERING_HISTORY","AVG","BASE64_DECODE_BINARY","BASE64_DECODE_STRING","BASE64_ENCODE","BIT_LENGTH","BITAND","BITAND_AGG","BITMAP_BIT_POSITION","BITMAP_BUCKET_NUMBER","BITMAP_CONSTRUCT_AGG","BITMAP_COUNT","BITMAP_OR_AGG","BITNOT","BITOR","BITOR_AGG","BITSHIFTLEFT","BITSHIFTRIGHT","BITXOR","BITXOR_AGG","BOOLAND","BOOLAND_AGG","BOOLNOT","BOOLOR","BOOLOR_AGG","BOOLXOR","BOOLXOR_AGG","BUILD_SCOPED_FILE_URL","BUILD_STAGE_FILE_URL","CASE","CAST","CBRT","CEIL","CHARINDEX","CHECK_JSON","CHECK_XML","CHR","CHAR","COALESCE","COLLATE","COLLATION","COMPLETE_TASK_GRAPHS","COMPRESS","CONCAT","CONCAT_WS","CONDITIONAL_CHANGE_EVENT","CONDITIONAL_TRUE_EVENT","CONTAINS","CONVERT_TIMEZONE","COPY_HISTORY","CORR","COS","COSH","COT","COUNT","COUNT_IF","COVAR_POP","COVAR_SAMP","CUME_DIST","CURRENT_ACCOUNT","CURRENT_AVAILABLE_ROLES","CURRENT_CLIENT","CURRENT_DATABASE","CURRENT_DATE","CURRENT_IP_ADDRESS","CURRENT_REGION","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SCHEMAS","CURRENT_SECONDARY_ROLES","CURRENT_SESSION","CURRENT_STATEMENT","CURRENT_TASK_GRAPHS","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TRANSACTION","CURRENT_USER","CURRENT_VERSION","CURRENT_WAREHOUSE","DATA_TRANSFER_HISTORY","DATABASE_REFRESH_HISTORY","DATABASE_REFRESH_PROGRESS","DATABASE_REFRESH_PROGRESS_BY_JOB","DATABASE_STORAGE_USAGE_HISTORY","DATE_FROM_PARTS","DATE_PART","DATE_TRUNC","DATEADD","DATEDIFF","DAYNAME","DECODE","DECOMPRESS_BINARY","DECOMPRESS_STRING","DECRYPT","DECRYPT_RAW","DEGREES","DENSE_RANK","DIV0","EDITDISTANCE","ENCRYPT","ENCRYPT_RAW","ENDSWITH","EQUAL_NULL","EXP","EXPLAIN_JSON","EXTERNAL_FUNCTIONS_HISTORY","EXTERNAL_TABLE_FILES","EXTERNAL_TABLE_FILE_REGISTRATION_HISTORY","EXTRACT","EXTRACT_SEMANTIC_CATEGORIES","FACTORIAL","FILTER","FIRST_VALUE","FLATTEN","FLOOR","GENERATE_COLUMN_DESCRIPTION","GENERATOR","GET","GET_ABSOLUTE_PATH","GET_DDL","GET_IGNORE_CASE","GET_OBJECT_REFERENCES","GET_PATH","GET_PRESIGNED_URL","GET_RELATIVE_PATH","GET_STAGE_LOCATION","GETBIT","GREATEST","GREATEST_IGNORE_NULLS","GROUPING","GROUPING_ID","HASH","HASH_AGG","HAVERSINE","HEX_DECODE_BINARY","HEX_DECODE_STRING","HEX_ENCODE","HLL","HLL_ACCUMULATE","HLL_COMBINE","HLL_ESTIMATE","HLL_EXPORT","HLL_IMPORT","HOUR","MINUTE","SECOND","IDENTIFIER","IFF","IFNULL","ILIKE","ILIKE ANY","INFER_SCHEMA","INITCAP","INSERT","INVOKER_ROLE","INVOKER_SHARE","IS_ARRAY","IS_BINARY","IS_BOOLEAN","IS_CHAR","IS_VARCHAR","IS_DATE","IS_DATE_VALUE","IS_DECIMAL","IS_DOUBLE","IS_REAL","IS_GRANTED_TO_INVOKER_ROLE","IS_INTEGER","IS_NULL_VALUE","IS_OBJECT","IS_ROLE_IN_SESSION","IS_TIME","IS_TIMESTAMP_LTZ","IS_TIMESTAMP_NTZ","IS_TIMESTAMP_TZ","JAROWINKLER_SIMILARITY","JSON_EXTRACT_PATH_TEXT","KURTOSIS","LAG","LAST_DAY","LAST_QUERY_ID","LAST_TRANSACTION","LAST_VALUE","LEAD","LEAST","LEFT","LENGTH","LEN","LIKE","LIKE ALL","LIKE ANY","LISTAGG","LN","LOCALTIME","LOCALTIMESTAMP","LOG","LOGIN_HISTORY","LOGIN_HISTORY_BY_USER","LOWER","LPAD","LTRIM","MATERIALIZED_VIEW_REFRESH_HISTORY","MD5","MD5_HEX","MD5_BINARY","MD5_NUMBER  Obsoleted","MD5_NUMBER_LOWER64","MD5_NUMBER_UPPER64","MEDIAN","MIN","MAX","MINHASH","MINHASH_COMBINE","MOD","MODE","MONTHNAME","MONTHS_BETWEEN","NEXT_DAY","NORMAL","NTH_VALUE","NTILE","NULLIF","NULLIFZERO","NVL","NVL2","OBJECT_AGG","OBJECT_CONSTRUCT","OBJECT_CONSTRUCT_KEEP_NULL","OBJECT_DELETE","OBJECT_INSERT","OBJECT_KEYS","OBJECT_PICK","OCTET_LENGTH","PARSE_IP","PARSE_JSON","PARSE_URL","PARSE_XML","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","PI","PIPE_USAGE_HISTORY","POLICY_CONTEXT","POLICY_REFERENCES","POSITION","POW","POWER","PREVIOUS_DAY","QUERY_ACCELERATION_HISTORY","QUERY_HISTORY","QUERY_HISTORY_BY_SESSION","QUERY_HISTORY_BY_USER","QUERY_HISTORY_BY_WAREHOUSE","RADIANS","RANDOM","RANDSTR","RANK","RATIO_TO_REPORT","REGEXP","REGEXP_COUNT","REGEXP_INSTR","REGEXP_LIKE","REGEXP_REPLACE","REGEXP_SUBSTR","REGEXP_SUBSTR_ALL","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","REGR_VALX","REGR_VALY","REPEAT","REPLACE","REPLICATION_GROUP_REFRESH_HISTORY","REPLICATION_GROUP_REFRESH_PROGRESS","REPLICATION_GROUP_REFRESH_PROGRESS_BY_JOB","REPLICATION_GROUP_USAGE_HISTORY","REPLICATION_USAGE_HISTORY","REST_EVENT_HISTORY","RESULT_SCAN","REVERSE","RIGHT","RLIKE","ROUND","ROW_NUMBER","RPAD","RTRIM","RTRIMMED_LENGTH","SEARCH_OPTIMIZATION_HISTORY","SEQ1","SEQ2","SEQ4","SEQ8","SERVERLESS_TASK_HISTORY","SHA1","SHA1_HEX","SHA1_BINARY","SHA2","SHA2_HEX","SHA2_BINARY","SIGN","SIN","SINH","SKEW","SOUNDEX","SPACE","SPLIT","SPLIT_PART","SPLIT_TO_TABLE","SQRT","SQUARE","ST_AREA","ST_ASEWKB","ST_ASEWKT","ST_ASGEOJSON","ST_ASWKB","ST_ASBINARY","ST_ASWKT","ST_ASTEXT","ST_AZIMUTH","ST_CENTROID","ST_COLLECT","ST_CONTAINS","ST_COVEREDBY","ST_COVERS","ST_DIFFERENCE","ST_DIMENSION","ST_DISJOINT","ST_DISTANCE","ST_DWITHIN","ST_ENDPOINT","ST_ENVELOPE","ST_GEOGFROMGEOHASH","ST_GEOGPOINTFROMGEOHASH","ST_GEOGRAPHYFROMWKB","ST_GEOGRAPHYFROMWKT","ST_GEOHASH","ST_GEOMETRYFROMWKB","ST_GEOMETRYFROMWKT","ST_HAUSDORFFDISTANCE","ST_INTERSECTION","ST_INTERSECTS","ST_LENGTH","ST_MAKEGEOMPOINT","ST_GEOM_POINT","ST_MAKELINE","ST_MAKEPOINT","ST_POINT","ST_MAKEPOLYGON","ST_POLYGON","ST_NPOINTS","ST_NUMPOINTS","ST_PERIMETER","ST_POINTN","ST_SETSRID","ST_SIMPLIFY","ST_SRID","ST_STARTPOINT","ST_SYMDIFFERENCE","ST_UNION","ST_WITHIN","ST_X","ST_XMAX","ST_XMIN","ST_Y","ST_YMAX","ST_YMIN","STAGE_DIRECTORY_FILE_REGISTRATION_HISTORY","STAGE_STORAGE_USAGE_HISTORY","STARTSWITH","STDDEV","STDDEV_POP","STDDEV_SAMP","STRIP_NULL_VALUE","STRTOK","STRTOK_SPLIT_TO_TABLE","STRTOK_TO_ARRAY","SUBSTR","SUBSTRING","SUM","SYSDATE","SYSTEM$ABORT_SESSION","SYSTEM$ABORT_TRANSACTION","SYSTEM$AUTHORIZE_PRIVATELINK","SYSTEM$AUTHORIZE_STAGE_PRIVATELINK_ACCESS","SYSTEM$BEHAVIOR_CHANGE_BUNDLE_STATUS","SYSTEM$CANCEL_ALL_QUERIES","SYSTEM$CANCEL_QUERY","SYSTEM$CLUSTERING_DEPTH","SYSTEM$CLUSTERING_INFORMATION","SYSTEM$CLUSTERING_RATIO ","SYSTEM$CURRENT_USER_TASK_NAME","SYSTEM$DATABASE_REFRESH_HISTORY ","SYSTEM$DATABASE_REFRESH_PROGRESS","SYSTEM$DATABASE_REFRESH_PROGRESS_BY_JOB ","SYSTEM$DISABLE_BEHAVIOR_CHANGE_BUNDLE","SYSTEM$DISABLE_DATABASE_REPLICATION","SYSTEM$ENABLE_BEHAVIOR_CHANGE_BUNDLE","SYSTEM$ESTIMATE_QUERY_ACCELERATION","SYSTEM$ESTIMATE_SEARCH_OPTIMIZATION_COSTS","SYSTEM$EXPLAIN_JSON_TO_TEXT","SYSTEM$EXPLAIN_PLAN_JSON","SYSTEM$EXTERNAL_TABLE_PIPE_STATUS","SYSTEM$GENERATE_SAML_CSR","SYSTEM$GENERATE_SCIM_ACCESS_TOKEN","SYSTEM$GET_AWS_SNS_IAM_POLICY","SYSTEM$GET_PREDECESSOR_RETURN_VALUE","SYSTEM$GET_PRIVATELINK","SYSTEM$GET_PRIVATELINK_AUTHORIZED_ENDPOINTS","SYSTEM$GET_PRIVATELINK_CONFIG","SYSTEM$GET_SNOWFLAKE_PLATFORM_INFO","SYSTEM$GET_TAG","SYSTEM$GET_TAG_ALLOWED_VALUES","SYSTEM$GET_TAG_ON_CURRENT_COLUMN","SYSTEM$GET_TAG_ON_CURRENT_TABLE","SYSTEM$GLOBAL_ACCOUNT_SET_PARAMETER","SYSTEM$LAST_CHANGE_COMMIT_TIME","SYSTEM$LINK_ACCOUNT_OBJECTS_BY_NAME","SYSTEM$MIGRATE_SAML_IDP_REGISTRATION","SYSTEM$PIPE_FORCE_RESUME","SYSTEM$PIPE_STATUS","SYSTEM$REVOKE_PRIVATELINK","SYSTEM$REVOKE_STAGE_PRIVATELINK_ACCESS","SYSTEM$SET_RETURN_VALUE","SYSTEM$SHOW_OAUTH_CLIENT_SECRETS","SYSTEM$STREAM_GET_TABLE_TIMESTAMP","SYSTEM$STREAM_HAS_DATA","SYSTEM$TASK_DEPENDENTS_ENABLE","SYSTEM$TYPEOF","SYSTEM$USER_TASK_CANCEL_ONGOING_EXECUTIONS","SYSTEM$VERIFY_EXTERNAL_OAUTH_TOKEN","SYSTEM$WAIT","SYSTEM$WHITELIST","SYSTEM$WHITELIST_PRIVATELINK","TAG_REFERENCES","TAG_REFERENCES_ALL_COLUMNS","TAG_REFERENCES_WITH_LINEAGE","TAN","TANH","TASK_DEPENDENTS","TASK_HISTORY","TIME_FROM_PARTS","TIME_SLICE","TIMEADD","TIMEDIFF","TIMESTAMP_FROM_PARTS","TIMESTAMPADD","TIMESTAMPDIFF","TO_ARRAY","TO_BINARY","TO_BOOLEAN","TO_CHAR","TO_VARCHAR","TO_DATE","DATE","TO_DECIMAL","TO_NUMBER","TO_NUMERIC","TO_DOUBLE","TO_GEOGRAPHY","TO_GEOMETRY","TO_JSON","TO_OBJECT","TO_TIME","TIME","TO_TIMESTAMP","TO_TIMESTAMP_LTZ","TO_TIMESTAMP_NTZ","TO_TIMESTAMP_TZ","TO_VARIANT","TO_XML","TRANSLATE","TRIM","TRUNCATE","TRUNC","TRUNC","TRY_BASE64_DECODE_BINARY","TRY_BASE64_DECODE_STRING","TRY_CAST","TRY_HEX_DECODE_BINARY","TRY_HEX_DECODE_STRING","TRY_PARSE_JSON","TRY_TO_BINARY","TRY_TO_BOOLEAN","TRY_TO_DATE","TRY_TO_DECIMAL","TRY_TO_NUMBER","TRY_TO_NUMERIC","TRY_TO_DOUBLE","TRY_TO_GEOGRAPHY","TRY_TO_GEOMETRY","TRY_TO_TIME","TRY_TO_TIMESTAMP","TRY_TO_TIMESTAMP_LTZ","TRY_TO_TIMESTAMP_NTZ","TRY_TO_TIMESTAMP_TZ","TYPEOF","UNICODE","UNIFORM","UPPER","UUID_STRING","VALIDATE","VALIDATE_PIPE_LOAD","VAR_POP","VAR_SAMP","VARIANCE","VARIANCE_SAMP","VARIANCE_POP","WAREHOUSE_LOAD_HISTORY","WAREHOUSE_METERING_HISTORY","WIDTH_BUCKET","XMLGET","YEAR","YEAROFWEEK","YEAROFWEEKISO","DAY","DAYOFMONTH","DAYOFWEEK","DAYOFWEEKISO","DAYOFYEAR","WEEK","WEEK","WEEKOFYEAR","WEEKISO","MONTH","QUARTER","ZEROIFNULL","ZIPF"],stringTypes:["$$","''-qq-bs"],identTypes:['""-qq'],variableTypes:[{regex:"[$][1-9]\\d*"},{regex:"[$][_a-zA-Z][_a-zA-Z0-9$]*"}],extraParens:["[]"],identChars:{rest:"$"},lineCommentTypes:["--","//"],operators:["%","::","||","=>",":=","->"],propertyAccessOperators:[":"]},formatOptions:{alwaysDenseOperators:["::"],onelineClauses:[...EL,...Ey],tabularOnelineClauses:Ey}},EM=e=>e[e.length-1],EU=e=>e.sort((e,t)=>t.length-e.length||e.localeCompare(t)),Ew=e=>e.replace(/\s+/gu," "),EG=e=>/\n/.test(e),EB=e=>e.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&"),EF=/\s+/uy,EH=e=>RegExp(`(?:${e})`,"uy"),Ex=e=>e.split("").map(e=>/ /gu.test(e)?"\\s+":`[${e.toUpperCase()}${e.toLowerCase()}]`).join(""),Ek=e=>e+"(?:-"+e+")*",EY=({prefixes:e,requirePrefix:t})=>`(?:${e.map(Ex).join("|")}${t?"":"|"})`,EV=e=>RegExp(`(?:${e.map(EB).join("|")}).*?(?=\r
|\r|
|$)`,"uy"),E$=(e,t=[])=>{let r="open"===e?0:1,a=["()",...t].map(e=>e[r]);return EH(a.map(EB).join("|"))},EW=e=>EH(`${EU(e).map(EB).join("|")}`),Ej=({rest:e,dashes:t})=>e||t?`(?![${e||""}${t?"-":""}])`:"",EX=(e,t={})=>{if(0===e.length)return/^\b$/u;let r=Ej(t),a=EU(e).map(EB).join("|").replace(/ /gu,"\\s+");return RegExp(`(?:${a})${r}\\b`,"iuy")},EK=(e,t)=>{if(!e.length)return;let r=e.map(EB).join("|");return EH(`(?:${r})(?:${t})`)},EZ={"``":"(?:`[^`]*`)+","[]":String.raw`(?:\[[^\]]*\])(?:\][^\]]*\])*`,'""-qq':String.raw`(?:"[^"]*")+`,'""-bs':String.raw`(?:"[^"\\]*(?:\\.[^"\\]*)*")`,'""-qq-bs':String.raw`(?:"[^"\\]*(?:\\.[^"\\]*)*")+`,'""-raw':String.raw`(?:"[^"]*")`,"''-qq":String.raw`(?:'[^']*')+`,"''-bs":String.raw`(?:'[^'\\]*(?:\\.[^'\\]*)*')`,"''-qq-bs":String.raw`(?:'[^'\\]*(?:\\.[^'\\]*)*')+`,"''-raw":String.raw`(?:'[^']*')`,$$:String.raw`(?<tag>\$\w*\$)[\s\S]*?\k<tag>`,"'''..'''":String.raw`'''[^\\]*?(?:\\.[^\\]*?)*?'''`,'""".."""':String.raw`"""[^\\]*?(?:\\.[^\\]*?)*?"""`,"{}":String.raw`(?:\{[^\}]*\})`,"q''":(()=>{let e={"<":">","[":"]","(":")","{":"}"},t=Object.entries(e).map(([e,t])=>"{left}(?:(?!{right}').)*?{right}".replace(/{left}/g,EB(e)).replace(/{right}/g,EB(t))),r=EB(Object.keys(e).join("")),a=String.raw`(?<tag>[^\s${r}])(?:(?!\k<tag>').)*?\k<tag>`,s=`[Qq]'(?:${a}|${t.join("|")})'`;return s})()},Eq=e=>"string"==typeof e?EZ[e]:"regex"in e?e.regex:EY(e)+EZ[e.quote],EJ=e=>EH(e.map(e=>"regex"in e?e.regex:Eq(e)).join("|")),Ez=e=>e.map(Eq).join("|"),EQ=e=>EH(Ez(e)),E0=(e={})=>EH(E1(e)),E1=({first:e,rest:t,dashes:r,allowFirstCharNumber:a}={})=>{let s="\\p{Alphabetic}\\p{Mark}_",i="\\p{Decimal_Number}",n=EB(null!=e?e:""),o=EB(null!=t?t:""),l=a?`[${s}${i}${n}][${s}${i}${o}]*`:`[${s}${n}][${s}${i}${o}]*`;return r?Ek(l):l};function E2(e,t){let r=e.slice(0,t).split(/\n/);return{line:r.length,col:r[r.length-1].length+1}}class E4{constructor(e,t){this.rules=e,this.dialectName=t,this.input="",this.index=0}tokenize(e){let t;this.input=e,this.index=0;let r=[];for(;this.index<this.input.length;){let e=this.getWhitespace();if(this.index<this.input.length){if(!(t=this.getNextToken()))throw this.createParseError();r.push(Object.assign(Object.assign({},t),{precedingWhitespace:e}))}}return r}createParseError(){let e=this.input.slice(this.index,this.index+10),{line:t,col:r}=E2(this.input,this.index);return Error(`Parse error: Unexpected "${e}" at line ${t} column ${r}.
${this.dialectInfo()}`)}dialectInfo(){return"sql"===this.dialectName?`This likely happens because you're using the default "sql" dialect.
If possible, please select a more specific dialect (like sqlite, postgresql, etc).`:`SQL dialect used: "${this.dialectName}".`}getWhitespace(){EF.lastIndex=this.index;let e=EF.exec(this.input);if(e)return this.index+=e[0].length,e[0]}getNextToken(){for(let e of this.rules){let t=this.match(e);if(t)return t}}match(e){e.regex.lastIndex=this.index;let t=e.regex.exec(this.input);if(t){let r=t[0],a={type:e.type,raw:r,text:e.text?e.text(r):r,start:this.index};return e.key&&(a.key=e.key(r)),this.index+=r.length,a}}}let E9=/\/\*/uy,E5=/[\s\S]/uy,E3=/\*\//uy;class E6{constructor(){this.lastIndex=0}exec(e){let t,r="",a=0;if(!(t=this.matchSection(E9,e)))return null;for(r+=t,a++;a>0;)if(t=this.matchSection(E9,e))r+=t,a++;else if(t=this.matchSection(E3,e))r+=t,a--;else{if(!(t=this.matchSection(E5,e)))return null;r+=t}return[r]}matchSection(e,t){e.lastIndex=this.lastIndex;let r=e.exec(t);return r&&(this.lastIndex+=r[0].length),r?r[0]:null}}class E8{constructor(e,t){this.cfg=e,this.dialectName=t,this.rulesBeforeParams=this.buildRulesBeforeParams(e),this.rulesAfterParams=this.buildRulesAfterParams(e)}tokenize(e,t){let r=[...this.rulesBeforeParams,...this.buildParamRules(this.cfg,t),...this.rulesAfterParams],a=new E4(r,this.dialectName).tokenize(e);return this.cfg.postProcess?this.cfg.postProcess(a):a}buildRulesBeforeParams(e){var t,r,a;return this.validRules([{type:ew.DISABLE_COMMENT,regex:/(\/\* *sql-formatter-disable *\*\/[\s\S]*?(?:\/\* *sql-formatter-enable *\*\/|$))/uy},{type:ew.BLOCK_COMMENT,regex:e.nestedBlockComments?new E6:/(\/\*[^]*?\*\/)/uy},{type:ew.LINE_COMMENT,regex:EV(null!==(t=e.lineCommentTypes)&&void 0!==t?t:["--"])},{type:ew.QUOTED_IDENTIFIER,regex:EQ(e.identTypes)},{type:ew.NUMBER,regex:e.underscoresInNumbers?/(?:0x[0-9a-fA-F_]+|0b[01_]+|(?:-\s*)?(?:[0-9_]*\.[0-9_]+|[0-9_]+(?:\.[0-9_]*)?)(?:[eE][-+]?[0-9_]+(?:\.[0-9_]+)?)?)(?![\w\p{Alphabetic}])/uy:/(?:0x[0-9a-fA-F]+|0b[01]+|(?:-\s*)?(?:[0-9]*\.[0-9]+|[0-9]+(?:\.[0-9]*)?)(?:[eE][-+]?[0-9]+(?:\.[0-9]+)?)?)(?![\w\p{Alphabetic}])/uy},{type:ew.RESERVED_KEYWORD_PHRASE,regex:EX(null!==(r=e.reservedKeywordPhrases)&&void 0!==r?r:[],e.identChars),text:E7},{type:ew.RESERVED_DATA_TYPE_PHRASE,regex:EX(null!==(a=e.reservedDataTypePhrases)&&void 0!==a?a:[],e.identChars),text:E7},{type:ew.CASE,regex:/CASE\b/iuy,text:E7},{type:ew.END,regex:/END\b/iuy,text:E7},{type:ew.BETWEEN,regex:/BETWEEN\b/iuy,text:E7},{type:ew.LIMIT,regex:e.reservedClauses.includes("LIMIT")?/LIMIT\b/iuy:void 0,text:E7},{type:ew.RESERVED_CLAUSE,regex:EX(e.reservedClauses,e.identChars),text:E7},{type:ew.RESERVED_SELECT,regex:EX(e.reservedSelect,e.identChars),text:E7},{type:ew.RESERVED_SET_OPERATION,regex:EX(e.reservedSetOperations,e.identChars),text:E7},{type:ew.WHEN,regex:/WHEN\b/iuy,text:E7},{type:ew.ELSE,regex:/ELSE\b/iuy,text:E7},{type:ew.THEN,regex:/THEN\b/iuy,text:E7},{type:ew.RESERVED_JOIN,regex:EX(e.reservedJoins,e.identChars),text:E7},{type:ew.AND,regex:/AND\b/iuy,text:E7},{type:ew.OR,regex:/OR\b/iuy,text:E7},{type:ew.XOR,regex:e.supportsXor?/XOR\b/iuy:void 0,text:E7},...e.operatorKeyword?[{type:ew.OPERATOR,regex:/OPERATOR *\([^)]+\)/iuy}]:[],{type:ew.RESERVED_FUNCTION_NAME,regex:EX(e.reservedFunctionNames,e.identChars),text:E7},{type:ew.RESERVED_DATA_TYPE,regex:EX(e.reservedDataTypes,e.identChars),text:E7},{type:ew.RESERVED_KEYWORD,regex:EX(e.reservedKeywords,e.identChars),text:E7}])}buildRulesAfterParams(e){var t,r;return this.validRules([{type:ew.VARIABLE,regex:e.variableTypes?EJ(e.variableTypes):void 0},{type:ew.STRING,regex:EQ(e.stringTypes)},{type:ew.IDENTIFIER,regex:E0(e.identChars)},{type:ew.DELIMITER,regex:/[;]/uy},{type:ew.COMMA,regex:/[,]/y},{type:ew.OPEN_PAREN,regex:E$("open",e.extraParens)},{type:ew.CLOSE_PAREN,regex:E$("close",e.extraParens)},{type:ew.OPERATOR,regex:EW(["+","-","/",">","<","=","<>","<=",">=","!=",...null!==(t=e.operators)&&void 0!==t?t:[]])},{type:ew.ASTERISK,regex:/[*]/uy},{type:ew.PROPERTY_ACCESS_OPERATOR,regex:EW([".",...null!==(r=e.propertyAccessOperators)&&void 0!==r?r:[]])}])}buildParamRules(e,t){var r,a,s,i,n;let o={named:(null==t?void 0:t.named)||(null===(r=e.paramTypes)||void 0===r?void 0:r.named)||[],quoted:(null==t?void 0:t.quoted)||(null===(a=e.paramTypes)||void 0===a?void 0:a.quoted)||[],numbered:(null==t?void 0:t.numbered)||(null===(s=e.paramTypes)||void 0===s?void 0:s.numbered)||[],positional:"boolean"==typeof(null==t?void 0:t.positional)?t.positional:null===(i=e.paramTypes)||void 0===i?void 0:i.positional,custom:(null==t?void 0:t.custom)||(null===(n=e.paramTypes)||void 0===n?void 0:n.custom)||[]};return this.validRules([{type:ew.NAMED_PARAMETER,regex:EK(o.named,E1(e.paramChars||e.identChars)),key:e=>e.slice(1)},{type:ew.QUOTED_PARAMETER,regex:EK(o.quoted,Ez(e.identTypes)),key:e=>(({tokenKey:e,quoteChar:t})=>e.replace(RegExp(EB("\\"+t),"gu"),t))({tokenKey:e.slice(2,-1),quoteChar:e.slice(-1)})},{type:ew.NUMBERED_PARAMETER,regex:EK(o.numbered,"[0-9]+"),key:e=>e.slice(1)},{type:ew.POSITIONAL_PARAMETER,regex:o.positional?/[?]/y:void 0},...o.custom.map(e=>{var t;return{type:ew.CUSTOM_PARAMETER,regex:EH(e.regex),key:null!==(t=e.key)&&void 0!==t?t:e=>e}})])}validRules(e){return e.filter(e=>!!e.regex)}}let E7=e=>Ew(e.toUpperCase()),ue=new Map,ut=e=>{let t=ue.get(e);return t||(t=ur(e),ue.set(e,t)),t},ur=e=>({tokenizer:new E8(e.tokenizerOptions,e.name),formatOptions:ua(e.formatOptions)}),ua=e=>{var t;return{alwaysDenseOperators:e.alwaysDenseOperators||[],onelineClauses:Object.fromEntries(e.onelineClauses.map(e=>[e,!0])),tabularOnelineClauses:Object.fromEntries((null!==(t=e.tabularOnelineClauses)&&void 0!==t?t:e.onelineClauses).map(e=>[e,!0]))}};function us(e){return"tabularLeft"===e.indentStyle||"tabularRight"===e.indentStyle}class ui{constructor(e){this.params=e,this.index=0}get({key:e,text:t}){return this.params?e?this.params[e]:this.params[this.index++]:t}getPositionalParameterIndex(){return this.index}setPositionalParameterIndex(e){this.index=e}}var un=r(57626);let uo=(e,t,r)=>{if(nJ(e.type)){let a=uT(r,t);if(a&&a.type===ew.PROPERTY_ACCESS_OPERATOR)return Object.assign(Object.assign({},e),{type:ew.IDENTIFIER,text:e.raw});let s=ud(r,t);if(s&&s.type===ew.PROPERTY_ACCESS_OPERATOR)return Object.assign(Object.assign({},e),{type:ew.IDENTIFIER,text:e.raw})}return e},ul=(e,t,r)=>{if(e.type===ew.RESERVED_FUNCTION_NAME){let a=ud(r,t);if(!a||!uh(a))return Object.assign(Object.assign({},e),{type:ew.IDENTIFIER,text:e.raw})}return e},uE=(e,t,r)=>{if(e.type===ew.RESERVED_DATA_TYPE){let a=ud(r,t);if(a&&uh(a))return Object.assign(Object.assign({},e),{type:ew.RESERVED_PARAMETERIZED_DATA_TYPE})}return e},uu=(e,t,r)=>{if(e.type===ew.IDENTIFIER){let a=ud(r,t);if(a&&uA(a))return Object.assign(Object.assign({},e),{type:ew.ARRAY_IDENTIFIER})}return e},uc=(e,t,r)=>{if(e.type===ew.RESERVED_DATA_TYPE){let a=ud(r,t);if(a&&uA(a))return Object.assign(Object.assign({},e),{type:ew.ARRAY_KEYWORD})}return e},uT=(e,t)=>ud(e,t,-1),ud=(e,t,r=1)=>{let a=1;for(;e[t+a*r]&&up(e[t+a*r]);)a++;return e[t+a*r]},uh=e=>e.type===ew.OPEN_PAREN&&"("===e.text,uA=e=>e.type===ew.OPEN_PAREN&&"["===e.text,up=e=>e.type===ew.BLOCK_COMMENT||e.type===ew.LINE_COMMENT;class uR{constructor(e){this.tokenize=e,this.index=0,this.tokens=[],this.input=""}reset(e,t){this.input=e,this.index=0,this.tokens=this.tokenize(e)}next(){return this.tokens[this.index++]}save(){}formatError(e){let{line:t,col:r}=E2(this.input,e.start);return`Parse error at token: ${e.text} at line ${t} column ${r}`}has(e){return e in ew}}function uS(e){return e[0]}!function(e){e.statement="statement",e.clause="clause",e.set_operation="set_operation",e.function_call="function_call",e.parameterized_data_type="parameterized_data_type",e.array_subscript="array_subscript",e.property_access="property_access",e.parenthesis="parenthesis",e.between_predicate="between_predicate",e.case_expression="case_expression",e.case_when="case_when",e.case_else="case_else",e.limit_clause="limit_clause",e.all_columns_asterisk="all_columns_asterisk",e.literal="literal",e.identifier="identifier",e.keyword="keyword",e.data_type="data_type",e.parameter="parameter",e.operator="operator",e.comma="comma",e.line_comment="line_comment",e.block_comment="block_comment",e.disable_comment="disable_comment"}(eG=eG||(eG={}));let u_=new uR(e=>[]),uO=([[e]])=>e,uI=e=>({type:eG.keyword,tokenType:e.type,text:e.text,raw:e.raw}),uf=e=>({type:eG.data_type,text:e.text,raw:e.raw}),uN=(e,{leading:t,trailing:r})=>((null==t?void 0:t.length)&&(e=Object.assign(Object.assign({},e),{leadingComments:t})),(null==r?void 0:r.length)&&(e=Object.assign(Object.assign({},e),{trailingComments:r})),e),um=(e,{leading:t,trailing:r})=>{if(null==t?void 0:t.length){let[r,...a]=e;e=[uN(r,{leading:t}),...a]}if(null==r?void 0:r.length){let t=e.slice(0,-1),a=e[e.length-1];e=[...t,uN(a,{trailing:r})]}return e},uC={Lexer:u_,ParserRules:[{name:"main$ebnf$1",symbols:[]},{name:"main$ebnf$1",symbols:["main$ebnf$1","statement"],postprocess:e=>e[0].concat([e[1]])},{name:"main",symbols:["main$ebnf$1"],postprocess:([e])=>{let t=e[e.length-1];return t&&!t.hasSemicolon?t.children.length>0?e:e.slice(0,-1):e}},{name:"statement$subexpression$1",symbols:[u_.has("DELIMITER")?{type:"DELIMITER"}:DELIMITER]},{name:"statement$subexpression$1",symbols:[u_.has("EOF")?{type:"EOF"}:EOF]},{name:"statement",symbols:["expressions_or_clauses","statement$subexpression$1"],postprocess:([e,[t]])=>({type:eG.statement,children:e,hasSemicolon:t.type===ew.DELIMITER})},{name:"expressions_or_clauses$ebnf$1",symbols:[]},{name:"expressions_or_clauses$ebnf$1",symbols:["expressions_or_clauses$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"expressions_or_clauses$ebnf$2",symbols:[]},{name:"expressions_or_clauses$ebnf$2",symbols:["expressions_or_clauses$ebnf$2","clause"],postprocess:e=>e[0].concat([e[1]])},{name:"expressions_or_clauses",symbols:["expressions_or_clauses$ebnf$1","expressions_or_clauses$ebnf$2"],postprocess:([e,t])=>[...e,...t]},{name:"clause$subexpression$1",symbols:["limit_clause"]},{name:"clause$subexpression$1",symbols:["select_clause"]},{name:"clause$subexpression$1",symbols:["other_clause"]},{name:"clause$subexpression$1",symbols:["set_operation"]},{name:"clause",symbols:["clause$subexpression$1"],postprocess:uO},{name:"limit_clause$ebnf$1$subexpression$1$ebnf$1",symbols:["free_form_sql"]},{name:"limit_clause$ebnf$1$subexpression$1$ebnf$1",symbols:["limit_clause$ebnf$1$subexpression$1$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"limit_clause$ebnf$1$subexpression$1",symbols:[u_.has("COMMA")?{type:"COMMA"}:COMMA,"limit_clause$ebnf$1$subexpression$1$ebnf$1"]},{name:"limit_clause$ebnf$1",symbols:["limit_clause$ebnf$1$subexpression$1"],postprocess:uS},{name:"limit_clause$ebnf$1",symbols:[],postprocess:()=>null},{name:"limit_clause",symbols:[u_.has("LIMIT")?{type:"LIMIT"}:LIMIT,"_","expression_chain_","limit_clause$ebnf$1"],postprocess:([e,t,r,a])=>{if(!a)return{type:eG.limit_clause,limitKw:uN(uI(e),{trailing:t}),count:r};{let[s,i]=a;return{type:eG.limit_clause,limitKw:uN(uI(e),{trailing:t}),offset:r,count:i}}}},{name:"select_clause$subexpression$1$ebnf$1",symbols:[]},{name:"select_clause$subexpression$1$ebnf$1",symbols:["select_clause$subexpression$1$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"select_clause$subexpression$1",symbols:["all_columns_asterisk","select_clause$subexpression$1$ebnf$1"]},{name:"select_clause$subexpression$1$ebnf$2",symbols:[]},{name:"select_clause$subexpression$1$ebnf$2",symbols:["select_clause$subexpression$1$ebnf$2","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"select_clause$subexpression$1",symbols:["asteriskless_free_form_sql","select_clause$subexpression$1$ebnf$2"]},{name:"select_clause",symbols:[u_.has("RESERVED_SELECT")?{type:"RESERVED_SELECT"}:RESERVED_SELECT,"select_clause$subexpression$1"],postprocess:([e,[t,r]])=>({type:eG.clause,nameKw:uI(e),children:[t,...r]})},{name:"select_clause",symbols:[u_.has("RESERVED_SELECT")?{type:"RESERVED_SELECT"}:RESERVED_SELECT],postprocess:([e])=>({type:eG.clause,nameKw:uI(e),children:[]})},{name:"all_columns_asterisk",symbols:[u_.has("ASTERISK")?{type:"ASTERISK"}:ASTERISK],postprocess:()=>({type:eG.all_columns_asterisk})},{name:"other_clause$ebnf$1",symbols:[]},{name:"other_clause$ebnf$1",symbols:["other_clause$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"other_clause",symbols:[u_.has("RESERVED_CLAUSE")?{type:"RESERVED_CLAUSE"}:RESERVED_CLAUSE,"other_clause$ebnf$1"],postprocess:([e,t])=>({type:eG.clause,nameKw:uI(e),children:t})},{name:"set_operation$ebnf$1",symbols:[]},{name:"set_operation$ebnf$1",symbols:["set_operation$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"set_operation",symbols:[u_.has("RESERVED_SET_OPERATION")?{type:"RESERVED_SET_OPERATION"}:RESERVED_SET_OPERATION,"set_operation$ebnf$1"],postprocess:([e,t])=>({type:eG.set_operation,nameKw:uI(e),children:t})},{name:"expression_chain_$ebnf$1",symbols:["expression_with_comments_"]},{name:"expression_chain_$ebnf$1",symbols:["expression_chain_$ebnf$1","expression_with_comments_"],postprocess:e=>e[0].concat([e[1]])},{name:"expression_chain_",symbols:["expression_chain_$ebnf$1"],postprocess:uS},{name:"expression_chain$ebnf$1",symbols:[]},{name:"expression_chain$ebnf$1",symbols:["expression_chain$ebnf$1","_expression_with_comments"],postprocess:e=>e[0].concat([e[1]])},{name:"expression_chain",symbols:["expression","expression_chain$ebnf$1"],postprocess:([e,t])=>[e,...t]},{name:"andless_expression_chain$ebnf$1",symbols:[]},{name:"andless_expression_chain$ebnf$1",symbols:["andless_expression_chain$ebnf$1","_andless_expression_with_comments"],postprocess:e=>e[0].concat([e[1]])},{name:"andless_expression_chain",symbols:["andless_expression","andless_expression_chain$ebnf$1"],postprocess:([e,t])=>[e,...t]},{name:"expression_with_comments_",symbols:["expression","_"],postprocess:([e,t])=>uN(e,{trailing:t})},{name:"_expression_with_comments",symbols:["_","expression"],postprocess:([e,t])=>uN(t,{leading:e})},{name:"_andless_expression_with_comments",symbols:["_","andless_expression"],postprocess:([e,t])=>uN(t,{leading:e})},{name:"free_form_sql$subexpression$1",symbols:["asteriskless_free_form_sql"]},{name:"free_form_sql$subexpression$1",symbols:["asterisk"]},{name:"free_form_sql",symbols:["free_form_sql$subexpression$1"],postprocess:uO},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["asteriskless_andless_expression"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["logic_operator"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["comma"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["comment"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["other_keyword"]},{name:"asteriskless_free_form_sql",symbols:["asteriskless_free_form_sql$subexpression$1"],postprocess:uO},{name:"expression$subexpression$1",symbols:["andless_expression"]},{name:"expression$subexpression$1",symbols:["logic_operator"]},{name:"expression",symbols:["expression$subexpression$1"],postprocess:uO},{name:"andless_expression$subexpression$1",symbols:["asteriskless_andless_expression"]},{name:"andless_expression$subexpression$1",symbols:["asterisk"]},{name:"andless_expression",symbols:["andless_expression$subexpression$1"],postprocess:uO},{name:"asteriskless_andless_expression$subexpression$1",symbols:["atomic_expression"]},{name:"asteriskless_andless_expression$subexpression$1",symbols:["between_predicate"]},{name:"asteriskless_andless_expression$subexpression$1",symbols:["case_expression"]},{name:"asteriskless_andless_expression",symbols:["asteriskless_andless_expression$subexpression$1"],postprocess:uO},{name:"atomic_expression$subexpression$1",symbols:["array_subscript"]},{name:"atomic_expression$subexpression$1",symbols:["function_call"]},{name:"atomic_expression$subexpression$1",symbols:["property_access"]},{name:"atomic_expression$subexpression$1",symbols:["parenthesis"]},{name:"atomic_expression$subexpression$1",symbols:["curly_braces"]},{name:"atomic_expression$subexpression$1",symbols:["square_brackets"]},{name:"atomic_expression$subexpression$1",symbols:["operator"]},{name:"atomic_expression$subexpression$1",symbols:["identifier"]},{name:"atomic_expression$subexpression$1",symbols:["parameter"]},{name:"atomic_expression$subexpression$1",symbols:["literal"]},{name:"atomic_expression$subexpression$1",symbols:["data_type"]},{name:"atomic_expression$subexpression$1",symbols:["keyword"]},{name:"atomic_expression",symbols:["atomic_expression$subexpression$1"],postprocess:uO},{name:"array_subscript",symbols:[u_.has("ARRAY_IDENTIFIER")?{type:"ARRAY_IDENTIFIER"}:ARRAY_IDENTIFIER,"_","square_brackets"],postprocess:([e,t,r])=>({type:eG.array_subscript,array:uN({type:eG.identifier,quoted:!1,text:e.text},{trailing:t}),parenthesis:r})},{name:"array_subscript",symbols:[u_.has("ARRAY_KEYWORD")?{type:"ARRAY_KEYWORD"}:ARRAY_KEYWORD,"_","square_brackets"],postprocess:([e,t,r])=>({type:eG.array_subscript,array:uN(uI(e),{trailing:t}),parenthesis:r})},{name:"function_call",symbols:[u_.has("RESERVED_FUNCTION_NAME")?{type:"RESERVED_FUNCTION_NAME"}:RESERVED_FUNCTION_NAME,"_","parenthesis"],postprocess:([e,t,r])=>({type:eG.function_call,nameKw:uN(uI(e),{trailing:t}),parenthesis:r})},{name:"parenthesis",symbols:[{literal:"("},"expressions_or_clauses",{literal:")"}],postprocess:([e,t,r])=>({type:eG.parenthesis,children:t,openParen:"(",closeParen:")"})},{name:"curly_braces$ebnf$1",symbols:[]},{name:"curly_braces$ebnf$1",symbols:["curly_braces$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"curly_braces",symbols:[{literal:"{"},"curly_braces$ebnf$1",{literal:"}"}],postprocess:([e,t,r])=>({type:eG.parenthesis,children:t,openParen:"{",closeParen:"}"})},{name:"square_brackets$ebnf$1",symbols:[]},{name:"square_brackets$ebnf$1",symbols:["square_brackets$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"square_brackets",symbols:[{literal:"["},"square_brackets$ebnf$1",{literal:"]"}],postprocess:([e,t,r])=>({type:eG.parenthesis,children:t,openParen:"[",closeParen:"]"})},{name:"property_access$subexpression$1",symbols:["identifier"]},{name:"property_access$subexpression$1",symbols:["array_subscript"]},{name:"property_access$subexpression$1",symbols:["all_columns_asterisk"]},{name:"property_access$subexpression$1",symbols:["parameter"]},{name:"property_access",symbols:["atomic_expression","_",u_.has("PROPERTY_ACCESS_OPERATOR")?{type:"PROPERTY_ACCESS_OPERATOR"}:PROPERTY_ACCESS_OPERATOR,"_","property_access$subexpression$1"],postprocess:([e,t,r,a,[s]])=>({type:eG.property_access,object:uN(e,{trailing:t}),operator:r.text,property:uN(s,{leading:a})})},{name:"between_predicate",symbols:[u_.has("BETWEEN")?{type:"BETWEEN"}:BETWEEN,"_","andless_expression_chain","_",u_.has("AND")?{type:"AND"}:AND,"_","andless_expression"],postprocess:([e,t,r,a,s,i,n])=>({type:eG.between_predicate,betweenKw:uI(e),expr1:um(r,{leading:t,trailing:a}),andKw:uI(s),expr2:[uN(n,{leading:i})]})},{name:"case_expression$ebnf$1",symbols:["expression_chain_"],postprocess:uS},{name:"case_expression$ebnf$1",symbols:[],postprocess:()=>null},{name:"case_expression$ebnf$2",symbols:[]},{name:"case_expression$ebnf$2",symbols:["case_expression$ebnf$2","case_clause"],postprocess:e=>e[0].concat([e[1]])},{name:"case_expression",symbols:[u_.has("CASE")?{type:"CASE"}:CASE,"_","case_expression$ebnf$1","case_expression$ebnf$2",u_.has("END")?{type:"END"}:END],postprocess:([e,t,r,a,s])=>({type:eG.case_expression,caseKw:uN(uI(e),{trailing:t}),endKw:uI(s),expr:r||[],clauses:a})},{name:"case_clause",symbols:[u_.has("WHEN")?{type:"WHEN"}:WHEN,"_","expression_chain_",u_.has("THEN")?{type:"THEN"}:THEN,"_","expression_chain_"],postprocess:([e,t,r,a,s,i])=>({type:eG.case_when,whenKw:uN(uI(e),{trailing:t}),thenKw:uN(uI(a),{trailing:s}),condition:r,result:i})},{name:"case_clause",symbols:[u_.has("ELSE")?{type:"ELSE"}:ELSE,"_","expression_chain_"],postprocess:([e,t,r])=>({type:eG.case_else,elseKw:uN(uI(e),{trailing:t}),result:r})},{name:"comma$subexpression$1",symbols:[u_.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"comma",symbols:["comma$subexpression$1"],postprocess:([[e]])=>({type:eG.comma})},{name:"asterisk$subexpression$1",symbols:[u_.has("ASTERISK")?{type:"ASTERISK"}:ASTERISK]},{name:"asterisk",symbols:["asterisk$subexpression$1"],postprocess:([[e]])=>({type:eG.operator,text:e.text})},{name:"operator$subexpression$1",symbols:[u_.has("OPERATOR")?{type:"OPERATOR"}:OPERATOR]},{name:"operator",symbols:["operator$subexpression$1"],postprocess:([[e]])=>({type:eG.operator,text:e.text})},{name:"identifier$subexpression$1",symbols:[u_.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER]},{name:"identifier$subexpression$1",symbols:[u_.has("QUOTED_IDENTIFIER")?{type:"QUOTED_IDENTIFIER"}:QUOTED_IDENTIFIER]},{name:"identifier$subexpression$1",symbols:[u_.has("VARIABLE")?{type:"VARIABLE"}:VARIABLE]},{name:"identifier",symbols:["identifier$subexpression$1"],postprocess:([[e]])=>({type:eG.identifier,quoted:"IDENTIFIER"!==e.type,text:e.text})},{name:"parameter$subexpression$1",symbols:[u_.has("NAMED_PARAMETER")?{type:"NAMED_PARAMETER"}:NAMED_PARAMETER]},{name:"parameter$subexpression$1",symbols:[u_.has("QUOTED_PARAMETER")?{type:"QUOTED_PARAMETER"}:QUOTED_PARAMETER]},{name:"parameter$subexpression$1",symbols:[u_.has("NUMBERED_PARAMETER")?{type:"NUMBERED_PARAMETER"}:NUMBERED_PARAMETER]},{name:"parameter$subexpression$1",symbols:[u_.has("POSITIONAL_PARAMETER")?{type:"POSITIONAL_PARAMETER"}:POSITIONAL_PARAMETER]},{name:"parameter$subexpression$1",symbols:[u_.has("CUSTOM_PARAMETER")?{type:"CUSTOM_PARAMETER"}:CUSTOM_PARAMETER]},{name:"parameter",symbols:["parameter$subexpression$1"],postprocess:([[e]])=>({type:eG.parameter,key:e.key,text:e.text})},{name:"literal$subexpression$1",symbols:[u_.has("NUMBER")?{type:"NUMBER"}:NUMBER]},{name:"literal$subexpression$1",symbols:[u_.has("STRING")?{type:"STRING"}:STRING]},{name:"literal",symbols:["literal$subexpression$1"],postprocess:([[e]])=>({type:eG.literal,text:e.text})},{name:"keyword$subexpression$1",symbols:[u_.has("RESERVED_KEYWORD")?{type:"RESERVED_KEYWORD"}:RESERVED_KEYWORD]},{name:"keyword$subexpression$1",symbols:[u_.has("RESERVED_KEYWORD_PHRASE")?{type:"RESERVED_KEYWORD_PHRASE"}:RESERVED_KEYWORD_PHRASE]},{name:"keyword$subexpression$1",symbols:[u_.has("RESERVED_JOIN")?{type:"RESERVED_JOIN"}:RESERVED_JOIN]},{name:"keyword",symbols:["keyword$subexpression$1"],postprocess:([[e]])=>uI(e)},{name:"data_type$subexpression$1",symbols:[u_.has("RESERVED_DATA_TYPE")?{type:"RESERVED_DATA_TYPE"}:RESERVED_DATA_TYPE]},{name:"data_type$subexpression$1",symbols:[u_.has("RESERVED_DATA_TYPE_PHRASE")?{type:"RESERVED_DATA_TYPE_PHRASE"}:RESERVED_DATA_TYPE_PHRASE]},{name:"data_type",symbols:["data_type$subexpression$1"],postprocess:([[e]])=>uf(e)},{name:"data_type",symbols:[u_.has("RESERVED_PARAMETERIZED_DATA_TYPE")?{type:"RESERVED_PARAMETERIZED_DATA_TYPE"}:RESERVED_PARAMETERIZED_DATA_TYPE,"_","parenthesis"],postprocess:([e,t,r])=>({type:eG.parameterized_data_type,dataType:uN(uf(e),{trailing:t}),parenthesis:r})},{name:"logic_operator$subexpression$1",symbols:[u_.has("AND")?{type:"AND"}:AND]},{name:"logic_operator$subexpression$1",symbols:[u_.has("OR")?{type:"OR"}:OR]},{name:"logic_operator$subexpression$1",symbols:[u_.has("XOR")?{type:"XOR"}:XOR]},{name:"logic_operator",symbols:["logic_operator$subexpression$1"],postprocess:([[e]])=>uI(e)},{name:"other_keyword$subexpression$1",symbols:[u_.has("WHEN")?{type:"WHEN"}:WHEN]},{name:"other_keyword$subexpression$1",symbols:[u_.has("THEN")?{type:"THEN"}:THEN]},{name:"other_keyword$subexpression$1",symbols:[u_.has("ELSE")?{type:"ELSE"}:ELSE]},{name:"other_keyword$subexpression$1",symbols:[u_.has("END")?{type:"END"}:END]},{name:"other_keyword",symbols:["other_keyword$subexpression$1"],postprocess:([[e]])=>uI(e)},{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1","comment"],postprocess:e=>e[0].concat([e[1]])},{name:"_",symbols:["_$ebnf$1"],postprocess:([e])=>e},{name:"comment",symbols:[u_.has("LINE_COMMENT")?{type:"LINE_COMMENT"}:LINE_COMMENT],postprocess:([e])=>({type:eG.line_comment,text:e.text,precedingWhitespace:e.precedingWhitespace})},{name:"comment",symbols:[u_.has("BLOCK_COMMENT")?{type:"BLOCK_COMMENT"}:BLOCK_COMMENT],postprocess:([e])=>({type:eG.block_comment,text:e.text,precedingWhitespace:e.precedingWhitespace})},{name:"comment",symbols:[u_.has("DISABLE_COMMENT")?{type:"DISABLE_COMMENT"}:DISABLE_COMMENT],postprocess:([e])=>({type:eG.disable_comment,text:e.text,precedingWhitespace:e.precedingWhitespace})}],ParserStart:"main"},{Parser:uL,Grammar:uy}=un;!function(e){e[e.SPACE=0]="SPACE",e[e.NO_SPACE=1]="NO_SPACE",e[e.NO_NEWLINE=2]="NO_NEWLINE",e[e.NEWLINE=3]="NEWLINE",e[e.MANDATORY_NEWLINE=4]="MANDATORY_NEWLINE",e[e.INDENT=5]="INDENT",e[e.SINGLE_INDENT=6]="SINGLE_INDENT"}(eB=eB||(eB={}));class ug{constructor(e){this.indentation=e,this.items=[]}add(...e){for(let t of e)switch(t){case eB.SPACE:this.items.push(eB.SPACE);break;case eB.NO_SPACE:this.trimHorizontalWhitespace();break;case eB.NO_NEWLINE:this.trimWhitespace();break;case eB.NEWLINE:this.trimHorizontalWhitespace(),this.addNewline(eB.NEWLINE);break;case eB.MANDATORY_NEWLINE:this.trimHorizontalWhitespace(),this.addNewline(eB.MANDATORY_NEWLINE);break;case eB.INDENT:this.addIndentation();break;case eB.SINGLE_INDENT:this.items.push(eB.SINGLE_INDENT);break;default:this.items.push(t)}}trimHorizontalWhitespace(){for(;uP(EM(this.items));)this.items.pop()}trimWhitespace(){for(;ub(EM(this.items));)this.items.pop()}addNewline(e){if(this.items.length>0)switch(EM(this.items)){case eB.NEWLINE:this.items.pop(),this.items.push(e);break;case eB.MANDATORY_NEWLINE:break;default:this.items.push(e)}}addIndentation(){for(let e=0;e<this.indentation.getLevel();e++)this.items.push(eB.SINGLE_INDENT)}toString(){return this.items.map(e=>this.itemToString(e)).join("")}getLayoutItems(){return this.items}itemToString(e){switch(e){case eB.SPACE:return" ";case eB.NEWLINE:case eB.MANDATORY_NEWLINE:return"\n";case eB.SINGLE_INDENT:return this.indentation.getSingleIndent();default:return e}}}let uP=e=>e===eB.SPACE||e===eB.SINGLE_INDENT,ub=e=>e===eB.SPACE||e===eB.SINGLE_INDENT||e===eB.NEWLINE;function uD(e,t){if("standard"===t)return e;let r=[];return e.length>=10&&e.includes(" ")&&([e,...r]=e.split(" ")),(e="tabularLeft"===t?e.padEnd(9," "):e.padStart(9," "))+["",...r].join(" ")}function uv(e){return nz(e)||e===ew.RESERVED_CLAUSE||e===ew.RESERVED_SELECT||e===ew.RESERVED_SET_OPERATION||e===ew.RESERVED_JOIN||e===ew.LIMIT}let uM="top-level";class uU{constructor(e){this.indent=e,this.indentTypes=[]}getSingleIndent(){return this.indent}getLevel(){return this.indentTypes.length}increaseTopLevel(){this.indentTypes.push(uM)}increaseBlockLevel(){this.indentTypes.push("block-level")}decreaseTopLevel(){this.indentTypes.length>0&&EM(this.indentTypes)===uM&&this.indentTypes.pop()}decreaseBlockLevel(){for(;this.indentTypes.length>0;){let e=this.indentTypes.pop();if(e!==uM)break}}}class uw extends ug{constructor(e){super(new uU("")),this.expressionWidth=e,this.length=0,this.trailingSpace=!1}add(...e){if(e.forEach(e=>this.addToLength(e)),this.length>this.expressionWidth)throw new uG;super.add(...e)}addToLength(e){if("string"==typeof e)this.length+=e.length,this.trailingSpace=!1;else if(e===eB.MANDATORY_NEWLINE||e===eB.NEWLINE)throw new uG;else e===eB.INDENT||e===eB.SINGLE_INDENT||e===eB.SPACE?this.trailingSpace||(this.length++,this.trailingSpace=!0):(e===eB.NO_NEWLINE||e===eB.NO_SPACE)&&this.trailingSpace&&(this.trailingSpace=!1,this.length--)}}class uG extends Error{}class uB{constructor({cfg:e,dialectCfg:t,params:r,layout:a,inline:s=!1}){this.inline=!1,this.nodes=[],this.index=-1,this.cfg=e,this.dialectCfg=t,this.inline=s,this.params=r,this.layout=a}format(e){for(this.nodes=e,this.index=0;this.index<this.nodes.length;this.index++)this.formatNode(this.nodes[this.index]);return this.layout}formatNode(e){this.formatComments(e.leadingComments),this.formatNodeWithoutComments(e),this.formatComments(e.trailingComments)}formatNodeWithoutComments(e){switch(e.type){case eG.function_call:return this.formatFunctionCall(e);case eG.parameterized_data_type:return this.formatParameterizedDataType(e);case eG.array_subscript:return this.formatArraySubscript(e);case eG.property_access:return this.formatPropertyAccess(e);case eG.parenthesis:return this.formatParenthesis(e);case eG.between_predicate:return this.formatBetweenPredicate(e);case eG.case_expression:return this.formatCaseExpression(e);case eG.case_when:return this.formatCaseWhen(e);case eG.case_else:return this.formatCaseElse(e);case eG.clause:return this.formatClause(e);case eG.set_operation:return this.formatSetOperation(e);case eG.limit_clause:return this.formatLimitClause(e);case eG.all_columns_asterisk:return this.formatAllColumnsAsterisk(e);case eG.literal:return this.formatLiteral(e);case eG.identifier:return this.formatIdentifier(e);case eG.parameter:return this.formatParameter(e);case eG.operator:return this.formatOperator(e);case eG.comma:return this.formatComma(e);case eG.line_comment:return this.formatLineComment(e);case eG.block_comment:case eG.disable_comment:return this.formatBlockComment(e);case eG.data_type:return this.formatDataType(e);case eG.keyword:return this.formatKeywordNode(e)}}formatFunctionCall(e){this.withComments(e.nameKw,()=>{this.layout.add(this.showFunctionKw(e.nameKw))}),this.formatNode(e.parenthesis)}formatParameterizedDataType(e){this.withComments(e.dataType,()=>{this.layout.add(this.showDataType(e.dataType))}),this.formatNode(e.parenthesis)}formatArraySubscript(e){let t;switch(e.array.type){case eG.data_type:t=this.showDataType(e.array);break;case eG.keyword:t=this.showKw(e.array);break;default:t=this.showIdentifier(e.array)}this.withComments(e.array,()=>{this.layout.add(t)}),this.formatNode(e.parenthesis)}formatPropertyAccess(e){this.formatNode(e.object),this.layout.add(eB.NO_SPACE,e.operator),this.formatNode(e.property)}formatParenthesis(e){let t=this.formatInlineExpression(e.children);t?(this.layout.add(e.openParen),this.layout.add(...t.getLayoutItems()),this.layout.add(eB.NO_SPACE,e.closeParen,eB.SPACE)):(this.layout.add(e.openParen,eB.NEWLINE),us(this.cfg)?(this.layout.add(eB.INDENT),this.layout=this.formatSubExpression(e.children)):(this.layout.indentation.increaseBlockLevel(),this.layout.add(eB.INDENT),this.layout=this.formatSubExpression(e.children),this.layout.indentation.decreaseBlockLevel()),this.layout.add(eB.NEWLINE,eB.INDENT,e.closeParen,eB.SPACE))}formatBetweenPredicate(e){this.layout.add(this.showKw(e.betweenKw),eB.SPACE),this.layout=this.formatSubExpression(e.expr1),this.layout.add(eB.NO_SPACE,eB.SPACE,this.showNonTabularKw(e.andKw),eB.SPACE),this.layout=this.formatSubExpression(e.expr2),this.layout.add(eB.SPACE)}formatCaseExpression(e){this.formatNode(e.caseKw),this.layout.indentation.increaseBlockLevel(),this.layout=this.formatSubExpression(e.expr),this.layout=this.formatSubExpression(e.clauses),this.layout.indentation.decreaseBlockLevel(),this.layout.add(eB.NEWLINE,eB.INDENT),this.formatNode(e.endKw)}formatCaseWhen(e){this.layout.add(eB.NEWLINE,eB.INDENT),this.formatNode(e.whenKw),this.layout=this.formatSubExpression(e.condition),this.formatNode(e.thenKw),this.layout=this.formatSubExpression(e.result)}formatCaseElse(e){this.layout.add(eB.NEWLINE,eB.INDENT),this.formatNode(e.elseKw),this.layout=this.formatSubExpression(e.result)}formatClause(e){this.isOnelineClause(e)?this.formatClauseInOnelineStyle(e):us(this.cfg)?this.formatClauseInTabularStyle(e):this.formatClauseInIndentedStyle(e)}isOnelineClause(e){return us(this.cfg)?this.dialectCfg.tabularOnelineClauses[e.nameKw.text]:this.dialectCfg.onelineClauses[e.nameKw.text]}formatClauseInIndentedStyle(e){this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e.nameKw),eB.NEWLINE),this.layout.indentation.increaseTopLevel(),this.layout.add(eB.INDENT),this.layout=this.formatSubExpression(e.children),this.layout.indentation.decreaseTopLevel()}formatClauseInOnelineStyle(e){this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e.nameKw),eB.SPACE),this.layout=this.formatSubExpression(e.children)}formatClauseInTabularStyle(e){this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e.nameKw),eB.SPACE),this.layout.indentation.increaseTopLevel(),this.layout=this.formatSubExpression(e.children),this.layout.indentation.decreaseTopLevel()}formatSetOperation(e){this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e.nameKw),eB.NEWLINE),this.layout.add(eB.INDENT),this.layout=this.formatSubExpression(e.children)}formatLimitClause(e){this.withComments(e.limitKw,()=>{this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e.limitKw))}),this.layout.indentation.increaseTopLevel(),us(this.cfg)?this.layout.add(eB.SPACE):this.layout.add(eB.NEWLINE,eB.INDENT),e.offset&&(this.layout=this.formatSubExpression(e.offset),this.layout.add(eB.NO_SPACE,",",eB.SPACE)),this.layout=this.formatSubExpression(e.count),this.layout.indentation.decreaseTopLevel()}formatAllColumnsAsterisk(e){this.layout.add("*",eB.SPACE)}formatLiteral(e){this.layout.add(e.text,eB.SPACE)}formatIdentifier(e){this.layout.add(this.showIdentifier(e),eB.SPACE)}formatParameter(e){this.layout.add(this.params.get(e),eB.SPACE)}formatOperator({text:e}){this.cfg.denseOperators||this.dialectCfg.alwaysDenseOperators.includes(e)?this.layout.add(eB.NO_SPACE,e):":"===e?this.layout.add(eB.NO_SPACE,e,eB.SPACE):this.layout.add(e,eB.SPACE)}formatComma(e){this.inline?this.layout.add(eB.NO_SPACE,",",eB.SPACE):this.layout.add(eB.NO_SPACE,",",eB.NEWLINE,eB.INDENT)}withComments(e,t){this.formatComments(e.leadingComments),t(),this.formatComments(e.trailingComments)}formatComments(e){e&&e.forEach(e=>{e.type===eG.line_comment?this.formatLineComment(e):this.formatBlockComment(e)})}formatLineComment(e){EG(e.precedingWhitespace||"")?this.layout.add(eB.NEWLINE,eB.INDENT,e.text,eB.MANDATORY_NEWLINE,eB.INDENT):this.layout.getLayoutItems().length>0?this.layout.add(eB.NO_NEWLINE,eB.SPACE,e.text,eB.MANDATORY_NEWLINE,eB.INDENT):this.layout.add(e.text,eB.MANDATORY_NEWLINE,eB.INDENT)}formatBlockComment(e){e.type===eG.block_comment&&this.isMultilineBlockComment(e)?(this.splitBlockComment(e.text).forEach(e=>{this.layout.add(eB.NEWLINE,eB.INDENT,e)}),this.layout.add(eB.NEWLINE,eB.INDENT)):this.layout.add(e.text,eB.SPACE)}isMultilineBlockComment(e){return EG(e.text)||EG(e.precedingWhitespace||"")}isDocComment(e){let t=e.split(/\n/);return/^\/\*\*?$/.test(t[0])&&t.slice(1,t.length-1).every(e=>/^\s*\*/.test(e))&&/^\s*\*\/$/.test(EM(t))}splitBlockComment(e){return this.isDocComment(e)?e.split(/\n/).map(e=>/^\s*\*/.test(e)?" "+e.replace(/^\s*/,""):e):e.split(/\n/).map(e=>e.replace(/^\s*/,""))}formatSubExpression(e){return new uB({cfg:this.cfg,dialectCfg:this.dialectCfg,params:this.params,layout:this.layout,inline:this.inline}).format(e)}formatInlineExpression(e){let t=this.params.getPositionalParameterIndex();try{return new uB({cfg:this.cfg,dialectCfg:this.dialectCfg,params:this.params,layout:new uw(this.cfg.expressionWidth),inline:!0}).format(e)}catch(e){if(e instanceof uG){this.params.setPositionalParameterIndex(t);return}throw e}}formatKeywordNode(e){switch(e.tokenType){case ew.RESERVED_JOIN:return this.formatJoin(e);case ew.AND:case ew.OR:case ew.XOR:return this.formatLogicalOperator(e);default:return this.formatKeyword(e)}}formatJoin(e){us(this.cfg)?(this.layout.indentation.decreaseTopLevel(),this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e),eB.SPACE),this.layout.indentation.increaseTopLevel()):this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e),eB.SPACE)}formatKeyword(e){this.layout.add(this.showKw(e),eB.SPACE)}formatLogicalOperator(e){"before"===this.cfg.logicalOperatorNewline?us(this.cfg)?(this.layout.indentation.decreaseTopLevel(),this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e),eB.SPACE),this.layout.indentation.increaseTopLevel()):this.layout.add(eB.NEWLINE,eB.INDENT,this.showKw(e),eB.SPACE):this.layout.add(this.showKw(e),eB.NEWLINE,eB.INDENT)}formatDataType(e){this.layout.add(this.showDataType(e),eB.SPACE)}showKw(e){return uv(e.tokenType)?uD(this.showNonTabularKw(e),this.cfg.indentStyle):this.showNonTabularKw(e)}showNonTabularKw(e){switch(this.cfg.keywordCase){case"preserve":return Ew(e.raw);case"upper":return e.text;case"lower":return e.text.toLowerCase()}}showFunctionKw(e){return uv(e.tokenType)?uD(this.showNonTabularFunctionKw(e),this.cfg.indentStyle):this.showNonTabularFunctionKw(e)}showNonTabularFunctionKw(e){switch(this.cfg.functionCase){case"preserve":return Ew(e.raw);case"upper":return e.text;case"lower":return e.text.toLowerCase()}}showIdentifier(e){if(e.quoted)return e.text;switch(this.cfg.identifierCase){case"preserve":return e.text;case"upper":return e.text.toUpperCase();case"lower":return e.text.toLowerCase()}}showDataType(e){switch(this.cfg.dataTypeCase){case"preserve":return Ew(e.raw);case"upper":return e.text;case"lower":return e.text.toLowerCase()}}}class uF{constructor(e,t){this.dialect=e,this.cfg=t,this.params=new ui(this.cfg.params)}format(e){let t=this.parse(e),r=this.formatAst(t);return r.trimEnd()}parse(e){return(function(e){let t={},r=new uR(r=>[...e.tokenize(r,t).map(uo).map(ul).map(uE).map(uu).map(uc),nX(r.length)]),a=new uL(uy.fromCompiled(uC),{lexer:r});return{parse:(e,r)=>{t=r;let{results:s}=a.feed(e);if(1===s.length)return s[0];if(0===s.length)throw Error("Parse error: Invalid SQL");throw Error(`Parse error: Ambiguous grammar
${JSON.stringify(s,void 0,2)}`)}}})(this.dialect.tokenizer).parse(e,this.cfg.paramTypes||{})}formatAst(e){return e.map(e=>this.formatStatement(e)).join("\n".repeat(this.cfg.linesBetweenQueries+1))}formatStatement(e){var t;let r=new uB({cfg:this.cfg,dialectCfg:this.dialect.formatOptions,params:this.params,layout:new ug(new uU("tabularLeft"===(t=this.cfg).indentStyle||"tabularRight"===t.indentStyle?" ".repeat(10):t.useTabs?"	":" ".repeat(t.tabWidth)))}).format(e.children);return e.hasSemicolon&&(this.cfg.newlineBeforeSemicolon?r.add(eB.NEWLINE,";"):r.add(eB.NO_NEWLINE,";")),r.toString()}}class uH extends Error{}var ux=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)0>t.indexOf(a[s])&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};let uk={bigquery:"bigquery",db2:"db2",db2i:"db2i",duckdb:"duckdb",hive:"hive",mariadb:"mariadb",mysql:"mysql",n1ql:"n1ql",plsql:"plsql",postgresql:"postgresql",redshift:"redshift",spark:"spark",sqlite:"sqlite",sql:"sql",tidb:"tidb",trino:"trino",transactsql:"transactsql",tsql:"transactsql",singlestoredb:"singlestoredb",snowflake:"snowflake"},uY=Object.keys(uk),uV={tabWidth:2,useTabs:!1,keywordCase:"preserve",identifierCase:"preserve",dataTypeCase:"preserve",functionCase:"preserve",indentStyle:"standard",logicalOperatorNewline:"before",expressionWidth:50,linesBetweenQueries:1,denseOperators:!1,newlineBeforeSemicolon:!1},u$=(e,t={})=>{if("string"==typeof t.language&&!uY.includes(t.language))throw new uH(`Unsupported SQL dialect: ${t.language}`);let r=uk[t.language||"sql"];return uW(e,Object.assign(Object.assign({},t),{dialect:eF[r]}))},uW=(e,t)=>{var{dialect:r}=t,a=ux(t,["dialect"]);if("string"!=typeof e)throw Error("Invalid query argument. Expected string, instead got "+typeof e);let s=function(e){var t;for(let t of["multilineLists","newlineBeforeOpenParen","newlineBeforeCloseParen","aliasAs","commaPosition","tabulateAlias"])if(t in e)throw new uH(`${t} config is no more supported.`);if(e.expressionWidth<=0)throw new uH(`expressionWidth config must be positive number. Received ${e.expressionWidth} instead.`);if(e.params&&!function(e){let t=e instanceof Array?e:Object.values(e);return t.every(e=>"string"==typeof e)}(e.params)&&console.warn('WARNING: All "params" option values should be strings.'),e.paramTypes&&!(!((t=e.paramTypes).custom&&Array.isArray(t.custom))||t.custom.every(e=>""!==e.regex)))throw new uH("Empty regex given in custom paramTypes. That would result in matching infinite amount of parameters.");return e}(Object.assign(Object.assign({},uV),a));return new uF(ut(r),s).format(e)};class uj{constructor(e,t){this.llm=new ic({openAIApiKey:e,modelName:"gpt-4",temperature:0}),this.schemaService=t}createSQLPrompt(){return new iT.Pf({template:`You are a SQL expert helping product managers analyze their data. 

Database Schema:
{schema}

User Question: {question}

Previous Context: {context}

Generate a SQL query that answers the user's question. Follow these guidelines:
1. Use proper PostgreSQL syntax
2. Include appropriate WHERE clauses for time ranges when relevant
3. Use meaningful column aliases
4. Optimize for readability and performance
5. If the question asks for trends, include time grouping (daily, weekly, monthly)

Also suggest the best chart type for visualizing this data:
- 'line' for trends over time
- 'bar' for comparisons between categories
- 'pie' for proportions/percentages
- 'table' for detailed data listings

Response format:
SQL: [your sql query]
CHART_TYPE: [suggested chart type]
EXPLANATION: [brief explanation of what the query does and insights it provides]`,inputVariables:["schema","question","context"]})}async generateQuery(e,t="",r=[]){try{let a=this.createSQLPrompt(),s=new id.LLMChain({llm:this.llm,prompt:a}),i=r.length>0?this.formatSchemaForPrompt(r):this.schemaService.generateSchemaContext(),n=await s.call({schema:i,question:e,context:t}),o=this.parseResponse(n.text),l=await this.schemaService.executeQuery(o.sql);return{...o,data:l,chartConfig:this.generateChartConfig(o.chartType||"table",l)}}catch(e){throw console.error("Error generating query:",e),Error(`Failed to generate query: ${e}`)}}formatSchemaForPrompt(e){return e.map(e=>{let t=e.columns.map(e=>`  ${e.column_name} (${e.data_type}${e.is_nullable?", nullable":""})`).join("\n");return`Table: ${e.table_name}
${t}`}).join("\n\n")}parseResponse(e){let t=e.match(/SQL:\s*(.*?)(?=CHART_TYPE:|EXPLANATION:|$)/),r=e.match(/CHART_TYPE:\s*(line|bar|pie|table)/),a=e.match(/EXPLANATION:\s*(.*?)$/),s=t?t[1].trim():"",i=r?r[1]:"table",n=a?a[1].trim():"";return{sql:u$(s,{language:"postgresql"}),explanation:n,chartType:i}}generateChartConfig(e,t){if(!t||0===t.length)return null;let r=t[0],a=Object.keys(r);switch(e){case"line":return{xAxis:a.find(e=>e.includes("date")||e.includes("time")||e.includes("day"))||a[0],yAxis:a.find(e=>e!==a[0])||a[1],dataKey:a[1]};case"bar":return{xAxis:a[0],yAxis:a[1],dataKey:a[1]};case"pie":return{dataKey:a[1],nameKey:a[0]};default:return{columns:a}}}async suggestFollowUp(e,t){let r=new iT.Pf({template:`Based on this SQL query and its results, suggest 3 relevant follow-up questions a PM might ask:

Previous Query: {query}
Results Summary: {summary}

Suggest practical follow-up questions that would provide additional insights.`,inputVariables:["query","summary"]}),a=new id.LLMChain({llm:this.llm,prompt:r}),s=`Query returned ${t.data.length} rows. Sample data: ${JSON.stringify(t.data.slice(0,2))}`,i=await a.call({query:e,summary:s});return i.text.split("\n").filter(e=>e.trim().length>0).slice(0,3)}}var uX=r(58081);async function uK(e){try{let{question:t,context:r}=await e.json();if(!t)return eV.Z.json({error:"Question is required"},{status:400});let a=new uX.Q(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY),s=new uj(process.env.NEXT_PUBLIC_OPENAI_API_KEY,a),i=await s.generateQuery(t,r||""),n=await s.suggestFollowUp(t,i);return eV.Z.json({result:i,followUpSuggestions:n})}catch(e){return console.error("Query API error:",e),eV.Z.json({error:"Failed to process query"},{status:500})}}async function uZ(){return eV.Z.json({message:"Query API is running"})}let uq=new ex.AppRouteRouteModule({definition:{kind:ek.x.APP_ROUTE,page:"/api/query/route",pathname:"/api/query",filename:"route",bundlePath:"app/api/query/route"},resolvedPagePath:"/Users/trinayhari/SailoGrowth/app/api/query/route.ts",nextConfigOutput:"",userland:eH}),{requestAsyncStorage:uJ,staticGenerationAsyncStorage:uz,serverHooks:uQ,headerHooks:u0,staticGenerationBailout:u1}=uq,u2="/api/query/route";function u4(){return(0,eY.patchFetch)({serverHooks:uQ,staticGenerationAsyncStorage:uz})}},58081:(e,t,r)=>{"use strict";r.d(t,{Q:()=>s});var a=r(54556);class s{constructor(e,t){this.supabase=(0,a.eI)(e,t)}async getTableSchemas(){try{let{data:e,error:t}=await this.supabase.from("information_schema.tables").select("table_name").eq("table_schema","public").eq("table_type","BASE TABLE");if(t)throw t;let r=[];for(let t of e){let{data:e,error:a}=await this.supabase.from("information_schema.columns").select("column_name, data_type, is_nullable, column_default").eq("table_schema","public").eq("table_name",t.table_name).order("ordinal_position");if(a)throw a;r.push({table_name:t.table_name,columns:e.map(e=>({column_name:e.column_name,data_type:e.data_type,is_nullable:"YES"===e.is_nullable,column_default:e.column_default}))})}return r}catch(e){return console.error("Error fetching schema:",e),[]}}async executeQuery(e){try{let{data:t,error:r}=await this.supabase.rpc("execute_sql",{query:e});if(r)throw r;return t||[]}catch(e){throw console.error("Error executing query:",e),e}}getCommonMetrics(){return[{name:"activation_rate",description:"Percentage of users who completed key activation events",sql_template:"SELECT COUNT(DISTINCT activated_users) * 100.0 / COUNT(DISTINCT total_users) as activation_rate FROM users",category:"engagement"},{name:"daily_active_users",description:"Number of unique users active in the last 24 hours",sql_template:"SELECT COUNT(DISTINCT user_id) as dau FROM events WHERE created_at >= NOW() - INTERVAL '1 day'",category:"engagement"},{name:"retention_rate",description:"Percentage of users who return after initial signup",sql_template:"SELECT cohort_week, COUNT(*) as retained_users FROM user_cohorts WHERE weeks_since_signup = 1 GROUP BY cohort_week",category:"retention"}]}generateSchemaContext(){return`
Available tables and their schemas:
- users: id, email, created_at, last_active_at, plan_type
- events: id, user_id, event_name, properties, created_at
- subscriptions: id, user_id, plan_id, status, created_at, updated_at
- products: id, name, category, price, created_at

Common metrics:
- activation_rate: activated_users / total_users
- daily_active_users: unique users in last 24h
- retention_rate: users who return after signup
    `}}},82158:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(24522);class AbortSignal extends a.EventTarget{constructor(){throw super(),TypeError("AbortSignal cannot be constructed directly")}get aborted(){let e=s.get(this);if("boolean"!=typeof e)throw TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return e}}a.defineEventAttribute(AbortSignal.prototype,"abort");let s=new WeakMap;Object.defineProperties(AbortSignal.prototype,{aborted:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(AbortSignal.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class AbortController{constructor(){i.set(this,function(){let e=Object.create(AbortSignal.prototype);return a.EventTarget.call(e),s.set(e,!1),e}())}get signal(){return n(this)}abort(){var e;e=n(this),!1===s.get(e)&&(s.set(e,!0),e.dispatchEvent({type:"abort"}))}}let i=new WeakMap;function n(e){let t=i.get(e);if(null==t)throw TypeError(`Expected 'this' to be an 'AbortController' object, but got ${null===e?"null":typeof e}`);return t}Object.defineProperties(AbortController.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(AbortController.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"}),t.AbortController=AbortController,t.AbortSignal=AbortSignal,t.default=AbortController,e.exports=AbortController,e.exports.AbortController=e.exports.default=AbortController,e.exports.AbortSignal=AbortSignal},36390:(e,t,r)=>{"use strict";let a=r(76412);e.exports=a,e.exports.HttpAgent=a,e.exports.HttpsAgent=r(14413),e.exports.constants=r(43190)},76412:(e,t,r)=>{"use strict";let a=r(13685).Agent,s=r(84149),i=r(73837).debuglog("agentkeepalive"),{INIT_SOCKET:n,CURRENT_ID:o,CREATE_ID:l,SOCKET_CREATED_TIME:E,SOCKET_NAME:u,SOCKET_REQUEST_COUNT:c,SOCKET_REQUEST_FINISHED_COUNT:T}=r(43190),d=1,h=parseInt(process.version.split(".",1)[0].substring(1));function A(e){console.log("[agentkeepalive:deprecated] %s",e)}h>=11&&h<=12?d=2:h>=13&&(d=3);class p extends a{constructor(e){(e=e||{}).keepAlive=!1!==e.keepAlive,void 0===e.freeSocketTimeout&&(e.freeSocketTimeout=4e3),e.keepAliveTimeout&&(A("options.keepAliveTimeout is deprecated, please use options.freeSocketTimeout instead"),e.freeSocketTimeout=e.keepAliveTimeout,delete e.keepAliveTimeout),e.freeSocketKeepAliveTimeout&&(A("options.freeSocketKeepAliveTimeout is deprecated, please use options.freeSocketTimeout instead"),e.freeSocketTimeout=e.freeSocketKeepAliveTimeout,delete e.freeSocketKeepAliveTimeout),void 0===e.timeout&&(e.timeout=Math.max(2*e.freeSocketTimeout,8e3)),e.timeout=s(e.timeout),e.freeSocketTimeout=s(e.freeSocketTimeout),e.socketActiveTTL=e.socketActiveTTL?s(e.socketActiveTTL):0,super(e),this[o]=0,this.createSocketCount=0,this.createSocketCountLastCheck=0,this.createSocketErrorCount=0,this.createSocketErrorCountLastCheck=0,this.closeSocketCount=0,this.closeSocketCountLastCheck=0,this.errorSocketCount=0,this.errorSocketCountLastCheck=0,this.requestCount=0,this.requestCountLastCheck=0,this.timeoutSocketCount=0,this.timeoutSocketCountLastCheck=0,this.on("free",e=>{let t=this.calcSocketTimeout(e);t>0&&e.timeout!==t&&e.setTimeout(t)})}get freeSocketKeepAliveTimeout(){return A("agent.freeSocketKeepAliveTimeout is deprecated, please use agent.options.freeSocketTimeout instead"),this.options.freeSocketTimeout}get timeout(){return A("agent.timeout is deprecated, please use agent.options.timeout instead"),this.options.timeout}get socketActiveTTL(){return A("agent.socketActiveTTL is deprecated, please use agent.options.socketActiveTTL instead"),this.options.socketActiveTTL}calcSocketTimeout(e){let t=this.options.freeSocketTimeout,r=this.options.socketActiveTTL;if(r){let a=Date.now()-e[E],s=r-a;if(s<=0)return s;t&&s<t&&(t=s)}if(t){let r=e.freeSocketTimeout||e.freeSocketKeepAliveTimeout;return r||t}}keepSocketAlive(e){let t=super.keepSocketAlive(e);if(!t)return t;let r=this.calcSocketTimeout(e);return void 0===r||(r<=0?(i("%s(requests: %s, finished: %s) free but need to destroy by TTL, request count %s, diff is %s",e[u],e[c],e[T],r),!1):(e.timeout!==r&&e.setTimeout(r),!0))}reuseSocket(...e){super.reuseSocket(...e);let t=e[0],r=e[1];r.reusedSocket=!0;let a=this.options.timeout;R(t)!==a&&(t.setTimeout(a),i("%s reset timeout to %sms",t[u],a)),t[c]++,i("%s(requests: %s, finished: %s) reuse on addRequest, timeout %sms",t[u],t[c],t[T],R(t))}[l](){let e=this[o]++;return this[o]===Number.MAX_SAFE_INTEGER&&(this[o]=0),e}[n](e,t){if(t.timeout){let r=R(e);r||e.setTimeout(t.timeout)}this.options.keepAlive&&e.setNoDelay(!0),this.createSocketCount++,this.options.socketActiveTTL&&(e[E]=Date.now()),e[u]=`sock[${this[l]()}#${t._agentKey}]`.split("-----BEGIN",1)[0],e[c]=1,e[T]=0,function(e,t,r){function a(){if(!t._httpMessage&&1===t[c])return;t[T]++,e.requestCount++,i("%s(requests: %s, finished: %s) free",t[u],t[c],t[T]);let a=e.getName(r);t.writable&&e.requests[a]&&e.requests[a].length&&(t[c]++,i("%s(requests: %s, finished: %s) will be reuse on agent free event",t[u],t[c],t[T]))}function s(r){i("%s(requests: %s, finished: %s) close, isError: %s",t[u],t[c],t[T],r),e.closeSocketCount++}function n(){let a=t.listeners("timeout").length,s=R(t),n=t._httpMessage,o=n&&n.listeners("timeout").length||0;i("%s(requests: %s, finished: %s) timeout after %sms, listeners %s, defaultTimeoutListenerCount %s, hasHttpRequest %s, HttpRequest timeoutListenerCount %s",t[u],t[c],t[T],s,a,d,!!n,o),i.enabled&&i("timeout listeners: %s",t.listeners("timeout").map(e=>e.name).join(", ")),e.timeoutSocketCount++;let l=e.getName(r);if(e.freeSockets[l]&&-1!==e.freeSockets[l].indexOf(t))t.destroy(),e.removeSocket(t,r),i("%s is free, destroy quietly",t[u]);else if(0===o){let a=Error("Socket timeout");a.code="ERR_SOCKET_TIMEOUT",a.timeout=s,t.destroy(a),e.removeSocket(t,r),i("%s destroy with timeout error",t[u])}}function o(r){let a=t.listeners("error").length;i("%s(requests: %s, finished: %s) error: %s, listenerCount: %s",t[u],t[c],t[T],r,a),e.errorSocketCount++,1===a&&(i("%s emit uncaught error event",t[u]),t.removeListener("error",o),t.emit("error",r))}i("%s create, timeout %sms",t[u],R(t)),t.on("free",a),t.on("close",s),t.on("timeout",n),t.on("error",o),t.on("agentRemove",function e(){i("%s(requests: %s, finished: %s) agentRemove",t[u],t[c],t[T]),t.removeListener("close",s),t.removeListener("error",o),t.removeListener("free",a),t.removeListener("timeout",n),t.removeListener("agentRemove",e)})}(this,e,t)}createConnection(e,t){let r=!1,a=(a,s)=>{if(!r){if(r=!0,a)return this.createSocketErrorCount++,t(a);this[n](s,e),t(a,s)}},s=super.createConnection(e,a);return s&&a(null,s),s}get statusChanged(){let e=this.createSocketCount!==this.createSocketCountLastCheck||this.createSocketErrorCount!==this.createSocketErrorCountLastCheck||this.closeSocketCount!==this.closeSocketCountLastCheck||this.errorSocketCount!==this.errorSocketCountLastCheck||this.timeoutSocketCount!==this.timeoutSocketCountLastCheck||this.requestCount!==this.requestCountLastCheck;return e&&(this.createSocketCountLastCheck=this.createSocketCount,this.createSocketErrorCountLastCheck=this.createSocketErrorCount,this.closeSocketCountLastCheck=this.closeSocketCount,this.errorSocketCountLastCheck=this.errorSocketCount,this.timeoutSocketCountLastCheck=this.timeoutSocketCount,this.requestCountLastCheck=this.requestCount),e}getCurrentStatus(){return{createSocketCount:this.createSocketCount,createSocketErrorCount:this.createSocketErrorCount,closeSocketCount:this.closeSocketCount,errorSocketCount:this.errorSocketCount,timeoutSocketCount:this.timeoutSocketCount,requestCount:this.requestCount,freeSockets:S(this.freeSockets),sockets:S(this.sockets),requests:S(this.requests)}}}function R(e){return e.timeout||e._idleTimeout}function S(e){let t={};for(let r in e)t[r]=e[r].length;return t}e.exports=p},43190:e=>{"use strict";e.exports={CURRENT_ID:Symbol("agentkeepalive#currentId"),CREATE_ID:Symbol("agentkeepalive#createId"),INIT_SOCKET:Symbol("agentkeepalive#initSocket"),CREATE_HTTPS_CONNECTION:Symbol("agentkeepalive#createHttpsConnection"),SOCKET_CREATED_TIME:Symbol("agentkeepalive#socketCreatedTime"),SOCKET_NAME:Symbol("agentkeepalive#socketName"),SOCKET_REQUEST_COUNT:Symbol("agentkeepalive#socketRequestCount"),SOCKET_REQUEST_FINISHED_COUNT:Symbol("agentkeepalive#socketRequestFinishedCount")}},14413:(e,t,r)=>{"use strict";let a=r(95687).Agent,s=r(76412),{INIT_SOCKET:i,CREATE_HTTPS_CONNECTION:n}=r(43190);class o extends s{constructor(e){super(e),this.defaultPort=443,this.protocol="https:",this.maxCachedSessions=this.options.maxCachedSessions,void 0===this.maxCachedSessions&&(this.maxCachedSessions=100),this._sessionCache={map:{},list:[]}}createConnection(e,t){let r=this[n](e,t);return this[i](r,e),r}}o.prototype[n]=a.prototype.createConnection,["getName","_getSession","_cacheSession","_evictSession"].forEach(function(e){"function"==typeof a.prototype[e]&&(o.prototype[e]=a.prototype[e])}),e.exports=o},53245:(e,t,r)=>{"use strict";e=r.nmd(e);let a=(e=0)=>t=>`\u001B[${38+e};5;${t}m`,s=(e=0)=>(t,r,a)=>`\u001B[${38+e};2;${t};${r};${a}m`;Object.defineProperty(e,"exports",{enumerable:!0,get:function(){let e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};for(let[r,a]of(t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright,Object.entries(t))){for(let[r,s]of Object.entries(a))t[r]={open:`\u001B[${s[0]}m`,close:`\u001B[${s[1]}m`},a[r]=t[r],e.set(s[0],s[1]);Object.defineProperty(t,r,{value:a,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1b[39m",t.bgColor.close="\x1b[49m",t.color.ansi256=a(),t.color.ansi16m=s(),t.bgColor.ansi256=a(10),t.bgColor.ansi16m=s(10),Object.defineProperties(t,{rgbToAnsi256:{value:(e,t,r)=>e===t&&t===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5),enumerable:!1},hexToRgb:{value:e=>{let t=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!t)return[0,0,0];let{colorString:r}=t.groups;3===r.length&&(r=r.split("").map(e=>e+e).join(""));let a=Number.parseInt(r,16);return[a>>16&255,a>>8&255,255&a]},enumerable:!1},hexToAnsi256:{value:e=>t.rgbToAnsi256(...t.hexToRgb(e)),enumerable:!1}}),t}})},64394:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],a=t[1];return(r+a)*3/4-a},t.toByteArray=function(e){var t,r,i=l(e),n=i[0],o=i[1],E=new s((n+o)*3/4-o),u=0,c=o>0?n-4:n;for(r=0;r<c;r+=4)t=a[e.charCodeAt(r)]<<18|a[e.charCodeAt(r+1)]<<12|a[e.charCodeAt(r+2)]<<6|a[e.charCodeAt(r+3)],E[u++]=t>>16&255,E[u++]=t>>8&255,E[u++]=255&t;return 2===o&&(t=a[e.charCodeAt(r)]<<2|a[e.charCodeAt(r+1)]>>4,E[u++]=255&t),1===o&&(t=a[e.charCodeAt(r)]<<10|a[e.charCodeAt(r+1)]<<4|a[e.charCodeAt(r+2)]>>2,E[u++]=t>>8&255,E[u++]=255&t),E},t.fromByteArray=function(e){for(var t,a=e.length,s=a%3,i=[],n=0,o=a-s;n<o;n+=16383)i.push(function(e,t,a){for(var s,i=[],n=t;n<a;n+=3)i.push(r[(s=(e[n]<<16&16711680)+(e[n+1]<<8&65280)+(255&e[n+2]))>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return i.join("")}(e,n,n+16383>o?o:n+16383));return 1===s?i.push(r[(t=e[a-1])>>2]+r[t<<4&63]+"=="):2===s&&i.push(r[(t=(e[a-2]<<8)+e[a-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),i.join("")};for(var r=[],a=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=i.length;n<o;++n)r[n]=i[n],a[i.charCodeAt(n)]=n;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var a=r===t?0:4-r%4;return[r,a]}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},86697:e=>{"use strict";let t=/[\p{Lu}]/u,r=/[\p{Ll}]/u,a=/^[\p{Lu}](?![\p{Lu}])/gu,s=/([\p{Alpha}\p{N}_]|$)/u,i=/[_.\- ]+/,n=RegExp("^"+i.source),o=RegExp(i.source+s.source,"gu"),l=RegExp("\\d+"+s.source,"gu"),E=(e,a,s)=>{let i=!1,n=!1,o=!1;for(let l=0;l<e.length;l++){let E=e[l];i&&t.test(E)?(e=e.slice(0,l)+"-"+e.slice(l),i=!1,o=n,n=!0,l++):n&&o&&r.test(E)?(e=e.slice(0,l-1)+"-"+e.slice(l-1),o=n,n=!1,i=!0):(i=a(E)===E&&s(E)!==E,o=n,n=s(E)===E&&a(E)!==E)}return e},u=(e,t)=>(a.lastIndex=0,e.replace(a,e=>t(e))),c=(e,t)=>(o.lastIndex=0,l.lastIndex=0,e.replace(o,(e,r)=>t(r)).replace(l,e=>t(e))),T=(e,t)=>{if(!("string"==typeof e||Array.isArray(e)))throw TypeError("Expected the input to be `string | string[]`");if(t={pascalCase:!1,preserveConsecutiveUppercase:!1,...t},0===(e=Array.isArray(e)?e.map(e=>e.trim()).filter(e=>e.length).join("-"):e.trim()).length)return"";let r=!1===t.locale?e=>e.toLowerCase():e=>e.toLocaleLowerCase(t.locale),a=!1===t.locale?e=>e.toUpperCase():e=>e.toLocaleUpperCase(t.locale);if(1===e.length)return t.pascalCase?a(e):r(e);let s=e!==r(e);return s&&(e=E(e,r,a)),e=e.replace(n,""),e=t.preserveConsecutiveUppercase?u(e,r):r(e),t.pascalCase&&(e=a(e.charAt(0))+e.slice(1)),c(e,a)};e.exports=T,e.exports.default=T},75571:e=>{"use strict";e.exports=function(e,t){if("string"!=typeof e)throw TypeError("Expected a string");return t=void 0===t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},24522:(e,t)=>{"use strict";/**
 * @author Toru Nagashima <https://github.com/mysticatea>
 * @copyright 2015 Toru Nagashima. All rights reserved.
 * See LICENSE file in root directory for full license.
 */Object.defineProperty(t,"__esModule",{value:!0});let r=new WeakMap,a=new WeakMap;function s(e){let t=r.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function i(e){if(null!=e.passiveListener){"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener);return}e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault())}function Event(e,t){r.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let a=Object.keys(t);for(let e=0;e<a.length;++e){let t=a[e];t in this||Object.defineProperty(this,t,n(t))}}function n(e){return{get(){return s(this).event[e]},set(t){s(this).event[e]=t},configurable:!0,enumerable:!0}}function o(e,t){s(e).passiveListener=t}Event.prototype={get type(){return s(this).event.type},get target(){return s(this).eventTarget},get currentTarget(){return s(this).currentTarget},composedPath(){let e=s(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return s(this).eventPhase},stopPropagation(){let e=s(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){let e=s(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return!!s(this).event.bubbles},get cancelable(){return!!s(this).event.cancelable},preventDefault(){i(s(this))},get defaultPrevented(){return s(this).canceled},get composed(){return!!s(this).event.composed},get timeStamp(){return s(this).timeStamp},get srcElement(){return s(this).eventTarget},get cancelBubble(){return s(this).stopped},set cancelBubble(value){if(!value)return;let e=s(this);e.stopped=!0,"boolean"==typeof e.event.cancelBubble&&(e.event.cancelBubble=!0)},get returnValue(){return!s(this).canceled},set returnValue(value){value||i(s(this))},initEvent(){}},Object.defineProperty(Event.prototype,"constructor",{value:Event,configurable:!0,writable:!0});let l=new WeakMap;function E(e){return null!==e&&"object"==typeof e}function u(e){let t=l.get(e);if(null==t)throw TypeError("'this' is expected an EventTarget object, but got another value.");return t}function c(e,t){Object.defineProperty(e,`on${t}`,{get(){let e=u(this),r=e.get(t);for(;null!=r;){if(3===r.listenerType)return r.listener;r=r.next}return null},set(e){"function"==typeof e||E(e)||(e=null);let r=u(this),a=null,s=r.get(t);for(;null!=s;)3===s.listenerType?null!==a?a.next=s.next:null!==s.next?r.set(t,s.next):r.delete(t):a=s,s=s.next;if(null!==e){let s={listener:e,listenerType:3,passive:!1,once:!1,next:null};null===a?r.set(t,s):a.next=s}},configurable:!0,enumerable:!0})}function T(e){function t(){EventTarget.call(this)}t.prototype=Object.create(EventTarget.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let r=0;r<e.length;++r)c(t.prototype,e[r]);return t}function EventTarget(){if(this instanceof EventTarget){l.set(this,new Map);return}if(1==arguments.length&&Array.isArray(arguments[0]))return T(arguments[0]);if(arguments.length>0){let e=Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return T(e)}throw TypeError("Cannot call a class as a function")}EventTarget.prototype={addEventListener(e,t,r){if(null==t)return;if("function"!=typeof t&&!E(t))throw TypeError("'listener' should be a function or an object.");let a=u(this),s=E(r),i=s?!!r.capture:!!r,n=i?1:2,o={listener:t,listenerType:n,passive:s&&!!r.passive,once:s&&!!r.once,next:null},l=a.get(e);if(void 0===l){a.set(e,o);return}let c=null;for(;null!=l;){if(l.listener===t&&l.listenerType===n)return;c=l,l=l.next}c.next=o},removeEventListener(e,t,r){if(null==t)return;let a=u(this),s=E(r)?!!r.capture:!!r,i=s?1:2,n=null,o=a.get(e);for(;null!=o;){if(o.listener===t&&o.listenerType===i){null!==n?n.next=o.next:null!==o.next?a.set(e,o.next):a.delete(e);return}n=o,o=o.next}},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw TypeError('"event.type" should be a string.');let t=u(this),r=e.type,i=t.get(r);if(null==i)return!0;let l=function(e,t){let r=function e(t){if(null==t||t===Object.prototype)return Event;let r=a.get(t);return null==r&&(r=function(e,t){let r=Object.keys(t);if(0===r.length)return e;function CustomEvent(t,r){e.call(this,t,r)}CustomEvent.prototype=Object.create(e.prototype,{constructor:{value:CustomEvent,configurable:!0,writable:!0}});for(let a=0;a<r.length;++a){let i=r[a];if(!(i in e.prototype)){let e=Object.getOwnPropertyDescriptor(t,i),r="function"==typeof e.value;Object.defineProperty(CustomEvent.prototype,i,r?function(e){return{value(){let t=s(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}(i):n(i))}}return CustomEvent}(e(Object.getPrototypeOf(t)),t),a.set(t,r)),r}(Object.getPrototypeOf(t));return new r(e,t)}(this,e),E=null;for(;null!=i;){if(i.once?null!==E?E.next=i.next:null!==i.next?t.set(r,i.next):t.delete(r):E=i,o(l,i.passive?i.listener:null),"function"==typeof i.listener)try{i.listener.call(this,l)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==i.listenerType&&"function"==typeof i.listener.handleEvent&&i.listener.handleEvent(l);if(s(l).immediateStopped)break;i=i.next}return o(l,null),s(l).eventPhase=0,s(l).currentTarget=null,!l.defaultPrevented}},Object.defineProperty(EventTarget.prototype,"constructor",{value:EventTarget,configurable:!0,writable:!0}),t.defineEventAttribute=c,t.EventTarget=EventTarget,t.default=EventTarget,e.exports=EventTarget,e.exports.EventTarget=e.exports.default=EventTarget,e.exports.defineEventAttribute=c},18483:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function a(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,a,i,n){if("function"!=typeof a)throw TypeError("The listener must be a function");var o=new s(a,i||e,n),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function n(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function o(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1)),o.prototype.eventNames=function(){var e,a,s=[];if(0===this._eventsCount)return s;for(a in e=this._events)t.call(e,a)&&s.push(r?a.slice(1):a);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},o.prototype.listeners=function(e){var t=r?r+e:e,a=this._events[t];if(!a)return[];if(a.fn)return[a.fn];for(var s=0,i=a.length,n=Array(i);s<i;s++)n[s]=a[s].fn;return n},o.prototype.listenerCount=function(e){var t=r?r+e:e,a=this._events[t];return a?a.fn?1:a.length:0},o.prototype.emit=function(e,t,a,s,i,n){var o=r?r+e:e;if(!this._events[o])return!1;var l,E,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,a),!0;case 4:return u.fn.call(u.context,t,a,s),!0;case 5:return u.fn.call(u.context,t,a,s,i),!0;case 6:return u.fn.call(u.context,t,a,s,i,n),!0}for(E=1,l=Array(c-1);E<c;E++)l[E-1]=arguments[E];u.fn.apply(u.context,l)}else{var T,d=u.length;for(E=0;E<d;E++)switch(u[E].once&&this.removeListener(e,u[E].fn,void 0,!0),c){case 1:u[E].fn.call(u[E].context);break;case 2:u[E].fn.call(u[E].context,t);break;case 3:u[E].fn.call(u[E].context,t,a);break;case 4:u[E].fn.call(u[E].context,t,a,s);break;default:if(!l)for(T=1,l=Array(c-1);T<c;T++)l[T-1]=arguments[T];u[E].fn.apply(u[E].context,l)}}return!0},o.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,a,s){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return n(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||s&&!o.once||a&&o.context!==a||n(this,i);else{for(var l=0,E=[],u=o.length;l<u;l++)(o[l].fn!==t||s&&!o[l].once||a&&o[l].context!==a)&&E.push(o[l]);E.length?this._events[i]=1===E.length?E[0]:E:n(this,i)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&n(this,t)):(this._events=new a,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o},84149:(e,t,r)=>{"use strict";/*!
 * humanize-ms - index.js
 * Copyright(c) 2014 dead_horse <dead_horse@qq.com>
 * MIT Licensed
 */var a=r(73837),s=r(8605);e.exports=function(e){if("number"==typeof e)return e;var t=s(e);return void 0===t&&console.warn(Error(a.format("humanize-ms(%j) result undefined",e)).stack),t}},29742:(e,t,r)=>{"use strict";let a=r(1213);a.zodToJsonSchema},48787:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultOptions=t.defaultOptions=void 0,t.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1},t.getDefaultOptions=e=>"string"==typeof e?Object.assign(Object.assign({},t.defaultOptions),{name:e}):Object.assign(Object.assign({},t.defaultOptions),e)},52109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRefs=void 0;let a=r(48787);t.getRefs=e=>{let t=(0,a.getDefaultOptions)(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return Object.assign(Object.assign({},t),{currentPath:r,propertyPath:void 0,seen:[]})}},44396:(e,t)=>{"use strict";function r(e,t,r,a){(null==a?void 0:a.errorMessages)&&r&&(e.errorMessage=Object.assign(Object.assign({},e.errorMessage),{[t]:r}))}Object.defineProperty(t,"__esModule",{value:!0}),t.setResponseValueAndErrors=t.addErrorMessage=void 0,t.addErrorMessage=r,t.setResponseValueAndErrors=function(e,t,a,s,i){e[t]=a,r(e,t,s,i)}},15656:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDef=void 0;let a=r(18088),s=r(5977),i=r(52758),n=r(15339),o=r(67028),l=r(65209),E=r(54999),u=r(98339),c=r(44384),T=r(97514),d=r(42132),h=r(51919),A=r(86121),p=r(30024),R=r(54404),S=r(31639),_=r(45292),O=r(81856),I=r(53885),f=r(90486),N=r(778),m=r(3438),C=r(99763),L=r(13735),y=r(99813),g=r(38135),P=r(24718),b=r(42359),D=r(40516),v=r(97590);function M(e,t){let r=t.seen.find(t=>Object.is(t.def,e));if(r)return U(r,t);let a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.push(a);let s=G(e,e.typeName,t);return s&&B(e,s),a.jsonSchema=s,s}t.parseDef=M;let U=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:0===e.path.length?"":1===e.path.length?`${e.path[0]}/`:e.path.join("/")};case"relative":return{$ref:w(t.currentPath,e.path)};case"none":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return e.jsonSchema}},w=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},G=(e,t,r)=>{switch(t){case a.ZodFirstPartyTypeKind.ZodString:return(0,g.parseStringDef)(e,r);case a.ZodFirstPartyTypeKind.ZodNumber:return(0,I.parseNumberDef)(e,r);case a.ZodFirstPartyTypeKind.ZodObject:return(0,f.parseObjectDef)(e,r);case a.ZodFirstPartyTypeKind.ZodBigInt:return(0,n.parseBigintDef)();case a.ZodFirstPartyTypeKind.ZodBoolean:return(0,o.parseBooleanDef)();case a.ZodFirstPartyTypeKind.ZodDate:return(0,u.parseDateDef)();case a.ZodFirstPartyTypeKind.ZodUndefined:return(0,b.parseUndefinedDef)();case a.ZodFirstPartyTypeKind.ZodNull:return(0,_.parseNullDef)(r);case a.ZodFirstPartyTypeKind.ZodArray:return(0,i.parseArrayDef)(e,r);case a.ZodFirstPartyTypeKind.ZodUnion:case a.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,D.parseUnionDef)(e,r);case a.ZodFirstPartyTypeKind.ZodIntersection:return(0,h.parseIntersectionDef)(e,r);case a.ZodFirstPartyTypeKind.ZodTuple:return(0,P.parseTupleDef)(e,r);case a.ZodFirstPartyTypeKind.ZodRecord:return(0,L.parseRecordDef)(e,r);case a.ZodFirstPartyTypeKind.ZodLiteral:return(0,A.parseLiteralDef)(e,r);case a.ZodFirstPartyTypeKind.ZodEnum:return(0,d.parseEnumDef)(e);case a.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,R.parseNativeEnumDef)(e);case a.ZodFirstPartyTypeKind.ZodNullable:return(0,O.parseNullableDef)(e,r);case a.ZodFirstPartyTypeKind.ZodOptional:return(0,N.parseOptionalDef)(e,r);case a.ZodFirstPartyTypeKind.ZodMap:return(0,p.parseMapDef)(e,r);case a.ZodFirstPartyTypeKind.ZodSet:return(0,y.parseSetDef)(e,r);case a.ZodFirstPartyTypeKind.ZodLazy:return M(e.getter()._def,r);case a.ZodFirstPartyTypeKind.ZodPromise:return(0,C.parsePromiseDef)(e,r);case a.ZodFirstPartyTypeKind.ZodNaN:case a.ZodFirstPartyTypeKind.ZodNever:return(0,S.parseNeverDef)();case a.ZodFirstPartyTypeKind.ZodEffects:return(0,T.parseEffectsDef)(e,r);case a.ZodFirstPartyTypeKind.ZodAny:return(0,s.parseAnyDef)();case a.ZodFirstPartyTypeKind.ZodUnknown:return(0,v.parseUnknownDef)();case a.ZodFirstPartyTypeKind.ZodDefault:return(0,c.parseDefaultDef)(e,r);case a.ZodFirstPartyTypeKind.ZodBranded:return(0,l.parseBrandedDef)(e,r);case a.ZodFirstPartyTypeKind.ZodCatch:return(0,E.parseCatchDef)(e,r);case a.ZodFirstPartyTypeKind.ZodPipeline:return(0,m.parsePipelineDef)(e,r);case a.ZodFirstPartyTypeKind.ZodFunction:case a.ZodFirstPartyTypeKind.ZodVoid:case a.ZodFirstPartyTypeKind.ZodSymbol:default:return}},B=(e,t)=>(e.description&&(t.description=e.description),t)},5977:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseAnyDef=void 0,t.parseAnyDef=function(){return{}}},52758:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseArrayDef=void 0;let a=r(18088),s=r(44396),i=r(15656);t.parseArrayDef=function(e,t){var r,n;let o={type:"array"};return(null===(n=null===(r=e.type)||void 0===r?void 0:r._def)||void 0===n?void 0:n.typeName)!==a.ZodFirstPartyTypeKind.ZodAny&&(o.items=(0,i.parseDef)(e.type._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items"]}))),e.minLength&&(0,s.setResponseValueAndErrors)(o,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&(0,s.setResponseValueAndErrors)(o,"maxItems",e.maxLength.value,e.maxLength.message,t),o}},15339:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBigintDef=void 0,t.parseBigintDef=function(){return{type:"integer",format:"int64"}}},67028:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBooleanDef=void 0,t.parseBooleanDef=function(){return{type:"boolean"}}},65209:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBrandedDef=void 0;let a=r(15656);t.parseBrandedDef=function(e,t){return(0,a.parseDef)(e.type._def,t)}},54999:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseCatchDef=void 0;let a=r(15656);t.parseCatchDef=(e,t)=>(0,a.parseDef)(e.innerType._def,t)},98339:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateDef=void 0,t.parseDateDef=function(){return{type:"string",format:"date-time"}}},44384:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDefaultDef=void 0;let a=r(15656);t.parseDefaultDef=function(e,t){return Object.assign(Object.assign({},(0,a.parseDef)(e.innerType._def,t)),{default:e.defaultValue()})}},97514:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEffectsDef=void 0;let a=r(15656);t.parseEffectsDef=function(e,t){return"input"===t.effectStrategy?(0,a.parseDef)(e.schema._def,t):{}}},42132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEnumDef=void 0,t.parseEnumDef=function(e){return{type:"string",enum:e.values}}},51919:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseIntersectionDef=void 0;let a=r(15656);t.parseIntersectionDef=function(e,t){let r=[(0,a.parseDef)(e.left._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","0"]})),(0,a.parseDef)(e.right._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","1"]}))].filter(e=>!!e);return r.length?{allOf:r}:void 0}},86121:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteralDef=void 0,t.parseLiteralDef=function(e,t){let r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}},30024:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseMapDef=void 0;let a=r(15656);t.parseMapDef=function(e,t){let r=(0,a.parseDef)(e.keyType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","0"]}))||{},s=(0,a.parseDef)(e.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,s],minItems:2,maxItems:2}}}},54404:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNativeEnumDef=void 0,t.parseNativeEnumDef=function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]),a=r.map(e=>t[e]),s=Array.from(new Set(a.map(e=>typeof e)));return{type:1===s.length?"string"===s[0]?"string":"number":["string","number"],enum:a}}},31639:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNeverDef=void 0,t.parseNeverDef=function(){return{not:{}}}},45292:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNullDef=void 0,t.parseNullDef=function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}},81856:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNullableDef=void 0;let a=r(15656),s=r(40516);t.parseNullableDef=function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:s.primitiveMappings[e.innerType._def.typeName],nullable:!0}:{type:[s.primitiveMappings[e.innerType._def.typeName],"null"]};let r=(0,a.parseDef)(e.innerType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf","0"]}));return r?"openApi3"===t.target?Object.assign(Object.assign({},r),{nullable:!0}):{anyOf:[r,{type:"null"}]}:void 0}},53885:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNumberDef=void 0;let a=r(44396);t.parseNumberDef=function(e,t){let r={type:"number"};if(!e.checks)return r;for(let s of e.checks)switch(s.kind){case"int":r.type="integer",(0,a.addErrorMessage)(r,"type",s.message,t);break;case"min":"jsonSchema7"===t.target?s.inclusive?(0,a.setResponseValueAndErrors)(r,"minimum",s.value,s.message,t):(0,a.setResponseValueAndErrors)(r,"exclusiveMinimum",s.value,s.message,t):(s.inclusive||(r.exclusiveMinimum=!0),(0,a.setResponseValueAndErrors)(r,"minimum",s.value,s.message,t));break;case"max":"jsonSchema7"===t.target?s.inclusive?(0,a.setResponseValueAndErrors)(r,"maximum",s.value,s.message,t):(0,a.setResponseValueAndErrors)(r,"exclusiveMaximum",s.value,s.message,t):(s.inclusive||(r.exclusiveMaximum=!0),(0,a.setResponseValueAndErrors)(r,"maximum",s.value,s.message,t));break;case"multipleOf":(0,a.setResponseValueAndErrors)(r,"multipleOf",s.value,s.message,t)}return r}},90486:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseObjectDef=void 0;let a=r(15656);t.parseObjectDef=function(e,t){var r;let s=Object.assign(Object.assign({type:"object"},Object.entries(e.shape()).reduce((e,[r,s])=>{if(void 0===s||void 0===s._def)return e;let i=(0,a.parseDef)(s._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"properties",r],propertyPath:[...t.currentPath,"properties",r]}));return void 0===i?e:{properties:Object.assign(Object.assign({},e.properties),{[r]:i}),required:s.isOptional()?e.required:[...e.required,r]}},{properties:{},required:[]})),{additionalProperties:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:null===(r=(0,a.parseDef)(e.catchall._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalProperties"]})))||void 0===r||r});return s.required.length||delete s.required,s}},778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseOptionalDef=void 0;let a=r(15656);t.parseOptionalDef=(e,t)=>{var r;if(t.currentPath.toString()===(null===(r=t.propertyPath)||void 0===r?void 0:r.toString()))return(0,a.parseDef)(e.innerType._def,t);let s=(0,a.parseDef)(e.innerType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf","1"]}));return s?{anyOf:[{not:{}},s]}:{}}},3438:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePipelineDef=void 0;let a=r(15656);t.parsePipelineDef=(e,t)=>{let r=(0,a.parseDef)(e.in._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","0"]})),s=(0,a.parseDef)(e.out._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf",r?"1":"0"]}));return{allOf:[r,s].filter(e=>void 0!==e)}}},99763:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePromiseDef=void 0;let a=r(15656);t.parsePromiseDef=function(e,t){return(0,a.parseDef)(e.type._def,t)}},13735:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRecordDef=void 0;let a=r(18088),s=r(15656),i=r(38135);t.parseRecordDef=function(e,t){var r,n,o;let l={type:"object",additionalProperties:(0,s.parseDef)(e.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalProperties"]}))||{}};if((null===(r=e.keyType)||void 0===r?void 0:r._def.typeName)===a.ZodFirstPartyTypeKind.ZodString&&(null===(n=e.keyType._def.checks)||void 0===n?void 0:n.length)){let r=Object.entries((0,i.parseStringDef)(e.keyType._def,t)).reduce((e,[t,r])=>"type"===t?e:Object.assign(Object.assign({},e),{[t]:r}),{});return Object.assign(Object.assign({},l),{propertyNames:r})}return(null===(o=e.keyType)||void 0===o?void 0:o._def.typeName)===a.ZodFirstPartyTypeKind.ZodEnum?Object.assign(Object.assign({},l),{propertyNames:{enum:e.keyType._def.values}}):l}},99813:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSetDef=void 0;let a=r(44396),s=r(15656);t.parseSetDef=function(e,t){let r=(0,s.parseDef)(e.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items"]})),i={type:"array",items:r};return e.minSize&&(0,a.setResponseValueAndErrors)(i,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&(0,a.setResponseValueAndErrors)(i,"maxItems",e.maxSize.value,e.maxSize.message,t),i}},38135:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStringDef=void 0;let a=r(44396);t.parseStringDef=function(e,t){let r={type:"string"};if(e.checks)for(let n of e.checks)switch(n.kind){case"min":(0,a.setResponseValueAndErrors)(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,n.message,t);break;case"max":(0,a.setResponseValueAndErrors)(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case"email":(0,a.setResponseValueAndErrors)(r,"format","email",n.message,t);break;case"url":(0,a.setResponseValueAndErrors)(r,"format","uri",n.message,t);break;case"uuid":(0,a.setResponseValueAndErrors)(r,"format","uuid",n.message,t);break;case"regex":i(r,n.regex.source,n.message,t);break;case"cuid":i(r,"^c[^\\s-]{8,}$",n.message,t);break;case"cuid2":i(r,"^[a-z][a-z0-9]*$",n.message,t);break;case"startsWith":i(r,"^"+s(n.value),n.message,t);break;case"endsWith":i(r,s(n.value)+"$",n.message,t);break;case"trim":break;case"datetime":(0,a.setResponseValueAndErrors)(r,"format","date-time",n.message,t);break;case"length":(0,a.setResponseValueAndErrors)(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,n.message,t),(0,a.setResponseValueAndErrors)(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value,n.message,t)}return r};let s=e=>Array.from(e).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),i=(e,t,r,s)=>{var i;e.pattern||(null===(i=e.allOf)||void 0===i?void 0:i.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push(Object.assign({pattern:e.pattern},e.errorMessage&&s.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}})),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push(Object.assign({pattern:t},r&&s.errorMessages&&{errorMessage:{pattern:r}}))):(0,a.setResponseValueAndErrors)(e,"pattern",t,r,s)}},24718:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTupleDef=void 0;let a=r(15656);t.parseTupleDef=function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>(0,a.parseDef)(e._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${r}`]}))).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:(0,a.parseDef)(e.rest._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>(0,a.parseDef)(e._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${r}`]}))).reduce((e,t)=>void 0===t?e:[...e,t],[])}}},42359:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUndefinedDef=void 0,t.parseUndefinedDef=function(){return{not:{}}}},40516:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnionDef=t.primitiveMappings=void 0;let a=r(15656);t.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},t.parseUnionDef=function(e,r){if("openApi3"===r.target)return s(e,r);let a=e.options instanceof Map?Array.from(e.options.values()):e.options;if(a.every(e=>e._def.typeName in t.primitiveMappings&&(!e._def.checks||!e._def.checks.length))){let e=a.reduce((e,r)=>{let a=t.primitiveMappings[r._def.typeName];return a&&!e.includes(a)?[...e,a]:e},[]);return{type:e.length>1?e:e[0]}}if(a.every(e=>"ZodLiteral"===e._def.typeName)){let e=a.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===a.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:a.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(a.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:a.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return s(e,r)};let s=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>(0,a.parseDef)(e._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf",`${r}`]}))).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0}},97590:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnknownDef=void 0,t.parseUnknownDef=function(){return{}}},1213:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zodToJsonSchema=void 0;let a=r(15656),s=r(52109);t.zodToJsonSchema=(e,t)=>{var r;let i=(0,s.getRefs)(t),n="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>{var s;return Object.assign(Object.assign({},e),{[t]:null!==(s=(0,a.parseDef)(r._def,Object.assign(Object.assign({},i),{currentPath:[...i.basePath,i.definitionPath,t]})))&&void 0!==s?s:{}})},{}):void 0,o="string"==typeof t?t:null==t?void 0:t.name,l=null!==(r=(0,a.parseDef)(e._def,void 0===o?i:Object.assign(Object.assign({},i),{currentPath:[...i.basePath,i.definitionPath,o]})))&&void 0!==r?r:{},E=void 0===o?n?Object.assign(Object.assign({},l),{[i.definitionPath]:n}):l:{$ref:[..."relative"===i.$refStrategy?[]:i.basePath,i.definitionPath,o].join("/"),[i.definitionPath]:Object.assign(Object.assign({},n),{[o]:l})};return"jsonSchema7"===i.target&&(E.$schema="http://json-schema.org/draft-07/schema#"),E}},85799:(e,t,r)=>{"use strict";let a=Symbol("SemVer ANY");class s{static get ANY(){return a}constructor(e,t){if(t=i(t),e instanceof s){if(!!t.loose===e.loose)return e;e=e.value}E("comparator",e=e.trim().split(/\s+/).join(" "),t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===a?this.value="":this.value=this.operator+this.semver.version,E("comp",this)}parse(e){let t=this.options.loose?n[o.COMPARATORLOOSE]:n[o.COMPARATOR],r=e.match(t);if(!r)throw TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new u(r[2],this.options.loose):this.semver=a}toString(){return this.value}test(e){if(E("Comparator.test",e,this.options.loose),this.semver===a||e===a)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof s))throw TypeError("a Comparator is required");return""===this.operator?""===this.value||new Range(e.value,t).test(this.value):""===e.operator?""===e.value||new Range(this.value,t).test(e.semver):!((t=i(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">"))}}e.exports=s;let i=r(60110),{safeRe:n,t:o}=r(45592),l=r(92372),E=r(8536),u=r(6422),Range=r(29506)},29506:(e,t,r)=>{"use strict";let a=/\s+/g;class Range{constructor(e,t){if(t=n(t),e instanceof Range){if(!!t.loose===e.loose&&!!t.includePrerelease===e.includePrerelease)return e;return new Range(e.raw,t)}if(e instanceof o)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(a," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let e=this.set[0];if(this.set=this.set.filter(e=>!R(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1){for(let e of this.set)if(1===e.length&&S(e[0])){this.set=[e];break}}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let t=(this.options.includePrerelease&&A)|(this.options.loose&&p),r=t+":"+e,a=i.get(r);if(a)return a;let s=this.options.loose,n=s?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];l("hyphen replace",e=e.replace(n,b(this.options.includePrerelease))),l("comparator trim",e=e.replace(u[c.COMPARATORTRIM],T)),l("tilde trim",e=e.replace(u[c.TILDETRIM],d)),l("caret trim",e=e.replace(u[c.CARETTRIM],h));let E=e.split(" ").map(e=>O(e,this.options)).join(" ").split(/\s+/).map(e=>P(e,this.options));s&&(E=E.filter(e=>(l("loose invalid filter",e,this.options),!!e.match(u[c.COMPARATORLOOSE])))),l("range list",E);let S=new Map,_=E.map(e=>new o(e,this.options));for(let e of _){if(R(e))return[e];S.set(e.value,e)}S.size>1&&S.has("")&&S.delete("");let I=[...S.values()];return i.set(r,I),I}intersects(e,t){if(!(e instanceof Range))throw TypeError("a Range is required");return this.set.some(r=>_(r,t)&&e.set.some(e=>_(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new E(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(D(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;let s=r(42012),i=new s,n=r(60110),o=r(85799),l=r(8536),E=r(6422),{safeRe:u,t:c,comparatorTrimReplace:T,tildeTrimReplace:d,caretTrimReplace:h}=r(45592),{FLAG_INCLUDE_PRERELEASE:A,FLAG_LOOSE:p}=r(44288),R=e=>"<0.0.0-0"===e.value,S=e=>""===e.value,_=(e,t)=>{let r=!0,a=e.slice(),s=a.pop();for(;r&&a.length;)r=a.every(e=>s.intersects(e,t)),s=a.pop();return r},O=(e,t)=>(l("comp",e=e.replace(u[c.BUILD],""),t),l("caret",e=m(e,t)),l("tildes",e=f(e,t)),l("xrange",e=L(e,t)),l("stars",e=g(e,t)),e),I=e=>!e||"x"===e.toLowerCase()||"*"===e,f=(e,t)=>e.trim().split(/\s+/).map(e=>N(e,t)).join(" "),N=(e,t)=>{let r=t.loose?u[c.TILDELOOSE]:u[c.TILDE];return e.replace(r,(t,r,a,s,i)=>{let n;return l("tilde",e,t,r,a,s,i),I(r)?n="":I(a)?n=`>=${r}.0.0 <${+r+1}.0.0-0`:I(s)?n=`>=${r}.${a}.0 <${r}.${+a+1}.0-0`:i?(l("replaceTilde pr",i),n=`>=${r}.${a}.${s}-${i} <${r}.${+a+1}.0-0`):n=`>=${r}.${a}.${s} <${r}.${+a+1}.0-0`,l("tilde return",n),n})},m=(e,t)=>e.trim().split(/\s+/).map(e=>C(e,t)).join(" "),C=(e,t)=>{l("caret",e,t);let r=t.loose?u[c.CARETLOOSE]:u[c.CARET],a=t.includePrerelease?"-0":"";return e.replace(r,(t,r,s,i,n)=>{let o;return l("caret",e,t,r,s,i,n),I(r)?o="":I(s)?o=`>=${r}.0.0${a} <${+r+1}.0.0-0`:I(i)?o="0"===r?`>=${r}.${s}.0${a} <${r}.${+s+1}.0-0`:`>=${r}.${s}.0${a} <${+r+1}.0.0-0`:n?(l("replaceCaret pr",n),o="0"===r?"0"===s?`>=${r}.${s}.${i}-${n} <${r}.${s}.${+i+1}-0`:`>=${r}.${s}.${i}-${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${i}-${n} <${+r+1}.0.0-0`):(l("no pr"),o="0"===r?"0"===s?`>=${r}.${s}.${i}${a} <${r}.${s}.${+i+1}-0`:`>=${r}.${s}.${i}${a} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${i} <${+r+1}.0.0-0`),l("caret return",o),o})},L=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map(e=>y(e,t)).join(" ")),y=(e,t)=>{e=e.trim();let r=t.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return e.replace(r,(r,a,s,i,n,o)=>{l("xRange",e,r,a,s,i,n,o);let E=I(s),u=E||I(i),c=u||I(n);return"="===a&&c&&(a=""),o=t.includePrerelease?"-0":"",E?r=">"===a||"<"===a?"<0.0.0-0":"*":a&&c?(u&&(i=0),n=0,">"===a?(a=">=",u?(s=+s+1,i=0):i=+i+1,n=0):"<="===a&&(a="<",u?s=+s+1:i=+i+1),"<"===a&&(o="-0"),r=`${a+s}.${i}.${n}${o}`):u?r=`>=${s}.0.0${o} <${+s+1}.0.0-0`:c&&(r=`>=${s}.${i}.0${o} <${s}.${+i+1}.0-0`),l("xRange return",r),r})},g=(e,t)=>(l("replaceStars",e,t),e.trim().replace(u[c.STAR],"")),P=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),b=e=>(t,r,a,s,i,n,o,l,E,u,c,T)=>(r=I(a)?"":I(s)?`>=${a}.0.0${e?"-0":""}`:I(i)?`>=${a}.${s}.0${e?"-0":""}`:n?`>=${r}`:`>=${r}${e?"-0":""}`,l=I(E)?"":I(u)?`<${+E+1}.0.0-0`:I(c)?`<${E}.${+u+1}.0-0`:T?`<=${E}.${u}.${c}-${T}`:e?`<${E}.${u}.${+c+1}-0`:`<=${l}`,`${r} ${l}`.trim()),D=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(l(e[r].semver),e[r].semver!==o.ANY&&e[r].semver.prerelease.length>0){let a=e[r].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}},6422:(e,t,r)=>{"use strict";let a=r(8536),{MAX_LENGTH:s,MAX_SAFE_INTEGER:i}=r(44288),{safeRe:n,t:o}=r(45592),l=r(60110),{compareIdentifiers:E}=r(26120);class u{constructor(e,t){if(t=l(t),e instanceof u){if(!!t.loose===e.loose&&!!t.includePrerelease===e.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>s)throw TypeError(`version is longer than ${s} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?n[o.LOOSE]:n[o.FULL]);if(!r)throw TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){let t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return(e instanceof u||(e=new u(e,this.options)),this.major<e.major)?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return -1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],s=e.prerelease[t];if(a("prerelease compare",t,r,s),void 0===r&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===r)return -1;if(r===s)continue;else return E(r,s)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{let r=this.build[t],s=e.build[t];if(a("build compare",t,r,s),void 0===r&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===r)return -1;if(r===s)continue;else return E(r,s)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw Error("invalid increment argument: identifier is empty");if(t){let e=`-${t}`.match(this.options.loose?n[o.PRERELEASELOOSE]:n[o.PRERELEASE]);if(!e||e[1]!==t)throw Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{let e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===r)throw Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===r&&(a=[t]),0===E(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},71631:(e,t,r)=>{"use strict";let a=r(36513);e.exports=(e,t)=>{let r=a(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},92372:(e,t,r)=>{"use strict";let a=r(25381),s=r(476),i=r(82942),n=r(87638),o=r(62088),l=r(61953);e.exports=(e,t,r,E)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return a(e,r,E);case"!=":return s(e,r,E);case">":return i(e,r,E);case">=":return n(e,r,E);case"<":return o(e,r,E);case"<=":return l(e,r,E);default:throw TypeError(`Invalid operator: ${t}`)}}},50529:(e,t,r)=>{"use strict";let a=r(6422),s=r(36513),{safeRe:i,t:n}=r(45592);e.exports=(e,t)=>{if(e instanceof a)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let a;let s=t.includePrerelease?i[n.COERCERTLFULL]:i[n.COERCERTL];for(;(a=s.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&a.index+a[0].length===r.index+r[0].length||(r=a),s.lastIndex=a.index+a[1].length+a[2].length;s.lastIndex=-1}else r=e.match(t.includePrerelease?i[n.COERCEFULL]:i[n.COERCE]);if(null===r)return null;let o=r[2],l=r[3]||"0",E=r[4]||"0",u=t.includePrerelease&&r[5]?`-${r[5]}`:"",c=t.includePrerelease&&r[6]?`+${r[6]}`:"";return s(`${o}.${l}.${E}${u}${c}`,t)}},74655:(e,t,r)=>{"use strict";let a=r(6422);e.exports=(e,t,r)=>{let s=new a(e,r),i=new a(t,r);return s.compare(i)||s.compareBuild(i)}},42422:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t)=>a(e,t,!0)},69577:(e,t,r)=>{"use strict";let a=r(6422);e.exports=(e,t,r)=>new a(e,r).compare(new a(t,r))},12120:(e,t,r)=>{"use strict";let a=r(36513);e.exports=(e,t)=>{let r=a(e,null,!0),s=a(t,null,!0),i=r.compare(s);if(0===i)return null;let n=i>0,o=n?r:s,l=n?s:r,E=!!o.prerelease.length,u=!!l.prerelease.length;if(u&&!E){if(!l.patch&&!l.minor)return"major";if(0===l.compareMain(o))return l.minor&&!l.patch?"minor":"patch"}let c=E?"pre":"";return r.major!==s.major?c+"major":r.minor!==s.minor?c+"minor":r.patch!==s.patch?c+"patch":"prerelease"}},25381:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t,r)=>0===a(e,t,r)},82942:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t,r)=>a(e,t,r)>0},87638:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t,r)=>a(e,t,r)>=0},69400:(e,t,r)=>{"use strict";let a=r(6422);e.exports=(e,t,r,s,i)=>{"string"==typeof r&&(i=s,s=r,r=void 0);try{return new a(e instanceof a?e.version:e,r).inc(t,s,i).version}catch(e){return null}}},62088:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t,r)=>0>a(e,t,r)},61953:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t,r)=>0>=a(e,t,r)},63378:(e,t,r)=>{"use strict";let a=r(6422);e.exports=(e,t)=>new a(e,t).major},89398:(e,t,r)=>{"use strict";let a=r(6422);e.exports=(e,t)=>new a(e,t).minor},476:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t,r)=>0!==a(e,t,r)},36513:(e,t,r)=>{"use strict";let a=r(6422);e.exports=(e,t,r=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!r)return null;throw e}}},64165:(e,t,r)=>{"use strict";let a=r(6422);e.exports=(e,t)=>new a(e,t).patch},21694:(e,t,r)=>{"use strict";let a=r(36513);e.exports=(e,t)=>{let r=a(e,t);return r&&r.prerelease.length?r.prerelease:null}},62025:(e,t,r)=>{"use strict";let a=r(69577);e.exports=(e,t,r)=>a(t,e,r)},91711:(e,t,r)=>{"use strict";let a=r(74655);e.exports=(e,t)=>e.sort((e,r)=>a(r,e,t))},65981:(e,t,r)=>{"use strict";let Range=r(29506);e.exports=(e,t,r)=>{try{t=new Range(t,r)}catch(e){return!1}return t.test(e)}},18665:(e,t,r)=>{"use strict";let a=r(74655);e.exports=(e,t)=>e.sort((e,r)=>a(e,r,t))},95349:(e,t,r)=>{"use strict";let a=r(36513);e.exports=(e,t)=>{let r=a(e,t);return r?r.version:null}},71634:(e,t,r)=>{"use strict";let a=r(45592),s=r(44288),i=r(6422),n=r(26120),o=r(36513),l=r(95349),E=r(71631),u=r(69400),c=r(12120),T=r(63378),d=r(89398),h=r(64165),A=r(21694),p=r(69577),R=r(62025),S=r(42422),_=r(74655),O=r(18665),I=r(91711),f=r(82942),N=r(62088),m=r(25381),C=r(476),L=r(87638),y=r(61953),g=r(92372),P=r(50529),b=r(85799),Range=r(29506),D=r(65981),v=r(29691),M=r(65012),U=r(74461),w=r(20937),G=r(12923),B=r(46173),F=r(99253),H=r(85677),x=r(35248),k=r(50541),Y=r(3480);e.exports={parse:o,valid:l,clean:E,inc:u,diff:c,major:T,minor:d,patch:h,prerelease:A,compare:p,rcompare:R,compareLoose:S,compareBuild:_,sort:O,rsort:I,gt:f,lt:N,eq:m,neq:C,gte:L,lte:y,cmp:g,coerce:P,Comparator:b,Range,satisfies:D,toComparators:v,maxSatisfying:M,minSatisfying:U,minVersion:w,validRange:G,outside:B,gtr:F,ltr:H,intersects:x,simplifyRange:k,subset:Y,SemVer:i,re:a.re,src:a.src,tokens:a.t,SEMVER_SPEC_VERSION:s.SEMVER_SPEC_VERSION,RELEASE_TYPES:s.RELEASE_TYPES,compareIdentifiers:n.compareIdentifiers,rcompareIdentifiers:n.rcompareIdentifiers}},44288:e=>{"use strict";let t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},8536:e=>{"use strict";let t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},26120:e=>{"use strict";let t=/^[0-9]+$/,r=(e,r)=>{if("number"==typeof e&&"number"==typeof r)return e===r?0:e<r?-1:1;let a=t.test(e),s=t.test(r);return a&&s&&(e=+e,r=+r),e===r?0:a&&!s?-1:s&&!a?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},42012:e=>{"use strict";class t{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(void 0!==t)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){let r=this.delete(e);if(!r&&void 0!==t){if(this.map.size>=this.max){let e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}e.exports=t},60110:e=>{"use strict";let t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},45592:(e,t,r)=>{"use strict";let{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:s,MAX_LENGTH:i}=r(44288),n=r(8536);t=e.exports={};let o=t.re=[],l=t.safeRe=[],E=t.src=[],u=t.safeSrc=[],c=t.t={},T=0,d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",i],[d,s]],A=e=>{for(let[t,r]of h)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e},p=(e,t,r)=>{let a=A(t),s=T++;n(e,s,t),c[e]=s,E[s]=t,u[s]=a,o[s]=new RegExp(t,r?"g":void 0),l[s]=new RegExp(a,r?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),p("MAINVERSION",`(${E[c.NUMERICIDENTIFIER]})\\.(${E[c.NUMERICIDENTIFIER]})\\.(${E[c.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${E[c.NUMERICIDENTIFIERLOOSE]})\\.(${E[c.NUMERICIDENTIFIERLOOSE]})\\.(${E[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${E[c.NONNUMERICIDENTIFIER]}|${E[c.NUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${E[c.NONNUMERICIDENTIFIER]}|${E[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASE",`(?:-(${E[c.PRERELEASEIDENTIFIER]}(?:\\.${E[c.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${E[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${E[c.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${d}+`),p("BUILD",`(?:\\+(${E[c.BUILDIDENTIFIER]}(?:\\.${E[c.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${E[c.MAINVERSION]}${E[c.PRERELEASE]}?${E[c.BUILD]}?`),p("FULL",`^${E[c.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${E[c.MAINVERSIONLOOSE]}${E[c.PRERELEASELOOSE]}?${E[c.BUILD]}?`),p("LOOSE",`^${E[c.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${E[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${E[c.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${E[c.XRANGEIDENTIFIER]})(?:\\.(${E[c.XRANGEIDENTIFIER]})(?:\\.(${E[c.XRANGEIDENTIFIER]})(?:${E[c.PRERELEASE]})?${E[c.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${E[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${E[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${E[c.XRANGEIDENTIFIERLOOSE]})(?:${E[c.PRERELEASELOOSE]})?${E[c.BUILD]}?)?)?`),p("XRANGE",`^${E[c.GTLT]}\\s*${E[c.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${E[c.GTLT]}\\s*${E[c.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),p("COERCE",`${E[c.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",E[c.COERCEPLAIN]+`(?:${E[c.PRERELEASE]})?`+`(?:${E[c.BUILD]})?`+"(?:$|[^\\d])"),p("COERCERTL",E[c.COERCE],!0),p("COERCERTLFULL",E[c.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${E[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${E[c.LONETILDE]}${E[c.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${E[c.LONETILDE]}${E[c.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${E[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${E[c.LONECARET]}${E[c.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${E[c.LONECARET]}${E[c.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${E[c.GTLT]}\\s*(${E[c.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${E[c.GTLT]}\\s*(${E[c.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${E[c.GTLT]}\\s*(${E[c.LOOSEPLAIN]}|${E[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${E[c.XRANGEPLAIN]})\\s+-\\s+(${E[c.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${E[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${E[c.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},99253:(e,t,r)=>{"use strict";let a=r(46173);e.exports=(e,t,r)=>a(e,t,">",r)},35248:(e,t,r)=>{"use strict";let Range=r(29506);e.exports=(e,t,r)=>(e=new Range(e,r),t=new Range(t,r),e.intersects(t,r))},85677:(e,t,r)=>{"use strict";let a=r(46173);e.exports=(e,t,r)=>a(e,t,"<",r)},65012:(e,t,r)=>{"use strict";let a=r(6422),Range=r(29506);e.exports=(e,t,r)=>{let s=null,i=null,n=null;try{n=new Range(t,r)}catch(e){return null}return e.forEach(e=>{n.test(e)&&(!s||-1===i.compare(e))&&(i=new a(s=e,r))}),s}},74461:(e,t,r)=>{"use strict";let a=r(6422),Range=r(29506);e.exports=(e,t,r)=>{let s=null,i=null,n=null;try{n=new Range(t,r)}catch(e){return null}return e.forEach(e=>{n.test(e)&&(!s||1===i.compare(e))&&(i=new a(s=e,r))}),s}},20937:(e,t,r)=>{"use strict";let a=r(6422),Range=r(29506),s=r(82942);e.exports=(e,t)=>{e=new Range(e,t);let r=new a("0.0.0");if(e.test(r)||(r=new a("0.0.0-0"),e.test(r)))return r;r=null;for(let t=0;t<e.set.length;++t){let i=e.set[t],n=null;i.forEach(e=>{let t=new a(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!n||s(t,n))&&(n=t);break;case"<":case"<=":break;default:throw Error(`Unexpected operation: ${e.operator}`)}}),n&&(!r||s(r,n))&&(r=n)}return r&&e.test(r)?r:null}},46173:(e,t,r)=>{"use strict";let a=r(6422),s=r(85799),{ANY:i}=s,Range=r(29506),n=r(65981),o=r(82942),l=r(62088),E=r(61953),u=r(87638);e.exports=(e,t,r,c)=>{let T,d,h,A,p;switch(e=new a(e,c),t=new Range(t,c),r){case">":T=o,d=E,h=l,A=">",p=">=";break;case"<":T=l,d=u,h=o,A="<",p="<=";break;default:throw TypeError('Must provide a hilo val of "<" or ">"')}if(n(e,t,c))return!1;for(let r=0;r<t.set.length;++r){let a=t.set[r],n=null,o=null;if(a.forEach(e=>{e.semver===i&&(e=new s(">=0.0.0")),n=n||e,o=o||e,T(e.semver,n.semver,c)?n=e:h(e.semver,o.semver,c)&&(o=e)}),n.operator===A||n.operator===p||(!o.operator||o.operator===A)&&d(e,o.semver)||o.operator===p&&h(e,o.semver))return!1}return!0}},50541:(e,t,r)=>{"use strict";let a=r(65981),s=r(69577);e.exports=(e,t,r)=>{let i=[],n=null,o=null,l=e.sort((e,t)=>s(e,t,r));for(let e of l){let s=a(e,t,r);s?(o=e,n||(n=e)):(o&&i.push([n,o]),o=null,n=null)}n&&i.push([n,null]);let E=[];for(let[e,t]of i)e===t?E.push(e):t||e!==l[0]?t?e===l[0]?E.push(`<=${t}`):E.push(`${e} - ${t}`):E.push(`>=${e}`):E.push("*");let u=E.join(" || "),c="string"==typeof t.raw?t.raw:String(t);return u.length<c.length?u:t}},3480:(e,t,r)=>{"use strict";let Range=r(29506),a=r(85799),{ANY:s}=a,i=r(65981),n=r(69577),o=[new a(">=0.0.0-0")],l=[new a(">=0.0.0")],E=(e,t,r)=>{let a,E,T,d,h,A,p;if(e===t)return!0;if(1===e.length&&e[0].semver===s){if(1===t.length&&t[0].semver===s)return!0;e=r.includePrerelease?o:l}if(1===t.length&&t[0].semver===s){if(r.includePrerelease)return!0;t=l}let R=new Set;for(let t of e)">"===t.operator||">="===t.operator?a=u(a,t,r):"<"===t.operator||"<="===t.operator?E=c(E,t,r):R.add(t.semver);if(R.size>1||a&&E&&((T=n(a.semver,E.semver,r))>0||0===T&&(">="!==a.operator||"<="!==E.operator)))return null;for(let e of R){if(a&&!i(e,String(a),r)||E&&!i(e,String(E),r))return null;for(let a of t)if(!i(e,String(a),r))return!1;return!0}let S=!!E&&!r.includePrerelease&&!!E.semver.prerelease.length&&E.semver,_=!!a&&!r.includePrerelease&&!!a.semver.prerelease.length&&a.semver;for(let e of(S&&1===S.prerelease.length&&"<"===E.operator&&0===S.prerelease[0]&&(S=!1),t)){if(p=p||">"===e.operator||">="===e.operator,A=A||"<"===e.operator||"<="===e.operator,a){if(_&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===_.major&&e.semver.minor===_.minor&&e.semver.patch===_.patch&&(_=!1),">"===e.operator||">="===e.operator){if((d=u(a,e,r))===e&&d!==a)return!1}else if(">="===a.operator&&!i(a.semver,String(e),r))return!1}if(E){if(S&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===S.major&&e.semver.minor===S.minor&&e.semver.patch===S.patch&&(S=!1),"<"===e.operator||"<="===e.operator){if((h=c(E,e,r))===e&&h!==E)return!1}else if("<="===E.operator&&!i(E.semver,String(e),r))return!1}if(!e.operator&&(E||a)&&0!==T)return!1}return(!a||!A||!!E||0===T)&&(!E||!p||!!a||0===T)&&!_&&!S},u=(e,t,r)=>{if(!e)return t;let a=n(e.semver,t.semver,r);return a>0?e:a<0?t:">"===t.operator&&">="===e.operator?t:e},c=(e,t,r)=>{if(!e)return t;let a=n(e.semver,t.semver,r);return a<0?e:a>0?t:"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new Range(e,r),t=new Range(t,r);let a=!1;e:for(let s of e.set){for(let e of t.set){let t=E(s,e,r);if(a=a||null!==t,t)continue e}if(a)return!1}return!0}},29691:(e,t,r)=>{"use strict";let Range=r(29506);e.exports=(e,t)=>new Range(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},12923:(e,t,r)=>{"use strict";let Range=r(29506);e.exports=(e,t)=>{try{return new Range(e,t).range||"*"}catch(e){return null}}},8605:e=>{"use strict";function t(e,t,r,a){return Math.round(e/r)+" "+a+(t>=1.5*r?"s":"")}e.exports=function(e,r){r=r||{};var a,s,i=typeof e;if("string"===i&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===i&&isFinite(e))return r.long?(a=Math.abs(e))>=864e5?t(e,a,864e5,"day"):a>=36e5?t(e,a,36e5,"hour"):a>=6e4?t(e,a,6e4,"minute"):a>=1e3?t(e,a,1e3,"second"):e+" ms":(s=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":s>=36e5?Math.round(e/36e5)+"h":s>=6e4?Math.round(e/6e4)+"m":s>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},57626:e=>{"use strict";!function(t,r){e.exports?e.exports=r():t.nearley=r()}(void 0,function(){function e(t,r,a){return this.id=++e.highestId,this.name=t,this.symbols=r,this.postprocess=a,this}function t(e,t,r,a){this.rule=e,this.dot=t,this.reference=r,this.data=[],this.wantedBy=a,this.isComplete=this.dot===e.symbols.length}function r(e,t){this.grammar=e,this.index=t,this.states=[],this.wants={},this.scannable=[],this.completed={}}function a(e,t){this.rules=e,this.start=t||this.rules[0].name;var r=this.byName={};this.rules.forEach(function(e){r.hasOwnProperty(e.name)||(r[e.name]=[]),r[e.name].push(e)})}function s(){this.reset("")}function i(e,t,i){if(e instanceof a)var n=e,i=t;else var n=a.fromCompiled(e,t);for(var o in this.grammar=n,this.options={keepHistory:!1,lexer:n.lexer||new s},i||{})this.options[o]=i[o];this.lexer=this.options.lexer,this.lexerState=void 0;var l=new r(n,0);this.table=[l],l.wants[n.start]=[],l.predict(n.start),l.process(),this.current=0}function n(e){var t=typeof e;if("string"===t)return e;if("object"===t){if(e.literal)return JSON.stringify(e.literal);if(e instanceof RegExp)return e.toString();if(e.type)return"%"+e.type;if(e.test)return"<"+String(e.test)+">";else throw Error("Unknown symbol type: "+e)}}return e.highestId=0,e.prototype.toString=function(e){var t=void 0===e?this.symbols.map(n).join(" "):this.symbols.slice(0,e).map(n).join(" ")+"  "+this.symbols.slice(e).map(n).join(" ");return this.name+"  "+t},t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(e){var r=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return r.left=this,r.right=e,r.isComplete&&(r.data=r.build(),r.right=void 0),r},t.prototype.build=function(){var e=[],t=this;do e.push(t.right.data),t=t.left;while(t.left);return e.reverse(),e},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,i.fail))},r.prototype.process=function(e){for(var t=this.states,r=this.wants,a=this.completed,s=0;s<t.length;s++){var n=t[s];if(n.isComplete){if(n.finish(),n.data!==i.fail){for(var o=n.wantedBy,l=o.length;l--;){var E=o[l];this.complete(E,n)}if(n.reference===this.index){var u=n.rule.name;(this.completed[u]=this.completed[u]||[]).push(n)}}}else{var u=n.rule.symbols[n.dot];if("string"!=typeof u){this.scannable.push(n);continue}if(r[u]){if(r[u].push(n),a.hasOwnProperty(u))for(var c=a[u],l=0;l<c.length;l++){var T=c[l];this.complete(n,T)}}else r[u]=[n],this.predict(u)}}},r.prototype.predict=function(e){for(var r=this.grammar.byName[e]||[],a=0;a<r.length;a++){var s=r[a],i=this.wants[e],n=new t(s,0,this.index,i);this.states.push(n)}},r.prototype.complete=function(e,t){var r=e.nextState(t);this.states.push(r)},a.fromCompiled=function(t,r){var s=t.Lexer;t.ParserStart&&(r=t.ParserStart,t=t.ParserRules);var t=t.map(function(t){return new e(t.name,t.symbols,t.postprocess)}),i=new a(t,r);return i.lexer=s,i},s.prototype.reset=function(e,t){this.buffer=e,this.index=0,this.line=t?t.line:1,this.lastLineBreak=t?-t.col:0},s.prototype.next=function(){if(this.index<this.buffer.length){var e=this.buffer[this.index++];return"\n"===e&&(this.line+=1,this.lastLineBreak=this.index),{value:e}}},s.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},s.prototype.formatError=function(e,t){var r=this.buffer;if("string"!=typeof r)return t+" at index "+(this.index-1);var a=r.split("\n").slice(Math.max(0,this.line-5),this.line),s=r.indexOf("\n",this.index);-1===s&&(s=r.length);var i=this.index-this.lastLineBreak,n=String(this.line).length;return t+(" at line "+this.line+" col "+i+":\n\n"+a.map(function(e,t){return o(this.line-a.length+t+1,n)+" "+e},this).join("\n")+"\n"+o("",n+i))+"^\n";function o(e,t){var r=String(e);return Array(t-r.length+1).join(" ")+r}},i.fail={},i.prototype.feed=function(e){var t,a=this.lexer;for(a.reset(e,this.lexerState);;){try{if(!(t=a.next()))break}catch(e){var i=new r(this.grammar,this.current+1);this.table.push(i);var n=Error(this.reportLexerError(e));throw n.offset=this.current,n.token=e.token,n}var o=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var l=this.current+1,i=new r(this.grammar,l);this.table.push(i);for(var E=void 0!==t.text?t.text:t.value,u=a.constructor===s?t.value:t,c=o.scannable,T=c.length;T--;){var d=c[T],h=d.rule.symbols[d.dot];if(h.test?h.test(u):h.type?h.type===t.type:h.literal===E){var A=d.nextState({data:u,token:t,isToken:!0,reference:l-1});i.states.push(A)}}if(i.process(),0===i.states.length){var n=Error(this.reportError(t));throw n.offset=this.current,n.token=t,n}this.options.keepHistory&&(o.lexerState=a.save()),this.current++}return o&&(this.lexerState=a.save()),this.results=this.finish(),this},i.prototype.reportLexerError=function(e){var t,r,a=e.token;return a?(t="input "+JSON.stringify(a.text[0])+" (lexer error)",r=this.lexer.formatError(a,"Syntax error")):(t="input (lexer error)",r=e.message),this.reportErrorCommon(r,t)},i.prototype.reportError=function(e){var t=(e.type?e.type+" token: ":"")+JSON.stringify(void 0!==e.value?e.value:e),r=this.lexer.formatError(e,"Syntax error");return this.reportErrorCommon(r,t)},i.prototype.reportErrorCommon=function(e,t){var r=[];r.push(e);var a=this.table.length-2,s=this.table[a],i=s.states.filter(function(e){var t=e.rule.symbols[e.dot];return t&&"string"!=typeof t});return 0===i.length?(r.push("Unexpected "+t+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(s.states,r)):(r.push("Unexpected "+t+". Instead, I was expecting to see one of the following:\n"),i.map(function(e){return this.buildFirstStateStack(e,[])||[e]},this).forEach(function(e){var t=e[0],a=t.rule.symbols[t.dot],s=this.getSymbolDisplay(a);r.push("A "+s+" based on:"),this.displayStateStack(e,r)},this)),r.push(""),r.join("\n")},i.prototype.displayStateStack=function(e,t){for(var r,a=0,s=0;s<e.length;s++){var i=e[s],n=i.rule.toString(i.dot);n===r?a++:(a>0&&t.push("    ^ "+a+" more lines identical to this"),a=0,t.push("    "+n)),r=n}},i.prototype.getSymbolDisplay=function(e){return function(e){var t=typeof e;if("string"===t)return e;if("object"===t){if(e.literal)return JSON.stringify(e.literal);if(e instanceof RegExp)return"character matching "+e;if(e.type)return e.type+" token";if(e.test)return"token matching "+String(e.test);else throw Error("Unknown symbol type: "+e)}}(e)},i.prototype.buildFirstStateStack=function(e,t){if(-1!==t.indexOf(e))return null;if(0===e.wantedBy.length)return[e];var r=e.wantedBy[0],a=[e].concat(t),s=this.buildFirstStateStack(r,a);return null===s?null:[e].concat(s)},i.prototype.save=function(){var e=this.table[this.current];return e.lexerState=this.lexerState,e},i.prototype.restore=function(e){var t=e.index;this.current=t,this.table[t]=e,this.table.splice(t+1),this.lexerState=e.lexerState,this.results=this.finish()},i.prototype.rewind=function(e){if(!this.options.keepHistory)throw Error("set option `keepHistory` to enable rewinding");this.restore(this.table[e])},i.prototype.finish=function(){var e=[],t=this.grammar.start;return this.table[this.table.length-1].states.forEach(function(r){r.rule.name===t&&r.dot===r.rule.symbols.length&&0===r.reference&&r.data!==i.fail&&e.push(r)}),e.map(function(e){return e.data})},{Parser:i,Grammar:a,Rule:e}})},93348:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},96110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(18483),s=r(8333),i=r(78253),n=()=>{},o=new s.TimeoutError;class l extends a{constructor(e){var t,r,a,s;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=n,this._resolveIdle=n,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:i.default},e)).intervalCap&&e.intervalCap>=1))throw TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(s=null===(a=e.interval)||void 0===a?void 0:a.toString())&&void 0!==s?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=n,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=n,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(void 0===this._intervalId){let t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,a)=>{let i=async()=>{this._pendingCount++,this._intervalCount++;try{let i=void 0===this._timeout&&void 0===t.timeout?e():s.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&a(o)});r(await i)}catch(e){a(e)}this._next()};this._queue.enqueue(i,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused&&(this._isPaused=!1,this._processQueue()),this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}t.default=l},31673:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let a=0,s=e.length;for(;s>0;){let i=s/2|0,n=a+i;0>=r(e[n],t)?(a=++n,s-=i+1):s=i}return a}},78253:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(31673);class s{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let r={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(r);return}let s=a.default(this._queue,r,(e,t)=>t.priority-e.priority);this._queue.splice(s,0,r)}dequeue(){let e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(e=>e.run)}get size(){return this._queue.length}}t.default=s},31776:(e,t,r)=>{"use strict";let a=r(96310),s=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class i extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}let n=(e,t,r)=>{let a=r.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=a,e},o=e=>s.includes(e),l=(e,t)=>new Promise((r,s)=>{t={onFailedAttempt:()=>{},retries:10,...t};let l=a.operation(t);l.attempt(async a=>{try{r(await e(a))}catch(e){if(!(e instanceof Error)){s(TypeError(`Non-error was thrown: "${e}". You should only throw errors.`));return}if(e instanceof i)l.stop(),s(e.originalError);else if(e instanceof TypeError&&!o(e.message))l.stop(),s(e);else{n(e,a,t);try{await t.onFailedAttempt(e)}catch(e){s(e);return}l.retry(e)||s(l.mainError())}}})});e.exports=l,e.exports.default=l,e.exports.AbortError=i},8333:(e,t,r)=>{"use strict";let a=r(93348);class s extends Error{constructor(e){super(e),this.name="TimeoutError"}}let i=(e,t,r)=>new Promise((i,n)=>{if("number"!=typeof t||t<0)throw TypeError("Expected `milliseconds` to be a positive number");if(t===1/0){i(e);return}let o=setTimeout(()=>{if("function"==typeof r){try{i(r())}catch(e){n(e)}return}let a="string"==typeof r?r:`Promise timed out after ${t} milliseconds`,o=r instanceof Error?r:new s(a);"function"==typeof e.cancel&&e.cancel(),n(o)},t);a(e.then(i,n),()=>{clearTimeout(o)})});e.exports=i,e.exports.default=i,e.exports.TimeoutError=s},96310:(e,t,r)=>{"use strict";e.exports=r(26300)},26300:(e,t,r)=>{var a=r(11830);t.operation=function(e){return new a(t.timeouts(e),{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw Error("minTimeout is greater than maxTimeout");for(var a=[],s=0;s<t.retries;s++)a.push(this.createTimeout(s,t));return e&&e.forever&&!a.length&&a.push(this.createTimeout(s,t)),a.sort(function(e,t){return e-t}),a},t.createTimeout=function(e,t){return Math.min(Math.round((t.randomize?Math.random()+1:1)*Math.max(t.minTimeout,1)*Math.pow(t.factor,e)),t.maxTimeout)},t.wrap=function(e,r,a){if(r instanceof Array&&(a=r,r=null),!a)for(var s in a=[],e)"function"==typeof e[s]&&a.push(s);for(var i=0;i<a.length;i++){var n=a[i],o=e[n];e[n]=(function(a){var s=t.operation(r),i=Array.prototype.slice.call(arguments,1),n=i.pop();i.push(function(e){s.retry(e)||(e&&(arguments[0]=s.mainError()),n.apply(this,arguments))}),s.attempt(function(){a.apply(e,i)})}).bind(e,o),e[n].options=r}}},11830:e=>{"use strict";function t(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1)}var a=this;return this._timer=setTimeout(function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout(function(){a._operationTimeoutCb(a._attempts)},a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)},r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,a=0;a<this._errors.length;a++){var s=this._errors[a],i=s.message,n=(e[i]||0)+1;e[i]=n,n>=r&&(t=s,r=n)}return t}},33499:(e,t,r)=>{"use strict";r.d(t,{Z:()=>E});let a=require("crypto");var s=r.n(a);let i={randomUUID:s().randomUUID},n=new Uint8Array(256),o=n.length,l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));let E=function(e,t,r){if(i.randomUUID&&!t&&!e)return i.randomUUID();e=e||{};let a=e.random||(e.rng||function(){return o>n.length-16&&(s().randomFillSync(n),o=0),n.slice(o,o+=16)})();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}(a)}},18088:(e,t,r)=>{"use strict";var a=Object.create?function(e,t,r,a){void 0===a&&(a=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,s)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};Object.defineProperty(t,"__esModule",{value:!0}),t.z=void 0;let i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return s(t,e),t}(r(75157));t.z=i,function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)}(r(75157),t),t.default=i},3811:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZodError=t.quotelessJson=t.ZodIssueCode=void 0;let a=r(38470);t.ZodIssueCode=a.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),t.quotelessJson=e=>{let t=JSON.stringify(e,null,2);return t.replace(/"([^"]+)":/g,"$1:")};class s extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},a=e=>{for(let s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(a);else if("invalid_return_type"===s.code)a(s.returnTypeError);else if("invalid_arguments"===s.code)a(s.argumentsError);else if(0===s.path.length)r._errors.push(t(s));else{let e=r,a=0;for(;a<s.path.length;){let r=s.path[a],i=a===s.path.length-1;i?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(s))):e[r]=e[r]||{_errors:[]},e=e[r],a++}}};return a(this),r}static assert(e){if(!(e instanceof s))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,a.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let a of this.issues)if(a.path.length>0){let r=a.path[0];t[r]=t[r]||[],t[r].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}t.ZodError=s,s.create=e=>{let t=new s(e);return t}},81473:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultErrorMap=void 0,t.setErrorMap=function(e){s=e},t.getErrorMap=function(){return s};let a=function(e){return e&&e.__esModule?e:{default:e}}(r(98728));t.defaultErrorMap=a.default;let s=a.default},75157:(e,t,r)=>{"use strict";var a=Object.create?function(e,t,r,a){void 0===a&&(a=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,s)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(81473),t),s(r(87876),t),s(r(50584),t),s(r(38470),t),s(r(46060),t),s(r(3811),t)},69626:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(r||(t.errorUtil=r={}))},87876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=t.isValid=t.isDirty=t.isAborted=t.OK=t.DIRTY=t.INVALID=t.ParseStatus=t.EMPTY_PATH=t.makeIssue=void 0,t.addIssueToContext=function(e,r){let i=(0,a.getErrorMap)(),n=(0,t.makeIssue)({issueData:r,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,i,i===s.default?void 0:s.default].filter(e=>!!e)});e.common.issues.push(n)};let a=r(81473),s=function(e){return e&&e.__esModule?e:{default:e}}(r(98728));t.makeIssue=e=>{let{data:t,path:r,errorMaps:a,issueData:s}=e,i=[...r,...s.path||[]],n={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let o="",l=a.filter(e=>!!e).slice().reverse();for(let e of l)o=e(n,{data:t,defaultError:o}).message;return{...s,path:i,message:o}},t.EMPTY_PATH=[];class i{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,r){let a=[];for(let s of r){if("aborted"===s.status)return t.INVALID;"dirty"===s.status&&e.dirty(),a.push(s.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,a=await e.value;r.push({key:t,value:a})}return i.mergeObjectSync(e,r)}static mergeObjectSync(e,r){let a={};for(let s of r){let{key:r,value:i}=s;if("aborted"===r.status||"aborted"===i.status)return t.INVALID;"dirty"===r.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"!==r.value&&(void 0!==i.value||s.alwaysSet)&&(a[r.value]=i.value)}return{status:e.value,value:a}}}t.ParseStatus=i,t.INVALID=Object.freeze({status:"aborted"}),t.DIRTY=e=>({status:"dirty",value:e}),t.OK=e=>({status:"valid",value:e}),t.isAborted=e=>"aborted"===e.status,t.isDirty=e=>"dirty"===e.status,t.isValid=e=>"valid"===e.status,t.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},50584:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},38470:(e,t)=>{"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),a={};for(let e of r)a[e]=t[e];return e.objectValues(a)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(r||(t.util=r={})),(a||(t.objectUtil=a={})).mergeShapes=(e,t)=>({...e,...t}),t.ZodParsedType=r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),t.getParsedType=e=>{let r=typeof e;switch(r){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return Number.isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":if(Array.isArray(e))return t.ZodParsedType.array;if(null===e)return t.ZodParsedType.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return t.ZodParsedType.promise;if("undefined"!=typeof Map&&e instanceof Map)return t.ZodParsedType.map;if("undefined"!=typeof Set&&e instanceof Set)return t.ZodParsedType.set;if("undefined"!=typeof Date&&e instanceof Date)return t.ZodParsedType.date;return t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}},98728:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(3811),s=r(38470);t.default=(e,t)=>{let r;switch(e.code){case a.ZodIssueCode.invalid_type:r=e.received===s.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case a.ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,s.util.jsonStringifyReplacer)}`;break;case a.ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${s.util.joinValues(e.keys,", ")}`;break;case a.ZodIssueCode.invalid_union:r="Invalid input";break;case a.ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${s.util.joinValues(e.options)}`;break;case a.ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${s.util.joinValues(e.options)}, received '${e.received}'`;break;case a.ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case a.ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case a.ZodIssueCode.invalid_date:r="Invalid date";break;case a.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:s.util.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case a.ZodIssueCode.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case a.ZodIssueCode.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case a.ZodIssueCode.custom:r="Invalid input";break;case a.ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case a.ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case a.ZodIssueCode.not_finite:r="Number must be finite";break;default:r=t.defaultError,s.util.assertNever(e)}return{message:r}}},46060:(e,t,r)=>{"use strict";var a;let s;Object.defineProperty(t,"__esModule",{value:!0}),t.discriminatedUnion=t.date=t.boolean=t.bigint=t.array=t.any=t.coerce=t.ZodFirstPartyTypeKind=t.late=t.ZodSchema=t.Schema=t.ZodReadonly=t.ZodPipeline=t.ZodBranded=t.BRAND=t.ZodNaN=t.ZodCatch=t.ZodDefault=t.ZodNullable=t.ZodOptional=t.ZodTransformer=t.ZodEffects=t.ZodPromise=t.ZodNativeEnum=t.ZodEnum=t.ZodLiteral=t.ZodLazy=t.ZodFunction=t.ZodSet=t.ZodMap=t.ZodRecord=t.ZodTuple=t.ZodIntersection=t.ZodDiscriminatedUnion=t.ZodUnion=t.ZodObject=t.ZodArray=t.ZodVoid=t.ZodNever=t.ZodUnknown=t.ZodAny=t.ZodNull=t.ZodUndefined=t.ZodSymbol=t.ZodDate=t.ZodBoolean=t.ZodBigInt=t.ZodNumber=t.ZodString=t.ZodType=void 0,t.NEVER=t.void=t.unknown=t.union=t.undefined=t.tuple=t.transformer=t.symbol=t.string=t.strictObject=t.set=t.record=t.promise=t.preprocess=t.pipeline=t.ostring=t.optional=t.onumber=t.oboolean=t.object=t.number=t.nullable=t.null=t.never=t.nativeEnum=t.nan=t.map=t.literal=t.lazy=t.intersection=t.instanceof=t.function=t.enum=t.effect=void 0,t.datetimeRegex=D,t.custom=eR;let i=r(3811),n=r(81473),o=r(69626),l=r(87876),E=r(38470);class u{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let c=(e,t)=>{if((0,l.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new i.ZodError(e.common.issues);return this._error=t,this._error}}};function T(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:a,description:s}=e;if(t&&(r||a))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:s}:{errorMap:(t,s)=>{let{message:i}=e;return"invalid_enum_value"===t.code?{message:i??s.defaultError}:void 0===s.data?{message:i??a??s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:i??r??s.defaultError}},description:s}}class d{get description(){return this._def.description}_getType(e){return(0,E.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,E.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new l.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,E.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if((0,l.isAsync)(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,E.getParsedType)(e)},a=this._parseSync({data:e,path:r.path,parent:r});return c(r,a)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,E.getParsedType)(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return(0,l.isValid)(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>(0,l.isValid)(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,E.getParsedType)(e)},a=this._parse({data:e,path:r.path,parent:r}),s=await ((0,l.isAsync)(a)?a:Promise.resolve(a));return c(r,s)}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,a)=>{let s=e(t),n=()=>a.addIssue({code:i.ZodIssueCode.custom,...r(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(e=>!!e||(n(),!1)):!!s||(n(),!1)})}refinement(e,t){return this._refinement((r,a)=>!!e(r)||(a.addIssue("function"==typeof t?t(r,a):t),!1))}_refinement(e){return new eo({schema:this,typeName:a.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return el.create(this,this._def)}nullable(){return eE.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return $.create(this)}promise(){return en.create(this,this._def)}or(e){return j.create([this,e],this._def)}and(e){return Z.create(this,e,this._def)}transform(e){return new eo({...T(this._def),schema:this,typeName:a.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new eu({...T(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:a.ZodDefault})}brand(){return new ed({typeName:a.ZodBranded,type:this,...T(this._def)})}catch(e){return new ec({...T(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:a.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return eh.create(this,e)}readonly(){return eA.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}t.ZodType=d,t.Schema=d,t.ZodSchema=d;let h=/^c[^\s-]{8,}$/i,A=/^[0-9a-z]+$/,p=/^[0-9A-HJKMNP-TV-Z]{26}$/i,R=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,S=/^[a-z0-9_-]{21}$/i,_=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,O=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,I=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,f=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,N=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,m=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,C=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,L=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,y=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,g="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",P=RegExp(`^${g}$`);function b(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function D(e){let t=`${g}T${b(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class v extends d{_parse(e){var t,r,a,n;let o;this._def.coerce&&(e.data=String(e.data));let u=this._getType(e);if(u!==E.ZodParsedType.string){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.string,received:t.parsedType}),l.INVALID}let c=new l.ParseStatus;for(let u of this._def.checks)if("min"===u.kind)e.data.length<u.value&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),c.dirty());else if("max"===u.kind)e.data.length>u.value&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),c.dirty());else if("length"===u.kind){let t=e.data.length>u.value,r=e.data.length<u.value;(t||r)&&(o=this._getOrReturnCtx(e,o),t?(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):r&&(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),c.dirty())}else if("email"===u.kind)I.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"email",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty());else if("emoji"===u.kind)s||(s=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),s.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"emoji",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty());else if("uuid"===u.kind)R.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"uuid",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty());else if("nanoid"===u.kind)S.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"nanoid",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty());else if("cuid"===u.kind)h.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"cuid",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty());else if("cuid2"===u.kind)A.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"cuid2",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty());else if("ulid"===u.kind)p.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"ulid",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty());else if("url"===u.kind)try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"url",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty()}else if("regex"===u.kind){u.regex.lastIndex=0;let t=u.regex.test(e.data);t||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"regex",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty())}else if("trim"===u.kind)e.data=e.data.trim();else if("includes"===u.kind)e.data.includes(u.value,u.position)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),c.dirty());else if("toLowerCase"===u.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===u.kind)e.data=e.data.toUpperCase();else if("startsWith"===u.kind)e.data.startsWith(u.value)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.invalid_string,validation:{startsWith:u.value},message:u.message}),c.dirty());else if("endsWith"===u.kind)e.data.endsWith(u.value)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.invalid_string,validation:{endsWith:u.value},message:u.message}),c.dirty());else if("datetime"===u.kind){let t=D(u);t.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.invalid_string,validation:"datetime",message:u.message}),c.dirty())}else if("date"===u.kind)P.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.invalid_string,validation:"date",message:u.message}),c.dirty());else if("time"===u.kind){let t=RegExp(`^${b(u)}$`);t.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:i.ZodIssueCode.invalid_string,validation:"time",message:u.message}),c.dirty())}else"duration"===u.kind?O.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"duration",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty()):"ip"===u.kind?(t=e.data,("v4"===(r=u.version)||!r)&&f.test(t)||("v6"===r||!r)&&m.test(t)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"ip",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty())):"jwt"===u.kind?!function(e,t){if(!_.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(a));if("object"!=typeof s||null===s||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)return!1;return!0}catch{return!1}}(e.data,u.alg)&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"jwt",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty()):"cidr"===u.kind?(a=e.data,("v4"===(n=u.version)||!n)&&N.test(a)||("v6"===n||!n)&&C.test(a)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"cidr",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty())):"base64"===u.kind?L.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"base64",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty()):"base64url"===u.kind?y.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"base64url",code:i.ZodIssueCode.invalid_string,message:u.message}),c.dirty()):E.util.assertNever(u);return{status:c.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:i.ZodIssueCode.invalid_string,...o.errorUtil.errToObj(r)})}_addCheck(e){return new v({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...o.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...o.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...o.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...o.errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...o.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...o.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...o.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...o.errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...o.errorUtil.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...o.errorUtil.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...o.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...o.errorUtil.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...o.errorUtil.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...o.errorUtil.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...o.errorUtil.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...o.errorUtil.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...o.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...o.errorUtil.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...o.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...o.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...o.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...o.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...o.errorUtil.errToObj(t)})}nonempty(e){return this.min(1,o.errorUtil.errToObj(e))}trim(){return new v({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new v({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new v({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodString=v,v.create=e=>new v({checks:[],typeName:a.ZodString,coerce:e?.coerce??!1,...T(e)});class M extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;this._def.coerce&&(e.data=Number(e.data));let r=this._getType(e);if(r!==E.ZodParsedType.number){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.number,received:t.parsedType}),l.INVALID}let a=new l.ParseStatus;for(let r of this._def.checks)if("int"===r.kind)E.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:r.message}),a.dirty());else if("min"===r.kind){let s=r.inclusive?e.data<r.value:e.data<=r.value;s&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),a.dirty())}else if("max"===r.kind){let s=r.inclusive?e.data>r.value:e.data>=r.value;s&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),a.dirty())}else"multipleOf"===r.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,s=r>a?r:a,i=Number.parseInt(e.toFixed(s).replace(".","")),n=Number.parseInt(t.toFixed(s).replace(".",""));return i%n/10**s}(e.data,r.value)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.not_multiple_of,multipleOf:r.value,message:r.message}),a.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.not_finite,message:r.message}),a.dirty()):E.util.assertNever(r);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,o.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.errorUtil.toString(t))}setLimit(e,t,r,a){return new M({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:o.errorUtil.toString(a)}]})}_addCheck(e){return new M({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:o.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:o.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:o.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:o.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:o.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:o.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:o.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:o.errorUtil.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&E.util.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}t.ZodNumber=M,M.create=e=>new M({checks:[],typeName:a.ZodNumber,coerce:e?.coerce||!1,...T(e)});class U extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}let r=this._getType(e);if(r!==E.ZodParsedType.bigint)return this._getInvalidInput(e);let a=new l.ParseStatus;for(let r of this._def.checks)if("min"===r.kind){let s=r.inclusive?e.data<r.value:e.data<=r.value;s&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),a.dirty())}else if("max"===r.kind){let s=r.inclusive?e.data>r.value:e.data>=r.value;s&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),a.dirty())}else"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.not_multiple_of,multipleOf:r.value,message:r.message}),a.dirty()):E.util.assertNever(r);return{status:a.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.bigint,received:t.parsedType}),l.INVALID}gte(e,t){return this.setLimit("min",e,!0,o.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.errorUtil.toString(t))}setLimit(e,t,r,a){return new U({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:o.errorUtil.toString(a)}]})}_addCheck(e){return new U({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:o.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:o.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:o.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:o.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.errorUtil.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodBigInt=U,U.create=e=>new U({checks:[],typeName:a.ZodBigInt,coerce:e?.coerce??!1,...T(e)});class w extends d{_parse(e){this._def.coerce&&(e.data=!!e.data);let t=this._getType(e);if(t!==E.ZodParsedType.boolean){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.boolean,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}t.ZodBoolean=w,w.create=e=>new w({typeName:a.ZodBoolean,coerce:e?.coerce||!1,...T(e)});class G extends d{_parse(e){let t;this._def.coerce&&(e.data=new Date(e.data));let r=this._getType(e);if(r!==E.ZodParsedType.date){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.date,received:t.parsedType}),l.INVALID}if(Number.isNaN(e.data.getTime())){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_date}),l.INVALID}let a=new l.ParseStatus;for(let r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),a.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),a.dirty()):E.util.assertNever(r);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new G({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:o.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:o.errorUtil.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}t.ZodDate=G,G.create=e=>new G({checks:[],coerce:e?.coerce||!1,typeName:a.ZodDate,...T(e)});class B extends d{_parse(e){let t=this._getType(e);if(t!==E.ZodParsedType.symbol){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.symbol,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}t.ZodSymbol=B,B.create=e=>new B({typeName:a.ZodSymbol,...T(e)});class F extends d{_parse(e){let t=this._getType(e);if(t!==E.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.undefined,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}t.ZodUndefined=F,F.create=e=>new F({typeName:a.ZodUndefined,...T(e)});class H extends d{_parse(e){let t=this._getType(e);if(t!==E.ZodParsedType.null){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.null,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}t.ZodNull=H,H.create=e=>new H({typeName:a.ZodNull,...T(e)});class x extends d{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,l.OK)(e.data)}}t.ZodAny=x,x.create=e=>new x({typeName:a.ZodAny,...T(e)});class k extends d{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,l.OK)(e.data)}}t.ZodUnknown=k,k.create=e=>new k({typeName:a.ZodUnknown,...T(e)});class Y extends d{_parse(e){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.never,received:t.parsedType}),l.INVALID}}t.ZodNever=Y,Y.create=e=>new Y({typeName:a.ZodNever,...T(e)});class V extends d{_parse(e){let t=this._getType(e);if(t!==E.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.void,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}t.ZodVoid=V,V.create=e=>new V({typeName:a.ZodVoid,...T(e)});class $ extends d{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==E.ZodParsedType.array)return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.array,received:t.parsedType}),l.INVALID;if(null!==a.exactLength){let e=t.data.length>a.exactLength.value,s=t.data.length<a.exactLength.value;(e||s)&&((0,l.addIssueToContext)(t,{code:e?i.ZodIssueCode.too_big:i.ZodIssueCode.too_small,minimum:s?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&((0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&((0,l.addIssueToContext)(t,{code:i.ZodIssueCode.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>a.type._parseAsync(new u(t,e,t.path,r)))).then(e=>l.ParseStatus.mergeArray(r,e));let s=[...t.data].map((e,r)=>a.type._parseSync(new u(t,e,t.path,r)));return l.ParseStatus.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new $({...this._def,minLength:{value:e,message:o.errorUtil.toString(t)}})}max(e,t){return new $({...this._def,maxLength:{value:e,message:o.errorUtil.toString(t)}})}length(e,t){return new $({...this._def,exactLength:{value:e,message:o.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}t.ZodArray=$,$.create=(e,t)=>new $({type:e,minLength:null,maxLength:null,exactLength:null,typeName:a.ZodArray,...T(t)});class W extends d{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=E.util.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){let t=this._getType(e);if(t!==E.ZodParsedType.object){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.object,received:t.parsedType}),l.INVALID}let{status:r,ctx:a}=this._processInputParams(e),{shape:s,keys:n}=this._getCached(),o=[];if(!(this._def.catchall instanceof Y&&"strip"===this._def.unknownKeys))for(let e in a.data)n.includes(e)||o.push(e);let c=[];for(let e of n){let t=s[e],r=a.data[e];c.push({key:{status:"valid",value:e},value:t._parse(new u(a,r,a.path,e)),alwaysSet:e in a.data})}if(this._def.catchall instanceof Y){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of o)c.push({key:{status:"valid",value:e},value:{status:"valid",value:a.data[e]}});else if("strict"===e)o.length>0&&((0,l.addIssueToContext)(a,{code:i.ZodIssueCode.unrecognized_keys,keys:o}),r.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of o){let r=a.data[t];c.push({key:{status:"valid",value:t},value:e._parse(new u(a,r,a.path,t)),alwaysSet:t in a.data})}}return a.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of c){let r=await t.key,a=await t.value;e.push({key:r,value:a,alwaysSet:t.alwaysSet})}return e}).then(e=>l.ParseStatus.mergeObjectSync(r,e)):l.ParseStatus.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return o.errorUtil.errToObj,new W({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let a=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:o.errorUtil.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new W({...this._def,unknownKeys:"strip"})}passthrough(){return new W({...this._def,unknownKeys:"passthrough"})}extend(e){return new W({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){let t=new W({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:a.ZodObject});return t}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new W({...this._def,catchall:e})}pick(e){let t={};for(let r of E.util.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new W({...this._def,shape:()=>t})}omit(e){let t={};for(let r of E.util.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new W({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof W){let r={};for(let a in t.shape){let s=t.shape[a];r[a]=el.create(e(s))}return new W({...t._def,shape:()=>r})}return t instanceof $?new $({...t._def,type:e(t.element)}):t instanceof el?el.create(e(t.unwrap())):t instanceof eE?eE.create(e(t.unwrap())):t instanceof q?q.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};for(let r of E.util.objectKeys(this.shape)){let a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new W({...this._def,shape:()=>t})}required(e){let t={};for(let r of E.util.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r],a=e;for(;a instanceof el;)a=a._def.innerType;t[r]=a}return new W({...this._def,shape:()=>t})}keyof(){return ea(E.util.objectKeys(this.shape))}}t.ZodObject=W,W.create=(e,t)=>new W({shape:()=>e,unknownKeys:"strip",catchall:Y.create(),typeName:a.ZodObject,...T(t)}),W.strictCreate=(e,t)=>new W({shape:()=>e,unknownKeys:"strict",catchall:Y.create(),typeName:a.ZodObject,...T(t)}),W.lazycreate=(e,t)=>new W({shape:e,unknownKeys:"strip",catchall:Y.create(),typeName:a.ZodObject,...T(t)});class j extends d{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new i.ZodError(e.ctx.common.issues));return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_union,unionErrors:r}),l.INVALID});{let e;let a=[];for(let s of r){let r={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&a.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let s=a.map(e=>new i.ZodError(e));return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_union,unionErrors:s}),l.INVALID}}get options(){return this._def.options}}t.ZodUnion=j,j.create=(e,t)=>new j({options:e,typeName:a.ZodUnion,...T(t)});let X=e=>{if(e instanceof et)return X(e.schema);if(e instanceof eo)return X(e.innerType());if(e instanceof er)return[e.value];if(e instanceof es)return e.options;if(e instanceof ei)return E.util.objectValues(e.enum);if(e instanceof eu)return X(e._def.innerType);if(e instanceof F)return[void 0];else if(e instanceof H)return[null];else if(e instanceof el)return[void 0,...X(e.unwrap())];else if(e instanceof eE)return[null,...X(e.unwrap())];else if(e instanceof ed)return X(e.unwrap());else if(e instanceof eA)return X(e.unwrap());else if(e instanceof ec)return X(e._def.innerType);else return[]};class K extends d{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==E.ZodParsedType.object)return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.object,received:t.parsedType}),l.INVALID;let r=this.discriminator,a=t.data[r],s=this.optionsMap.get(a);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):((0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),l.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let s=new Map;for(let r of t){let t=X(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of t){if(s.has(a))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,r)}}return new K({typeName:a.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...T(r)})}}t.ZodDiscriminatedUnion=K;class Z extends d{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=(e,a)=>{if((0,l.isAborted)(e)||(0,l.isAborted)(a))return l.INVALID;let s=function e(t,r){let a=(0,E.getParsedType)(t),s=(0,E.getParsedType)(r);if(t===r)return{valid:!0,data:t};if(a===E.ZodParsedType.object&&s===E.ZodParsedType.object){let a=E.util.objectKeys(r),s=E.util.objectKeys(t).filter(e=>-1!==a.indexOf(e)),i={...t,...r};for(let a of s){let s=e(t[a],r[a]);if(!s.valid)return{valid:!1};i[a]=s.data}return{valid:!0,data:i}}if(a===E.ZodParsedType.array&&s===E.ZodParsedType.array){if(t.length!==r.length)return{valid:!1};let a=[];for(let s=0;s<t.length;s++){let i=t[s],n=r[s],o=e(i,n);if(!o.valid)return{valid:!1};a.push(o.data)}return{valid:!0,data:a}}return a===E.ZodParsedType.date&&s===E.ZodParsedType.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}(e.value,a.value);return s.valid?(((0,l.isDirty)(e)||(0,l.isDirty)(a))&&t.dirty(),{status:t.value,value:s.data}):((0,l.addIssueToContext)(r,{code:i.ZodIssueCode.invalid_intersection_types}),l.INVALID)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>a(e,t)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}t.ZodIntersection=Z,Z.create=(e,t,r)=>new Z({left:e,right:t,typeName:a.ZodIntersection,...T(r)});class q extends d{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.ZodParsedType.array)return(0,l.addIssueToContext)(r,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.array,received:r.parsedType}),l.INVALID;if(r.data.length<this._def.items.length)return(0,l.addIssueToContext)(r,{code:i.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),l.INVALID;let a=this._def.rest;!a&&r.data.length>this._def.items.length&&((0,l.addIssueToContext)(r,{code:i.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let s=[...r.data].map((e,t)=>{let a=this._def.items[t]||this._def.rest;return a?a._parse(new u(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(s).then(e=>l.ParseStatus.mergeArray(t,e)):l.ParseStatus.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new q({...this._def,rest:e})}}t.ZodTuple=q,q.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new q({items:e,typeName:a.ZodTuple,rest:null,...T(t)})};class J extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.ZodParsedType.object)return(0,l.addIssueToContext)(r,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.object,received:r.parsedType}),l.INVALID;let a=[],s=this._def.keyType,n=this._def.valueType;for(let e in r.data)a.push({key:s._parse(new u(r,e,r.path,e)),value:n._parse(new u(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?l.ParseStatus.mergeObjectAsync(t,a):l.ParseStatus.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return new J(t instanceof d?{keyType:e,valueType:t,typeName:a.ZodRecord,...T(r)}:{keyType:v.create(),valueType:e,typeName:a.ZodRecord,...T(t)})}}t.ZodRecord=J;class z extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.ZodParsedType.map)return(0,l.addIssueToContext)(r,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.map,received:r.parsedType}),l.INVALID;let a=this._def.keyType,s=this._def.valueType,n=[...r.data.entries()].map(([e,t],i)=>({key:a._parse(new u(r,e,r.path,[i,"key"])),value:s._parse(new u(r,t,r.path,[i,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of n){let a=await r.key,s=await r.value;if("aborted"===a.status||"aborted"===s.status)return l.INVALID;("dirty"===a.status||"dirty"===s.status)&&t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of n){let a=r.key,s=r.value;if("aborted"===a.status||"aborted"===s.status)return l.INVALID;("dirty"===a.status||"dirty"===s.status)&&t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}}}}t.ZodMap=z,z.create=(e,t,r)=>new z({valueType:t,keyType:e,typeName:a.ZodMap,...T(r)});class Q extends d{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==E.ZodParsedType.set)return(0,l.addIssueToContext)(r,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.set,received:r.parsedType}),l.INVALID;let a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&((0,l.addIssueToContext)(r,{code:i.ZodIssueCode.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&((0,l.addIssueToContext)(r,{code:i.ZodIssueCode.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());let s=this._def.valueType;function n(e){let r=new Set;for(let a of e){if("aborted"===a.status)return l.INVALID;"dirty"===a.status&&t.dirty(),r.add(a.value)}return{status:t.value,value:r}}let o=[...r.data.values()].map((e,t)=>s._parse(new u(r,e,r.path,t)));return r.common.async?Promise.all(o).then(e=>n(e)):n(o)}min(e,t){return new Q({...this._def,minSize:{value:e,message:o.errorUtil.toString(t)}})}max(e,t){return new Q({...this._def,maxSize:{value:e,message:o.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t.ZodSet=Q,Q.create=(e,t)=>new Q({valueType:e,minSize:null,maxSize:null,typeName:a.ZodSet,...T(t)});class ee extends d{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==E.ZodParsedType.function)return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.function,received:t.parsedType}),l.INVALID;function r(e,r){return(0,l.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(e=>!!e),issueData:{code:i.ZodIssueCode.invalid_arguments,argumentsError:r}})}function a(e,r){return(0,l.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(e=>!!e),issueData:{code:i.ZodIssueCode.invalid_return_type,returnTypeError:r}})}let s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof en){let e=this;return(0,l.OK)(async function(...t){let n=new i.ZodError([]),l=await e._def.args.parseAsync(t,s).catch(e=>{throw n.addIssue(r(t,e)),n}),E=await Reflect.apply(o,this,l),u=await e._def.returns._def.type.parseAsync(E,s).catch(e=>{throw n.addIssue(a(E,e)),n});return u})}{let e=this;return(0,l.OK)(function(...t){let n=e._def.args.safeParse(t,s);if(!n.success)throw new i.ZodError([r(t,n.error)]);let l=Reflect.apply(o,this,n.data),E=e._def.returns.safeParse(l,s);if(!E.success)throw new i.ZodError([a(l,E.error)]);return E.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ee({...this._def,args:q.create(e).rest(k.create())})}returns(e){return new ee({...this._def,returns:e})}implement(e){let t=this.parse(e);return t}strictImplement(e){let t=this.parse(e);return t}static create(e,t,r){return new ee({args:e||q.create([]).rest(k.create()),returns:t||k.create(),typeName:a.ZodFunction,...T(r)})}}t.ZodFunction=ee;class et extends d{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.getter();return r._parse({data:t.data,path:t.path,parent:t})}}t.ZodLazy=et,et.create=(e,t)=>new et({getter:e,typeName:a.ZodLazy,...T(t)});class er extends d{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{received:t.data,code:i.ZodIssueCode.invalid_literal,expected:this._def.value}),l.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function ea(e,t){return new es({values:e,typeName:a.ZodEnum,...T(t)})}t.ZodLiteral=er,er.create=(e,t)=>new er({value:e,typeName:a.ZodLiteral,...T(t)});class es extends d{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,l.addIssueToContext)(t,{expected:E.util.joinValues(r),received:t.parsedType,code:i.ZodIssueCode.invalid_type}),l.INVALID}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,l.addIssueToContext)(t,{received:t.data,code:i.ZodIssueCode.invalid_enum_value,options:r}),l.INVALID}return(0,l.OK)(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return es.create(e,{...this._def,...t})}exclude(e,t=this._def){return es.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}t.ZodEnum=es,es.create=ea;class ei extends d{_parse(e){let t=E.util.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==E.ZodParsedType.string&&r.parsedType!==E.ZodParsedType.number){let e=E.util.objectValues(t);return(0,l.addIssueToContext)(r,{expected:E.util.joinValues(e),received:r.parsedType,code:i.ZodIssueCode.invalid_type}),l.INVALID}if(this._cache||(this._cache=new Set(E.util.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=E.util.objectValues(t);return(0,l.addIssueToContext)(r,{received:r.data,code:i.ZodIssueCode.invalid_enum_value,options:e}),l.INVALID}return(0,l.OK)(e.data)}get enum(){return this._def.values}}t.ZodNativeEnum=ei,ei.create=(e,t)=>new ei({values:e,typeName:a.ZodNativeEnum,...T(t)});class en extends d{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==E.ZodParsedType.promise&&!1===t.common.async)return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.promise,received:t.parsedType}),l.INVALID;let r=t.parsedType===E.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,l.OK)(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}t.ZodPromise=en,en.create=(e,t)=>new en({type:e,typeName:a.ZodPromise,...T(t)});class eo extends d{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===a.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null,s={addIssue:e=>{(0,l.addIssueToContext)(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===a.type){let e=a.transform(r.data,s);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return l.INVALID;let a=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===a.status?l.INVALID:"dirty"===a.status||"dirty"===t.value?(0,l.DIRTY)(a.value):a});{if("aborted"===t.value)return l.INVALID;let a=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===a.status?l.INVALID:"dirty"===a.status||"dirty"===t.value?(0,l.DIRTY)(a.value):a}}if("refinement"===a.type){let e=e=>{let t=a.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?l.INVALID:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?l.INVALID:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}}if("transform"===a.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>(0,l.isValid)(e)?Promise.resolve(a.transform(e.value,s)).then(e=>({status:t.value,value:e})):l.INVALID);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!(0,l.isValid)(e))return l.INVALID;let i=a.transform(e.value,s);if(i instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}}E.util.assertNever(a)}}t.ZodEffects=eo,t.ZodTransformer=eo,eo.create=(e,t,r)=>new eo({schema:e,typeName:a.ZodEffects,effect:t,...T(r)}),eo.createWithPreprocess=(e,t,r)=>new eo({schema:t,effect:{type:"preprocess",transform:e},typeName:a.ZodEffects,...T(r)});class el extends d{_parse(e){let t=this._getType(e);return t===E.ZodParsedType.undefined?(0,l.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodOptional=el,el.create=(e,t)=>new el({innerType:e,typeName:a.ZodOptional,...T(t)});class eE extends d{_parse(e){let t=this._getType(e);return t===E.ZodParsedType.null?(0,l.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodNullable=eE,eE.create=(e,t)=>new eE({innerType:e,typeName:a.ZodNullable,...T(t)});class eu extends d{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===E.ZodParsedType.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t.ZodDefault=eu,eu.create=(e,t)=>new eu({innerType:e,typeName:a.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...T(t)});class ec extends d{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return(0,l.isAsync)(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new i.ZodError(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new i.ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}t.ZodCatch=ec,ec.create=(e,t)=>new ec({innerType:e,typeName:a.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...T(t)});class eT extends d{_parse(e){let t=this._getType(e);if(t!==E.ZodParsedType.nan){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:i.ZodIssueCode.invalid_type,expected:E.ZodParsedType.nan,received:t.parsedType}),l.INVALID}return{status:"valid",value:e.data}}}t.ZodNaN=eT,eT.create=e=>new eT({typeName:a.ZodNaN,...T(e)}),t.BRAND=Symbol("zod_brand");class ed extends d{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}t.ZodBranded=ed;class eh extends d{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){let e=async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?l.INVALID:"dirty"===e.status?(t.dirty(),(0,l.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})};return e()}{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?l.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new eh({in:e,out:t,typeName:a.ZodPipeline})}}t.ZodPipeline=eh;class eA extends d{_parse(e){let t=this._def.innerType._parse(e),r=e=>((0,l.isValid)(e)&&(e.value=Object.freeze(e.value)),e);return(0,l.isAsync)(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function ep(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function eR(e,t={},r){return e?x.create().superRefine((a,s)=>{let i=e(a);if(i instanceof Promise)return i.then(e=>{if(!e){let e=ep(t,a),i=e.fatal??r??!0;s.addIssue({code:"custom",...e,fatal:i})}});if(!i){let e=ep(t,a),i=e.fatal??r??!0;s.addIssue({code:"custom",...e,fatal:i})}}):x.create()}t.ZodReadonly=eA,eA.create=(e,t)=>new eA({innerType:e,typeName:a.ZodReadonly,...T(t)}),t.late={object:W.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(a||(t.ZodFirstPartyTypeKind=a={})),t.instanceof=(e,t={message:`Input not instance of ${e.name}`})=>eR(t=>t instanceof e,t);let eS=v.create;t.string=eS;let e_=M.create;t.number=e_;let eO=eT.create;t.nan=eO;let eI=U.create;t.bigint=eI;let ef=w.create;t.boolean=ef;let eN=G.create;t.date=eN;let em=B.create;t.symbol=em;let eC=F.create;t.undefined=eC;let eL=H.create;t.null=eL;let ey=x.create;t.any=ey;let eg=k.create;t.unknown=eg;let eP=Y.create;t.never=eP;let eb=V.create;t.void=eb;let eD=$.create;t.array=eD;let ev=W.create;t.object=ev;let eM=W.strictCreate;t.strictObject=eM;let eU=j.create;t.union=eU;let ew=K.create;t.discriminatedUnion=ew;let eG=Z.create;t.intersection=eG;let eB=q.create;t.tuple=eB;let eF=J.create;t.record=eF;let eH=z.create;t.map=eH;let ex=Q.create;t.set=ex;let ek=ee.create;t.function=ek;let eY=et.create;t.lazy=eY;let eV=er.create;t.literal=eV;let e$=es.create;t.enum=e$;let eW=ei.create;t.nativeEnum=eW;let ej=en.create;t.promise=ej;let eX=eo.create;t.effect=eX,t.transformer=eX;let eK=el.create;t.optional=eK;let eZ=eE.create;t.nullable=eZ;let eq=eo.createWithPreprocess;t.preprocess=eq;let eJ=eh.create;t.pipeline=eJ,t.ostring=()=>eS().optional(),t.onumber=()=>e_().optional(),t.oboolean=()=>ef().optional(),t.coerce={string:e=>v.create({...e,coerce:!0}),number:e=>M.create({...e,coerce:!0}),boolean:e=>w.create({...e,coerce:!0}),bigint:e=>U.create({...e,coerce:!0}),date:e=>G.create({...e,coerce:!0})},t.NEVER=l.INVALID},1308:(e,t,r)=>{"use strict";r(57830),r(2576)},62281:(e,t,r)=>{"use strict";r.d(t,{h4:()=>d});/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var a={},s="0123456789abcdef".split(""),i=[-2147483648,8388608,32768,128],n=[24,16,8,0],o=[];function l(e){e?(o[0]=o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0,this.blocks=o):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}l.prototype.update=function(e){if(!this.finalized){var t="string"!=typeof e;t&&e.constructor===a.ArrayBuffer&&(e=new Uint8Array(e));for(var r,s,i=0,o=e.length||0,l=this.blocks;i<o;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),t)for(s=this.start;i<o&&s<64;++i)l[s>>2]|=e[i]<<n[3&s++];else for(s=this.start;i<o&&s<64;++i)(r=e.charCodeAt(i))<128?l[s>>2]|=r<<n[3&s++]:(r<2048?l[s>>2]|=(192|r>>6)<<n[3&s++]:(r<55296||r>=57344?l[s>>2]|=(224|r>>12)<<n[3&s++]:(r=65536+((1023&r)<<10|1023&e.charCodeAt(++i)),l[s>>2]|=(240|r>>18)<<n[3&s++],l[s>>2]|=(128|r>>12&63)<<n[3&s++]),l[s>>2]|=(128|r>>6&63)<<n[3&s++]),l[s>>2]|=(128|63&r)<<n[3&s++]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=l[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},l.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=i[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},l.prototype.hash=function(){var e,t,r,a=this.h0,s=this.h1,i=this.h2,n=this.h3,o=this.h4,l=this.blocks;for(t=16;t<80;++t)r=l[t-3]^l[t-8]^l[t-14]^l[t-16],l[t]=r<<1|r>>>31;for(t=0;t<20;t+=5)e=s&i|~s&n,o=(r=a<<5|a>>>27)+e+o+1518500249+l[t]<<0,e=a&(s=s<<30|s>>>2)|~a&i,n=(r=o<<5|o>>>27)+e+n+1518500249+l[t+1]<<0,e=o&(a=a<<30|a>>>2)|~o&s,i=(r=n<<5|n>>>27)+e+i+1518500249+l[t+2]<<0,e=n&(o=o<<30|o>>>2)|~n&a,s=(r=i<<5|i>>>27)+e+s+1518500249+l[t+3]<<0,e=i&(n=n<<30|n>>>2)|~i&o,a=(r=s<<5|s>>>27)+e+a+1518500249+l[t+4]<<0,i=i<<30|i>>>2;for(;t<40;t+=5)e=s^i^n,o=(r=a<<5|a>>>27)+e+o+1859775393+l[t]<<0,e=a^(s=s<<30|s>>>2)^i,n=(r=o<<5|o>>>27)+e+n+1859775393+l[t+1]<<0,e=o^(a=a<<30|a>>>2)^s,i=(r=n<<5|n>>>27)+e+i+1859775393+l[t+2]<<0,e=n^(o=o<<30|o>>>2)^a,s=(r=i<<5|i>>>27)+e+s+1859775393+l[t+3]<<0,e=i^(n=n<<30|n>>>2)^o,a=(r=s<<5|s>>>27)+e+a+1859775393+l[t+4]<<0,i=i<<30|i>>>2;for(;t<60;t+=5)e=s&i|s&n|i&n,o=(r=a<<5|a>>>27)+e+o-1894007588+l[t]<<0,e=a&(s=s<<30|s>>>2)|a&i|s&i,n=(r=o<<5|o>>>27)+e+n-1894007588+l[t+1]<<0,e=o&(a=a<<30|a>>>2)|o&s|a&s,i=(r=n<<5|n>>>27)+e+i-1894007588+l[t+2]<<0,e=n&(o=o<<30|o>>>2)|n&a|o&a,s=(r=i<<5|i>>>27)+e+s-1894007588+l[t+3]<<0,e=i&(n=n<<30|n>>>2)|i&o|n&o,a=(r=s<<5|s>>>27)+e+a-1894007588+l[t+4]<<0,i=i<<30|i>>>2;for(;t<80;t+=5)e=s^i^n,o=(r=a<<5|a>>>27)+e+o-899497514+l[t]<<0,e=a^(s=s<<30|s>>>2)^i,n=(r=o<<5|o>>>27)+e+n-899497514+l[t+1]<<0,e=o^(a=a<<30|a>>>2)^s,i=(r=n<<5|n>>>27)+e+i-899497514+l[t+2]<<0,e=n^(o=o<<30|o>>>2)^a,s=(r=i<<5|i>>>27)+e+s-899497514+l[t+3]<<0,e=i^(n=n<<30|n>>>2)^o,a=(r=s<<5|s>>>27)+e+a-899497514+l[t+4]<<0,i=i<<30|i>>>2;this.h0=this.h0+a<<0,this.h1=this.h1+s<<0,this.h2=this.h2+i<<0,this.h3=this.h3+n<<0,this.h4=this.h4+o<<0},l.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,a=this.h3,i=this.h4;return s[e>>28&15]+s[e>>24&15]+s[e>>20&15]+s[e>>16&15]+s[e>>12&15]+s[e>>8&15]+s[e>>4&15]+s[15&e]+s[t>>28&15]+s[t>>24&15]+s[t>>20&15]+s[t>>16&15]+s[t>>12&15]+s[t>>8&15]+s[t>>4&15]+s[15&t]+s[r>>28&15]+s[r>>24&15]+s[r>>20&15]+s[r>>16&15]+s[r>>12&15]+s[r>>8&15]+s[r>>4&15]+s[15&r]+s[a>>28&15]+s[a>>24&15]+s[a>>20&15]+s[a>>16&15]+s[a>>12&15]+s[a>>8&15]+s[a>>4&15]+s[15&a]+s[i>>28&15]+s[i>>24&15]+s[i>>20&15]+s[i>>16&15]+s[i>>12&15]+s[i>>8&15]+s[i>>4&15]+s[15&i]},l.prototype.toString=l.prototype.hex,l.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,a=this.h3,s=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,a>>24&255,a>>16&255,a>>8&255,255&a,s>>24&255,s>>16&255,s>>8&255,255&s]},l.prototype.array=l.prototype.digest,l.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};let E=e=>new l(!0).update(e).hex();r(2576);let u=(...e)=>E(e.join("_"));class c{}let T=new Map;class d extends c{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(u(e,t))??null)}async update(e,t,r){this.cache.set(u(e,t),r)}static global(){return new d(T)}}},98077:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var a=r(33499),s=r(57830),i=r(35387);class n{}class o extends n{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,(0,s.j)(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:"true"!==(0,i.lS)("LANGCHAIN_CALLBACKS_BACKGROUND")}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.awaitHandlers=e._awaitHandler??this.awaitHandlers)}copy(){return new this.constructor(this)}toJSON(){return s.i.prototype.toJSON.call(this)}toJSONNotImplemented(){return s.i.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends o{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:a.Z()}),Object.assign(this,e)}}return new t}}},74311:(e,t,r)=>{"use strict";let a,s,i,n;r.d(t,{Ye:()=>eg,xz:()=>eP,QH:()=>eI});var o=r(33499),l=r(98077),E=r(53245),u=r(58519);function c(e,t){return`${e.open}${t}${e.close}`}function T(e,t){try{return JSON.stringify(e,null,2)}catch(e){return t}}function d(e){if(!e.end_time)return"";let t=e.end_time-e.start_time;return t<1e3?`${t}ms`:`${(t/1e3).toFixed(2)}s`}let{color:h}=E;class A extends u.Z{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){let t=[],r=e;for(;r.parent_run_id;){let e=this.runMap.get(r.parent_run_id);if(e)t.push(e),r=e;else break}return t}getBreadcrumbs(e){let t=this.getParents(e).reverse(),r=[...t,e].map((e,t,r)=>{let a=`${e.execution_order}:${e.run_type}:${e.name}`;return t===r.length-1?c(E.bold,a):a}).join(" > ");return c(h.grey,r)}onChainStart(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.green,"[chain/start]")} [${t}] Entering Chain run with input: ${T(e.inputs,"[inputs]")}`)}onChainEnd(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.cyan,"[chain/end]")} [${t}] [${d(e)}] Exiting Chain run with output: ${T(e.outputs,"[outputs]")}`)}onChainError(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.red,"[chain/error]")} [${t}] [${d(e)}] Chain run errored with error: ${T(e.error,"[error]")}`)}onLLMStart(e){let t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(e=>e.trim())}:e.inputs;console.log(`${c(h.green,"[llm/start]")} [${t}] Entering LLM run with input: ${T(r,"[inputs]")}`)}onLLMEnd(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.cyan,"[llm/end]")} [${t}] [${d(e)}] Exiting LLM run with output: ${T(e.outputs,"[response]")}`)}onLLMError(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.red,"[llm/error]")} [${t}] [${d(e)}] LLM run errored with error: ${T(e.error,"[error]")}`)}onToolStart(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.green,"[tool/start]")} [${t}] Entering Tool run with input: "${e.inputs.input?.trim()}"`)}onToolEnd(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.cyan,"[tool/end]")} [${t}] [${d(e)}] Exiting Tool run with output: "${e.outputs?.output?.trim()}"`)}onToolError(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.red,"[tool/error]")} [${t}] [${d(e)}] Tool run errored with error: ${T(e.error,"[error]")}`)}onRetrieverStart(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${T(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.cyan,"[retriever/end]")} [${t}] [${d(e)}] Exiting Retriever run with output: ${T(e.outputs,"[outputs]")}`)}onRetrieverError(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.red,"[retriever/error]")} [${t}] [${d(e)}] Retriever run errored with error: ${T(e.error,"[error]")}`)}onAgentAction(e){let t=this.getBreadcrumbs(e);console.log(`${c(h.blue,"[agent/action]")} [${t}] Agent selected action: ${T(e.actions[e.actions.length-1],"[action]")}`)}}let p=require("node:crypto");var R=r.n(p);let S={randomUUID:R().randomUUID},_=new Uint8Array(256),O=_.length,I=[];for(let e=0;e<256;++e)I.push((e+256).toString(16).slice(1));let f=function(e,t,r){if(S.randomUUID&&!t&&!e)return S.randomUUID();e=e||{};let a=e.random||(e.rng||function(){return O>_.length-16&&(R().randomFillSync(_),O=0),_.slice(O,O+=16)})();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return(I[e[t+0]]+I[e[t+1]]+I[e[t+2]]+I[e[t+3]]+"-"+I[e[t+4]]+I[e[t+5]]+"-"+I[e[t+6]]+I[e[t+7]]+"-"+I[e[t+8]]+I[e[t+9]]+"-"+I[e[t+10]]+I[e[t+11]]+I[e[t+12]]+I[e[t+13]]+I[e[t+14]]+I[e[t+15]]).toLowerCase()}(a)};var N=r(31776),m=r(96110);let C=(...e)=>fetch(...e),L=Symbol.for("ls:fetch_implementation"),y=()=>globalThis[L]??C,g=[400,401,403,404,405,406,407,408],P=[409];class b{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.queue=new m.default({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e?.onFailedResponseHook}call(e,...t){let r=this.onFailedResponseHook;return this.queue.add(()=>N(()=>e(...t).catch(e=>{if(e instanceof Error)throw e;throw Error(e)}),{async onFailedAttempt(e){if(e.message.startsWith("Cancel")||e.message.startsWith("TimeoutError")||e.message.startsWith("AbortError")||e?.code==="ECONNABORTED")throw e;let t=e?.response,a=t?.status;if(a){if(g.includes(+a))throw e;if(P.includes(+a))return;r&&await r(t)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((t,r)=>{e.signal?.addEventListener("abort",()=>{r(Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>y()(...e).then(e=>e.ok?e:Promise.reject(e)))}}function D(e){return"function"==typeof e?._getType}function v(e){let t={type:e._getType(),data:{content:e.content}};return e?.additional_kwargs&&Object.keys(e.additional_kwargs).length>0&&(t.data.additional_kwargs={...e.additional_kwargs}),t}let M=()=>!1,U=()=>"object"==typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name,w=()=>"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),G=()=>"undefined"!=typeof Deno,B=()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node&&!G(),F=()=>a||(a=M()?"browser":B()?"node":U()?"webworker":w()?"jsdom":G()?"deno":"other");function H(){if(void 0===s){let e=F(),t=function(){if(void 0!==i)return i;let e={};for(let t of["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"]){let r=x(t);void 0!==r&&(e[t]=r)}return i=e,e}();s={library:"langsmith",runtime:e,sdk:"langsmith-js",sdk_version:eA,...t}}return s}function x(e){try{return"undefined"!=typeof process?process.env?.[e]:void 0}catch(e){return}}function k(e){return x(`LANGSMITH_${e}`)||x(`LANGCHAIN_${e}`)}let Y=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function V(e,t){if(!("string"==typeof e&&Y.test(e))){let r=void 0!==t?`Invalid UUID for ${t}: ${e}`:`Invalid UUID: ${e}`;throw Error(r)}return e}let $={};function W(e){$[e]||(console.warn(e),$[e]=!0)}var j=r(71634);function X(e){if(!e||e.split("/").length>2||e.startsWith("/")||e.endsWith("/")||e.split(":").length>2)throw Error(`Invalid identifier format: ${e}`);let[t,r]=e.split(":"),a=r||"latest";if(t.includes("/")){let[r,s]=t.split("/",2);if(!r||!s)throw Error(`Invalid identifier format: ${e}`);return[r,s,a]}if(!t)throw Error(`Invalid identifier format: ${e}`);return["-",t,a]}class K extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function Z(e,t,r){let a;if(e.ok){r&&(a=await e.text());return}a=await e.text();let s=`Failed to ${t}. Received status [${e.status}]: ${e.statusText}. Server response: ${a}`;if(409===e.status)throw new K(s);throw Error(s)}var q={result:"[Circular]"},J=[],z=[];function Q(e,t,r,a){try{return JSON.stringify(e,t,r)}catch(o){if(!o.message?.includes("Converting circular structure to JSON"))return console.warn("[WARNING]: LangSmith received unserializable value."),"[Unserializable]";console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),void 0===a&&(a={depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}),function e(t,r,a,s,i,n,o){if(n+=1,"object"==typeof t&&null!==t){for(l=0;l<s.length;l++)if(s[l]===t){ee(q,t,r,i);return}if(void 0!==o.depthLimit&&n>o.depthLimit||void 0!==o.edgesLimit&&a+1>o.edgesLimit){ee("[...]",t,r,i);return}if(s.push(t),Array.isArray(t))for(l=0;l<t.length;l++)e(t[l],l,l,s,t,n,o);else{var l,E=Object.keys(t);for(l=0;l<E.length;l++){var u=E[l];e(t[u],u,l,s,t,n,o)}}s.pop()}}(e,"",0,[],void 0,0,a);try{var s;i=0===z.length?JSON.stringify(e,t,r):JSON.stringify(e,(s=t,s=void 0!==s?s:function(e,t){return t},function(e,t){if(z.length>0)for(var r=0;r<z.length;r++){var a=z[r];if(a[1]===e&&a[0]===t){t=a[2],z.splice(r,1);break}}return s.call(this,e,t)}),r)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==J.length;){var i,n=J.pop();4===n.length?Object.defineProperty(n[0],n[1],n[3]):n[0][n[1]]=n[2]}}return i}}function ee(e,t,r,a){var s=Object.getOwnPropertyDescriptor(a,r);void 0!==s.get?s.configurable?(Object.defineProperty(a,r,{value:e}),J.push([a,r,t,s])):z.push([t,r,e]):(a[r]=e,J.push([a,r,t]))}function et(e){let t=H(),r=function(){let e=function(){try{if("undefined"!=typeof process&&process.env)return Object.entries(process.env).reduce((e,[t,r])=>(e[t]=String(r),e),{});return}catch(e){return}}()||{},t={},r=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"];for(let[a,s]of Object.entries(e))!a.startsWith("LANGCHAIN_")||"string"!=typeof s||r.includes(a)||a.toLowerCase().includes("key")||a.toLowerCase().includes("secret")||a.toLowerCase().includes("token")||("LANGCHAIN_REVISION_ID"===a?t.revision_id=s:t[a]=s);return t}(),a=e.extra??{},s=a.metadata;return e.extra={...a,runtime:{...t,...a?.runtime},metadata:{...r,...r.revision_id||e.revision_id?{revision_id:e.revision_id??r.revision_id}:{},...s}},e}let er=()=>{let e=k("TRACING_SAMPLING_RATE");if(void 0===e)return;let t=parseFloat(e);if(t<0||t>1)throw Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t},ea=e=>{let t=e.replace("http://","").replace("https://",""),r=t.split("/")[0].split(":")[0];return"localhost"===r||"127.0.0.1"===r||"::1"===r};async function es(e){let t=[];for await(let r of e)t.push(r);return t}function ei(e){if(void 0!==e)return e.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}let en=async e=>{if(e?.status===429){let t=1e3*parseInt(e.headers.get("retry-after")??"30",10);if(t>0)return await new Promise(e=>setTimeout(e,t)),!0}return!1};class eo{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;let r=new Promise(e=>{t=e}),a=Q(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:r,size:a}),this.sizeBytes+=a,r}pop(e){if(e<1)throw Error("Number of bytes to pop off may not be less than 1.");let t=[],r=0;for(;r+(this.peek()?.size??0)<e&&this.items.length>0;){let e=this.items.shift();e&&(t.push(e),r+=e.size,this.sizeBytes-=e.size)}if(0===t.length&&this.items.length>0){let e=this.items.shift();t.push(e),r+=e.size,this.sizeBytes-=e.size}return[t.map(e=>({action:e.action,item:e.payload})),()=>t.forEach(e=>e.itemPromiseResolve())]}}class el{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new eo}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let t=el.getDefaultClientConfig();this.tracingSampleRate=er(),this.apiUrl=ei(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=ei(e.apiKey??t.apiKey),this.webUrl=ei(e.webUrl??t.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??12e3,this.caller=new b(e.callerOptions??{}),this.batchIngestCaller=new b({...e.callerOptions??{},onFailedResponseHook:en}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{}}static getDefaultClientConfig(){let e=k("API_KEY"),t=k("ENDPOINT")??"https://api.smith.langchain.com",r="true"===k("HIDE_INPUTS"),a="true"===k("HIDE_OUTPUTS");return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:a}}getHostUrl(){return this.webUrl?this.webUrl:ea(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){let e={"User-Agent":`langsmith-js/${eA}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return!1===this.hideInputs?e:!0===this.hideInputs?{}:"function"==typeof this.hideInputs?this.hideInputs(e):e}processOutputs(e){return!1===this.hideOutputs?e:!0===this.hideOutputs?{}:"function"==typeof this.hideOutputs?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){let t={...e};return void 0!==t.inputs&&(t.inputs=this.processInputs(t.inputs)),void 0!==t.outputs&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){let r=t?.toString()??"",a=`${this.apiUrl}${e}?${r}`,s=await this.caller.call(y(),a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Z(s,`Failed to fetch ${e}`),s}async _get(e,t){let r=await this._getResponse(e,t);return r.json()}async *_getPaginated(e,t=new URLSearchParams,r){let a=Number(t.get("offset"))||0,s=Number(t.get("limit"))||100;for(;;){t.set("offset",String(a)),t.set("limit",String(s));let i=`${this.apiUrl}${e}?${t}`,n=await this.caller.call(y(),i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(n,`Failed to fetch ${e}`);let o=r?r(await n.json()):await n.json();if(0===o.length||(yield o,o.length<s))break;a+=o.length}}async *_getCursorPaginatedList(e,t=null,r="POST",a="runs"){let s=t?{...t}:{};for(;;){let t=await this.caller.call(y(),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(s)}),i=await t.json();if(!i||!i[a])break;yield i[a];let n=i.cursors;if(!n||!n.next)break;s.cursor=n.next}}_filterForSampling(e,t=!1){if(void 0===this.tracingSampleRate)return e;if(t){let t=[];for(let r of e)this.filteredPostUuids.has(r.id)?this.filteredPostUuids.delete(r.id):t.push(r);return t}{let t=[];for(let r of e)r.id!==r.trace_id&&!this.filteredPostUuids.has(r.trace_id)||Math.random()<this.tracingSampleRate?t.push(r):this.filteredPostUuids.add(r.id);return t}}async _getBatchSizeLimitBytes(){let e=await this._ensureServerInfo();return this.batchSizeBytesLimit??e.batch_ingest_config?.size_limit_bytes??20971520}async drainAutoBatchQueue(){for(;this.autoBatchQueue.items.length>=0;){let[e,t]=this.autoBatchQueue.pop(await this._getBatchSizeLimitBytes());if(!e.length){t();return}try{let t={runCreates:e.filter(e=>"create"===e.action).map(e=>e.item),runUpdates:e.filter(e=>"update"===e.action).map(e=>e.item)},r=await this._ensureServerInfo();r?.batch_ingest_config?.use_multipart_endpoint?await this.multipartIngestRuns(t):await this.batchIngestRuns(t)}finally{t()}}}async processRunOperation(e,t){let r=this.autoBatchTimeout;clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,"create"===e.action&&(e.item=et(e.item));let a=this.autoBatchQueue.push(e),s=await this._getBatchSizeLimitBytes();return(t||this.autoBatchQueue.sizeBytes>s)&&await this.drainAutoBatchQueue().catch(console.error),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue().catch(console.error)},r?this.autoBatchAggregationDelayMs:this.autoBatchInitialDelayMs)),a}async _getServerInfo(){let e=await y()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e3),...this.fetchOptions});return await Z(e,"get server info"),e.json()}async _ensureServerInfo(){return void 0===this._getServerInfoPromise&&(this._getServerInfoPromise=(async()=>{if(void 0===this._serverInfo)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to single calls and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(void 0===this._serverInfo&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async createRun(e){if(!this._filterForSampling([e]).length)return;let t={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;let a=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&void 0!==a.trace_id&&void 0!==a.dotted_order){this.processRunOperation({action:"create",item:a}).catch(console.error);return}let s=et(a),i=await this.caller.call(y(),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:Q(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(i,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t}){if(void 0===e&&void 0===t)return;let r=e?.map(e=>this.prepareRunCreateOrUpdateInputs(e))??[],a=t?.map(e=>this.prepareRunCreateOrUpdateInputs(e))??[];if(r.length>0&&a.length>0){let e=r.reduce((e,t)=>(t.id&&(e[t.id]=t),e),{}),t=[];for(let r of a)void 0!==r.id&&e[r.id]?e[r.id]={...e[r.id],...r}:t.push(r);r=Object.values(e),a=t}let s={post:this._filterForSampling(r),patch:this._filterForSampling(a,!0)};if(!s.post.length&&!s.patch.length)return;let i=await this._ensureServerInfo();if(void 0===i.version){for(let e of(this.autoBatchTracing=!1,s.post))await this.createRun(e);for(let e of s.patch)void 0!==e.id&&await this.updateRun(e.id,e);return}let n={post:[],patch:[]};for(let e of["post","patch"]){let t=s[e].reverse(),r=t.pop();for(;void 0!==r;)n[e].push(r),r=t.pop()}(n.post.length>0||n.patch.length>0)&&await this._postBatchIngestRuns(Q(n))}async _postBatchIngestRuns(e){let t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(y(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(r,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t}){if(void 0===e&&void 0===t)return;let r={},a=[];for(let t of e??[]){let e=this.prepareRunCreateOrUpdateInputs(t);void 0!==e.id&&void 0!==e.attachments&&(r[e.id]=e.attachments),delete e.attachments,a.push(e)}let s=[];for(let e of t??[])s.push(this.prepareRunCreateOrUpdateInputs(e));let i=a.find(e=>void 0===e.trace_id||void 0===e.dotted_order);if(void 0!==i)throw Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');let n=s.find(e=>void 0===e.trace_id||void 0===e.dotted_order);if(void 0!==n)throw Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(a.length>0&&s.length>0){let e=a.reduce((e,t)=>(t.id&&(e[t.id]=t),e),{}),t=[];for(let r of s)void 0!==r.id&&e[r.id]?e[r.id]={...e[r.id],...r}:t.push(r);a=Object.values(e),s=t}if(0===a.length&&0===s.length)return;let o=[],l=[];for(let[e,t]of[["post",a],["patch",s]])for(let a of t){let{inputs:t,outputs:s,events:i,...n}=a,E={inputs:t,outputs:s,events:i},u=Q(n);for(let[t,r]of(l.push({name:`${e}.${n.id}`,payload:new Blob([u],{type:`application/json; length=${u.length}`})}),Object.entries(E))){if(void 0===r)continue;let a=Q(r);l.push({name:`${e}.${n.id}.${t}`,payload:new Blob([a],{type:`application/json; length=${a.length}`})})}if(void 0!==n.id){let e=r[n.id];if(e)for(let[t,[a,s]]of(delete r[n.id],Object.entries(e)))l.push({name:`attachment.${n.id}.${t}`,payload:new Blob([s],{type:`${a}; length=${s.length}`})})}o.push(`trace=${n.trace_id},id=${n.id}`)}await this._sendMultipartRequest(l,o.join("; "))}async _sendMultipartRequest(e,t){try{let t=new FormData;for(let r of e)t.append(r.name,r.payload);await this.batchIngestCaller.call(y(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers},body:t,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})}catch(r){let e="Failed to multipart ingest runs";r instanceof Error?e+=`: ${r.stack||r.message}`:e+=`: ${String(r)}`,console.warn(`${e.trim()}

Context: ${t}`)}}async updateRun(e,t){V(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));let r={...t,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&void 0!==r.trace_id&&void 0!==r.dotted_order){void 0!==t.end_time&&void 0===r.parent_run_id&&this.blockOnRootRunFinalization?await this.processRunOperation({action:"update",item:r},!0):this.processRunOperation({action:"update",item:r}).catch(console.error);return}let a={...this.headers,"Content-Type":"application/json"},s=await this.caller.call(y(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:a,body:Q(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(s,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){V(e);let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:t,projectOpts:r}){if(void 0!==t){let e;if(t.session_id)e=t.session_id;else if(r?.projectName)e=(await this.readProject({projectName:r?.projectName})).id;else if(r?.projectId)e=r?.projectId;else{let t=await this.readProject({projectName:k("PROJECT")||"default"});e=t.id}let a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${e}/r/${t.id}?poll=true`}if(void 0!==e){let t=await this.readRun(e);if(!t.app_path)throw Error(`Run ${e} has no app_path`);let r=this.getHostUrl();return`${r}${t.app_path}`}throw Error("Must provide either runId or run")}async _loadChildRuns(e){let t=await es(this.listRuns({id:e.child_run_ids})),r={},a={};for(let e of(t.sort((e,t)=>(e?.dotted_order??"").localeCompare(t?.dotted_order??"")),t)){if(null===e.parent_run_id||void 0===e.parent_run_id)throw Error(`Child run ${e.id} has no parent`);e.parent_run_id in r||(r[e.parent_run_id]=[]),r[e.parent_run_id].push(e),a[e.id]=e}for(let t in e.child_runs=r[e.id]||[],r)t!==e.id&&(a[t].child_runs=r[t]);return e}async *listRuns(e){let{projectId:t,projectName:r,parentRunId:a,traceId:s,referenceExampleId:i,startTime:n,executionOrder:o,isRoot:l,runType:E,error:u,id:c,query:T,filter:d,traceFilter:h,treeFilter:A,limit:p,select:R}=e,S=[];if(t&&(S=Array.isArray(t)?t:[t]),r){let e=Array.isArray(r)?r:[r],t=await Promise.all(e.map(e=>this.readProject({projectName:e}).then(e=>e.id)));S.push(...t)}let _={session:S.length?S:null,run_type:E,reference_example:i,query:T,filter:d,trace_filter:h,tree_filter:A,execution_order:o,parent_run:a,start_time:n?n.toISOString():null,error:u,id:c,limit:p,trace:s,select:R||["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],is_root:l},O=0;for await(let e of this._getCursorPaginatedList("/runs/query",_))if(p){if(O>=p)break;if(e.length+O>p){let t=e.slice(0,p-O);yield*t;break}O+=e.length,yield*e}else yield*e}async getRunStats({id:e,trace:t,parentRun:r,runType:a,projectNames:s,projectIds:i,referenceExampleIds:n,startTime:o,endTime:l,error:E,query:u,filter:c,traceFilter:T,treeFilter:d,isRoot:h,dataSourceType:A}){let p=i||[];s&&(p=[...i||[],...await Promise.all(s.map(e=>this.readProject({projectName:e}).then(e=>e.id)))]);let R={id:e,trace:t,parent_run:r,run_type:a,session:p,reference_example:n,start_time:o,end_time:l,error:E,query:u,filter:c,trace_filter:T,tree_filter:d,is_root:h,data_source_type:A},S=Object.fromEntries(Object.entries(R).filter(([e,t])=>void 0!==t)),_=await this.caller.call(y(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(S),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),O=await _.json();return O}async shareRun(e,{shareId:t}={}){let r={run_id:e,share_token:t||f()};V(e);let a=await this.caller.call(y(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),s=await a.json();if(null===s||!("share_token"in s))throw Error("Invalid response from server");return`${this.getHostUrl()}/public/${s.share_token}/r`}async unshareRun(e){V(e);let t=await this.caller.call(y(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(t,"unshare run",!0)}async readRunSharedLink(e){V(e);let t=await this.caller.call(y(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await t.json();if(null!==r&&"share_token"in r)return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){let r=new URLSearchParams({share_token:e});if(void 0!==t)for(let e of t)r.append("id",e);V(e);let a=await this.caller.call(y(),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),s=await a.json();return s}async readDatasetSharedSchema(e,t){if(!e&&!t)throw Error("Either datasetId or datasetName must be given");if(!e){let r=await this.readDataset({datasetName:t});e=r.id}V(e);let r=await this.caller.call(y(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),a=await r.json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async shareDataset(e,t){if(!e&&!t)throw Error("Either datasetId or datasetName must be given");if(!e){let r=await this.readDataset({datasetName:t});e=r.id}let r={dataset_id:e};V(e);let a=await this.caller.call(y(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),s=await a.json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async unshareDataset(e){V(e);let t=await this.caller.call(y(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(t,"unshare dataset",!0)}async readSharedDataset(e){V(e);let t=await this.caller.call(y(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await t.json();return r}async listSharedExamples(e,t){let r={};t?.exampleIds&&(r.id=t.exampleIds);let a=new URLSearchParams;Object.entries(r).forEach(([e,t])=>{Array.isArray(t)?t.forEach(t=>a.append(e,t)):a.append(e,t)});let s=await this.caller.call(y(),`${this.apiUrl}/public/${e}/examples?${a.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),i=await s.json();if(!s.ok){if("detail"in i)throw Error(`Failed to list shared examples.
Status: ${s.status}
Message: ${i.detail.join("\n")}`);throw Error(`Failed to list shared examples: ${s.status} ${s.statusText}`)}return i.map(e=>({...e,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:r=null,upsert:a=!1,projectExtra:s=null,referenceDatasetId:i=null}){let n=`${this.apiUrl}/sessions${a?"?upsert=true":""}`,o=s||{};r&&(o.metadata=r);let l={name:e,extra:o,description:t};null!==i&&(l.reference_dataset_id=i);let E=await this.caller.call(y(),n,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(E,"create project");let u=await E.json();return u}async updateProject(e,{name:t=null,description:r=null,metadata:a=null,projectExtra:s=null,endTime:i=null}){let n=`${this.apiUrl}/sessions/${e}`,o=s;a&&(o={...o||{},metadata:a});let l={name:t,extra:o,description:r,end_time:i?new Date(i).toISOString():null},E=await this.caller.call(y(),n,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(E,"update project");let u=await E.json();return u}async hasProject({projectId:e,projectName:t}){let r="/sessions",a=new URLSearchParams;if(void 0!==e&&void 0!==t)throw Error("Must provide either projectName or projectId, not both");if(void 0!==e)V(e),r+=`/${e}`;else if(void 0!==t)a.append("name",t);else throw Error("Must provide projectName or projectId");let s=await this.caller.call(y(),`${this.apiUrl}${r}?${a}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{let e=await s.json();if(!s.ok)return!1;if(Array.isArray(e))return e.length>0;return!0}catch(e){return!1}}async readProject({projectId:e,projectName:t,includeStats:r}){let a,s="/sessions",i=new URLSearchParams;if(void 0!==e&&void 0!==t)throw Error("Must provide either projectName or projectId, not both");if(void 0!==e)V(e),s+=`/${e}`;else if(void 0!==t)i.append("name",t);else throw Error("Must provide projectName or projectId");void 0!==r&&i.append("include_stats",r.toString());let n=await this._get(s,i);if(Array.isArray(n)){if(0===n.length)throw Error(`Project[id=${e}, name=${t}] not found`);a=n[0]}else a=n;return a}async getProjectUrl({projectId:e,projectName:t}){if(void 0===e&&void 0===t)throw Error("Must provide either projectName or projectId");let r=await this.readProject({projectId:e,projectName:t}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(void 0===e&&void 0===t)throw Error("Must provide either datasetName or datasetId");let r=await this.readDataset({datasetId:e,datasetName:t}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/datasets/${r.id}`}async _getTenantId(){if(null!==this._tenantId)return this._tenantId;let e=new URLSearchParams({limit:"1"});for await(let t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw Error("No projects found to resolve tenant.")}async *listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:a,referenceDatasetName:s,referenceFree:i,metadata:n}={}){let o=new URLSearchParams;if(void 0!==e)for(let t of e)o.append("id",t);if(void 0!==t&&o.append("name",t),void 0!==r&&o.append("name_contains",r),void 0!==a)o.append("reference_dataset",a);else if(void 0!==s){let e=await this.readDataset({datasetName:s});o.append("reference_dataset",e.id)}for await(let e of(void 0!==i&&o.append("reference_free",i.toString()),void 0!==n&&o.append("metadata",JSON.stringify(n)),this._getPaginated("/sessions",o)))yield*e}async deleteProject({projectId:e,projectName:t}){let r;if(void 0===e&&void 0===t)throw Error("Must provide projectName or projectId");if(void 0!==e&&void 0!==t)throw Error("Must provide either projectName or projectId, not both");V(r=void 0===e?(await this.readProject({projectName:t})).id:e);let a=await this.caller.call(y(),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(a,`delete session ${r} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:a,description:s,dataType:i,name:n}){let o=`${this.apiUrl}/datasets/upload`,l=new FormData;l.append("file",e,t),r.forEach(e=>{l.append("input_keys",e)}),a.forEach(e=>{l.append("output_keys",e)}),s&&l.append("description",s),i&&l.append("data_type",i),n&&l.append("name",n);let E=await this.caller.call(y(),o,{method:"POST",headers:this.headers,body:l,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(E,"upload CSV");let u=await E.json();return u}async createDataset(e,{description:t,dataType:r,inputsSchema:a,outputsSchema:s,metadata:i}={}){let n={name:e,description:t,extra:i?{metadata:i}:void 0};r&&(n.data_type=r),a&&(n.inputs_schema_definition=a),s&&(n.outputs_schema_definition=s);let o=await this.caller.call(y(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(o,"create dataset");let l=await o.json();return l}async readDataset({datasetId:e,datasetName:t}){let r,a="/datasets",s=new URLSearchParams({limit:"1"});if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0!==e)V(e),a+=`/${e}`;else if(void 0!==t)s.append("name",t);else throw Error("Must provide datasetName or datasetId");let i=await this._get(a,s);if(Array.isArray(i)){if(0===i.length)throw Error(`Dataset[id=${e}, name=${t}] not found`);r=i[0]}else r=i;return r}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(e){if(e instanceof Error&&e.message.toLocaleLowerCase().includes("not found"))return!1;throw e}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:r,toVersion:a}){let s=e;if(void 0===s&&void 0===t)throw Error("Must provide either datasetName or datasetId");if(void 0!==s&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0===s){let e=await this.readDataset({datasetName:t});s=e.id}let i=new URLSearchParams({from_version:"string"==typeof r?r:r.toISOString(),to_version:"string"==typeof a?a:a.toISOString()}),n=await this._get(`/datasets/${s}/versions/diff`,i);return n}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){if(void 0!==e);else if(void 0!==t)e=(await this.readDataset({datasetName:t})).id;else throw Error("Must provide datasetName or datasetId");let r=await this._getResponse(`/datasets/${e}/openai_ft`),a=await r.text(),s=a.trim().split("\n").map(e=>JSON.parse(e));return s}async *listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:a,datasetNameContains:s,metadata:i}={}){let n=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(void 0!==r)for(let e of r)n.append("id",e);for await(let e of(void 0!==a&&n.append("name",a),void 0!==s&&n.append("name_contains",s),void 0!==i&&n.append("metadata",JSON.stringify(i)),this._getPaginated("/datasets",n)))yield*e}async updateDataset(e){let{datasetId:t,datasetName:r,...a}=e;if(!t&&!r)throw Error("Must provide either datasetName or datasetId");let s=t??(await this.readDataset({datasetName:r})).id;V(s);let i=await this.caller.call(y(),`${this.apiUrl}/datasets/${s}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Z(i,"update dataset"),await i.json()}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",a=e;if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0!==t){let e=await this.readDataset({datasetName:t});a=e.id}if(void 0!==a)V(a),r+=`/${a}`;else throw Error("Must provide datasetName or datasetId");let s=await this.caller.call(y(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(s,`delete ${r}`),await s.json()}async indexDataset({datasetId:e,datasetName:t,tag:r}){let a=e;if(a||t){if(a&&t)throw Error("Must provide either datasetName or datasetId, not both");if(!a){let e=await this.readDataset({datasetName:t});a=e.id}}else throw Error("Must provide either datasetName or datasetId");V(a);let s=await this.caller.call(y(),`${this.apiUrl}/datasets/${a}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({tag:r}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(s,"index dataset"),await s.json()}async similarExamples(e,t,r,{filter:a}={}){let s={limit:r,inputs:e};void 0!==a&&(s.filter=a),V(t);let i=await this.caller.call(y(),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(i,"fetch similar examples");let n=await i.json();return n.examples}async createExample(e,t,{datasetId:r,datasetName:a,createdAt:s,exampleId:i,metadata:n,split:o,sourceRunId:l}){let E=r;if(void 0===E&&void 0===a)throw Error("Must provide either datasetName or datasetId");if(void 0!==E&&void 0!==a)throw Error("Must provide either datasetName or datasetId, not both");if(void 0===E){let e=await this.readDataset({datasetName:a});E=e.id}let u=s||new Date,c={dataset_id:E,inputs:e,outputs:t,created_at:u?.toISOString(),id:i,metadata:n,split:o,source_run_id:l},T=await this.caller.call(y(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(T,"create example");let d=await T.json();return d}async createExamples(e){let{inputs:t,outputs:r,metadata:a,sourceRunIds:s,exampleIds:i,datasetId:n,datasetName:o}=e,l=n;if(void 0===l&&void 0===o)throw Error("Must provide either datasetName or datasetId");if(void 0!==l&&void 0!==o)throw Error("Must provide either datasetName or datasetId, not both");if(void 0===l){let e=await this.readDataset({datasetName:o});l=e.id}let E=t.map((t,n)=>({dataset_id:l,inputs:t,outputs:r?r[n]:void 0,metadata:a?a[n]:void 0,split:e.splits?e.splits[n]:void 0,id:i?i[n]:void 0,source_run_id:s?s[n]:void 0})),u=await this.caller.call(y(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(E),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(u,"create examples");let c=await u.json();return c}async createLLMExample(e,t,r){return this.createExample({input:e},{output:t},r)}async createChatExample(e,t,r){let a=e.map(e=>D(e)?v(e):e),s=D(t)?v(t):t;return this.createExample({input:a},{output:s},r)}async readExample(e){V(e);let t=`/examples/${e}`;return await this._get(t)}async *listExamples({datasetId:e,datasetName:t,exampleIds:r,asOf:a,splits:s,inlineS3Urls:i,metadata:n,limit:o,offset:l,filter:E}={}){let u;if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0!==e)u=e;else if(void 0!==t){let e=await this.readDataset({datasetName:t});u=e.id}else throw Error("Must provide a datasetName or datasetId");let c=new URLSearchParams({dataset:u}),T=a?"string"==typeof a?a:a?.toISOString():void 0;if(T&&c.append("as_of",T),c.append("inline_s3_urls",(i??!0).toString()),void 0!==r)for(let e of r)c.append("id",e);if(void 0!==s)for(let e of s)c.append("splits",e);if(void 0!==n){let e=JSON.stringify(n);c.append("metadata",e)}void 0!==o&&c.append("limit",o.toString()),void 0!==l&&c.append("offset",l.toString()),void 0!==E&&c.append("filter",E);let d=0;for await(let e of this._getPaginated("/examples",c)){for(let t of e)yield t,d++;if(void 0!==o&&d>=o)break}}async deleteExample(e){V(e);let t=`/examples/${e}`,r=await this.caller.call(y(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(r,`delete ${t}`),await r.json()}async updateExample(e,t){V(e);let r=await this.caller.call(y(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(r,"update example");let a=await r.json();return a}async updateExamples(e){let t=await this.caller.call(y(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(t,"update examples");let r=await t.json();return r}async listDatasetSplits({datasetId:e,datasetName:t,asOf:r}){let a;if(void 0===e&&void 0===t)throw Error("Must provide dataset name or ID");if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0===e){let e=await this.readDataset({datasetName:t});a=e.id}else a=e;V(a);let s=new URLSearchParams,i=r?"string"==typeof r?r:r?.toISOString():void 0;i&&s.append("as_of",i);let n=await this._get(`/datasets/${a}/splits`,s);return n}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:r,exampleIds:a,remove:s=!1}){let i;if(void 0===e&&void 0===t)throw Error("Must provide dataset name or ID");if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0===e){let e=await this.readDataset({datasetName:t});i=e.id}else i=e;V(i);let n={split_name:r,examples:a.map(e=>(V(e),e)),remove:s},o=await this.caller.call(y(),`${this.apiUrl}/datasets/${i}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(o,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:a,referenceExample:s}={loadChildRuns:!1}){let i;if(W("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead."),"string"==typeof e)i=await this.readRun(e,{loadChildRuns:a});else if("object"==typeof e&&"id"in e)i=e;else throw Error(`Invalid run type: ${typeof e}`);null!==i.reference_example_id&&void 0!==i.reference_example_id&&(s=await this.readExample(i.reference_example_id));let n=await t.evaluateRun(i,s),[o,l]=await this._logEvaluationFeedback(n,i,r);return l[0]}async createFeedback(e,t,{score:r,value:a,correction:s,comment:i,sourceInfo:n,feedbackSourceType:o="api",sourceRunId:l,feedbackId:E,feedbackConfig:u,projectId:c,comparativeExperimentId:T}){if(!e&&!c)throw Error("One of runId or projectId must be provided");if(e&&c)throw Error("Only one of runId or projectId can be provided");let d={type:o??"api",metadata:n??{}};void 0===l||d?.metadata===void 0||d.metadata.__run||(d.metadata.__run={run_id:l}),d?.metadata!==void 0&&d.metadata.__run?.run_id!==void 0&&V(d.metadata.__run.run_id);let h={id:E??f(),run_id:e,key:t,score:r,value:a,correction:s,comment:i,feedback_source:d,comparative_experiment_id:T,feedbackConfig:u,session_id:c},A=`${this.apiUrl}/feedback`,p=await this.caller.call(y(),A,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Z(p,"create feedback",!0),h}async updateFeedback(e,{score:t,value:r,correction:a,comment:s}){let i={};null!=t&&(i.score=t),null!=r&&(i.value=r),null!=a&&(i.correction=a),null!=s&&(i.comment=s),V(e);let n=await this.caller.call(y(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(n,"update feedback",!0)}async readFeedback(e){V(e);let t=`/feedback/${e}`,r=await this._get(t);return r}async deleteFeedback(e){V(e);let t=`/feedback/${e}`,r=await this.caller.call(y(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(r,`delete ${t}`),await r.json()}async *listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:r}={}){let a=new URLSearchParams;if(e&&a.append("run",e.join(",")),t)for(let e of t)a.append("key",e);if(r)for(let e of r)a.append("source",e);for await(let e of this._getPaginated("/feedback",a))yield*e}async createPresignedFeedbackToken(e,t,{expiration:r,feedbackConfig:a}={}){let s={run_id:e,feedback_key:t,feedback_config:a};r?"string"==typeof r?s.expires_at=r:(r?.hours||r?.minutes||r?.days)&&(s.expires_in=r):s.expires_in={hours:3};let i=await this.caller.call(y(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await i.json();return n}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:r,createdAt:a,description:s,metadata:i,id:n}){if(0===t.length)throw Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:t[0]})).reference_dataset_id),null==!r)throw Error("A reference dataset is required");let o={id:n,name:e,experiment_ids:t,reference_dataset_id:r,description:s,created_at:(a??new Date)?.toISOString(),extra:{}};i&&(o.extra.metadata=i);let l=await this.caller.call(y(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await l.json()}async *listPresignedFeedbackTokens(e){V(e);let t=new URLSearchParams({run_id:e});for await(let e of this._getPaginated("/feedback/tokens",t))yield*e}_selectEvalResults(e){return"results"in e?e.results:[e]}async _logEvaluationFeedback(e,t,r){let a=this._selectEvalResults(e),s=[];for(let e of a){let a=r||{};e.evaluatorInfo&&(a={...e.evaluatorInfo,...a});let i=null;e.targetRunId?i=e.targetRunId:t&&(i=t.id),s.push(await this.createFeedback(i,e.key,{score:e.score,value:e.value,comment:e.comment,correction:e.correction,sourceInfo:a,sourceRunId:e.sourceRunId,feedbackConfig:e.feedbackConfig,feedbackSourceType:"model"}))}return[a,s]}async logEvaluationFeedback(e,t,r){let[a]=await this._logEvaluationFeedback(e,t,r);return a}async *listAnnotationQueues(e={}){let{queueIds:t,name:r,nameContains:a,limit:s}=e,i=new URLSearchParams;t&&t.forEach((e,t)=>{V(e,`queueIds[${t}]`),i.append("ids",e)}),r&&i.append("name",r),a&&i.append("name_contains",a),i.append("limit",(void 0!==s?Math.min(s,100):100).toString());let n=0;for await(let e of this._getPaginated("/annotation-queues",i))if(yield*e,n++,void 0!==s&&n>=s)break}async createAnnotationQueue(e){let{name:t,description:r,queueId:a}=e,s={name:t,description:r,id:a||f()},i=await this.caller.call(y(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(s).filter(([e,t])=>void 0!==t))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(i,"create annotation queue");let n=await i.json();return n}async readAnnotationQueue(e){let t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){let{name:r,description:a}=t,s=await this.caller.call(y(),`${this.apiUrl}/annotation-queues/${V(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(s,"update annotation queue")}async deleteAnnotationQueue(e){let t=await this.caller.call(y(),`${this.apiUrl}/annotation-queues/${V(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){let r=await this.caller.call(y(),`${this.apiUrl}/annotation-queues/${V(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((e,t)=>V(e,`runIds[${t}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){let r=`/annotation-queues/${V(e,"queueId")}/run`,a=await this.caller.call(y(),`${this.apiUrl}${r}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Z(a,"get run from annotation queue"),await a.json()}async _currentTenantIsOwner(e){let t=await this._getSettings();return"-"==e||t.tenant_handle===e}async _ownerConflictError(e,t){let r=await this._getSettings();return Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){let t=await this.caller.call(y(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await t.json();if(!t.ok){let e="string"==typeof r.detail?r.detail:JSON.stringify(r.detail),a=Error(`Error ${t.status}: ${t.statusText}
${e}`);throw a.statusCode=t.status,a}if(0!==r.commits.length)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){let[r,a,s]=X(e),i=await this.caller.call(y(),`${this.apiUrl}/likes/${r}/${a}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Z(i,`${t?"like":"unlike"} prompt`),await i.json()}async _getPromptUrl(e){let[t,r,a]=X(e);if(await this._currentTenantIsOwner(t)){let e=await this._getSettings();return"latest"!==a?`${this.getHostUrl()}/prompts/${r}/${a.substring(0,8)}?organizationId=${e.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${e.id}`}return"latest"!==a?`${this.getHostUrl()}/hub/${t}/${r}/${a.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${r}`}async promptExists(e){let t=await this.getPrompt(e);return!!t}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async *listCommits(e){for await(let t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,e=>e.commits))yield*t}async *listPrompts(e){let t=new URLSearchParams;for await(let r of(t.append("sort_field",e?.sortField??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!e?.isArchived).toString()),e?.isPublic!==void 0&&t.append("is_public",e.isPublic.toString()),e?.query&&t.append("query",e.query),this._getPaginated("/repos",t,e=>e.repos)))yield*r}async getPrompt(e){let[t,r,a]=X(e),s=await this.caller.call(y(),`${this.apiUrl}/repos/${t}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(404===s.status)return null;await Z(s,"get prompt");let i=await s.json();return i.repo?i.repo:null}async createPrompt(e,t){let r=await this._getSettings();if(t?.isPublic&&!r.tenant_handle)throw Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);let[a,s,i]=X(e);if(!await this._currentTenantIsOwner(a))throw await this._ownerConflictError("create a prompt",a);let n={repo_handle:s,...t?.description&&{description:t.description},...t?.readme&&{readme:t.readme},...t?.tags&&{tags:t.tags},is_public:!!t?.isPublic},o=await this.caller.call(y(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(o,"create prompt");let{repo:l}=await o.json();return l}async createCommit(e,t,r){if(!await this.promptExists(e))throw Error("Prompt does not exist, you must create it first.");let[a,s,i]=X(e),n=r?.parentCommitHash!=="latest"&&r?.parentCommitHash?r?.parentCommitHash:await this._getLatestCommitHash(`${a}/${s}`),o={manifest:JSON.parse(JSON.stringify(t)),parent_commit:n},l=await this.caller.call(y(),`${this.apiUrl}/commits/${a}/${s}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(l,"create commit");let E=await l.json();return this._getPromptUrl(`${a}/${s}${E.commit_hash?`:${E.commit_hash}`:""}`)}async updatePrompt(e,t){if(!await this.promptExists(e))throw Error("Prompt does not exist, you must create it first.");let[r,a]=X(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);let s={};if(t?.description!==void 0&&(s.description=t.description),t?.readme!==void 0&&(s.readme=t.readme),t?.tags!==void 0&&(s.tags=t.tags),t?.isPublic!==void 0&&(s.is_public=t.isPublic),t?.isArchived!==void 0&&(s.is_archived=t.isArchived),0===Object.keys(s).length)throw Error("No valid update options provided");let i=await this.caller.call(y(),`${this.apiUrl}/repos/${r}/${a}`,{method:"PATCH",body:JSON.stringify(s),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Z(i,"update prompt"),i.json()}async deletePrompt(e){if(!await this.promptExists(e))throw Error("Prompt does not exist, you must create it first.");let[t,r,a]=X(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);let s=await this.caller.call(y(),`${this.apiUrl}/repos/${t}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await s.json()}async pullPromptCommit(e,t){let[r,a,s]=X(e),i=await this._getServerInfo(),n=function(e,t){let r=(0,j.parse)(e),a=(0,j.parse)(t);if(!r||!a)throw Error("Invalid version format.");return r.compare(a)>=0}(i.version,"0.5.23"),o=s;if(!n&&"latest"===s){let e=await this._getLatestCommitHash(`${r}/${a}`);if(e)o=e;else throw Error("No commits found")}let l=await this.caller.call(y(),`${this.apiUrl}/commits/${r}/${a}/${o}${t?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Z(l,"pull prompt commit");let E=await l.json();return{owner:r,repo:a,commit_hash:E.commit_hash,manifest:E.manifest,examples:E.examples}}async _pullPrompt(e,t){let r=await this.pullPromptCommit(e,{includeModel:t?.includeModel}),a=JSON.stringify(r.manifest);return a}async pushPrompt(e,t){if(await this.promptExists(e)?t&&Object.keys(t).some(e=>"object"!==e)&&await this.updatePrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}):await this.createPrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}),!t?.object)return await this._getPromptUrl(e);let r=await this.createCommit(e,t?.object,{parentCommitHash:t?.parentCommitHash});return r}async clonePublicDataset(e,t={}){let{sourceApiUrl:r=this.apiUrl,datasetName:a}=t,[s,i]=this.parseTokenOrUrl(e,r),n=new el({apiUrl:s,apiKey:"placeholder"}),o=await n.readSharedDataset(i),l=a||o.name;try{if(await this.hasDataset({datasetId:l})){console.log(`Dataset ${l} already exists in your tenant. Skipping.`);return}}catch(e){}let E=await n.listSharedExamples(i),u=await this.createDataset(l,{description:o.description,dataType:o.data_type||"kv",inputsSchema:o.inputs_schema_definition??void 0,outputsSchema:o.outputs_schema_definition??void 0});try{await this.createExamples({inputs:E.map(e=>e.inputs),outputs:E.flatMap(e=>e.outputs?[e.outputs]:[]),datasetId:u.id})}catch(e){throw console.error(`An error occurred while creating dataset ${l}. You should delete it manually.`),e}}parseTokenOrUrl(e,t,r=2,a="dataset"){try{return V(e),[t,e]}catch(e){}try{let s=new URL(e),i=s.pathname.split("/").filter(e=>""!==e);if(i.length>=r){let e=i[i.length-r];return[t,e]}throw Error(`Invalid public ${a} URL: ${e}`)}catch(t){throw Error(`Invalid public ${a} URL or token: ${e}`)}}awaitPendingTraceBatches(){return Promise.all(this.autoBatchQueue.items.map(({itemPromise:e})=>e))}}let eE=e=>void 0!==e?e:!!["TRACING_V2","TRACING"].find(e=>"true"===k(e)),eu=Symbol.for("lc:context_variables");class ec{constructor(e,t){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t}static fromHeader(e){let t=e.split(","),r={},a=[];for(let e of t){let[t,s]=e.split("="),i=decodeURIComponent(s);"langsmith-metadata"===t?r=JSON.parse(i):"langsmith-tags"===t&&(a=i.split(","))}return new ec(r,a)}toHeader(){let e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class eT{constructor(e){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),function(e){return void 0!==e&&"function"==typeof e.createChild&&"function"==typeof e.postRun}(e)){Object.assign(this,{...e});return}let t=eT.getDefaultConfig(),{metadata:r,...a}=e,s=a.client??eT.getSharedClient(),i={...r,...a?.extra?.metadata};if(a.extra={...a.extra,metadata:i},Object.assign(this,{...t,...a,client:s}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??=1,this.child_execution_order??=1,!this.dotted_order){let e=function(e,t,r=1){let a=r.toFixed(0).slice(0,3).padStart(3,"0");return`${new Date(e).toISOString().slice(0,-1)}${a}Z`.replace(/[-:.]/g,"")+t}(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+e:this.dotted_order=e}}static getDefaultConfig(){return{id:f(),run_type:"chain",project_name:x("LANGCHAIN_PROJECT")??x("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:x("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:x("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return eT.sharedClient||(eT.sharedClient=new el),eT.sharedClient}createChild(e){var t;let r=this.child_execution_order+1,a=new eT({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:r,child_execution_order:r});eu in this&&(a[eu]=this[eu]);let s=Symbol.for("lc:child_config"),i=e.extra?.[s]??this.extra[s];if(void 0!==i&&"object"==typeof i.callbacks&&(eh(i.callbacks?.handlers)||eh(i.callbacks))){let e={...i},r="object"==typeof(t=e.callbacks)&&null!=t&&Array.isArray(t.handlers)?e.callbacks.copy?.():void 0;r&&(Object.assign(r,{_parentRunId:a.id}),r.handlers?.find(ed)?.updateFromRunTree?.(a),e.callbacks=r),a.extra[s]=e}let n=new Set,o=this;for(;null!=o&&!n.has(o.id);)n.add(o.id),o.child_execution_order=Math.max(o.child_execution_order,r),o=o.parent_run;return this.child_runs.push(a),a}async end(e,t,r=Date.now(),a){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??r,a&&Object.keys(a).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...a}}:{metadata:a})}_convertToCreate(e,t,r=!0){let a,s;let i=e.extra??{};if(i.runtime||(i.runtime={}),t)for(let[e,r]of Object.entries(t))i.runtime[e]||(i.runtime[e]=r);r?(s=e.parent_run?.id,a=[]):(a=e.child_runs.map(e=>this._convertToCreate(e,t,r)),s=void 0);let n={id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:i,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:s,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags};return n}async postRun(e=!0){try{let t=H(),r=await this._convertToCreate(this,t,!0);if(await this.client.createRun(r),!e)for(let e of(W("Posting with excludeChildRuns=false is deprecated and will be removed in a future version."),this.child_runs))await e.postRun(!1)}catch(e){console.error(`Error in postRun for run ${this.id}:`,e)}}async patchRun(){try{let e={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:this.parent_run?.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags};await this.client.updateRun(this.id,e)}catch(e){console.error(`Error in patchRun for run ${this.id}`,e)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,t){let r,a,s;let i=e?.callbacks,n=eE();if(i){let e=i?.getParentRunId?.()??"",t=i?.handlers?.find(e=>e?.name=="langchain_tracer");r=t?.getRun?.(e),a=t?.projectName,s=t?.client,n=n||!!t}if(!r)return new eT({...t,client:s,tracingEnabled:n,project_name:a});let o=new eT({name:r.name,id:r.id,trace_id:r.trace_id,dotted_order:r.dotted_order,client:s,tracingEnabled:n,project_name:a,tags:[...new Set((r?.tags??[]).concat(e?.tags??[]))],extra:{metadata:{...r?.extra?.metadata,...e?.metadata}}});return o.createChild(t)}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){let r="get"in e&&"function"==typeof e.get?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,a=r["langsmith-trace"];if(!a||"string"!=typeof a)return;let s=a.trim(),i=s.split(".").map(e=>{let[t,r]=e.split("Z");return{strTime:t,time:Date.parse(t+"Z"),uuid:r}}),n=i[0].uuid,o={...t,name:t?.name??"parent",run_type:t?.run_type??"chain",start_time:t?.start_time??Date.now(),id:i.at(-1)?.uuid,trace_id:n,dotted_order:s};if(r.baggage&&"string"==typeof r.baggage){let e=ec.fromHeader(r.baggage);o.metadata=e.metadata,o.tags=e.tags}return new eT(o)}toHeaders(e){let t={"langsmith-trace":this.dotted_order,baggage:new ec(this.extra?.metadata,this.tags).toHeader()};if(e)for(let[r,a]of Object.entries(t))e.set(r,a);return t}}function ed(e){return"object"==typeof e&&null!=e&&"string"==typeof e.name&&"langchain_tracer"===e.name}function eh(e){return Array.isArray(e)&&e.some(e=>ed(e))}Object.defineProperty(eT,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});let eA="0.1.68";var ep=r(35387);class eR extends u.Z{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let{exampleId:t,projectName:r,client:a}=e;this.projectName=r??(0,ep.lS)("LANGCHAIN_PROJECT")??(0,ep.lS)("LANGCHAIN_SESSION"),this.exampleId=t,this.client=a??new el({})}async _convertToCreate(e,t){return{...e,extra:{...e.extra,runtime:await (0,ep.sA)()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){let t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){let t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}}var eS=r(2576);async function e_(){return new eR}async function eO(e,t){!0===t?await e():(void 0===n&&(n=function(){let e=m.default;return new e({autoStart:!0,concurrency:1})}()),n.add(e))}function eI(e){return e?Array.isArray(e)||"name"in e?{callbacks:e}:e:{}}class ef{setHandler(e){return this.setHandlers([e])}}class eN{constructor(e,t,r,a,s,i,n,o){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:o})}async handleText(e){await Promise.all(this.handlers.map(t=>eO(async()=>{try{await t.handleText?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleText: ${e}`)}},t.awaitHandlers)))}}class em extends eN{getChild(e){let t=new eg(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleRetriever`)}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleRetrieverError: ${e}`)}},t.awaitHandlers)))}}class eC extends eN{async handleLLMNewToken(e,t,r,a,s,i){await Promise.all(this.handlers.map(r=>eO(async()=>{if(!r.ignoreLLM)try{await r.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,i)}catch(e){console.error(`Error in handler ${r.constructor.name}, handleLLMNewToken: ${e}`)}},r.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreLLM)try{await t.handleLLMError?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleLLMError: ${e}`)}},t.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreLLM)try{await t.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleLLMEnd: ${e}`)}},t.awaitHandlers)))}}class eL extends eN{getChild(e){let t=new eg(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,a,s){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreChain)try{await t.handleChainError?.(e,this.runId,this._parentRunId,this.tags,s)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleChainError: ${e}`)}},t.awaitHandlers)))}async handleChainEnd(e,t,r,a,s){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreChain)try{await t.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,s)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleChainEnd: ${e}`)}},t.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreAgent)try{await t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleAgentAction: ${e}`)}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreAgent)try{await t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleAgentEnd: ${e}`)}},t.awaitHandlers)))}}class ey extends eN{getChild(e){let t=new eg(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreAgent)try{await t.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleToolError: ${e}`)}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>eO(async()=>{if(!t.ignoreAgent)try{await t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){console.error(`Error in handler ${t.constructor.name}, handleToolEnd: ${e}`)}},t.awaitHandlers)))}}class eg extends ef{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=t?.handlers??this.handlers,this.inheritableHandlers=t?.inheritableHandlers??this.inheritableHandlers,this.tags=t?.tags??this.tags,this.inheritableTags=t?.inheritableTags??this.inheritableTags,this.metadata=t?.metadata??this.metadata,this.inheritableMetadata=t?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,r,a,s,i,n,l){return Promise.all(t.map(async(t,a)=>{let i=0===a&&r?r:(0,o.Z)();return await Promise.all(this.handlers.map(r=>eO(async()=>{if(!r.ignoreLLM)try{await r.handleLLMStart?.(e,[t],i,this._parentRunId,s,this.tags,this.metadata,l)}catch(e){console.error(`Error in handler ${r.constructor.name}, handleLLMStart: ${e}`)}},r.awaitHandlers))),new eC(i,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r,a,s,i,n,l){return Promise.all(t.map(async(t,a)=>{let i=0===a&&r?r:(0,o.Z)();return await Promise.all(this.handlers.map(r=>eO(async()=>{if(!r.ignoreLLM)try{if(r.handleChatModelStart)await r.handleChatModelStart?.(e,[t],i,this._parentRunId,s,this.tags,this.metadata,l);else if(r.handleLLMStart){let a=(0,eS.zs)(t);await r.handleLLMStart?.(e,[a],i,this._parentRunId,s,this.tags,this.metadata,l)}}catch(e){console.error(`Error in handler ${r.constructor.name}, handleLLMStart: ${e}`)}},r.awaitHandlers))),new eC(i,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=(0,o.Z)(),a,s,i,n){return await Promise.all(this.handlers.map(s=>eO(async()=>{if(!s.ignoreChain)try{await s.handleChainStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,a,n)}catch(e){console.error(`Error in handler ${s.constructor.name}, handleChainStart: ${e}`)}},s.awaitHandlers))),new eL(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=(0,o.Z)(),a,s,i,n){return await Promise.all(this.handlers.map(a=>eO(async()=>{if(!a.ignoreAgent)try{await a.handleToolStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,n)}catch(e){console.error(`Error in handler ${a.constructor.name}, handleToolStart: ${e}`)}},a.awaitHandlers))),new ey(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=(0,o.Z)(),a,s,i,n){return await Promise.all(this.handlers.map(a=>eO(async()=>{if(!a.ignoreRetriever)try{await a.handleRetrieverStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,n)}catch(e){console.error(`Error in handler ${a.constructor.name}, handleRetrieverStart: ${e}`)}},a.awaitHandlers))),new em(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){for(let r of(this.handlers=[],this.inheritableHandlers=[],e))this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(let t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){let r=new eg(this._parentRunId);for(let e of this.handlers){let t=this.inheritableHandlers.includes(e);r.addHandler(e,t)}for(let e of this.tags){let t=this.inheritableTags.includes(e);r.addTags([e],t)}for(let e of Object.keys(this.metadata)){let t=Object.keys(this.inheritableMetadata).includes(e);r.addMetadata({[e]:this.metadata[e]},t)}for(let a of e)r.handlers.filter(e=>"console_callback_handler"===e.name).some(e=>e.name===a.name)||r.addHandler(a,t);return r}static fromHandlers(e){class t extends l.E{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:(0,o.Z)()}),Object.assign(this,e)}}let r=new this;return r.addHandler(new t),r}static async configure(e,t,r,a,s,i,n){let o;(e||t)&&(Array.isArray(e)||!e?(o=new eg).setHandlers(e?.map(eP)??[],!0):o=e,o=o.copy(Array.isArray(t)?t.map(eP):t?.handlers,!1));let l="true"===(0,ep.lS)("LANGCHAIN_VERBOSE")||n?.verbose,E="true"===(0,ep.lS)("LANGCHAIN_TRACING_V2"),u=E||((0,ep.lS)("LANGCHAIN_TRACING")??!1);if(l||u){if(o||(o=new eg),l&&!o.handlers.some(e=>e.name===A.prototype.name)){let e=new A;o.addHandler(e,!0)}u&&!o.handlers.some(e=>"langchain_tracer"===e.name)&&E&&o.addHandler(await e_(),!0)}return(r||a)&&o&&(o.addTags(r??[]),o.addTags(a??[],!1)),(s||i)&&o&&(o.addMetadata(s??{}),o.addMetadata(i??{},!1)),o}}function eP(e){return"name"in e?e:l.E.fromMethods(e)}},48548:(e,t,r)=>{"use strict";r.d(t,{BD:()=>c,qV:()=>T});var a=r(62281),s=r(43527),i=r(2576),n=r(66188),o=r(26504),l=r(44349);let E=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e,u=()=>!1;class c extends l.eq{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??u(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class T extends c{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){super({callbacks:e??t,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"object"==typeof r.cache?this.cache=r.cache:r.cache?this.cache=a.h4.global():this.cache=void 0,this.caller=new n.L(r??{})}async getNumTokens(e){if("string"!=typeof e)return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await (0,o.b)("modelName"in this?E(this.modelName):"gpt2")}catch(e){console.warn("Failed to calculate number of tokens, falling back to approximate count",e)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(e){console.warn("Failed to calculate number of tokens, falling back to approximate count",e)}return t}static _convertInputToPromptValue(e){return"string"==typeof e?new s.nw(e):Array.isArray(e)?new s.GU(e.map(i.E1)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){let r={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()},a=Object.entries(r).filter(([e,t])=>void 0!==t),s=a.map(([e,t])=>`${e}:${JSON.stringify(t)}`).sort().join(",");return s}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw Error("Use .toJSON() instead")}}},57830:(e,t,r)=>{"use strict";r.d(t,{i:()=>o,j:()=>n});var a=r(75571);function s(e,t){return t?.[e]||a(e)}function i(e){return Array.isArray(e)?[...e]:{...e}}function n(e){let t=Object.getPrototypeOf(e),r="function"==typeof e.lc_name&&("function"!=typeof t.lc_name||e.lc_name()!==t.lc_name());return r?e.lc_name():e.name}r(86697);class o{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,n(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable||this.lc_kwargs instanceof o||"object"!=typeof this.lc_kwargs||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();let e={},t={},r=Object.keys(this.lc_kwargs).reduce((e,t)=>(e[t]=t in this?this[t]:this.lc_kwargs[t],e),{});for(let a=Object.getPrototypeOf(this);a;a=Object.getPrototypeOf(a))Object.assign(e,Reflect.get(a,"lc_aliases",this)),Object.assign(t,Reflect.get(a,"lc_secrets",this)),Object.assign(r,Reflect.get(a,"lc_attributes",this));return Object.keys(t).forEach(e=>{let t=this,a=r,[s,...i]=e.split(".").reverse();for(let e of i.reverse()){if(!(e in t)||void 0===t[e])return;e in a&&void 0!==a[e]||("object"==typeof t[e]&&null!=t[e]?a[e]={}:Array.isArray(t[e])&&(a[e]=[])),t=t[e],a=a[e]}s in t&&void 0!==t[s]&&(a[s]=a[s]||t[s])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:function(e,t,r){let a={};for(let s in e)Object.hasOwn(e,s)&&(a[t(s,r)]=e[s]);return a}(Object.keys(t).length?function(e,t){let r=i(e);for(let[e,a]of Object.entries(t)){let[t,...s]=e.split(".").reverse(),n=r;for(let e of s.reverse()){if(void 0===n[e])break;n[e]=i(n[e]),n=n[e]}void 0!==n[t]&&(n[t]={lc:1,type:"secret",id:[a]})}return r}(r,t):r,s,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}},34591:(e,t,r)=>{"use strict";r.d(t,{gY:()=>i,GC:()=>n});var a=r(1210),s=r(92746);class i extends a.ku{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){let r;if("string"==typeof e)r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{r=e;let t=r.additional_kwargs?.tool_calls,a=r.tool_calls;null!=t&&t.length>0&&(void 0===a||0===a.length)&&console.warn("New LangChain packages are available that more efficiently handle tool calling.\n\nPlease upgrade your packages to versions that set message tool calls. e.g., `yarn add @langchain/anthropic`, yarn add @langchain/openai`, etc.");try{if(null!=t&&void 0===a){let[e,a]=(0,s.jC)(t);r.tool_calls=e??[],r.invalid_tool_calls=a??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch(e){r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),"string"!=typeof r&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls)}static lc_name(){return"AIMessage"}_getType(){return"ai"}}class n extends a.$k{constructor(e){let t;if("string"==typeof e)t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(void 0===e.tool_call_chunks)t={...e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else{let r=[],a=[];for(let t of e.tool_call_chunks){let e={};try{if(e=function(e){if(void 0===e)return null;try{return JSON.parse(e)}catch(e){}let t="",r=[],a=!1,s=!1;for(let i of e){if(a)'"'!==i||s?"\n"!==i||s?s="\\"===i&&!s:i="\\n":a=!1;else if('"'===i)a=!0,s=!1;else if("{"===i)r.push("}");else if("["===i)r.push("]");else if("}"===i||"]"===i){if(!r||r[r.length-1]!==i)return null;r.pop()}t+=i}a&&(t+='"');for(let e=r.length-1;e>=0;e-=1)t+=r[e];try{return JSON.parse(t)}catch(e){return null}}(t.args??"{}")??{},"object"!=typeof e||Array.isArray(e))throw Error("Malformed tool call chunk args.");r.push({name:t.name??"",args:e,id:t.id})}catch(e){a.push({name:t.name,args:t.args,id:t.id,error:"Malformed args."})}}t={...e,tool_calls:r,invalid_tool_calls:a}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.tool_call_chunks=t?.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t?.tool_calls??this.tool_calls,this.invalid_tool_calls=t?.invalid_tool_calls??this.invalid_tool_calls}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}concat(e){let t={content:(0,a.Wf)(this.content,e.content),additional_kwargs:(0,a.wv)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,a.wv)(this.response_metadata,e.response_metadata),tool_call_chunks:[]};if(void 0!==this.tool_call_chunks||void 0!==e.tool_call_chunks){let r=(0,a.eL)(this.tool_call_chunks,e.tool_call_chunks);void 0!==r&&r.length>0&&(t.tool_call_chunks=r)}return new n(t)}}},1210:(e,t,r)=>{"use strict";r.d(t,{$k:()=>l,QW:()=>E,Wf:()=>s,eL:()=>o,ku:()=>i,wv:()=>n});var a=r(57830);function s(e,t){return"string"==typeof e?"string"==typeof t?e+t:[{type:"text",text:e},...t]:Array.isArray(t)?[...e,...t]:[...e,{type:"text",text:t}]}class i extends a.i{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return"string"==typeof this.content?this.content:""}constructor(e,t){"string"==typeof e&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}}function n(e,t){let r={...e};for(let[e,a]of Object.entries(t))if(null==r[e])r[e]=a;else if(null==a)continue;else if(typeof r[e]!=typeof a||Array.isArray(r[e])!==Array.isArray(a))throw Error(`field[${e}] already exists in the message chunk, but with a different type.`);else if("string"==typeof r[e])r[e]=r[e]+a;else if(Array.isArray(r[e])||"object"!=typeof r[e]){if(Array.isArray(r[e]))r[e]=o(r[e],a);else{if(r[e]===a)continue;console.warn(`field[${e}] already exists in this message chunk and value has unsupported type.`)}}else r[e]=n(r[e],a);return r}function o(e,t){if(void 0!==e||void 0!==t){if(void 0===e||void 0===t)return e||t;{let r=[...e];for(let e of t)if("object"==typeof e&&"index"in e&&"number"==typeof e.index){let t=r.findIndex(t=>t.index===e.index);-1!==t?r[t]=n(r[t],e):r.push(e)}else r.push(e);return r}}}class l extends i{}function E(e){return"function"==typeof e?._getType}},60842:(e,t,r)=>{"use strict";r.d(t,{H:()=>i,J:()=>s});var a=r(1210);class s extends a.ku{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return s}constructor(e,t){"string"==typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return"generic"===e._getType()}}class i extends a.$k{static lc_name(){return"ChatMessageChunk"}constructor(e,t){"string"==typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new i({content:(0,a.Wf)(this.content,e.content),additional_kwargs:(0,a.wv)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,a.wv)(this.response_metadata,e.response_metadata),role:this.role})}}},33313:(e,t,r)=>{"use strict";r.d(t,{C:()=>s});var a=r(1210);class s extends a.$k{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new s({content:(0,a.Wf)(this.content,e.content),additional_kwargs:(0,a.wv)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,a.wv)(this.response_metadata,e.response_metadata),name:this.name??""})}}},80767:(e,t,r)=>{"use strict";r.d(t,{r:()=>i,x:()=>s});var a=r(1210);class s extends a.ku{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class i extends a.$k{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new i({content:(0,a.Wf)(this.content,e.content),additional_kwargs:(0,a.wv)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,a.wv)(this.response_metadata,e.response_metadata)})}}},2576:(e,t,r)=>{"use strict";r.d(t,{Cr:()=>n.C,E1:()=>E.E1,GC:()=>a.GC,HD:()=>i.H,J:()=>i.J,QW:()=>s.QW,Xz:()=>u.Xz,gY:()=>a.gY,jN:()=>l.j,ku:()=>s.ku,ro:()=>o.r,xk:()=>o.x,xq:()=>l.x,zs:()=>E.zs});var a=r(34591),s=r(1210),i=r(60842),n=r(33313),o=r(80767),l=r(16008),E=r(983),u=r(92746)},16008:(e,t,r)=>{"use strict";r.d(t,{j:()=>s,x:()=>i});var a=r(1210);class s extends a.ku{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class i extends a.$k{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new i({content:(0,a.Wf)(this.content,e.content),additional_kwargs:(0,a.wv)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,a.wv)(this.response_metadata,e.response_metadata)})}}},92746:(e,t,r)=>{"use strict";r.d(t,{Xz:()=>s,jC:()=>i});var a=r(1210);class s extends a.$k{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new s({content:(0,a.Wf)(this.content,e.content),additional_kwargs:(0,a.wv)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,a.wv)(this.response_metadata,e.response_metadata),tool_call_id:this.tool_call_id})}}function i(e){let t=[],r=[];for(let a of e)if(a.function){let e=a.function.name;try{let r=JSON.parse(a.function.arguments),s={name:e||"",args:r||{},id:a.id};t.push(s)}catch(t){r.push({name:e,args:a.function.arguments,id:a.id,error:"Malformed args."})}}return[t,r]}},983:(e,t,r)=>{"use strict";r.d(t,{E1:()=>o,zs:()=>l});var a=r(1210),s=r(80767),i=r(34591),n=r(16008);function o(e){if("string"==typeof e)return new s.x(e);if((0,a.QW)(e))return e;let[t,r]=e;if("human"===t||"user"===t)return new s.x({content:r});if("ai"===t||"assistant"===t)return new i.gY({content:r});if("system"===t)return new n.j({content:r});throw Error("Unable to coerce message from array: only human, AI, or system message coercion is currently supported.")}function l(e,t="Human",r="AI"){let a=[];for(let s of e){let e;if("human"===s._getType())e=t;else if("ai"===s._getType())e=r;else if("system"===s._getType())e="System";else if("function"===s._getType())e="Function";else if("tool"===s._getType())e="Tool";else if("generic"===s._getType())e=s.role;else throw Error(`Got unsupported message type: ${s._getType()}`);let i=s.name?`${s.name}, `:"";a.push(`${e}: ${i}${s.content}`)}return a.join("\n")}r(60842),r(33313),r(92746)},40247:(e,t,r)=>{"use strict";r.d(t,{Ls:()=>i,WH:()=>a});let a="__run";class s{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new s({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class i extends s{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new i({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}},43527:(e,t,r)=>{"use strict";r.d(t,{GU:()=>o,Nn:()=>l,nw:()=>n});var a=r(57830),s=r(2576);class i extends a.i{}class n extends i{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new s.xk(this.value)]}}class o extends i{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return(0,s.zs)(this.messages)}toChatMessages(){return this.messages}}class l extends i{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new s.xk({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}},17784:(e,t,r)=>{"use strict";r.d(t,{d:()=>s});var a=r(44349);class s extends a.eq{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let{inputVariables:t}=e;if(t.includes("stop"))throw Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){let t=this.partialVariables??{},r={};for(let[e,a]of Object.entries(t))"string"==typeof a?r[e]=a:r[e]=await a();let a={...r,...e};return a}async invoke(e,t){return this._callWithConfig(e=>this.formatPromptValue(e),e,{...t,runType:"prompt"})}serialize(){throw Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{let{PromptTemplate:t}=await Promise.resolve().then(r.bind(r,20508));return t.deserialize(e)}case void 0:{let{PromptTemplate:t}=await Promise.resolve().then(r.bind(r,20508));return t.deserialize({...e,_type:"prompt"})}case"few_shot":{let{FewShotPromptTemplate:t}=await Promise.resolve().then(r.bind(r,18766));return t.deserialize(e)}default:throw Error(`Invalid prompt type in config: ${e._type}`)}}}},95295:(e,t,r)=>{"use strict";r.d(t,{gc:()=>S,kq:()=>R,ks:()=>O,ov:()=>_});var a=r(2576),s=r(43527),i=r(44349),n=r(94237),o=r(17784),l=r(20508),E=r(91834),u=r(22367);class c extends i.eq{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,t){return this._callWithConfig(e=>this.formatMessages(e),e,{...t,runType:"prompt"})}}class T extends c{static lc_name(){return"MessagesPlaceholder"}constructor(e){"string"==typeof e&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}validateInputOrThrow(e,t){if(this.optional&&!e)return!1;if(!e){let e=Error(`Error: Field "${t}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw e.name="InputFormatError",e}if(!(Array.isArray(e)?e.every(e=>(0,a.QW)(e)):(0,a.QW)(e))){let r="string"==typeof e?e:JSON.stringify(e,null,2),a=Error(`Error: Field "${t}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: ${r}`);throw a.name="InputFormatError",a}return!0}async formatMessages(e){return this.validateInputOrThrow(e[this.variableName],this.variableName),e[this.variableName]??[]}}class d extends c{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class h extends o.d{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){let t=await this.formatMessages(e);return new s.GU(t)}}class A extends d{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,t){"prompt"in e||(e={prompt:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new a.J(await this.prompt.format(e),this.role)}static fromTemplate(e,t,r){return new this(l.PromptTemplate.fromTemplate(e,{templateFormat:r?.templateFormat}),t)}}class p extends c{static _messageClass(){throw Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,t){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let e=[];this.prompt.forEach(t=>{"inputVariables"in t&&(e=e.concat(t.inputVariables))}),this.inputVariables=e}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=t??this.additionalOptions}createMessage(e){let t=this.constructor;if(t._messageClass()){let r=t._messageClass();return new r({content:e})}if(t.chatMessageClass){let r=t.chatMessageClass();return new r({content:e,role:this.getRoleFromMessageClass(r.lc_name())})}throw Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw Error("Invalid message class name")}}static fromTemplate(e,t){if("string"==typeof e)return new this(l.PromptTemplate.fromTemplate(e,t));let r=[];for(let t of e)if("string"==typeof t||"object"==typeof t&&"text"in t){let e="";"string"==typeof t?e=t:"string"==typeof t.text&&(e=t.text??""),r.push(l.PromptTemplate.fromTemplate(e))}else if("object"==typeof t&&"image_url"in t){let e,a=t.image_url??"",s=[];if("string"==typeof a){let t=(0,u._O)(a),r=t.flatMap(e=>"variable"===e.type?[e.name]:[]);if((r?.length??0)>0){if(r.length>1)throw Error(`Only one format variable allowed per image template.
Got: ${r}
From: ${a}`);s=[r[0]]}else s=[];a={url:a},e=new E.r({template:a,inputVariables:s})}else if("object"==typeof a){if("url"in a){let e=(0,u._O)(a.url);s=e.flatMap(e=>"variable"===e.type?[e.name]:[])}else s=[];e=new E.r({template:a,inputVariables:s})}else throw Error("Invalid image template");r.push(e)}return new this({prompt:r,additionalOptions:t})}async format(e){if(this.prompt instanceof n.A){let t=await this.prompt.format(e);return this.createMessage(t)}{let t=[];for(let r of this.prompt){let a={};if(!("inputVariables"in r))throw Error(`Prompt ${r} does not have inputVariables defined.`);for(let t of r.inputVariables)a||(a={[t]:e[t]}),a={...a,[t]:e[t]};if(r instanceof n.A){let e=await r.format(a);t.push({type:"text",text:e})}else if(r instanceof E.r){let e=await r.format(a);t.push({type:"image_url",image_url:e})}}return this.createMessage(t)}}async formatMessages(e){return[await this.format(e)]}}class R extends p{static _messageClass(){return a.xk}static lc_name(){return"HumanMessagePromptTemplate"}}class S extends p{static _messageClass(){return a.gY}static lc_name(){return"AIMessagePromptTemplate"}}class _ extends p{static _messageClass(){return a.jN}static lc_name(){return"SystemMessagePromptTemplate"}}class O extends h{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),"mustache"===e.templateFormat&&void 0===e.validateTemplate&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){let e=new Set;for(let t of this.promptMessages)if(!(t instanceof a.ku))for(let r of t.inputVariables)e.add(r);let t=this.inputVariables,r=new Set(this.partialVariables?t.concat(Object.keys(this.partialVariables)):t),s=new Set([...r].filter(t=>!e.has(t)));if(s.size>0)throw Error(`Input variables \`${[...s]}\` are not used in any of the prompt messages.`);let i=new Set([...e].filter(e=>!r.has(e)));if(i.size>0)throw Error(`Input variables \`${[...i]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,t){if("string"==typeof e.content)return e;let r=await Promise.all(e.content.map(async e=>{if("image_url"!==e.type)return e;let r="";r="string"==typeof e.image_url?e.image_url:e.image_url.url;let a=l.PromptTemplate.fromTemplate(r),s=await a.format(t);return"string"!=typeof e.image_url&&"url"in e.image_url?e.image_url.url=s:e.image_url=s,e}));return e.content=r,e}async formatMessages(e){let t=await this.mergePartialAndUserVariables(e),r=[];for(let e of this.promptMessages)if(e instanceof a.ku)r.push(await this._parseImagePrompts(e,t));else{let a=e.inputVariables.reduce((r,a)=>{if(!(a in t)&&!("MessagesPlaceholder"===e.constructor.lc_name()&&e.optional))throw Error(`Missing value for input variable \`${a.toString()}\``);return r[a]=t[a],r},{}),s=await e.formatMessages(a);r=r.concat(s)}return r}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e},a={...this,inputVariables:t,partialVariables:r};return new O(a)}static fromTemplate(e,t){let r=l.PromptTemplate.fromTemplate(e,t),a=new R({prompt:r});return this.fromMessages([a])}static fromMessages(e,t){let r=e.reduce((e,r)=>e.concat(r instanceof O?r.promptMessages:[function(e,t){let r;if("function"==typeof e.formatMessages||(0,a.QW)(e))return e;if(Array.isArray(e)&&"placeholder"===e[0]){let t=e[1];if("string"!=typeof t||"{"!==t[0]||"}"!==t[t.length-1])throw Error(`Invalid placeholder template: "${e[1]}". Expected a variable name surrounded by curly braces.`);let r=t.slice(1,-1);return new T({variableName:r,optional:!0})}let s=(0,a.E1)(e);if(r="string"==typeof s.content?s.content:s.content.map(e=>"text"in e?{text:e.text}:"image_url"in e?{image_url:e.image_url}:e),"human"===s._getType())return R.fromTemplate(r,t);if("ai"===s._getType())return S.fromTemplate(r,t);if("system"===s._getType())return _.fromTemplate(r,t);if(a.J.isInstance(s))return A.fromTemplate(s.content,s.role,t);throw Error(`Could not coerce message prompt template from input. Received message type: "${s._getType()}".`)}(r,t)]),[]),s=e.reduce((e,t)=>t instanceof O?Object.assign(e,t.partialVariables):e,Object.create(null)),i=new Set;for(let e of r)if(!(e instanceof a.ku))for(let t of e.inputVariables)t in s||i.add(t);return new this({...t,inputVariables:[...i],promptMessages:r,partialVariables:s,templateFormat:t?.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}},18766:(e,t,r)=>{"use strict";r.d(t,{FewShotPromptTemplate:()=>n});var a=r(94237),s=r(22367),i=r(20508);r(95295);class n extends a.A{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:"\n\n"}),Object.defineProperty(this,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),void 0!==this.examples&&void 0!==this.exampleSelector)throw Error("Only one of 'examples' and 'example_selector' should be provided");if(void 0===this.examples&&void 0===this.exampleSelector)throw Error("One of 'examples' and 'example_selector' should be provided");if(this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,s.af)(this.prefix+this.suffix,this.templateFormat,e)}}_getPromptType(){return"few_shot"}static lc_name(){return"FewShotPromptTemplate"}async getExamples(e){if(void 0!==this.examples)return this.examples;if(void 0!==this.exampleSelector)return this.exampleSelector.selectExamples(e);throw Error("One of 'examples' and 'example_selector' should be provided")}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e},a={...this,inputVariables:t,partialVariables:r};return new n(a)}async format(e){let t=await this.mergePartialAndUserVariables(e),r=await this.getExamples(t),a=await Promise.all(r.map(e=>this.examplePrompt.format(e))),i=[this.prefix,...a,this.suffix].join(this.exampleSeparator);return(0,s.SM)(i,this.templateFormat,t)}serialize(){if(this.exampleSelector||!this.examples)throw Error("Serializing an example selector is not currently supported");if(void 0!==this.outputParser)throw Error("Serializing an output parser is not currently supported");return{_type:this._getPromptType(),input_variables:this.inputVariables,example_prompt:this.examplePrompt.serialize(),example_separator:this.exampleSeparator,suffix:this.suffix,prefix:this.prefix,template_format:this.templateFormat,examples:this.examples}}static async deserialize(e){let t;let{example_prompt:r}=e;if(!r)throw Error("Missing example prompt");let a=await i.PromptTemplate.deserialize(r);if(Array.isArray(e.examples))t=e.examples;else throw Error("Invalid examples format. Only list or string are supported.");return new n({inputVariables:e.input_variables,examplePrompt:a,examples:t,exampleSeparator:e.example_separator,prefix:e.prefix,suffix:e.suffix,templateFormat:e.template_format})}}},91834:(e,t,r)=>{"use strict";r.d(t,{r:()=>n});var a=r(43527),s=r(17784),i=r(22367);class n extends s.d{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,i.af)([{type:"image_url",image_url:this.template}],this.templateFormat,e)}}_getPromptType(){return"prompt"}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e},a={...this,inputVariables:t,partialVariables:r};return new n(a)}async format(e){let t={};for(let[r,a]of Object.entries(this.template))"string"==typeof a?t[r]=a.replace(/{([^{}]*)}/g,(t,r)=>{let a=e[r];return"string"==typeof a||"number"==typeof a?String(a):t}):t[r]=a;let r=e.url||t.url,a=e.detail||t.detail;if(!r)throw Error("Must provide either an image URL.");if("string"!=typeof r)throw Error("url must be a string.");let s={url:r};return a&&(s.detail=a),s}async formatPromptValue(e){let t=await this.format(e);return new a.Nn(t)}}},20508:(e,t,r)=>{"use strict";r.d(t,{PromptTemplate:()=>i});var a=r(94237),s=r(22367);class i extends a.A{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),"mustache"===e.templateFormat&&void 0===e.validateTemplate&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if("mustache"===this.templateFormat)throw Error("Mustache templates cannot be validated.");let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,s.af)(this.template,this.templateFormat,e)}}_getPromptType(){return"prompt"}async format(e){let t=await this.mergePartialAndUserVariables(e);return(0,s.SM)(this.template,this.templateFormat,t)}static fromExamples(e,t,r,a="\n\n",s=""){let n=[s,...e,t].join(a);return new i({inputVariables:r,template:n})}static fromTemplate(e,t){let{templateFormat:r="f-string",...a}=t??{},n=new Set;return(0,s.$M)(e,r).forEach(e=>{"variable"===e.type&&n.add(e.name)}),new i({inputVariables:[...n],templateFormat:r,template:e,...a})}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e},a={...this,inputVariables:t,partialVariables:r};return new i(a)}serialize(){if(void 0!==this.outputParser)throw Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw Error("Prompt template must have a template");let t=new i({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format});return t}}},94237:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(43527),s=r(17784);class i extends s.d{async formatPromptValue(e){let t=await this.format(e);return new a.nw(t)}}},22367:(e,t,r)=>{"use strict";r.d(t,{af:()=>y,_O:()=>I,$M:()=>L,SM:()=>C});/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var a=Object.prototype.toString,s=Array.isArray||function(e){return"[object Array]"===a.call(e)};function i(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"==typeof e&&t in e}var l=RegExp.prototype.test,E=/\S/,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,T=/\s+/,d=/\s*=/,h=/\s*\}/,A=/#|\^|\/|>|\{|&|=|!/;function p(e){this.string=e,this.tail=e,this.pos=0}function R(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function S(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}p.prototype.eos=function(){return""===this.tail},p.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},p.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case -1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},R.prototype.push=function(e){return new R(e,this)},R.prototype.lookup=function(e){var t=this.cache;if(t.hasOwnProperty(e))s=t[e];else{for(var r,a,s,n,l,E,u=this,c=!1;u;){if(e.indexOf(".")>0)for(n=u.view,l=e.split("."),E=0;null!=n&&E<l.length;)E===l.length-1&&(c=o(n,l[E])||(r=n,a=l[E],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(a))),n=n[l[E++]];else n=u.view[e],c=o(u.view,e);if(c){s=n;break}u=u.parent}t[e]=s}return i(s)&&(s=s.call(this.view)),s},S.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},S.prototype.parse=function(e,t){var r=this.templateCache,a=e+":"+(t||_.tags).join(":"),i=void 0!==r,o=i?r.get(a):void 0;return void 0==o&&(o=function(e,t){if(!e)return[];var r,a,i,o,u,R,S,O,I,f=!1,N=[],m=[],C=[],L=!1,y=!1,g="",P=0;function b(){if(L&&!y)for(;C.length;)delete m[C.pop()];else C=[];L=!1,y=!1}function D(e){if("string"==typeof e&&(e=e.split(T,2)),!s(e)||2!==e.length)throw Error("Invalid tags: "+e);r=RegExp(n(e[0])+"\\s*"),a=RegExp("\\s*"+n(e[1])),i=RegExp("\\s*"+n("}"+e[1]))}D(t||_.tags);for(var v=new p(e);!v.eos();){if(o=v.pos,R=v.scanUntil(r))for(var M,U=0,w=R.length;U<w;++U){(M=S=R.charAt(U),l.call(E,M))?(y=!0,f=!0,g+=" "):(C.push(m.length),g+=S),m.push(["text",S,o,o+1]),o+=1,"\n"===S&&(b(),g="",P=0,f=!1)}if(!v.scan(r))break;if(L=!0,u=v.scan(A)||"name",v.scan(c),"="===u?(R=v.scanUntil(d),v.scan(d),v.scanUntil(a)):"{"===u?(R=v.scanUntil(i),v.scan(h),v.scanUntil(a),u="&"):R=v.scanUntil(a),!v.scan(a))throw Error("Unclosed tag at "+v.pos);if(O=">"==u?[u,R,o,v.pos,g,P,f]:[u,R,o,v.pos],P++,m.push(O),"#"===u||"^"===u)N.push(O);else if("/"===u){if(!(I=N.pop()))throw Error('Unopened section "'+R+'" at '+o);if(I[1]!==R)throw Error('Unclosed section "'+I[1]+'" at '+o)}else"name"===u||"{"===u||"&"===u?y=!0:"="===u&&D(R)}if(b(),I=N.pop())throw Error('Unclosed section "'+I[1]+'" at '+v.pos);return function(e){for(var t,r=[],a=r,s=[],i=0,n=e.length;i<n;++i)switch((t=e[i])[0]){case"#":case"^":a.push(t),s.push(t),a=t[4]=[];break;case"/":s.pop()[5]=t[2],a=s.length>0?s[s.length-1][4]:r;break;default:a.push(t)}return r}(function(e){for(var t,r,a=[],s=0,i=e.length;s<i;++s)(t=e[s])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(a.push(t),r=t));return a}(m))}(e,t),i&&r.set(a,o)),o},S.prototype.render=function(e,t,r,a){var s=this.getConfigTags(a),i=this.parse(e,s),n=t instanceof R?t:new R(t,void 0);return this.renderTokens(i,n,r,e,a)},S.prototype.renderTokens=function(e,t,r,a,s){for(var i,n,o,l="",E=0,u=e.length;E<u;++E)o=void 0,"#"===(n=(i=e[E])[0])?o=this.renderSection(i,t,r,a,s):"^"===n?o=this.renderInverted(i,t,r,a,s):">"===n?o=this.renderPartial(i,t,r,s):"&"===n?o=this.unescapedValue(i,t):"name"===n?o=this.escapedValue(i,t,s):"text"===n&&(o=this.rawValue(i)),void 0!==o&&(l+=o);return l},S.prototype.renderSection=function(e,t,r,a,n){var o=this,l="",E=t.lookup(e[1]);if(E){if(s(E))for(var u=0,c=E.length;u<c;++u)l+=this.renderTokens(e[4],t.push(E[u]),r,a,n);else if("object"==typeof E||"string"==typeof E||"number"==typeof E)l+=this.renderTokens(e[4],t.push(E),r,a,n);else if(i(E)){if("string"!=typeof a)throw Error("Cannot use higher-order sections without the original template");null!=(E=E.call(t.view,a.slice(e[3],e[5]),function(e){return o.render(e,t,r,n)}))&&(l+=E)}else l+=this.renderTokens(e[4],t,r,a,n);return l}},S.prototype.renderInverted=function(e,t,r,a,i){var n=t.lookup(e[1]);if(!n||s(n)&&0===n.length)return this.renderTokens(e[4],t,r,a,i)},S.prototype.indentPartial=function(e,t,r){for(var a=t.replace(/[^ \t]/g,""),s=e.split("\n"),i=0;i<s.length;i++)s[i].length&&(i>0||!r)&&(s[i]=a+s[i]);return s.join("\n")},S.prototype.renderPartial=function(e,t,r,a){if(r){var s=this.getConfigTags(a),n=i(r)?r(e[1]):r[e[1]];if(null!=n){var o=e[6],l=e[5],E=e[4],u=n;0==l&&E&&(u=this.indentPartial(n,E,o));var c=this.parse(u,s);return this.renderTokens(c,t,r,u,a)}}},S.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(null!=r)return r},S.prototype.escapedValue=function(e,t,r){var a=this.getConfigEscape(r)||_.escape,s=t.lookup(e[1]);if(null!=s)return"number"==typeof s&&a===_.escape?String(s):a(s)},S.prototype.rawValue=function(e){return e[1]},S.prototype.getConfigTags=function(e){return s(e)?e:e&&"object"==typeof e?e.tags:void 0},S.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!s(e)?e.escape:void 0};var _={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(cache){O.templateCache=cache},get templateCache(){return O.templateCache}},O=new S;_.clearCache=function(){return O.clearCache()},_.parse=function(e,t){return O.parse(e,t)},_.render=function(e,t,r,a){if("string"!=typeof e)throw TypeError('Invalid template! Template should be a "string" but "'+(s(e)?"array":typeof e)+'" was given as the first argument for mustache#render(template, view, partials)');return O.render(e,t,r,a)},_.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return u[e]})},_.Scanner=p,_.Context=R,_.Writer=S;let I=e=>{let t=e.split(""),r=[],a=(e,r)=>{for(let a=r;a<t.length;a+=1)if(e.includes(t[a]))return a;return -1},s=0;for(;s<t.length;)if("{"===t[s]&&s+1<t.length&&"{"===t[s+1])r.push({type:"literal",text:"{"}),s+=2;else if("}"===t[s]&&s+1<t.length&&"}"===t[s+1])r.push({type:"literal",text:"}"}),s+=2;else if("{"===t[s]){let e=a("}",s);if(e<0)throw Error("Unclosed '{' in template.");r.push({type:"variable",name:t.slice(s+1,e).join("")}),s=e+1}else if("}"===t[s])throw Error("Single '}' in template.");else{let e=a("{}",s),i=(e<0?t.slice(s):t.slice(s,e)).join("");r.push({type:"literal",text:i}),s=e<0?t.length:e}return r},f=e=>e.map(e=>{if("name"===e[0]){let t=e[1].includes(".")?e[1].split(".")[0]:e[1];return{type:"variable",name:t}}return"#"===e[0]?{type:"variable",name:e[1]}:{type:"literal",text:e[1]}}),N={"f-string":(e,t)=>I(e).reduce((e,r)=>{if("variable"===r.type){if(r.name in t)return e+t[r.name];throw Error(`(f-string) Missing value for input ${r.name}`)}return e+r.text},""),mustache:(e,t)=>_.render(e,t)},m={"f-string":I,mustache:e=>{let t=_.parse(e);return f(t)}},C=(e,t,r)=>N[t](e,r),L=(e,t)=>m[t](e),y=(e,t,r)=>{if(!(t in N)){let e=Object.keys(N);throw Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${e}`)}try{let a=r.reduce((e,t)=>(e[t]="foo",e),{});Array.isArray(e)?e.forEach(e=>{if("text"===e.type)C(e.text,t,a);else if("image_url"===e.type){if("string"==typeof e.image_url)C(e.image_url,t,a);else{let r=e.image_url.url;C(r,t,a)}}else throw Error(`Invalid message template received. ${JSON.stringify(e,null,2)}`)}):C(e,t,a)}catch(e){throw Error(`Invalid prompt schema: ${e.message}`)}}},44349:(e,t,r)=>{"use strict";r.d(t,{eq:()=>D});var a=r(68332),s=r(31776),i=r(74311),n=r(76881),o=r(58519),l=r(63816),E=r(2576);class u{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){let t=this.ops.concat(e.ops),r=(0,n.af)({},t);return new c({ops:t,state:r[r.length-1].newDocument})}}class c extends u{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){let t=this.ops.concat(e.ops),r=(0,n.af)(this.state,e.ops);return new c({ops:t,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){let t=(0,n.af)({},e.ops);return new c({ops:e.ops,state:t[t.length-1].newDocument})}}async function T(e,t){if("original"===t)throw Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");let{inputs:r}=e;return["retriever","llm","prompt"].includes(e.run_type)?r:1!==Object.keys(r).length||r?.input!==""?r.input:void 0}async function d(e,t){let{outputs:r}=e;return"original"===t||["retriever","llm","prompt"].includes(e.run_type)?r:void 0!==r&&1===Object.keys(r).length&&r?.output!==void 0?r.output:r}class h extends o.Z{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=l.QJ.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;let t=e.tags??[],r=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(r=r||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(r=r||this.includeTypes.includes(e.run_type)),void 0!==this.includeTags&&(r=r||void 0!==t.find(e=>this.includeTags?.includes(e))),void 0!==this.excludeNames&&(r=r&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(r=r&&!this.excludeTypes.includes(e.run_type)),void 0!==this.excludeTags&&(r=r&&t.every(e=>!this.excludeTags?.includes(e))),r}async *tapOutputIterable(e,t){for await(let r of t){if(e!==this.rootId){let t=this.keyMapByRunId[e];t&&await this.writer.write(new u({ops:[{op:"add",path:`/logs/${t}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){if(void 0===this.rootId&&(this.rootId=e.id,await this.writer.write(new u({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;void 0===this.counterMapByRunName[e.name]&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;let t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=1===t?e.name:`${e.name}:${t}`;let r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};"streaming_events"===this._schemaFormat&&(r.inputs=await T(e,this._schemaFormat)),await this.writer.write(new u({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{let t=this.keyMapByRunId[e.id];if(void 0===t)return;let r=[];"streaming_events"===this._schemaFormat&&r.push({op:"replace",path:`/logs/${t}/inputs`,value:await T(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${t}/final_output`,value:await d(e,this._schemaFormat)}),void 0!==e.end_time&&r.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});let a=new u({ops:r});await this.writer.write(a)}finally{if(e.id===this.rootId){let t=new u({ops:[{op:"replace",path:"/final_output",value:await d(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,r){let a;let s=this.keyMapByRunId[e.id];if(void 0===s)return;let i=void 0!==e.inputs.messages;if(i){var n;a=void 0!==(n=r?.chunk)&&void 0!==n.message?r?.chunk:new E.GC(t)}else a=t;let o=new u({ops:[{op:"add",path:`/logs/${s}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${s}/streamed_output/-`,value:a}]});await this.writer.write(o)}}var A=r(57830),p=r(47032),R=r(66188);class S extends o.Z{constructor({config:e,onStart:t,onEnd:r,onError:a}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=r,this.argOnError=a}persistRun(e){return Promise.resolve()}async onRunCreate(e){!this.rootId&&(this.rootId=e.id,this.argOnStart&&(1===this.argOnStart.length?await this.argOnStart(e):2===this.argOnStart.length&&await this.argOnStart(e,this.config)))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&(1===this.argOnError.length?await this.argOnError(e):2===this.argOnError.length&&await this.argOnError(e,this.config)):this.argOnEnd&&(1===this.argOnEnd.length?await this.argOnEnd(e):2===this.argOnEnd.length&&await this.argOnEnd(e,this.config)))}}function _(e){return!!e&&e.lc_runnable}class O{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let r=void 0===this.includeNames&&void 0===this.includeTypes&&void 0===this.includeTags,a=e.tags??[];return void 0!==this.includeNames&&(r=r||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(r=r||this.includeTypes.includes(t)),void 0!==this.includeTags&&(r=r||a.some(e=>this.includeTags?.includes(e))),void 0!==this.excludeNames&&(r=r&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(r=r&&!this.excludeTypes.includes(t)),void 0!==this.excludeTags&&(r=r&&a.every(e=>!this.excludeTags?.includes(e))),r}}var I=r(29425),f=r(38066);let N=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var m=r(33499);class C{constructor(){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]})}toJSON(){let e={};return Object.values(this.nodes).forEach((t,r)=>{var a;e[t.id]="string"==typeof(a=t.id)&&N.test(a)?r:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],..._(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...(0,f.Y_)(t.data.schema),title:t.data.name}}})),edges:this.edges.map(t=>t.data?{source:e[t.source],target:e[t.target],data:t.data}:{source:e[t.source],target:e[t.target]})}}addNode(e,t){if(void 0!==t&&void 0!==this.nodes[t])throw Error(`Node with id ${t} already exists`);let r=t||(0,m.Z)(),a={id:r,data:e};return this.nodes[r]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,r){if(void 0===this.nodes[e.id])throw Error(`Source node ${e.id} not in graph`);if(void 0===this.nodes[t.id])throw Error(`Target node ${t.id} not in graph`);let a={source:e.id,target:t.id,data:r};return this.edges.push(a),a}firstNode(){let e=new Set(this.edges.map(e=>e.target)),t=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||t.push(r)}),t[0]}lastNode(){let e=new Set(this.edges.map(e=>e.source)),t=[];return Object.values(this.nodes).forEach(r=>{e.has(r.id)||t.push(r)}),t[0]}extend(e){Object.entries(e.nodes).forEach(([e,t])=>{this.nodes[e]=t}),this.edges=[...this.edges,...e.edges]}trimFirstNode(){let e=this.firstNode();if(e){let t=this.edges.filter(t=>t.source===e.id);(1===Object.keys(this.nodes).length||1===t.length)&&this.removeNode(e)}}trimLastNode(){let e=this.lastNode();if(e){let t=this.edges.filter(t=>t.target===e.id);(1===Object.keys(this.nodes).length||1===t.length)&&this.removeNode(e)}}}function L(e){return"object"==typeof e&&null!==e&&"function"==typeof e[Symbol.iterator]&&"function"==typeof e.next}function y(e){return"object"==typeof e&&null!==e&&"function"==typeof e[Symbol.asyncIterator]}function*g(e,t){let r=I.A.getInstance();for(;;){let{value:a,done:s}=r.run(e,t.next.bind(t));if(s)break;yield a}}async function*P(e,t){let r=I.A.getInstance(),a=t[Symbol.asyncIterator]();for(;;){let{value:s,done:i}=await r.run(e,a.next.bind(t));if(i)break;yield s}}function b(e,t){return!e||Array.isArray(e)||e instanceof Date||"object"!=typeof e?{[t]:e}:e}class D extends A.i{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){let t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new v({bound:this,kwargs:e,config:{}})}map(){return new M({bound:this})}withRetry(e){return new U({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new v({bound:this,config:e,kwargs:{}})}withFallbacks(e){return new F({runnable:this,fallbacks:e.fallbacks})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(p.LE);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");let r=Object.fromEntries(Object.entries(e).filter(([e])=>"runId"!==e));return Array.from({length:t},(t,a)=>(0,p.LE)(0===a?e:r))}return Array.from({length:t},()=>(0,p.LE)(e))}async batch(e,t,r){let a=this._getOptionsList(t??{},e.length),s=a[0]?.maxConcurrency??r?.maxConcurrency,i=new R.L({maxConcurrency:s,onFailedAttempt:e=>{throw e}}),n=e.map((e,t)=>i.call(async()=>{try{let r=await this.invoke(e,a[t]);return r}catch(e){if(r?.returnExceptions)return e;throw e}}));return Promise.all(n)}async *_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){let r=new l.qq(this._streamIterator(e,(0,p.LE)(t)));return await r.setup,l.QJ.fromAsyncGenerator(r)}_separateRunnableConfigFromCallOptions(e){let t;t=void 0===e?(0,p.LE)(e):(0,p.LE)({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId});let r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,[t,r]}async _callWithConfig(e,t,r){let a;let s=(0,p.LE)(r),i=await (0,p.Le)(s),n=await i?.handleChainStart(this.toJSON(),b(t,"input"),s.runId,s?.runType,void 0,void 0,s?.runName??this.getName());delete s.runId;try{a=await e.call(this,t,s,n)}catch(e){throw await n?.handleChainError(e),e}return await n?.handleChainEnd(b(a,"output")),a}async _batchWithConfig(e,t,r,a){let s;let i=this._getOptionsList(r??{},t.length),n=await Promise.all(i.map(p.Le)),o=await Promise.all(n.map(async(e,r)=>{let a=await e?.handleChainStart(this.toJSON(),b(t[r],"input"),i[r].runId,i[r].runType,void 0,void 0,i[r].runName??this.getName());return delete i[r].runId,a}));try{s=await e.call(this,t,i,o,a)}catch(e){throw await Promise.all(o.map(t=>t?.handleChainError(e))),e}return await Promise.all(o.map(e=>e?.handleChainEnd(b(s,"output")))),s}async *_transformStreamWithConfig(e,t,r){let a,s,i;let n=!0,o=!0,E=(0,p.LE)(r),u=await (0,p.Le)(E);async function*c(){for await(let t of e){if(n){if(void 0===a)a=t;else try{a=(0,l.zo)(a,t)}catch{a=void 0,n=!1}}yield t}}try{let e=await (0,l.E7)(t.bind(this),c(),async()=>u?.handleChainStart(this.toJSON(),{input:""},E.runId,E.runType,void 0,void 0,E.runName??this.getName()),E);delete E.runId,i=e.setup;let r=i?.handlers.find(e=>"log_stream_tracer"===e.name),a=e.output;for await(let t of(void 0!==r&&void 0!==i&&(a=await r.tapOutputIterable(i.runId,e.output)),a))if(yield t,o){if(void 0===s)s=t;else try{s=(0,l.zo)(s,t)}catch{s=void 0,o=!1}}}catch(e){throw await i?.handleChainError(e,void 0,void 0,void 0,{inputs:b(a,"input")}),e}await i?.handleChainEnd(s??{},void 0,void 0,void 0,{inputs:b(a,"input")})}getGraph(e){let t=new C,r=t.addNode({name:`${this.getName()}Input`,schema:a.Yj()}),s=t.addNode(this),i=t.addNode({name:`${this.getName()}Output`,schema:a.Yj()});return t.addEdge(r,s),t.addEdge(s,i),t}pipe(e){return new w({first:this,last:H(e)})}pick(e){return this.pipe(new k(e))}assign(e){return this.pipe(new x(new G({steps:e})))}async *transform(e,t){let r;for await(let t of e)r=void 0===r?t:(0,l.zo)(r,t);yield*this._streamIterator(r,(0,p.LE)(t))}async *streamLog(e,t,r){let a=new h({...r,autoClose:!1,_schemaFormat:"original"}),s=(0,p.LE)(t);yield*this._streamLog(e,a,s)}async *_streamLog(e,t,r){let{callbacks:a}=r;if(void 0===a)r.callbacks=[t];else if(Array.isArray(a))r.callbacks=a.concat([t]);else{let e=a.copy();e.inheritableHandlers.push(t),r.callbacks=e}let s=this.stream(e,r);async function i(){try{let e=await s;for await(let r of e){let e=new u({ops:[{op:"add",path:"/streamed_output/-",value:r}]});await t.writer.write(e)}}finally{await t.writer.close()}}let n=i();try{for await(let e of t)yield e}finally{await n}}async *streamEvents(e,t,r){if("text/event-stream"===t.encoding){let a=await this._streamEvents(e,t,r);yield*function(e){let t=new TextEncoder,r=new ReadableStream({async start(r){for await(let a of e)r.enqueue(t.encode(`event: data
data: ${JSON.stringify(a)}

`));r.enqueue(t.encode("event: end\n\n")),r.close()}});return l.QJ.fromReadableStream(r)}(a)}else yield*this._streamEvents(e,t,r)}async *_streamEvents(e,t,r){let a;if("v1"!==t.version)throw Error('Only version "v1" of the events schema is currently supported.');let s=!1,i=(0,p.LE)(t),n=i.tags??[],o=i.metadata??{},l=i.runName??this.getName(),E=new h({...r,autoClose:!1,_schemaFormat:"streaming_events"}),u=new O({...r}),T=this._streamLog(e,E,i);for await(let t of T){if(void 0===(a=a?a.concat(t):c.fromRunLogPatch(t)).state)throw Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!s){s=!0;let t={...a.state},r={run_id:t.id,event:`on_${t.type}_start`,name:l,tags:n,metadata:o,data:{input:e}};u.includeEvent(r,t.type)&&(yield r)}let r=t.ops.filter(e=>e.path.startsWith("/logs/")).map(e=>e.path.split("/")[2]),i=[...new Set(r)];for(let e of i){let t;let r={},s=a.state.logs[e];if("start"==(t=void 0===s.end_time?s.streamed_output.length>0?"stream":"start":"end"))void 0!==s.inputs&&(r.input=s.inputs);else if("end"===t)void 0!==s.inputs&&(r.input=s.inputs),r.output=s.final_output;else if("stream"===t){let e=s.streamed_output.length;if(1!==e)throw Error(`Expected exactly one chunk of streamed output, got ${e} instead. Encountered in: "${s.name}"`);r={chunk:s.streamed_output[0]},s.streamed_output=[]}yield{event:`on_${s.type}_${t}`,name:s.name,run_id:s.id,tags:s.tags,metadata:s.metadata,data:r}}let{state:E}=a;if(E.streamed_output.length>0){let e=E.streamed_output.length;if(1!==e)throw Error(`Expected exactly one chunk of streamed output, got ${e} instead. Encountered in: "${E.name}"`);let t={chunk:E.streamed_output[0]};E.streamed_output=[];let r={event:`on_${E.type}_stream`,run_id:E.id,tags:n,metadata:o,name:l,data:t};u.includeEvent(r,E.type)&&(yield r)}}let d=a?.state;if(void 0!==d){let e={event:`on_${d.type}_end`,name:l,run_id:d.id,tags:n,metadata:o,data:{output:d.final_output}};u.includeEvent(e,d.type)&&(yield e)}}static isRunnable(e){return _(e)}withListeners({onStart:e,onEnd:t,onError:r}){return new v({bound:this,config:{},configFactories:[a=>({callbacks:[new S({config:a,onStart:e,onEnd:t,onError:r})]})]})}}class v extends D{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){let t=(0,p.t8)(this.config,...e);return(0,p.t8)(t,...this.configFactories?await Promise.all(this.configFactories.map(async e=>await e(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig((0,p.LE)(t),this.kwargs))}async batch(e,t,r){let a=Array.isArray(t)?await Promise.all(t.map(async e=>this._mergeConfig((0,p.LE)(e),this.kwargs))):await this._mergeConfig((0,p.LE)(t),this.kwargs);return this.bound.batch(e,a,r)}async *_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig((0,p.LE)(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig((0,p.LE)(t),this.kwargs))}async *transform(e,t){yield*this.bound.transform(e,await this._mergeConfig((0,p.LE)(t),this.kwargs))}async *streamEvents(e,t,r){yield*this.bound.streamEvents(e,{...await this._mergeConfig((0,p.LE)(t),this.kwargs),version:t.version},r)}static isRunnableBinding(e){return e.bound&&D.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:r}){return new v({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[a=>({callbacks:[new S({config:a,onStart:e,onEnd:t,onError:r})]})]})}}class M extends D{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new M({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke,e,t)}async _invoke(e,t,r){return this.bound.batch(e,(0,p.q)(t,{callbacks:r?.getChild()}))}withListeners({onStart:e,onEnd:t,onError:r}){return new M({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:r})})}}class U extends v{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,r){let a=e>1?`retry:attempt:${e}`:void 0;return(0,p.q)(t,{callbacks:r?.getChild(a)})}async _invoke(e,t,r){return s(a=>super.invoke(e,this._patchConfigForRetry(a,t,r)),{onFailedAttempt:t=>this.onFailedAttempt(t,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke,e,t)}async _batch(e,t,r,a){let i={};try{await s(async s=>{let n;let o=e.map((e,t)=>t).filter(e=>void 0===i[e.toString()]||i[e.toString()]instanceof Error),l=o.map(t=>e[t]),E=o.map(e=>this._patchConfigForRetry(s,t?.[e],r?.[e])),u=await super.batch(l,E,{...a,returnExceptions:!0});for(let e=0;e<u.length;e+=1){let t=u[e],r=o[e];t instanceof Error&&void 0===n&&((n=t).input=l[e]),i[r.toString()]=t}if(n)throw n;return u},{onFailedAttempt:e=>this.onFailedAttempt(e,e.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(e){if(a?.returnExceptions!==!0)throw e}return Object.keys(i).sort((e,t)=>parseInt(e,10)-parseInt(t,10)).map(e=>i[parseInt(e,10)])}async batch(e,t,r){return this._batchWithConfig(this._batch.bind(this),e,t,r)}}class w extends D{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){let r;let a=(0,p.LE)(t),s=await (0,p.Le)(a),i=await s?.handleChainStart(this.toJSON(),b(e,"input"),a.runId,void 0,void 0,void 0,a?.runName);delete a.runId;let n=e;try{let e=[this.first,...this.middle];for(let t=0;t<e.length;t+=1){let r=e[t];n=await r.invoke(n,(0,p.q)(a,{callbacks:i?.getChild(`seq:step:${t+1}`)}))}r=await this.last.invoke(n,(0,p.q)(a,{callbacks:i?.getChild(`seq:step:${this.steps.length}`)}))}catch(e){throw await i?.handleChainError(e),e}return await i?.handleChainEnd(b(r,"output")),r}async batch(e,t,r){let a=this._getOptionsList(t??{},e.length),s=await Promise.all(a.map(p.Le)),i=await Promise.all(s.map(async(t,r)=>{let s=await t?.handleChainStart(this.toJSON(),b(e[r],"input"),a[r].runId,void 0,void 0,void 0,a[r].runName);return delete a[r].runId,s})),n=e;try{for(let e=0;e<this.steps.length;e+=1){let t=this.steps[e];n=await t.batch(n,i.map((t,r)=>{let s=t?.getChild(`seq:step:${e+1}`);return(0,p.q)(a[r],{callbacks:s})}),r)}}catch(e){throw await Promise.all(i.map(t=>t?.handleChainError(e))),e}return await Promise.all(i.map(e=>e?.handleChainEnd(b(n,"output")))),n}async *_streamIterator(e,t){let r;let a=await (0,p.Le)(t),{runId:s,...i}=t??{},n=await a?.handleChainStart(this.toJSON(),b(e,"input"),s,void 0,void 0,void 0,i?.runName),o=[this.first,...this.middle,this.last],E=!0;async function*u(){yield e}try{let e=o[0].transform(u(),(0,p.q)(i,{callbacks:n?.getChild("seq:step:1")}));for(let t=1;t<o.length;t+=1){let r=o[t];e=await r.transform(e,(0,p.q)(i,{callbacks:n?.getChild(`seq:step:${t+1}`)}))}for await(let t of e)if(yield t,E){if(void 0===r)r=t;else try{r=(0,l.zo)(r,t)}catch(e){r=void 0,E=!1}}}catch(e){throw await n?.handleChainError(e),e}await n?.handleChainEnd(b(r,"output"))}getGraph(e){let t=new C,r=null;return this.steps.forEach((a,s)=>{let i=a.getGraph(e);0!==s&&i.trimFirstNode(),s!==this.steps.length-1&&i.trimLastNode(),t.extend(i);let n=i.firstNode();if(!n)throw Error(`Runnable ${a} has no first node`);r&&t.addEdge(r,n),r=i.lastNode()}),t}pipe(e){return new w(w.isRunnableSequence(e)?{first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}:{first:this.first,middle:[...this.middle,this.last],last:H(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&D.isRunnable(e)}static from([e,...t],r){return new w({first:H(e),middle:t.slice(0,-1).map(H),last:H(t[t.length-1]),name:r})}}class G extends D{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){for(let[t,r]of(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={},Object.entries(e.steps)))this.steps[t]=H(r)}static from(e){return new G({steps:e})}async invoke(e,t){let r=(0,p.LE)(t),a=await (0,p.Le)(r),s=await a?.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r?.runName);delete r.runId;let i={};try{await Promise.all(Object.entries(this.steps).map(async([t,a])=>{i[t]=await a.invoke(e,(0,p.q)(r,{callbacks:s?.getChild(`map:key:${t}`)}))}))}catch(e){throw await s?.handleChainError(e),e}return await s?.handleChainEnd(i),i}async *_transform(e,t,r){let a={...this.steps},s=(0,l.y2)(e,Object.keys(a).length),i=new Map(Object.entries(a).map(([e,a],i)=>{let n=a.transform(s[i],(0,p.q)(r,{callbacks:t?.getChild(`map:key:${e}`)}));return[e,n.next().then(t=>({key:e,gen:n,result:t}))]}));for(;i.size;){let{key:e,result:t,gen:r}=await Promise.race(i.values());i.delete(e),t.done||(yield{[e]:t.value},i.set(e,r.next().then(t=>({key:e,gen:r,result:t}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let a=new l.qq(this.transform(r(),t));return await a.setup,l.QJ.fromAsyncGenerator(a)}}class B extends D{static lc_name(){return"RunnableLambda"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.func=e.func}static from(e){return new B({func:e})}async _invoke(e,t,r){return new Promise((a,s)=>{let i=(0,p.q)(t,{callbacks:r?.getChild(),recursionLimit:(t?.recursionLimit??p.ov)-1});I.A.getInstance().run(i,async()=>{try{let r=await this.func(e,{...i,config:i});if(r&&D.isRunnable(r)){if(t?.recursionLimit===0)throw Error("Recursion limit reached.");r=await r.invoke(e,{...i,recursionLimit:(i.recursionLimit??p.ov)-1})}else if(y(r)){let e;for await(let t of P(i,r))if(void 0===e)e=t;else try{e=(0,l.zo)(e,t)}catch(r){e=t}r=e}else if(L(r)){let e;for(let t of g(i,r))if(void 0===e)e=t;else try{e=(0,l.zo)(e,t)}catch(r){e=t}r=e}a(r)}catch(e){s(e)}})})}async invoke(e,t){return this._callWithConfig(this._invoke,e,t)}async *_transform(e,t,r){let a;for await(let t of e)if(void 0===a)a=t;else try{a=(0,l.zo)(a,t)}catch(e){a=t}let s=await new Promise((e,t)=>{I.A.getInstance().run(r,async()=>{try{let t=await this.func(a,{...r,config:r});e(t)}catch(e){t(e)}})});if(s&&D.isRunnable(s)){if(r?.recursionLimit===0)throw Error("Recursion limit reached.");let e=await s.stream(a,(0,p.q)(r,{callbacks:t?.getChild(),recursionLimit:(r?.recursionLimit??p.ov)-1}));for await(let t of e)yield t}else if(y(s))for await(let e of P(r,s))yield e;else if(L(s))for(let e of g(r,s))yield e;else yield s}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let a=new l.qq(this.transform(r(),t));return await a.setup,l.QJ.fromAsyncGenerator(a)}}class F extends D{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){for(let e of(yield this.runnable,this.fallbacks))yield e}async invoke(e,t){let r;let a=await i.Ye.configure(t?.callbacks,void 0,t?.tags,void 0,t?.metadata),{runId:s,...n}=t??{},o=await a?.handleChainStart(this.toJSON(),b(e,"input"),s,void 0,void 0,void 0,n?.runName);for(let t of this.runnables())try{let r=await t.invoke(e,(0,p.q)(n,{callbacks:o?.getChild()}));return await o?.handleChainEnd(b(r,"output")),r}catch(e){void 0===r&&(r=e)}if(void 0===r)throw Error("No error stored at end of fallback.");throw await o?.handleChainError(r),r}async batch(e,t,r){let a;if(r?.returnExceptions)throw Error("Not implemented.");let s=this._getOptionsList(t??{},e.length),n=await Promise.all(s.map(e=>i.Ye.configure(e?.callbacks,void 0,e?.tags,void 0,e?.metadata))),o=await Promise.all(n.map(async(t,r)=>{let a=await t?.handleChainStart(this.toJSON(),b(e[r],"input"),s[r].runId,void 0,void 0,void 0,s[r].runName);return delete s[r].runId,a}));for(let t of this.runnables())try{let a=await t.batch(e,o.map((e,t)=>(0,p.q)(s[t],{callbacks:e?.getChild()})),r);return await Promise.all(o.map((e,t)=>e?.handleChainEnd(b(a[t],"output")))),a}catch(e){void 0===a&&(a=e)}if(!a)throw Error("No error stored at end of fallbacks.");throw await Promise.all(o.map(e=>e?.handleChainError(a))),a}}function H(e){if("function"==typeof e)return new B({func:e});if(D.isRunnable(e))return e;if(Array.isArray(e)||"object"!=typeof e)throw Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`);{let t={};for(let[r,a]of Object.entries(e))t[r]=H(a);return new G({steps:t})}}class x extends D{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof G&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){let r=await this.mapper.invoke(e,t);return{...e,...r}}async *_transform(e,t,r){let a=this.mapper.getStepsKeys(),[s,i]=(0,l.y2)(e),n=this.mapper.transform(i,(0,p.q)(r,{callbacks:t?.getChild()})),o=n.next();for await(let e of s){if("object"!=typeof e||Array.isArray(e))throw Error(`RunnableAssign can only be used with objects as input, got ${typeof e}`);let t=Object.fromEntries(Object.entries(e).filter(([e])=>!a.includes(e)));Object.keys(t).length>0&&(yield t)}for await(let e of(yield(await o).value,n))yield e}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let a=new l.qq(this.transform(r(),t));return await a.setup,l.QJ.fromAsyncGenerator(a)}}class k extends D{static lc_name(){return"RunnablePick"}constructor(e){("string"==typeof e||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if("string"==typeof this.keys)return e[this.keys];{let t=this.keys.map(t=>[t,e[t]]).filter(e=>void 0!==e[1]);return 0===t.length?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async *_transform(e){for await(let t of e){let e=await this._pick(t);void 0!==e&&(yield e)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let a=new l.qq(this.transform(r(),t));return await a.setup,l.QJ.fromAsyncGenerator(a)}}},47032:(e,t,r)=>{"use strict";r.d(t,{LE:()=>E,Le:()=>n,ov:()=>i,q:()=>u,t8:()=>o});var a=r(74311),s=r(29425);let i=25;async function n(e){return a.Ye.configure(e?.callbacks,void 0,e?.tags,void 0,e?.metadata)}function o(...e){let t={};for(let r of e.filter(e=>!!e))for(let e of Object.keys(r))if("metadata"===e)t[e]={...t[e],...r[e]};else if("tags"===e){let a=t[e]??[];t[e]=[...new Set(a.concat(r[e]??[]))]}else if("configurable"===e)t[e]={...t[e],...r[e]};else if("callbacks"===e){let e=t.callbacks,s=r.callbacks;if(Array.isArray(s)){if(e){if(Array.isArray(e))t.callbacks=e.concat(s);else{let r=e.copy();for(let e of s)r.addHandler((0,a.xz)(e),!0);t.callbacks=r}}else t.callbacks=s}else if(s){if(e){if(Array.isArray(e)){let r=s.copy();for(let t of e)r.addHandler((0,a.xz)(t),!0);t.callbacks=r}else t.callbacks=new a.Ye(s._parentRunId,{handlers:e.handlers.concat(s.handlers),inheritableHandlers:e.inheritableHandlers.concat(s.inheritableHandlers),tags:Array.from(new Set(e.tags.concat(s.tags))),inheritableTags:Array.from(new Set(e.inheritableTags.concat(s.inheritableTags))),metadata:{...e.metadata,...s.metadata}})}else t.callbacks=s}}else t[e]=r[e]??t[e];return t}let l=new Set(["string","number","boolean"]);function E(e){let t=e??s.A.getInstance().getStore(),r={tags:[],metadata:{},callbacks:void 0,recursionLimit:25,runId:void 0};if(t&&(r={...r,...t}),t?.configurable)for(let e of Object.keys(t.configurable))l.has(typeof t.configurable[e])&&!r.metadata?.[e]&&(r.metadata||(r.metadata={}),r.metadata[e]=t.configurable[e]);return r}function u(e={},{callbacks:t,maxConcurrency:r,recursionLimit:a,runName:s,configurable:i,runId:n}={}){let o=E(e);return void 0!==t&&(delete o.runName,o.callbacks=t),void 0!==a&&(o.recursionLimit=a),void 0!==r&&(o.maxConcurrency=r),void 0!==s&&(o.runName=s),void 0!==i&&(o.configurable={...o.configurable,...i}),void 0!==n&&delete o.runId,o}},62299:(e,t,r)=>{"use strict";r.d(t,{eq:()=>a.eq});var a=r(44349);r(47032),r(63816),r(2576)},29425:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});class a{getStore(){}run(e,t){return t()}}class s{constructor(){Object.defineProperty(this,"asyncLocalStorage",{enumerable:!0,configurable:!0,writable:!0,value:new a}),Object.defineProperty(this,"hasBeenInitialized",{enumerable:!0,configurable:!0,writable:!0,value:!1})}getInstance(){return this.asyncLocalStorage}initializeGlobalInstance(e){this.hasBeenInitialized||(this.hasBeenInitialized=!0,this.asyncLocalStorage=e)}}let i=new s},58519:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(98077);function s(e,t){return e&&!Array.isArray(e)&&"object"==typeof e?e:{[t]:e}}class i extends a.E{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`

${e.stack}`:""):"string"==typeof e?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}async _startTrace(e){let t=function(e,t,r){let a=r.toFixed(0).slice(0,3).padStart(3,"0");return`${new Date(e).toISOString().slice(0,-1)}${a}Z`.replace(/[-:.]/g,"")+t}(e.start_time,e.id,e.execution_order),r={...e};if(void 0!==r.parent_run_id){let e=this.runMap.get(r.parent_run_id);e&&(this._addChildRun(e,r),e.child_execution_order=Math.max(e.child_execution_order,r.child_execution_order),r.trace_id=e.trace_id,void 0!==e.dotted_order&&(r.dotted_order=[e.dotted_order,t].join(".")))}else r.trace_id=r.id,r.dotted_order=t;this.runMap.set(r.id,r),await this.onRunCreate?.(r)}async _endTrace(e){let t=void 0!==e.parent_run_id&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await this.onRunUpdate?.(e)}_getExecutionOrder(e){let t=void 0!==e&&this.runMap.get(e);return t?t.child_execution_order+1:1}async handleLLMStart(e,t,r,a,s,i,n,o){let l=this._getExecutionOrder(a),E=Date.now(),u=n?{...s,metadata:n}:s,c={id:r,name:o??e.id[e.id.length-1],parent_run_id:a,start_time:E,serialized:e,events:[{name:"start",time:new Date(E).toISOString()}],inputs:{prompts:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:u??{},tags:i||[]};return await this._startTrace(c),await this.onLLMStart?.(c),c}async handleChatModelStart(e,t,r,a,s,i,n,o){let l=this._getExecutionOrder(a),E=Date.now(),u=n?{...s,metadata:n}:s,c={id:r,name:o??e.id[e.id.length-1],parent_run_id:a,start_time:E,serialized:e,events:[{name:"start",time:new Date(E).toISOString()}],inputs:{messages:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:u??{},tags:i||[]};return await this._startTrace(c),await this.onLLMStart?.(c),c}async handleLLMEnd(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="llm")throw Error("No LLM run to end.");return r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onLLMEnd?.(r),await this._endTrace(r),r}async handleLLMError(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="llm")throw Error("No LLM run to end.");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onLLMError?.(r),await this._endTrace(r),r}async handleChainStart(e,t,r,a,s,i,n,o){let l=this._getExecutionOrder(a),E=Date.now(),u={id:r,name:o??e.id[e.id.length-1],parent_run_id:a,start_time:E,serialized:e,events:[{name:"start",time:new Date(E).toISOString()}],inputs:t,execution_order:l,child_execution_order:l,run_type:n??"chain",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};return await this._startTrace(u),await this.onChainStart?.(u),u}async handleChainEnd(e,t,r,a,i){let n=this.runMap.get(t);if(!n)throw Error("No chain run to end.");return n.end_time=Date.now(),n.outputs=s(e,"output"),n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),i?.inputs!==void 0&&(n.inputs=s(i.inputs,"input")),await this.onChainEnd?.(n),await this._endTrace(n),n}async handleChainError(e,t,r,a,i){let n=this.runMap.get(t);if(!n)throw Error("No chain run to end.");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),i?.inputs!==void 0&&(n.inputs=s(i.inputs,"input")),await this.onChainError?.(n),await this._endTrace(n),n}async handleToolStart(e,t,r,a,s,i,n){let o=this._getExecutionOrder(a),l=Date.now(),E={id:r,name:n??e.id[e.id.length-1],parent_run_id:a,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:t},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};return await this._startTrace(E),await this.onToolStart?.(E),E}async handleToolEnd(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="tool")throw Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onToolEnd?.(r),await this._endTrace(r),r}async handleToolError(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="tool")throw Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onToolError?.(r),await this._endTrace(r),r}async handleAgentAction(e,t){let r=this.runMap.get(t);r&&r?.run_type==="chain"&&(r.actions=r.actions||[],r.actions.push(e),r.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(r))}async handleAgentEnd(e,t){let r=this.runMap.get(t);r&&r?.run_type==="chain"&&(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(r))}async handleRetrieverStart(e,t,r,a,s,i,n){let o=this._getExecutionOrder(a),l=Date.now(),E={id:r,name:n??e.id[e.id.length-1],parent_run_id:a,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:t},execution_order:o,child_execution_order:o,run_type:"retriever",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};return await this._startTrace(E),await this.onRetrieverStart?.(E),E}async handleRetrieverEnd(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="retriever")throw Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onRetrieverEnd?.(r),await this._endTrace(r),r}async handleRetrieverError(e,t){let r=this.runMap.get(t);if(!r||r?.run_type!=="retriever")throw Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onRetrieverError?.(r),await this._endTrace(r),r}async handleText(e,t){let r=this.runMap.get(t);r&&r?.run_type==="chain"&&(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(r))}async handleLLMNewToken(e,t,r,a,s,i){let n=this.runMap.get(r);if(!n||n?.run_type!=="llm")throw Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return n.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:i?.chunk}}),await this.onLLMNewToken?.(n,e,{chunk:i?.chunk}),n}}},66188:(e,t,r)=>{"use strict";r.d(t,{L:()=>o});var a=r(31776),s=r(96110);let i=[400,401,402,403,404,405,406,407,409],n=e=>{if(e.message.startsWith("Cancel")||e.message.startsWith("AbortError")||"AbortError"===e.name||e?.code==="ECONNABORTED")throw e;let t=e?.response?.status??e?.status;if(t&&i.includes(+t))throw e;if(e?.error?.code==="insufficient_quota"){let t=Error(e?.message);throw t.name="InsufficientQuotaError",t}};class o{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??n;let t=s.default;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>a(()=>e(...t).catch(e=>{if(e instanceof Error)throw e;throw Error(e)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((t,r)=>{e.signal?.addEventListener("abort",()=>{r(Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(e=>e.ok?e:Promise.reject(e)))}}},35387:(e,t,r)=>{"use strict";let a;r.d(t,{lS:()=>c,sA:()=>u});let s=()=>!1,i=()=>"object"==typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name,n=()=>"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),o=()=>"undefined"!=typeof Deno,l=()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node&&!o(),E=()=>s()?"browser":l()?"node":i()?"webworker":n()?"jsdom":o()?"deno":"other";async function u(){if(void 0===a){let e=E();a={library:"langchain-js",runtime:e}}return a}function c(e){try{return"undefined"!=typeof process?process.env?.[e]:void 0}catch(e){return}}},76881:(e,t,r)=>{"use strict";r.d(t,{af:()=>A});var a={};r.r(a),r.d(a,{JsonPatchError:()=>E,_areEquals:()=>_,applyOperation:()=>h,applyPatch:()=>A,applyReducer:()=>p,deepClone:()=>u,getValueByPointer:()=>d,validate:()=>S,validator:()=>R});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */let s=Object.prototype.hasOwnProperty;function i(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function n(e){let t,r=0,a=e.length;for(;r<a;){if((t=e.charCodeAt(r))>=48&&t<=57){r++;continue}return!1}return!0}function o(e,t){let r=[e];for(let e in t){let a="object"==typeof t[e]?JSON.stringify(t[e],null,2):t[e];void 0!==a&&r.push(`${e}: ${a}`)}return r.join("\n")}class l extends Error{constructor(e,t,r,a,s){super(o(e,{name:t,index:r,operation:a,tree:s})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.setPrototypeOf(this,new.target.prototype),this.message=o(e,{name:t,index:r,operation:a,tree:s})}}let E=l,u=i,c={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var a=e[t];return delete e[t],{newDocument:r,removed:a}},replace:function(e,t,r){var a=e[t];return e[t]=this.value,{newDocument:r,removed:a}},move:function(e,t,r){let a=d(r,this.path);a&&(a=i(a));let s=h(r,{op:"remove",path:this.from}).removed;return h(r,{op:"add",path:this.path,value:s}),{newDocument:r,removed:a}},copy:function(e,t,r){let a=d(r,this.from);return h(r,{op:"add",path:this.path,value:i(a)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:_(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}};var T={add:function(e,t,r){return n(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var a=e[t];return e[t]=this.value,{newDocument:r,removed:a}},move:c.move,copy:c.copy,test:c.test,_get:c._get};function d(e,t){if(""==t)return e;var r={op:"_get",path:t};return h(e,r),r.value}function h(e,t,r=!1,a=!0,s=!0,o=0){if(r&&("function"==typeof r?r(t,0,e,t.path):R(t,0)),""===t.path){let a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=d(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=_(e,t.value),!1===a.test)throw new E("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}else{if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(!r)return a;throw new E("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e)}}{let l,u,d;a||(e=i(e));let h=t.path||"",A=h.split("/"),p=e,S=1,_=A.length;for(u="function"==typeof r?r:R;;){if((l=A[S])&&-1!=l.indexOf("~")&&(l=l.replace(/~1/g,"/").replace(/~0/g,"~")),s&&("__proto__"==l||"prototype"==l&&S>0&&"constructor"==A[S-1]))throw TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===d&&(void 0===p[l]?d=A.slice(0,S).join("/"):S==_-1&&(d=t.path),void 0!==d&&u(t,0,e,d)),S++,Array.isArray(p)){if("-"===l)l=p.length;else{if(r&&!n(l))throw new E("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);n(l)&&(l=~~l)}if(S>=_){if(r&&"add"===t.op&&l>p.length)throw new E("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);let a=T[t.op].call(t,p,l,e);if(!1===a.test)throw new E("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(S>=_){let r=c[t.op].call(t,p,l,e);if(!1===r.test)throw new E("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return r}if(p=p[l],r&&S<_&&(!p||"object"!=typeof p))throw new E("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function A(e,t,r,a=!0,s=!0){if(r&&!Array.isArray(t))throw new E("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");a||(e=i(e));let n=Array(t.length);for(let a=0,i=t.length;a<i;a++)n[a]=h(e,t[a],r,!0,s,a),e=n[a].newDocument;return n.newDocument=e,n}function p(e,t,r){let a=h(e,t);if(!1===a.test)throw new E("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return a.newDocument}function R(e,t,r,a){if("object"!=typeof e||null===e||Array.isArray(e))throw new E("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(c[e.op]){if("string"!=typeof e.path)throw new E("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new E('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new E("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function e(t){if(void 0===t)return!0;if(t){if(Array.isArray(t)){for(let r=0,a=t.length;r<a;r++)if(e(t[r]))return!0}else if("object"==typeof t){let a=function(e){if(Array.isArray(e)){let t=Array(e.length);for(let e=0;e<t.length;e++)t[e]=""+e;return t}if(Object.keys)return Object.keys(e);let t=[];for(let r in e)s.call(e,r)&&t.push(r);return t}(t),i=a.length;for(var r=0;r<i;r++)if(e(t[a[r]]))return!0}}return!1}(e.value))throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);else if(r){if("add"==e.op){var i=e.path.split("/").length,n=a.split("/").length;if(i!==n+1&&i!==n)throw new E("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==a)throw new E("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if("move"===e.op||"copy"===e.op){var o=S([{op:"_get",path:e.from,value:void 0}],r);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new E("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}}else throw new E("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r)}function S(e,t,r){try{if(!Array.isArray(e))throw new E("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)A(i(t),i(e),r||!0);else{r=r||R;for(var a=0;a<e.length;a++)r(e[a],a,t,void 0)}}catch(e){if(e instanceof E)return e;throw e}}function _(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,a,s,i=Array.isArray(e),n=Array.isArray(t);if(i&&n){if((a=e.length)!=t.length)return!1;for(r=a;0!=r--;)if(!_(e[r],t[r]))return!1;return!0}if(i!=n)return!1;var o=Object.keys(e);if((a=o.length)!==Object.keys(t).length)return!1;for(r=a;0!=r--;)if(!t.hasOwnProperty(o[r]))return!1;for(r=a;0!=r--;)if(!_(e[s=o[r]],t[s]))return!1;return!0}return e!=e&&t!=t}new WeakMap,{...a}},71470:(e,t,r)=>{"use strict";r(76881)},63816:(e,t,r)=>{"use strict";r.d(t,{E7:()=>n,QJ:()=>a,qq:()=>i,y2:()=>s,zo:()=>function e(t,r){if(Array.isArray(t)&&Array.isArray(r))return t.concat(r);if("string"==typeof t&&"string"==typeof r||"number"==typeof t&&"number"==typeof r)return t+r;if("concat"in t&&"function"==typeof t.concat)return t.concat(r);if("object"==typeof t&&"object"==typeof r){let a={...t};for(let[t,s]of Object.entries(r))t in a&&!Array.isArray(a[t])?a[t]=e(a[t],s):a[t]=s;return a}throw Error(`Cannot concat ${typeof t} and ${typeof r}`)}});class a extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{let e=await this.reader.read();if(e.done)return this.reader.releaseLock(),{done:!0,value:void 0};return{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){let e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){let e=this.reader.cancel();this.reader.releaseLock(),await e}throw e}[Symbol.asyncIterator](){return this}static fromReadableStream(e){let t=e.getReader();return new a({start:e=>(function r(){return t.read().then(({done:t,value:a})=>{if(t){e.close();return}return e.enqueue(a),r()})})(),cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new a({async pull(t){let{value:r,done:a}=await e.next();a&&t.close(),t.enqueue(r)},async cancel(t){await e.return(t)}})}}function s(e,t=2){let r=Array.from({length:t},()=>[]);return r.map(async function*(t){for(;;)if(0===t.length){let t=await e.next();for(let e of r)e.push(t)}else{if(t[0].done)return;yield t.shift().value}})}class i{constructor(e,t){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e,this.setup=new Promise((r,a)=>{this.firstResult=e.next(),t?this.firstResult.then(t).then(r,a):this.firstResult.then(e=>r(void 0),a)})}async next(...e){return this.firstResultUsed?this.generator.next(...e):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}}async function n(e,t,r,...a){let s=new i(t,r),o=await s.setup;return{output:e(s,o,...a),setup:o}}},26504:(e,t,r)=>{"use strict";r.d(t,{b:()=>h});var a,s,i,n,o=r(64394),l=Object.defineProperty,E=class{constructor(e,t){this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder("utf-8"),this.rankMap=new Map,this.textMap=new Map,this.patStr=e.pat_str;let r=e.bpe_ranks.split("\n").filter(Boolean).reduce((e,t)=>{let[r,a,...s]=t.split(" "),i=Number.parseInt(a,10);return s.forEach((t,r)=>e[t]=i+r),e},{});for(let[e,t]of Object.entries(r)){let r=o.toByteArray(e);this.rankMap.set(r.join(","),t),this.textMap.set(t,r)}this.specialTokens={...e.special_tokens,...t},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((e,[t,r])=>(e[r]=this.textEncoder.encode(t),e),{})}encode(e,t=[],r="all"){let a=RegExp(this.patStr,"ug"),s=E.specialTokenRegex(Object.keys(this.specialTokens)),i=[],n=new Set("all"===t?Object.keys(this.specialTokens):t),o=new Set("all"===r?Object.keys(this.specialTokens).filter(e=>!n.has(e)):r);if(o.size>0){let t=E.specialTokenRegex([...o]),r=e.match(t);if(null!=r)throw Error(`The text contains a special token that is not allowed: ${r[0]}`)}let l=0;for(;;){let t=null,r=l;for(;s.lastIndex=r,!(null==(t=s.exec(e))||n.has(t[0]));)r=t.index+1;let o=t?.index??e.length;for(let t of e.substring(l,o).matchAll(a)){let e=this.textEncoder.encode(t[0]),r=this.rankMap.get(e.join(","));if(null!=r){i.push(r);continue}i.push(...function(e,t){return 1===e.length?[t.get(e.join(","))]:(function(e,t){let r=Array.from({length:e.length},(e,t)=>({start:t,end:t+1}));for(;r.length>1;){let a=null;for(let s=0;s<r.length-1;s++){let i=e.slice(r[s].start,r[s+1].end),n=t.get(i.join(","));null!=n&&(null==a||n<a[0])&&(a=[n,s])}if(null!=a){let e=a[1];r[e]={start:r[e].start,end:r[e+1].end},r.splice(e+1,1)}else break}return r})(e,t).map(r=>t.get(e.slice(r.start,r.end).join(","))).filter(e=>null!=e)}(e,this.rankMap))}if(null==t)break;let E=this.specialTokens[t[0]];i.push(E),l=t.index+t[0].length}return i}decode(e){let t=[],r=0;for(let a=0;a<e.length;++a){let s=e[a],i=this.textMap.get(s)??this.inverseSpecialTokens[s];null!=i&&(t.push(i),r+=i.length)}let a=new Uint8Array(r),s=0;for(let e of t)a.set(e,s),s+=e.length;return this.textDecoder.decode(a)}};n="specialTokenRegex",a=E,s="symbol"!=typeof n?n+"":n,i=e=>RegExp(e.map(e=>e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")).join("|"),"g"),s in a?l(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i;var u=r(66188);let c={},T=new u.L({});async function d(e){return e in c||(c[e]=T.fetch(`https://tiktoken.pages.dev/js/${e}.json`).then(e=>e.json()).then(e=>new E(e)).catch(t=>{throw delete c[e],t})),await c[e]}async function h(e){return d(function(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":case"gpt-5":case"gpt-5-2025-08-07":case"gpt-5-nano":case"gpt-5-nano-2025-08-07":case"gpt-5-mini":case"gpt-5-mini-2025-08-07":case"gpt-5-chat-latest":return"o200k_base";default:throw Error("Unknown model")}}(e))}},22680:(e,t,r)=>{"use strict";r.d(t,{n3:()=>s,s_:()=>i}),r(57830);class a{async getPromptAsync(e,t){let r=this.getPrompt(e);return r.partial(t?.partialVariables??{})}}class s extends a{constructor(e,t=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=t}getPrompt(e){for(let[t,r]of this.conditionals)if(t(e))return r;return this.defaultPrompt}}function i(e){return"base_chat_model"===e._modelType()}},72100:(e,t,r)=>{"use strict";r.d(t,{BD:()=>a.BD,qV:()=>a.qV});var a=r(48548)},54519:(e,t,r)=>{"use strict";r.d(t,{Cr:()=>a.Cr,GC:()=>a.GC,HD:()=>a.HD,J:()=>a.J,Xz:()=>a.Xz,gY:()=>a.gY,ro:()=>a.ro,xq:()=>a.xq});var a=r(2576)},22879:(e,t,r)=>{"use strict";r(43527)},58014:(e,t,r)=>{"use strict";r.d(t,{gc:()=>s.gc,dy:()=>a.d,ks:()=>s.ks,P8:()=>i.FewShotPromptTemplate,kq:()=>s.kq,Pf:()=>n.PromptTemplate,ov:()=>s.ov});var a=r(17784),s=r(95295),i=r(18766),n=r(20508);r(94237),r(22367),r(91834)},83785:(e,t,r)=>{"use strict";r.d(t,{t:()=>Blob});/**
 * @license
 * web-streams-polyfill v4.0.0-beta.3
 * Copyright 2021 Mattias Buelens, Diwank Singh Tomer and other contributors.
 * This code is released under the MIT license.
 * SPDX-License-Identifier: MIT
 */let a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:e=>`Symbol(${e})`;function s(){}function i(e){return"object"==typeof e&&null!==e||"function"==typeof e}function n(e,t){try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch(e){}}let o=Promise,l=Promise.prototype.then,E=Promise.resolve.bind(o),u=Promise.reject.bind(o);function c(e){return new o(e)}function T(e,t,r){return l.call(e,t,r)}function d(e,t,r){T(T(e,t,r),void 0,s)}function h(e){T(e,void 0,s)}let A=e=>{if("function"==typeof queueMicrotask)A=queueMicrotask;else{let e=E(void 0);A=t=>T(e,t)}return A(e)};function p(e,t,r){if("function"!=typeof e)throw TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function R(e,t,r){try{var a;return a=p(e,t,r),E(a)}catch(e){return u(e)}}class S{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){let t=this._back,r=t;16383===t._elements.length&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){let e=this._front,t=e,r=this._cursor,a=r+1,s=e._elements,i=s[r];return 16384===a&&(t=e._next,a=0),--this._size,this._cursor=a,e!==t&&(this._front=t),s[r]=void 0,i}forEach(e){let t=this._cursor,r=this._front,a=r._elements;for(;!(t===a.length&&void 0===r._next||t===a.length&&(a=(r=r._next)._elements,t=0,0===a.length));)e(a[t]),++t}peek(){let e=this._front,t=this._cursor;return e._elements[t]}}let _=a("[[AbortSteps]]"),O=a("[[ErrorSteps]]"),I=a("[[CancelSteps]]"),f=a("[[PullSteps]]"),N=a("[[ReleaseSteps]]");function m(e,t){var r;e._ownerReadableStream=t,t._reader=e,"readable"===t._state?g(e):"closed"===t._state?(g(e),b(e)):(r=t._storedError,g(e),P(e,r))}function C(e,t){return tm(e._ownerReadableStream,t)}function L(e){var t;let r=e._ownerReadableStream;"readable"===r._state?P(e,TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):(t=TypeError("Reader was released and can no longer be used to monitor the stream's closedness"),g(e),P(e,t)),r._readableStreamController[N](),r._reader=void 0,e._ownerReadableStream=void 0}function y(e){return TypeError("Cannot "+e+" a stream using a released reader")}function g(e){e._closedPromise=c((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function P(e,t){void 0!==e._closedPromise_reject&&(h(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function b(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let D=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},v=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function M(e,t){var r;if(void 0!==e&&"object"!=typeof(r=e)&&"function"!=typeof r)throw TypeError(`${t} is not an object.`)}function U(e,t){if("function"!=typeof e)throw TypeError(`${t} is not a function.`)}function w(e,t){if(!("object"==typeof e&&null!==e||"function"==typeof e))throw TypeError(`${t} is not an object.`)}function G(e,t,r){if(void 0===e)throw TypeError(`Parameter ${t} is required in '${r}'.`)}function B(e,t,r){if(void 0===e)throw TypeError(`${t} is required in '${r}'.`)}function F(e){return Number(e)}function H(e,t){var r,a;let s=Number.MAX_SAFE_INTEGER,i=Number(e);if(!D(i=0===(r=i)?0:r))throw TypeError(`${t} is not a finite number`);if((i=0===(a=v(i))?0:a)<0||i>s)throw TypeError(`${t} is outside the accepted range of 0 to ${s}, inclusive`);return D(i)&&0!==i?i:0}function x(e){if(!i(e)||"function"!=typeof e.getReader)return!1;try{return"boolean"==typeof e.locked}catch(e){return!1}}function k(e){if(!i(e)||"function"!=typeof e.getWriter)return!1;try{return"boolean"==typeof e.locked}catch(e){return!1}}function Y(e,t){if(!tf(e))throw TypeError(`${t} is not a ReadableStream.`)}function V(e,t){e._reader._readRequests.push(t)}function $(e,t,r){let a=e._reader._readRequests.shift();r?a._closeSteps():a._chunkSteps(t)}function W(e){return e._reader._readRequests.length}function j(e){let t=e._reader;return void 0!==t&&!!K(t)}class X{constructor(e){if(G(e,1,"ReadableStreamDefaultReader"),Y(e,"First parameter"),tN(e))throw TypeError("This stream has already been locked for exclusive reading by another reader");m(this,e),this._readRequests=new S}get closed(){return K(this)?this._closedPromise:u(q("closed"))}cancel(e){return K(this)?void 0===this._ownerReadableStream?u(y("cancel")):C(this,e):u(q("cancel"))}read(){let e,t;if(!K(this))return u(q("read"));if(void 0===this._ownerReadableStream)return u(y("read from"));let r=c((r,a)=>{e=r,t=a});return function(e,t){let r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[f](t)}(this,{_chunkSteps:t=>e({value:t,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:e=>t(e)}),r}releaseLock(){if(!K(this))throw q("releaseLock");void 0!==this._ownerReadableStream&&function(e){L(e);let t=TypeError("Reader was released");Z(e,t)}(this)}}function K(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof X}function Z(e,t){let r=e._readRequests;e._readRequests=new S,r.forEach(e=>{e._errorSteps(t)})}function q(e){return TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}Object.defineProperties(X.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),n(X.prototype.cancel,"cancel"),n(X.prototype.read,"read"),n(X.prototype.releaseLock,"releaseLock"),"symbol"==typeof a.toStringTag&&Object.defineProperty(X.prototype,a.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});class J{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){let e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?T(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){let t=()=>this._returnSteps(e);return this._ongoingPromise?T(this._ongoingPromise,t,t):t()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let e=this._reader;return void 0===e?u(y("iterate")):T(e.read(),e=>{var t;return this._ongoingPromise=void 0,e.done&&(this._isFinished=!0,null===(t=this._reader)||void 0===t||t.releaseLock(),this._reader=void 0),e},e=>{var t;throw this._ongoingPromise=void 0,this._isFinished=!0,null===(t=this._reader)||void 0===t||t.releaseLock(),this._reader=void 0,e})}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;let t=this._reader;if(void 0===t)return u(y("finish iterating"));if(this._reader=void 0,!this._preventCancel){let r=t.cancel(e);return t.releaseLock(),T(r,()=>({value:e,done:!0}),void 0)}return t.releaseLock(),E({value:e,done:!0})}}let z={next(){return Q(this)?this._asyncIteratorImpl.next():u(ee("next"))},return(e){return Q(this)?this._asyncIteratorImpl.return(e):u(ee("return"))}};function Q(e){if(!i(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof J}catch(e){return!1}}function ee(e){return TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}"symbol"==typeof a.asyncIterator&&Object.defineProperty(z,a.asyncIterator,{value(){return this},writable:!0,configurable:!0});let et=Number.isNaN||function(e){return e!=e};function er(e,t,r,a,s){new Uint8Array(e).set(new Uint8Array(r,a,s),t)}function ea(e){let t=function(e,t,r){if(e.slice)return e.slice(t,r);let a=r-t,s=new ArrayBuffer(a);return er(s,0,e,t,a),s}(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function es(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function ei(e,t,r){if("number"!=typeof r||et(r)||r<0||r===1/0)throw RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function en(e){e._queue=new S,e._queueTotalSize=0}class eo{constructor(){throw TypeError("Illegal constructor")}get view(){if(!eu(this))throw eP("view");return this._view}respond(e){if(!eu(this))throw eP("respond");if(G(e,1,"respond"),e=H(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");this._view.buffer,function(e,t){let r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw RangeError("bytesWritten out of range")}r.buffer=r.buffer,eN(e,t)}(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!eu(this))throw eP("respondWithNewView");if(G(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");e.buffer,function(e,t){let r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw RangeError("The region specified by view is larger than byobRequest");let a=t.byteLength;r.buffer=t.buffer,eN(e,a)}(this._associatedReadableByteStreamController,e)}}Object.defineProperties(eo.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),n(eo.prototype.respond,"respond"),n(eo.prototype.respondWithNewView,"respondWithNewView"),"symbol"==typeof a.toStringTag&&Object.defineProperty(eo.prototype,a.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class el{constructor(){throw TypeError("Illegal constructor")}get byobRequest(){if(!eE(this))throw eb("byobRequest");return function(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),a=Object.create(eo.prototype);a._associatedReadableByteStreamController=e,a._view=r,e._byobRequest=a}return e._byobRequest}(this)}get desiredSize(){if(!eE(this))throw eb("desiredSize");return eg(this)}close(){if(!eE(this))throw eb("close");if(this._closeRequested)throw TypeError("The stream has already been closed; do not close it again!");let e=this._controlledReadableByteStream._state;if("readable"!==e)throw TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);!function(e){let t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state){if(e._queueTotalSize>0)return void(e._closeRequested=!0);if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let t=TypeError("Insufficient bytes to fill elements in the given buffer");throw eL(e,t),t}eC(e),tC(t)}}(this)}enqueue(e){if(!eE(this))throw eb("enqueue");if(G(e,1,"enqueue"),!ArrayBuffer.isView(e))throw TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw TypeError("stream is closed or draining");let t=this._controlledReadableByteStream._state;if("readable"!==t)throw TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);!function(e,t){let r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;let a=t.buffer,s=t.byteOffset,i=t.byteLength;if(e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek();t.buffer,eI(e),t.buffer=t.buffer,"none"===t.readerType&&eR(e,t)}j(r)?(function(e){let t=e._controlledReadableByteStream._reader;for(;t._readRequests.length>0;){if(0===e._queueTotalSize)return;ey(e,t._readRequests.shift())}}(e),0===W(r))?eA(e,a,s,i):(e._pendingPullIntos.length>0&&em(e),$(r,new Uint8Array(a,s,i),!1)):eM(r)?(eA(e,a,s,i),ef(e)):eA(e,a,s,i),ec(e)}(this,e)}error(e){if(!eE(this))throw eb("error");eL(this,e)}[I](e){eT(this),en(this);let t=this._cancelAlgorithm(e);return eC(this),t}[f](e){let t=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void ey(this,e);let r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(t){return void e._errorSteps(t)}let a={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(a)}V(t,e),ec(this)}[N](){if(this._pendingPullIntos.length>0){let e=this._pendingPullIntos.peek();e.readerType="none",this._pendingPullIntos=new S,this._pendingPullIntos.push(e)}}}function eE(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof el}function eu(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof eo}function ec(e){let t=function(e){let t=e._controlledReadableByteStream;return"readable"===t._state&&!e._closeRequested&&!!e._started&&!!(j(t)&&W(t)>0||eM(t)&&ev(t)>0||eg(e)>0)}(e);if(t){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,d(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ec(e)),null),t=>(eL(e,t),null))}}function eT(e){eI(e),e._pendingPullIntos=new S}function ed(e,t){let r=!1;"closed"===e._state&&(r=!0);let a=eh(t);"default"===t.readerType?$(e,a,r):function(e,t,r){let a=e._reader._readIntoRequests.shift();r?a._closeSteps(t):a._chunkSteps(t)}(e,a,r)}function eh(e){let t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function eA(e,t,r,a){e._queue.push({buffer:t,byteOffset:r,byteLength:a}),e._queueTotalSize+=a}function ep(e,t,r,a){let s;try{s=t.slice(r,r+a)}catch(t){throw eL(e,t),t}eA(e,s,0,a)}function eR(e,t){t.bytesFilled>0&&ep(e,t.buffer,t.byteOffset,t.bytesFilled),em(e)}function eS(e,t){let r=t.elementSize,a=t.bytesFilled-t.bytesFilled%r,s=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),i=t.bytesFilled+s,n=i-i%r,o=s,l=!1;n>a&&(o=n-t.bytesFilled,l=!0);let E=e._queue;for(;o>0;){let r=E.peek(),a=Math.min(o,r.byteLength),s=t.byteOffset+t.bytesFilled;er(t.buffer,s,r.buffer,r.byteOffset,a),r.byteLength===a?E.shift():(r.byteOffset+=a,r.byteLength-=a),e._queueTotalSize-=a,e_(e,a,t),o-=a}return l}function e_(e,t,r){r.bytesFilled+=t}function eO(e){0===e._queueTotalSize&&e._closeRequested?(eC(e),tC(e._controlledReadableByteStream)):ec(e)}function eI(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ef(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;let t=e._pendingPullIntos.peek();eS(e,t)&&(em(e),ed(e._controlledReadableByteStream,t))}}function eN(e,t){let r=e._pendingPullIntos.peek();eI(e),"closed"===e._controlledReadableByteStream._state?function(e,t){"none"===t.readerType&&em(e);let r=e._controlledReadableByteStream;if(eM(r))for(;ev(r)>0;)ed(r,em(e))}(e,r):function(e,t,r){if(e_(0,t,r),"none"===r.readerType)return eR(e,r),void ef(e);if(r.bytesFilled<r.elementSize)return;em(e);let a=r.bytesFilled%r.elementSize;if(a>0){let t=r.byteOffset+r.bytesFilled;ep(e,r.buffer,t-a,a)}r.bytesFilled-=a,ed(e._controlledReadableByteStream,r),ef(e)}(e,t,r),ec(e)}function em(e){return e._pendingPullIntos.shift()}function eC(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function eL(e,t){let r=e._controlledReadableByteStream;"readable"===r._state&&(eT(e),en(e),eC(e),tL(r,t))}function ey(e,t){let r=e._queue.shift();e._queueTotalSize-=r.byteLength,eO(e);let a=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(a)}function eg(e){let t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function eP(e){return TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function eb(e){return TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function eD(e,t){e._reader._readIntoRequests.push(t)}function ev(e){return e._reader._readIntoRequests.length}function eM(e){let t=e._reader;return void 0!==t&&!!ew(t)}Object.defineProperties(el.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),n(el.prototype.close,"close"),n(el.prototype.enqueue,"enqueue"),n(el.prototype.error,"error"),"symbol"==typeof a.toStringTag&&Object.defineProperty(el.prototype,a.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class eU{constructor(e){if(G(e,1,"ReadableStreamBYOBReader"),Y(e,"First parameter"),tN(e))throw TypeError("This stream has already been locked for exclusive reading by another reader");if(!eE(e._readableStreamController))throw TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");m(this,e),this._readIntoRequests=new S}get closed(){return ew(this)?this._closedPromise:u(eB("closed"))}cancel(e){return ew(this)?void 0===this._ownerReadableStream?u(y("cancel")):C(this,e):u(eB("cancel"))}read(e){let t,r;if(!ew(this))return u(eB("read"));if(!ArrayBuffer.isView(e))return u(TypeError("view must be an array buffer view"));if(0===e.byteLength)return u(TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return u(TypeError("view's buffer must have non-zero byteLength"));if(e.buffer,void 0===this._ownerReadableStream)return u(y("read from"));let a=c((e,a)=>{t=e,r=a});return function(e,t,r){let a=e._ownerReadableStream;a._disturbed=!0,"errored"===a._state?r._errorSteps(a._storedError):function(e,t,r){let a=e._controlledReadableByteStream,s=1;t.constructor!==DataView&&(s=t.constructor.BYTES_PER_ELEMENT);let i=t.constructor,n=t.buffer,o={buffer:n,bufferByteLength:n.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:s,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(o),void eD(a,r);if("closed"!==a._state){if(e._queueTotalSize>0){if(eS(e,o)){let t=eh(o);return eO(e),void r._chunkSteps(t)}if(e._closeRequested){let t=TypeError("Insufficient bytes to fill elements in the given buffer");return eL(e,t),void r._errorSteps(t)}}e._pendingPullIntos.push(o),eD(a,r),ec(e)}else{let e=new i(o.buffer,o.byteOffset,0);r._closeSteps(e)}}(a._readableStreamController,t,r)}(this,e,{_chunkSteps:e=>t({value:e,done:!1}),_closeSteps:e=>t({value:e,done:!0}),_errorSteps:e=>r(e)}),a}releaseLock(){if(!ew(this))throw eB("releaseLock");void 0!==this._ownerReadableStream&&function(e){L(e);let t=TypeError("Reader was released");eG(e,t)}(this)}}function ew(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof eU}function eG(e,t){let r=e._readIntoRequests;e._readIntoRequests=new S,r.forEach(e=>{e._errorSteps(t)})}function eB(e){return TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function eF(e,t){let{highWaterMark:r}=e;if(void 0===r)return t;if(et(r)||r<0)throw RangeError("Invalid highWaterMark");return r}function eH(e){let{size:t}=e;return t||(()=>1)}function ex(e,t){M(e,t);let r=null==e?void 0:e.highWaterMark,a=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:F(r),size:void 0===a?void 0:(U(a,`${t} has member 'size' that`),e=>F(a(e)))}}Object.defineProperties(eU.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),n(eU.prototype.cancel,"cancel"),n(eU.prototype.read,"read"),n(eU.prototype.releaseLock,"releaseLock"),"symbol"==typeof a.toStringTag&&Object.defineProperty(eU.prototype,a.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});let ek="function"==typeof AbortController;class WritableStream{constructor(e={},t={}){void 0===e?e=null:w(e,"First parameter");let r=ex(t,"Second parameter"),a=function(e,t){M(e,t);let r=null==e?void 0:e.abort,a=null==e?void 0:e.close,s=null==e?void 0:e.start,i=null==e?void 0:e.type,n=null==e?void 0:e.write;return{abort:void 0===r?void 0:(U(r,`${t} has member 'abort' that`),t=>R(r,e,[t])),close:void 0===a?void 0:(U(a,`${t} has member 'close' that`),()=>R(a,e,[])),start:void 0===s?void 0:(U(s,`${t} has member 'start' that`),t=>p(s,e,[t])),write:void 0===n?void 0:(U(n,`${t} has member 'write' that`),(t,r)=>R(n,e,[t,r])),type:i}}(e,"First parameter");if(this._state="writable",this._storedError=void 0,this._writer=void 0,this._writableStreamController=void 0,this._writeRequests=new S,this._inFlightWriteRequest=void 0,this._closeRequest=void 0,this._inFlightCloseRequest=void 0,this._pendingAbortRequest=void 0,this._backpressure=!1,void 0!==a.type)throw RangeError("Invalid type is specified");let s=eH(r);!function(e,t,r,a){let s,i;let n=Object.create(e2.prototype);s=void 0!==t.start?()=>t.start(n):()=>{},i=void 0!==t.write?e=>t.write(e,n):()=>E(void 0),function(e,t,r,a,s,i,n,o){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,en(t),t._abortReason=void 0,t._abortController=function(){if(ek)return new AbortController}(),t._started=!1,t._strategySizeAlgorithm=o,t._strategyHWM=n,t._writeAlgorithm=a,t._closeAlgorithm=s,t._abortAlgorithm=i;let l=0>=e5(t);eJ(e,l);let u=r();d(E(u),()=>(t._started=!0,e3(t),null),r=>(t._started=!0,ej(e,r),null))}(e,n,s,i,void 0!==t.close?()=>t.close():()=>E(void 0),void 0!==t.abort?e=>t.abort(e):()=>E(void 0),r,a)}(this,a,eF(r,1),s)}get locked(){if(!eY(this))throw e7("locked");return eV(this)}abort(e){return eY(this)?eV(this)?u(TypeError("Cannot abort a stream that already has a writer")):e$(this,e):u(e7("abort"))}close(){return eY(this)?eV(this)?u(TypeError("Cannot close a stream that already has a writer")):eZ(this)?u(TypeError("Cannot close an already-closing stream")):eW(this):u(e7("close"))}getWriter(){if(!eY(this))throw e7("getWriter");return new ez(this)}}function eY(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof WritableStream}function eV(e){return void 0!==e._writer}function e$(e,t){var r;if("closed"===e._state||"errored"===e._state)return E(void 0);e._writableStreamController._abortReason=t,null===(r=e._writableStreamController._abortController)||void 0===r||r.abort(t);let a=e._state;if("closed"===a||"errored"===a)return E(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let s=!1;"erroring"===a&&(s=!0,t=void 0);let i=c((r,a)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:a,_reason:t,_wasAlreadyErroring:s}});return e._pendingAbortRequest._promise=i,s||eX(e,t),i}function eW(e){var t;let r=e._state;if("closed"===r||"errored"===r)return u(TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let a=c((t,r)=>{e._closeRequest={_resolve:t,_reject:r}}),s=e._writer;return void 0!==s&&e._backpressure&&"writable"===r&&tE(s),ei(t=e._writableStreamController,e1,0),e3(t),a}function ej(e,t){"writable"!==e._state?eK(e):eX(e,t)}function eX(e,t){let r=e._writableStreamController;e._state="erroring",e._storedError=t;let a=e._writer;void 0!==a&&e0(a,t),!(void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest)&&r._started&&eK(e)}function eK(e){e._state="errored",e._writableStreamController[O]();let t=e._storedError;if(e._writeRequests.forEach(e=>{e._reject(t)}),e._writeRequests=new S,void 0===e._pendingAbortRequest)return void eq(e);let r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void eq(e);d(e._writableStreamController[_](r._reason),()=>(r._resolve(),eq(e),null),t=>(r._reject(t),eq(e),null))}function eZ(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function eq(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;void 0!==t&&ts(t,e._storedError)}function eJ(e,t){let r=e._writer;void 0!==r&&t!==e._backpressure&&(t?tn(r):tE(r)),e._backpressure=t}Object.defineProperties(WritableStream.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),n(WritableStream.prototype.abort,"abort"),n(WritableStream.prototype.close,"close"),n(WritableStream.prototype.getWriter,"getWriter"),"symbol"==typeof a.toStringTag&&Object.defineProperty(WritableStream.prototype,a.toStringTag,{value:"WritableStream",configurable:!0});class ez{constructor(e){if(G(e,1,"WritableStreamDefaultWriter"),function(e,t){if(!eY(e))throw TypeError(`${t} is not a WritableStream.`)}(e,"First parameter"),eV(e))throw TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;let t=e._state;if("writable"===t)!eZ(e)&&e._backpressure?tn(this):function(e){tn(e),tE(e)}(this),ta(this);else if("erroring"===t)to(this,e._storedError),ta(this);else if("closed"===t)(function(e){tn(e),tE(e)})(this),ta(this),ti(this);else{let t=e._storedError;to(this,t),function(e,t){ta(e),ts(e,t)}(this,t)}}get closed(){return eQ(this)?this._closedPromise:u(tt("closed"))}get desiredSize(){if(!eQ(this))throw tt("desiredSize");if(void 0===this._ownerWritableStream)throw tr("desiredSize");return function(e){let t=e._ownerWritableStream,r=t._state;return"errored"===r||"erroring"===r?null:"closed"===r?0:e5(t._writableStreamController)}(this)}get ready(){return eQ(this)?this._readyPromise:u(tt("ready"))}abort(e){return eQ(this)?void 0===this._ownerWritableStream?u(tr("abort")):e$(this._ownerWritableStream,e):u(tt("abort"))}close(){if(!eQ(this))return u(tt("close"));let e=this._ownerWritableStream;return void 0===e?u(tr("close")):eZ(e)?u(TypeError("Cannot close an already-closing stream")):eW(this._ownerWritableStream)}releaseLock(){if(!eQ(this))throw tt("releaseLock");void 0!==this._ownerWritableStream&&function(e){let t=e._ownerWritableStream,r=TypeError("Writer was released and can no longer be used to monitor the stream's closedness");e0(e,r),"pending"===e._closedPromiseState||ta(e),ts(e,r),t._writer=void 0,e._ownerWritableStream=void 0}(this)}write(e){return eQ(this)?void 0===this._ownerWritableStream?u(tr("write to")):function(e,t){let r=e._ownerWritableStream,a=r._writableStreamController,s=function(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return e6(e,t),1}}(a,t);if(r!==e._ownerWritableStream)return u(tr("write to"));let i=r._state;if("errored"===i)return u(r._storedError);if(eZ(r)||"closed"===i)return u(TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return u(r._storedError);let n=c((e,t)=>{r._writeRequests.push({_resolve:e,_reject:t})});return function(e,t,r){try{ei(e,t,r)}catch(t){return void e6(e,t)}let a=e._controlledWritableStream;eZ(a)||"writable"!==a._state||eJ(a,0>=e5(e)),e3(e)}(a,t,s),n}(this,e):u(tt("write"))}}function eQ(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof ez}function e0(e,t){"pending"===e._readyPromiseState?tl(e,t):to(e,t)}Object.defineProperties(ez.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),n(ez.prototype.abort,"abort"),n(ez.prototype.close,"close"),n(ez.prototype.releaseLock,"releaseLock"),n(ez.prototype.write,"write"),"symbol"==typeof a.toStringTag&&Object.defineProperty(ez.prototype,a.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});let e1={};class e2{constructor(){throw TypeError("Illegal constructor")}get abortReason(){if(!e4(this))throw te("abortReason");return this._abortReason}get signal(){if(!e4(this))throw te("signal");if(void 0===this._abortController)throw TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e){if(!e4(this))throw te("error");"writable"===this._controlledWritableStream._state&&e8(this,e)}[_](e){let t=this._abortAlgorithm(e);return e9(this),t}[O](){en(this)}}function e4(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof e2}function e9(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function e5(e){return e._strategyHWM-e._queueTotalSize}function e3(e){let t=e._controlledWritableStream;if(!e._started||void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state)return void eK(t);if(0===e._queue.length)return;let r=e._queue.peek().value;r===e1?function(e){let t=e._controlledWritableStream;t._inFlightCloseRequest=t._closeRequest,t._closeRequest=void 0,es(e);let r=e._closeAlgorithm();e9(e),d(r,()=>((function(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let t=e._writer;void 0!==t&&ti(t)})(t),null),e=>(t._inFlightCloseRequest._reject(e),t._inFlightCloseRequest=void 0,void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._reject(e),t._pendingAbortRequest=void 0),ej(t,e),null))}(e):function(e,t){let r=e._controlledWritableStream;r._inFlightWriteRequest=r._writeRequests.shift(),d(e._writeAlgorithm(t),()=>{r._inFlightWriteRequest._resolve(void 0),r._inFlightWriteRequest=void 0;let t=r._state;if(es(e),!eZ(r)&&"writable"===t){let t=0>=e5(e);eJ(r,t)}return e3(e),null},t=>("writable"===r._state&&e9(e),r._inFlightWriteRequest._reject(t),r._inFlightWriteRequest=void 0,ej(r,t),null))}(e,r)}function e6(e,t){"writable"===e._controlledWritableStream._state&&e8(e,t)}function e8(e,t){let r=e._controlledWritableStream;e9(e),eX(r,t)}function e7(e){return TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function te(e){return TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function tt(e){return TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function tr(e){return TypeError("Cannot "+e+" a stream using a released writer")}function ta(e){e._closedPromise=c((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function ts(e,t){void 0!==e._closedPromise_reject&&(h(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function ti(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function tn(e){e._readyPromise=c((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function to(e,t){tn(e),tl(e,t)}function tl(e,t){void 0!==e._readyPromise_reject&&(h(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function tE(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(e2.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof a.toStringTag&&Object.defineProperty(e2.prototype,a.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});let tu="undefined"!=typeof DOMException?DOMException:void 0,tc=!function(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}(tu)?function(){let e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}():tu;function tT(e,t,r,a,s,i){let n=e.getReader(),o=t.getWriter();tf(e)&&(e._disturbed=!0);let l,p,R,S=!1,_=!1,O="readable",I="writable",f=!1,N=!1,m=c(e=>{R=e}),C=Promise.resolve(void 0);return c((L,y)=>{let g;function P(){if(S)return;let e=c((e,t)=>{!function r(a){a?e():T(S?E(!0):T(o.ready,()=>T(n.read(),e=>!!e.done||(h(C=o.write(e.value)),!1))),r,t)}(!1)});h(e)}function b(){return O="closed",r?U():M(()=>(eY(t)&&(f=eZ(t),I=t._state),f||"closed"===I?E(void 0):"erroring"===I||"errored"===I?u(p):(f=!0,o.close())),!1,void 0),null}function D(e){return S||(O="errored",l=e,a?U(!0,e):M(()=>o.abort(e),!0,e)),null}function v(e){return _||(I="errored",p=e,s?U(!0,e):M(()=>n.cancel(e),!0,e)),null}if(void 0!==i&&(g=()=>{let e=void 0!==i.reason?i.reason:new tc("Aborted","AbortError"),t=[];a||t.push(()=>"writable"===I?o.abort(e):E(void 0)),s||t.push(()=>"readable"===O?n.cancel(e):E(void 0)),M(()=>Promise.all(t.map(e=>e())),!0,e)},i.aborted?g():i.addEventListener("abort",g)),tf(e)&&(O=e._state,l=e._storedError),eY(t)&&(I=t._state,p=t._storedError,f=eZ(t)),tf(e)&&eY(t)&&(N=!0,R()),"errored"===O)D(l);else if("erroring"===I||"errored"===I)v(p);else if("closed"===O)b();else if(f||"closed"===I){let e=TypeError("the destination writable stream closed before all data could be piped to it");s?U(!0,e):M(()=>n.cancel(e),!0,e)}function M(e,t,r){function a(){let e;return"writable"!==I||f?s():d(E(function t(){if(e!==C)return e=C,T(C,t,t)}()),s),null}function s(){return e?d(e(),()=>w(t,r),e=>w(!0,e)):w(t,r),null}S||(S=!0,N?a():d(m,a))}function U(e,t){M(void 0,e,t)}function w(e,t){return _=!0,o.releaseLock(),n.releaseLock(),void 0!==i&&i.removeEventListener("abort",g),e?y(t):L(void 0),null}S||(d(n.closed,b,D),d(o.closed,function(){return _||(I="closed"),null},v)),N?P():A(()=>{N=!0,R(),P()})})}class td{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!th(this))throw tO("desiredSize");return tS(this)}close(){if(!th(this))throw tO("close");if(!t_(this))throw TypeError("The stream is not in a state that permits close");!function(e){if(!t_(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(tp(e),tC(t))}(this)}enqueue(e){if(!th(this))throw tO("enqueue");if(!t_(this))throw TypeError("The stream is not in a state that permits enqueue");return function(e,t){if(!t_(e))return;let r=e._controlledReadableStream;if(tN(r)&&W(r)>0)$(r,t,!1);else{let r;try{r=e._strategySizeAlgorithm(t)}catch(t){throw tR(e,t),t}try{ei(e,t,r)}catch(t){throw tR(e,t),t}}tA(e)}(this,e)}error(e){if(!th(this))throw tO("error");tR(this,e)}[I](e){en(this);let t=this._cancelAlgorithm(e);return tp(this),t}[f](e){let t=this._controlledReadableStream;if(this._queue.length>0){let r=es(this);this._closeRequested&&0===this._queue.length?(tp(this),tC(t)):tA(this),e._chunkSteps(r)}else V(t,e),tA(this)}[N](){}}function th(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof td}function tA(e){let t=function(e){let t=e._controlledReadableStream;return!!t_(e)&&!!e._started&&!!(tN(t)&&W(t)>0||tS(e)>0)}(e);if(t){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,d(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,tA(e)),null),t=>(tR(e,t),null))}}function tp(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function tR(e,t){let r=e._controlledReadableStream;"readable"===r._state&&(en(e),tp(e),tL(r,t))}function tS(e){let t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function t_(e){return!e._closeRequested&&"readable"===e._controlledReadableStream._state}function tO(e){return TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function tI(e,t){M(e,t);let r=null==e?void 0:e.preventAbort,a=null==e?void 0:e.preventCancel,s=null==e?void 0:e.preventClose,i=null==e?void 0:e.signal;return void 0!==i&&function(e,t){if(!function(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}(e))throw TypeError(`${t} is not an AbortSignal.`)}(i,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!a,preventClose:!!s,signal:i}}Object.defineProperties(td.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),n(td.prototype.close,"close"),n(td.prototype.enqueue,"enqueue"),n(td.prototype.error,"error"),"symbol"==typeof a.toStringTag&&Object.defineProperty(td.prototype,a.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class ReadableStream{constructor(e={},t={}){void 0===e?e=null:w(e,"First parameter");let r=ex(t,"Second parameter"),a=function(e,t){M(e,t);let r=null==e?void 0:e.autoAllocateChunkSize,a=null==e?void 0:e.cancel,s=null==e?void 0:e.pull,i=null==e?void 0:e.start,n=null==e?void 0:e.type;return{autoAllocateChunkSize:void 0===r?void 0:H(r,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===a?void 0:(U(a,`${t} has member 'cancel' that`),t=>R(a,e,[t])),pull:void 0===s?void 0:(U(s,`${t} has member 'pull' that`),t=>R(s,e,[t])),start:void 0===i?void 0:(U(i,`${t} has member 'start' that`),t=>p(i,e,[t])),type:void 0===n?void 0:function(e,t){if("bytes"!=(e=`${e}`))throw TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}(n,`${t} has member 'type' that`)}}(e,"First parameter");if(this._state="readable",this._reader=void 0,this._storedError=void 0,this._disturbed=!1,"bytes"===a.type){if(void 0!==r.size)throw RangeError("The strategy for a byte stream cannot have a size function");!function(e,t,r){let a,s,i;let n=Object.create(el.prototype);a=void 0!==t.start?()=>t.start(n):()=>{},s=void 0!==t.pull?()=>t.pull(n):()=>E(void 0),i=void 0!==t.cancel?e=>t.cancel(e):()=>E(void 0);let o=t.autoAllocateChunkSize;if(0===o)throw TypeError("autoAllocateChunkSize must be greater than 0");n._controlledReadableByteStream=e,n._pullAgain=!1,n._pulling=!1,n._byobRequest=null,n._queue=n._queueTotalSize=void 0,en(n),n._closeRequested=!1,n._started=!1,n._strategyHWM=r,n._pullAlgorithm=s,n._cancelAlgorithm=i,n._autoAllocateChunkSize=o,n._pendingPullIntos=new S,e._readableStreamController=n,d(E(a()),()=>(n._started=!0,ec(n),null),e=>(eL(n,e),null))}(this,a,eF(r,0))}else{let e=eH(r);!function(e,t,r,a){let s,i,n;let o=Object.create(td.prototype);s=void 0!==t.start?()=>t.start(o):()=>{},i=void 0!==t.pull?()=>t.pull(o):()=>E(void 0),n=void 0!==t.cancel?e=>t.cancel(e):()=>E(void 0),o._controlledReadableStream=e,o._queue=void 0,o._queueTotalSize=void 0,en(o),o._started=!1,o._closeRequested=!1,o._pullAgain=!1,o._pulling=!1,o._strategySizeAlgorithm=a,o._strategyHWM=r,o._pullAlgorithm=i,o._cancelAlgorithm=n,e._readableStreamController=o,d(E(s()),()=>(o._started=!0,tA(o),null),e=>(tR(o,e),null))}(this,a,eF(r,1),e)}}get locked(){if(!tf(this))throw ty("locked");return tN(this)}cancel(e){return tf(this)?tN(this)?u(TypeError("Cannot cancel a stream that already has a reader")):tm(this,e):u(ty("cancel"))}getReader(e){if(!tf(this))throw ty("getReader");return void 0===function(e,t){M(e,t);let r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:function(e,t){if("byob"!=(e=`${e}`))throw TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}(r,`${t} has member 'mode' that`)}}(e,"First parameter").mode?new X(this):new eU(this)}pipeThrough(e,t={}){if(!x(this))throw ty("pipeThrough");G(e,1,"pipeThrough");let r=function(e,t){M(e,t);let r=null==e?void 0:e.readable;B(r,"readable","ReadableWritablePair"),function(e,t){if(!x(e))throw TypeError(`${t} is not a ReadableStream.`)}(r,`${t} has member 'readable' that`);let a=null==e?void 0:e.writable;return B(a,"writable","ReadableWritablePair"),function(e,t){if(!k(e))throw TypeError(`${t} is not a WritableStream.`)}(a,`${t} has member 'writable' that`),{readable:r,writable:a}}(e,"First parameter"),a=tI(t,"Second parameter");if(this.locked)throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(r.writable.locked)throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return h(tT(this,r.writable,a.preventClose,a.preventAbort,a.preventCancel,a.signal)),r.readable}pipeTo(e,t={}){let r;if(!x(this))return u(ty("pipeTo"));if(void 0===e)return u("Parameter 1 is required in 'pipeTo'.");if(!k(e))return u(TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));try{r=tI(t,"Second parameter")}catch(e){return u(e)}return this.locked?u(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):e.locked?u(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):tT(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!x(this))throw ty("tee");if(this.locked)throw TypeError("Cannot tee a stream that already has a reader");return!function(e){try{return e.getReader({mode:"byob"}).releaseLock(),!0}catch(e){return!1}}(this)?function(e,t){let r=e.getReader(),a,s,i,n,o,l=!1,u=!1,T=!1,h=!1,A=c(e=>{o=e});function p(){return l?u=!0:(l=!0,d(r.read(),e=>{if(u=!1,e.done)return T||i.close(),h||n.close(),T&&h||o(void 0),null;let t=e.value;return T||i.enqueue(t),h||n.enqueue(t),l=!1,u&&p(),null},()=>(l=!1,null))),E(void 0)}let R=new ReadableStream({start(e){i=e},pull:p,cancel:function(e){if(T=!0,a=e,h){let e=[a,s],t=r.cancel(e);o(t)}return A}}),S=new ReadableStream({start(e){n=e},pull:p,cancel:function(e){if(h=!0,s=e,T){let e=[a,s],t=r.cancel(e);o(t)}return A}});return d(r.closed,void 0,e=>(i.error(e),n.error(e),T&&h||o(void 0),null)),[R,S]}(this):function(e){let t,r,a,s,i,n=e.getReader(),o=!1,l=!1,u=!1,T=!1,h=!1,A=!1,p=c(e=>{i=e});function R(e){d(e.closed,void 0,t=>(e!==n||(a.error(t),s.error(t),h&&A||i(void 0)),null))}function S(){o&&(n.releaseLock(),R(n=e.getReader()),o=!1),d(n.read(),e=>{var t,r;if(u=!1,T=!1,e.done)return h||a.close(),A||s.close(),null===(t=a.byobRequest)||void 0===t||t.respond(0),null===(r=s.byobRequest)||void 0===r||r.respond(0),h&&A||i(void 0),null;let o=e.value,E=o;if(!h&&!A)try{E=ea(o)}catch(e){return a.error(e),s.error(e),i(n.cancel(e)),null}return h||a.enqueue(o),A||s.enqueue(E),l=!1,u?O():T&&I(),null},()=>(l=!1,null))}function _(t,r){o||(n.releaseLock(),R(n=e.getReader({mode:"byob"})),o=!0);let E=r?s:a,c=r?a:s;d(n.read(t),e=>{var t;u=!1,T=!1;let a=r?A:h,s=r?h:A;if(e.done){a||E.close(),s||c.close();let r=e.value;return void 0!==r&&(a||E.byobRequest.respondWithNewView(r),s||null===(t=c.byobRequest)||void 0===t||t.respond(0)),a&&s||i(void 0),null}let o=e.value;if(s)a||E.byobRequest.respondWithNewView(o);else{let e;try{e=ea(o)}catch(e){return E.error(e),c.error(e),i(n.cancel(e)),null}a||E.byobRequest.respondWithNewView(o),c.enqueue(e)}return l=!1,u?O():T&&I(),null},()=>(l=!1,null))}function O(){if(l)return u=!0,E(void 0);l=!0;let e=a.byobRequest;return null===e?S():_(e.view,!1),E(void 0)}function I(){if(l)return T=!0,E(void 0);l=!0;let e=s.byobRequest;return null===e?S():_(e.view,!0),E(void 0)}let f=new ReadableStream({type:"bytes",start(e){a=e},pull:O,cancel:function(e){if(h=!0,t=e,A){let e=[t,r],a=n.cancel(e);i(a)}return p}}),N=new ReadableStream({type:"bytes",start(e){s=e},pull:I,cancel:function(e){if(A=!0,r=e,h){let e=[t,r],a=n.cancel(e);i(a)}return p}});return R(n),[f,N]}(this)}values(e){if(!x(this))throw ty("values");return function(e,t){let r=e.getReader(),a=new J(r,t),s=Object.create(z);return s._asyncIteratorImpl=a,s}(this,function(e,t){M(e,t);let r=null==e?void 0:e.preventCancel;return{preventCancel:!!r}}(e,"First parameter").preventCancel)}}function tf(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof ReadableStream}function tN(e){return void 0!==e._reader}function tm(e,t){if(e._disturbed=!0,"closed"===e._state)return E(void 0);if("errored"===e._state)return u(e._storedError);tC(e);let r=e._reader;if(void 0!==r&&ew(r)){let e=r._readIntoRequests;r._readIntoRequests=new S,e.forEach(e=>{e._closeSteps(void 0)})}return T(e._readableStreamController[I](t),s,void 0)}function tC(e){e._state="closed";let t=e._reader;if(void 0!==t&&(b(t),K(t))){let e=t._readRequests;t._readRequests=new S,e.forEach(e=>{e._closeSteps()})}}function tL(e,t){e._state="errored",e._storedError=t;let r=e._reader;void 0!==r&&(P(r,t),K(r)?Z(r,t):eG(r,t))}function ty(e){return TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function tg(e,t){M(e,t);let r=null==e?void 0:e.highWaterMark;return B(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:F(r)}}Object.defineProperties(ReadableStream.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),n(ReadableStream.prototype.cancel,"cancel"),n(ReadableStream.prototype.getReader,"getReader"),n(ReadableStream.prototype.pipeThrough,"pipeThrough"),n(ReadableStream.prototype.pipeTo,"pipeTo"),n(ReadableStream.prototype.tee,"tee"),n(ReadableStream.prototype.values,"values"),"symbol"==typeof a.toStringTag&&Object.defineProperty(ReadableStream.prototype,a.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof a.asyncIterator&&Object.defineProperty(ReadableStream.prototype,a.asyncIterator,{value:ReadableStream.prototype.values,writable:!0,configurable:!0});let tP=e=>e.byteLength;n(tP,"size");class ByteLengthQueuingStrategy{constructor(e){G(e,1,"ByteLengthQueuingStrategy"),e=tg(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!tD(this))throw tb("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!tD(this))throw tb("size");return tP}}function tb(e){return TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function tD(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")&&e instanceof ByteLengthQueuingStrategy}Object.defineProperties(ByteLengthQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof a.toStringTag&&Object.defineProperty(ByteLengthQueuingStrategy.prototype,a.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});let tv=()=>1;n(tv,"size");class CountQueuingStrategy{constructor(e){G(e,1,"CountQueuingStrategy"),e=tg(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!tU(this))throw tM("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!tU(this))throw tM("size");return tv}}function tM(e){return TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function tU(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")&&e instanceof CountQueuingStrategy}Object.defineProperties(CountQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof a.toStringTag&&Object.defineProperty(CountQueuingStrategy.prototype,a.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class tw{constructor(e={},t={},r={}){let a;void 0===e&&(e=null);let s=ex(t,"Second parameter"),i=ex(r,"Third parameter"),n=function(e,t){M(e,t);let r=null==e?void 0:e.flush,a=null==e?void 0:e.readableType,s=null==e?void 0:e.start,i=null==e?void 0:e.transform,n=null==e?void 0:e.writableType;return{flush:void 0===r?void 0:(U(r,`${t} has member 'flush' that`),t=>R(r,e,[t])),readableType:a,start:void 0===s?void 0:(U(s,`${t} has member 'start' that`),t=>p(s,e,[t])),transform:void 0===i?void 0:(U(i,`${t} has member 'transform' that`),(t,r)=>R(i,e,[t,r])),writableType:n}}(e,"First parameter");if(void 0!==n.readableType)throw RangeError("Invalid readableType specified");if(void 0!==n.writableType)throw RangeError("Invalid writableType specified");let o=eF(i,0),l=eH(i),d=eF(s,1),h=eH(s);(function(e,t,r,a,s,i){function n(){return t}e._writableState="writable",e._writableStoredError=void 0,e._writableHasInFlightOperation=!1,e._writableStarted=!1,e._writable=new WritableStream({start(r){e._writableController=r;try{let t=r.signal;void 0!==t&&t.addEventListener("abort",()=>{"writable"===e._writableState&&(e._writableState="erroring",t.reason&&(e._writableStoredError=t.reason))})}catch(e){}return T(t,()=>(e._writableStarted=!0,t0(e),null),t=>{throw e._writableStarted=!0,tJ(e,t),t})},write:t=>(e._writableHasInFlightOperation=!0,T(function(e,t){let r=e._transformStreamController;return e._backpressure?T(e._backpressureChangePromise,()=>{if("erroring"===(eY(e._writable)?e._writable._state:e._writableState))throw eY(e._writable)?e._writable._storedError:e._writableStoredError;return t$(r,t)},void 0):t$(r,t)}(e,t),()=>(e._writableHasInFlightOperation=!1,t0(e),null),t=>{throw e._writableHasInFlightOperation=!1,tJ(e,t),t})),close:()=>(e._writableHasInFlightOperation=!0,T(function(e){let t=e._transformStreamController,r=t._flushAlgorithm();return tY(t),T(r,()=>{if("errored"===e._readableState)throw e._readableStoredError;tX(e)&&tK(e)},t=>{throw tB(e,t),e._readableStoredError})}(e),()=>(e._writableHasInFlightOperation=!1,"erroring"===e._writableState&&(e._writableStoredError=void 0),e._writableState="closed",null),t=>{throw e._writableHasInFlightOperation=!1,e._writableState,tJ(e,t),t})),abort:t=>(e._writableState="errored",e._writableStoredError=t,tB(e,t),E(void 0))},{highWaterMark:r,size:a}),e._readableState="readable",e._readableStoredError=void 0,e._readableCloseRequested=!1,e._readablePulling=!1,e._readable=new ReadableStream({start:r=>(e._readableController=r,t.catch(t=>{tZ(e,t)})),pull:()=>(e._readablePulling=!0,(tH(e,!1),e._backpressureChangePromise).catch(t=>{tZ(e,t)})),cancel:t=>(e._readableState="closed",tF(e,t),E(void 0))},{highWaterMark:s,size:i}),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,tH(e,!0),e._transformStreamController=void 0})(this,c(e=>{a=e}),d,h,o,l),function(e,t){let r,a;let s=Object.create(tx.prototype);r=void 0!==t.transform?e=>t.transform(e,s):e=>{try{return tV(s,e),E(void 0)}catch(e){return u(e)}},a=void 0!==t.flush?()=>t.flush(s):()=>E(void 0),s._controlledTransformStream=e,e._transformStreamController=s,s._transformAlgorithm=r,s._flushAlgorithm=a}(this,n),void 0!==n.start?a(n.start(this._transformStreamController)):a(void 0)}get readable(){if(!tG(this))throw tj("readable");return this._readable}get writable(){if(!tG(this))throw tj("writable");return this._writable}}function tG(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof tw}function tB(e,t){tZ(e,t),tF(e,t)}function tF(e,t){tY(e._transformStreamController),e._writableController.error(t),"writable"===e._writableState&&tz(e,t),e._backpressure&&tH(e,!1)}function tH(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=c(t=>{e._backpressureChangePromise_resolve=t}),e._backpressure=t}Object.defineProperties(tw.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof a.toStringTag&&Object.defineProperty(tw.prototype,a.toStringTag,{value:"TransformStream",configurable:!0});class tx{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!tk(this))throw tW("desiredSize");return tq(this._controlledTransformStream)}enqueue(e){if(!tk(this))throw tW("enqueue");tV(this,e)}error(e){if(!tk(this))throw tW("error");tB(this._controlledTransformStream,e)}terminate(){if(!tk(this))throw tW("terminate");!function(e){let t=e._controlledTransformStream;tX(t)&&tK(t);let r=TypeError("TransformStream terminated");tF(t,r)}(this)}}function tk(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof tx}function tY(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function tV(e,t){let r=e._controlledTransformStream;if(!tX(r))throw TypeError("Readable side is not in a state that permits enqueue");try{!function(e,t){e._readablePulling=!1;try{e._readableController.enqueue(t)}catch(t){throw tZ(e,t),t}}(r,t)}catch(e){throw tF(r,e),r._readableStoredError}let a=!(tX(r)&&(r._readablePulling||tq(r)>0));a!==r._backpressure&&tH(r,!0)}function t$(e,t){return T(e._transformAlgorithm(t),void 0,t=>{throw tB(e._controlledTransformStream,t),t})}function tW(e){return TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function tj(e){return TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}function tX(e){return!e._readableCloseRequested&&"readable"===e._readableState}function tK(e){e._readableState="closed",e._readableCloseRequested=!0,e._readableController.close()}function tZ(e,t){"readable"===e._readableState&&(e._readableState="errored",e._readableStoredError=t),e._readableController.error(t)}function tq(e){return e._readableController.desiredSize}function tJ(e,t){"writable"!==e._writableState?tQ(e):tz(e,t)}function tz(e,t){e._writableState="erroring",e._writableStoredError=t,!e._writableHasInFlightOperation&&e._writableStarted&&tQ(e)}function tQ(e){e._writableState="errored"}function t0(e){"erroring"===e._writableState&&tQ(e)}Object.defineProperties(tx.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),n(tx.prototype.enqueue,"enqueue"),n(tx.prototype.error,"error"),n(tx.prototype.terminate,"terminate"),"symbol"==typeof a.toStringTag&&Object.defineProperty(tx.prototype,a.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});var t1,t2,t4,t9=r(81883);async function*t5(e){let t=e.byteOffset+e.byteLength,r=e.byteOffset;for(;r!==t;){let a=Math.min(t-r,65536),s=e.buffer.slice(r,r+a);r+=s.byteLength,yield new Uint8Array(s)}}async function*t3(e){let t=0;for(;t!==e.size;){let r=e.slice(t,Math.min(e.size,t+65536)),a=await r.arrayBuffer();t+=a.byteLength,yield new Uint8Array(a)}}async function*t6(e,t=!1){for(let r of e)ArrayBuffer.isView(r)?t?yield*t5(r):yield r:(0,t9.m)(r.stream)?yield*r.stream():yield*t3(r)}/*! Based on fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> & David Frank */var t8=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)},t7=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r};class Blob{constructor(e=[],t={}){if(t1.set(this,[]),t2.set(this,""),t4.set(this,0),null!=t||(t={}),"object"!=typeof e||null===e)throw TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(!(0,t9.m)(e[Symbol.iterator]))throw TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if("object"!=typeof t&&!(0,t9.m)(t))throw TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");let r=new TextEncoder;for(let t of e){let e;e=ArrayBuffer.isView(t)?new Uint8Array(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)):t instanceof ArrayBuffer?new Uint8Array(t.slice(0)):t instanceof Blob?t:r.encode(String(t)),t7(this,t4,t8(this,t4,"f")+(ArrayBuffer.isView(e)?e.byteLength:e.size),"f"),t8(this,t1,"f").push(e)}let a=void 0===t.type?"":String(t.type);t7(this,t2,/^[\x20-\x7E]*$/.test(a)?a:"","f")}static[(t1=new WeakMap,t2=new WeakMap,t4=new WeakMap,Symbol.hasInstance)](e){return!!(e&&"object"==typeof e&&(0,t9.m)(e.constructor)&&((0,t9.m)(e.stream)||(0,t9.m)(e.arrayBuffer))&&/^(Blob|File)$/.test(e[Symbol.toStringTag]))}get type(){return t8(this,t2,"f")}get size(){return t8(this,t4,"f")}slice(e,t,r){return new Blob(function*(e,t,r=0,a){null!=a||(a=t);let s=r<0?Math.max(t+r,0):Math.min(r,t),i=a<0?Math.max(t+a,0):Math.min(a,t),n=Math.max(i-s,0),o=0;for(let t of e){if(o>=n)break;let e=ArrayBuffer.isView(t)?t.byteLength:t.size;if(s&&e<=s)s-=e,i-=e;else{let r;ArrayBuffer.isView(t)?o+=(r=t.subarray(s,Math.min(e,i))).byteLength:o+=(r=t.slice(s,Math.min(e,i))).size,i-=e,s=0,yield r}}}(t8(this,t1,"f"),this.size,e,t),{type:r})}async text(){let e=new TextDecoder,t="";for await(let r of t6(t8(this,t1,"f")))t+=e.decode(r,{stream:!0});return t+e.decode()}async arrayBuffer(){let e=new Uint8Array(this.size),t=0;for await(let r of t6(t8(this,t1,"f")))e.set(r,t),t+=r.length;return e.buffer}stream(){let e=t6(t8(this,t1,"f"),!0);return new ReadableStream({async pull(t){let{value:r,done:a}=await e.next();if(a)return queueMicrotask(()=>t.close());t.enqueue(r)},async cancel(){await e.return()}})}get[Symbol.toStringTag](){return"Blob"}}Object.defineProperties(Blob.prototype,{type:{enumerable:!0},size:{enumerable:!0},slice:{enumerable:!0},stream:{enumerable:!0},text:{enumerable:!0},arrayBuffer:{enumerable:!0}})},70087:(e,t,r)=>{"use strict";r.d(t,{$:()=>File});var a,s,i=r(83785),n=function(e,t,r,a,s){if("m"===a)throw TypeError("Private method is not writable");if("a"===a&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,r):s?s.value=r:t.set(e,r),r},o=function(e,t,r,a){if("a"===r&&!a)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};class File extends i.t{constructor(e,t,r={}){if(super(e,r),a.set(this,void 0),s.set(this,0),arguments.length<2)throw TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);n(this,a,String(t),"f");let i=void 0===r.lastModified?Date.now():Number(r.lastModified);Number.isNaN(i)||n(this,s,i,"f")}static[(a=new WeakMap,s=new WeakMap,Symbol.hasInstance)](e){return e instanceof i.t&&"File"===e[Symbol.toStringTag]&&"string"==typeof e.name}get name(){return o(this,a,"f")}get lastModified(){return o(this,s,"f")}get webkitRelativePath(){return""}get[Symbol.toStringTag](){return"File"}}},68100:(e,t,r)=>{"use strict";r.d(t,{z:()=>s});var a=r(70087);let s=e=>e instanceof a.$},81883:(e,t,r)=>{"use strict";r.d(t,{m:()=>a});let a=e=>"function"==typeof e},72575:(e,t,r)=>{"use strict";r.d(t,{BD:()=>a.BD,qV:()=>a.qV});var a=r(72100)},95961:(e,t,r)=>{"use strict";r.d(t,{APIChain:()=>u});var a=r(66249),s=r(94579),i=r(34707);let n=`You are given the below API Documentation:
{api_docs}
Using this documentation, generate the full API url to call for answering the user question.
You should build the API url in order to get a response that is as short as possible, while still getting the necessary information to answer the question. Pay attention to deliberately exclude any unnecessary pieces of data in the API call.

Question:{question}
API url:`,o=new i.P({inputVariables:["api_docs","question"],template:n}),l=`${n} {api_url}

Here is the response from the API:

{api_response}

Summarize this response to answer the original question.

Summary:`,E=new i.P({inputVariables:["api_docs","question","api_url","api_response"],template:l});class u extends a.l{get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"apiAnswerChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiRequestChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiDocs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),this.apiRequestChain=e.apiRequestChain,this.apiAnswerChain=e.apiAnswerChain,this.apiDocs=e.apiDocs,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.headers=e.headers??this.headers}async _call(e,t){let r=e[this.inputKey],a=await this.apiRequestChain.predict({question:r,api_docs:this.apiDocs},t?.getChild("request")),s=await fetch(a,{headers:this.headers}),i=await s.text(),n=await this.apiAnswerChain.predict({question:r,api_docs:this.apiDocs,api_url:a,api_response:i},t?.getChild("response"));return{[this.outputKey]:n}}_chainType(){return"api_chain"}static async deserialize(e){let{api_request_chain:t,api_answer_chain:r,api_docs:a}=e;if(!t)throw Error("LLMChain must have api_request_chain");if(!r)throw Error("LLMChain must have api_answer_chain");if(!a)throw Error("LLMChain must have api_docs");return new u({apiAnswerChain:await s.LLMChain.deserialize(r),apiRequestChain:await s.LLMChain.deserialize(t),apiDocs:a})}serialize(){return{_type:this._chainType(),api_answer_chain:this.apiAnswerChain.serialize(),api_request_chain:this.apiRequestChain.serialize(),api_docs:this.apiDocs}}static fromLLMAndAPIDocs(e,t,r={}){let{apiUrlPrompt:a=o,apiResponsePrompt:i=E}=r,n=new s.LLMChain({prompt:a,llm:e}),l=new s.LLMChain({prompt:i,llm:e});return new this({apiAnswerChain:l,apiRequestChain:n,apiDocs:t,...r})}}},66249:(e,t,r)=>{"use strict";r.d(t,{l:()=>n});var a=r(73096),s=r(74311),i=r(72575);class n extends i.BD{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,t,r){if(1!=arguments.length||"object"!=typeof e||"saveContext"in e)super({verbose:t,callbacks:r}),this.memory=e;else{let{memory:t,callbackManager:r,...a}=e;super({...a,callbacks:r??a.callbacks}),this.memory=t}}_selectMemoryInputs(e){let t={...e};return"signal"in t&&delete t.signal,"timeout"in t&&delete t.timeout,t}async invoke(e,t){return this.call(e,t)}_validateOutputs(e){let t=this.outputKeys.filter(t=>!(t in e));if(t.length)throw Error(`Missing output keys: ${t.join(", ")} from chain ${this._chainType()}`)}async prepOutputs(e,t,r=!1){return(this._validateOutputs(t),this.memory&&await this.memory.saveContext(e,t),r)?t:{...e,...t}}serialize(){throw Error("Method not implemented.")}async run(e,t){let r=this.inputKeys.filter(e=>!this.memory?.memoryKeys.includes(e)??!0),a=r.length<=1;if(!a)throw Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);let s=r.length?{[r[0]]:e}:{},i=await this.call(s,t),n=Object.keys(i);if(1===n.length)return i[n[0]];throw Error("return values have multiple keys, `run` only supported when one key currently")}async _formatValues(e){let t={...e};if(t.timeout&&!t.signal&&(t.signal=AbortSignal.timeout(t.timeout),delete t.timeout),null!=this.memory){let r=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(let[e,a]of Object.entries(r))t[e]=a}return t}async call(e,t,r){let i;let n=await this._formatValues(e),o=(0,s.QH)(t),l=await s.Ye.configure(o.callbacks,this.callbacks,o.tags||r,this.tags,o.metadata,this.metadata,{verbose:this.verbose}),E=await l?.handleChainStart(this.toJSON(),n,void 0,void 0,void 0,void 0,o.runName);try{i=await (e.signal?Promise.race([this._call(n,E),new Promise((t,r)=>{e.signal?.addEventListener("abort",()=>{r(Error("AbortError"))})})]):this._call(n,E))}catch(e){throw await E?.handleChainError(e),e}return null!=this.memory&&await this.memory.saveContext(this._selectMemoryInputs(e),i),await E?.handleChainEnd(i),Object.defineProperty(i,a.WH,{value:E?{runId:E?.runId}:void 0,configurable:!0}),i}async apply(e,t){return Promise.all(e.map(async(e,r)=>this.call(e,t?.[r])))}static async deserialize(e,t={}){switch(e._type){case"llm_chain":{let{LLMChain:t}=await Promise.resolve().then(r.bind(r,94579));return t.deserialize(e)}case"sequential_chain":{let{SequentialChain:t}=await Promise.resolve().then(r.bind(r,48511));return t.deserialize(e)}case"simple_sequential_chain":{let{SimpleSequentialChain:t}=await Promise.resolve().then(r.bind(r,48511));return t.deserialize(e)}case"stuff_documents_chain":{let{StuffDocumentsChain:t}=await Promise.resolve().then(r.bind(r,38884));return t.deserialize(e)}case"map_reduce_documents_chain":{let{MapReduceDocumentsChain:t}=await Promise.resolve().then(r.bind(r,38884));return t.deserialize(e)}case"refine_documents_chain":{let{RefineDocumentsChain:t}=await Promise.resolve().then(r.bind(r,38884));return t.deserialize(e)}case"vector_db_qa":{let{VectorDBQAChain:a}=await Promise.resolve().then(r.bind(r,31278));return a.deserialize(e,t)}case"api_chain":{let{APIChain:t}=await Promise.resolve().then(r.bind(r,95961));return t.deserialize(e)}default:throw Error(`Invalid prompt type in config: ${e._type}`)}}}},38884:(e,t,r)=>{"use strict";r.d(t,{MapReduceDocumentsChain:()=>o,RefineDocumentsChain:()=>l,StuffDocumentsChain:()=>n});var a=r(66249),s=r(94579),i=r(34707);class n extends a.l{static lc_name(){return"StuffDocumentsChain"}get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter(e=>e!==this.documentVariableName)}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw Error(`Document key ${this.inputKey} not found.`);let{[this.inputKey]:t,...r}=e,a=t.map(({pageContent:e})=>e),s=a.join("\n\n");return{...r,[this.documentVariableName]:s}}async _call(e,t){let r=await this.llmChain.call(this._prepInputs(e),t?.getChild("combine_documents"));return r}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw Error("Missing llm_chain");return new n({llmChain:await s.LLMChain.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class o extends a.l{static lc_name(){return"MapReduceDocumentsChain"}get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,t){if(!(this.inputKey in e))throw Error(`Document key ${this.inputKey} not found.`);let{[this.inputKey]:r,...a}=e,s=r,i=[];for(let e=0;e<this.maxIterations;e+=1){let r=s.map(e=>({[this.documentVariableName]:e.pageContent,...a})),n=0!==e||!this.ensureMapStep;if(n){let e=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:s,...a})),t=await this.combineDocumentChain.llmChain._getNumTokens(e),r=t<this.maxTokens;if(r)break}let o=await this.llmChain.apply(r,t?Array.from({length:r.length},(e,r)=>t.getChild(`map_${r+1}`)):void 0),{outputKey:l}=this.llmChain;this.returnIntermediateSteps&&(i=i.concat(o.map(e=>e[l]))),s=o.map(e=>({pageContent:e[l],metadata:{}}))}let n={[this.combineDocumentChain.inputKey]:s,...a},o=await this.combineDocumentChain.call(n,t?.getChild("combine_documents"));return this.returnIntermediateSteps?{...o,intermediateSteps:i}:o}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw Error("Missing llm_chain");if(!e.combine_document_chain)throw Error("Missing combine_document_chain");return new o({llmChain:await s.LLMChain.deserialize(e.llm_chain),combineDocumentChain:await n.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class l extends a.l{static lc_name(){return"RefineDocumentsChain"}get defaultDocumentPrompt(){return new i.P({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter(e=>e!==this.documentVariableName&&e!==this.initialResponseName)}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,t){let r={page_content:e.pageContent,...e.metadata},a={};this.documentPrompt.inputVariables.forEach(e=>{a[e]=r[e]});let s={[this.documentVariableName]:await this.documentPrompt.format({...a})},i={...s,...t};return i}async _constructRefineInputs(e,t){let r={page_content:e.pageContent,...e.metadata},a={};this.documentPrompt.inputVariables.forEach(e=>{a[e]=r[e]});let s={[this.documentVariableName]:await this.documentPrompt.format({...a})},i={[this.initialResponseName]:t,...s};return i}async _call(e,t){if(!(this.inputKey in e))throw Error(`Document key ${this.inputKey} not found.`);let{[this.inputKey]:r,...a}=e,s=await this._constructInitialInputs(r[0],a),i=await this.llmChain.predict({...s},t?.getChild("answer")),n=[i];for(let e=1;e<r.length;e+=1){let s=await this._constructRefineInputs(r[e],i),o={...s,...a};i=await this.refineLLMChain.predict({...o},t?.getChild("refine")),n.push(i)}return{[this.outputKey]:i}}_chainType(){return"refine_documents_chain"}static async deserialize(e){let t=e.llm_chain;if(!t)throw Error("Missing llm_chain");let r=e.refine_llm_chain;if(!r)throw Error("Missing refine_llm_chain");return new l({llmChain:await s.LLMChain.deserialize(t),refineLLMChain:await s.LLMChain.deserialize(r)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}},94579:(e,t,r)=>{"use strict";r.d(t,{LLMChain:()=>E});var a=r(66249),s=r(73368),i=r(72575),n=r(24075);class o extends n.bI{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"NoOpOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}var l=r(62299);class E extends a.l{static lc_name(){return"LLMChain"}get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new o,this.prompt.outputParser){if(e.outputParser)throw Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}getCallKeys(){let e="callKeys"in this.llm?this.llm.callKeys:[];return e}_selectMemoryInputs(e){let t=super._selectMemoryInputs(e),r=this.getCallKeys();for(let a of r)a in e&&delete t[a];return t}async _getFinalOutput(e,t,r){return this.outputParser?await this.outputParser.parseResultWithPrompt(e,t,r?.getChild()):e[0].text}call(e,t){return super.call(e,t)}async _call(e,t){let r={...e},a={...this.llmKwargs},s=this.getCallKeys();for(let t of s)t in e&&a&&(a[t]=e[t],delete r[t]);let i=await this.prompt.formatPromptValue(r);if("generatePrompt"in this.llm){let{generations:e}=await this.llm.generatePrompt([i],a,t?.getChild());return{[this.outputKey]:await this._getFinalOutput(e[0],i,t)}}let n=this.outputParser?this.llm.pipe(this.outputParser):this.llm,o=await n.invoke(i,t?.getChild());return{[this.outputKey]:o}}async predict(e,t){let r=await this.call(e,t);return r[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){let{llm:t,prompt:r}=e;if(!t)throw Error("LLMChain must have llm");if(!r)throw Error("LLMChain must have prompt");return new E({llm:await i.qV.deserialize(t),prompt:await s.dy.deserialize(r)})}serialize(){let e="serialize"in this.llm?this.llm.serialize():void 0;return{_type:`${this._chainType()}_chain`,llm:e,prompt:this.prompt.serialize()}}_getNumTokens(e){return(function e(t){if("function"==typeof t._llmType)return t;if("bound"in t&&l.eq.isRunnable(t.bound))return e(t.bound);if("runnable"in t&&"fallbacks"in t&&l.eq.isRunnable(t.runnable))return e(t.runnable);if("default"in t&&l.eq.isRunnable(t.default))return e(t.default);throw Error("Unable to extract BaseLanguageModel from llmLike object.")})(this.llm).getNumTokens(e)}}},34003:(e,t,r)=>{"use strict";r.d(t,{cf:()=>d});var a=r(94579),s=r(38884),i=r(34707),n=r(91178),o=r(58133);let l=new i.P({template:"Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.\n\n{context}\n\nQuestion: {question}\nHelpful Answer:",inputVariables:["context","question"]}),E=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,u=[n.ov.fromTemplate(E),n.kq.fromTemplate("{question}")],c=n.ks.fromMessages(u),T=new o.n3(l,[[o.s_,c]]);o.s_;o.s_,r(27831);o.s_;function d(e,t={}){let{prompt:r=T.getPrompt(e),verbose:i}=t,n=new a.LLMChain({prompt:r,llm:e,verbose:i}),o=new s.StuffDocumentsChain({llmChain:n,verbose:i});return o}o.s_},48511:(e,t,r)=>{"use strict";r.d(t,{SequentialChain:()=>o,SimpleSequentialChain:()=>l});var a=r(66249);function s(e,t){let r=new Set;for(let a of t)e.has(a)&&r.add(a);return r}function i(e,t){let r=new Set(e);for(let e of t)r.delete(e);return r}function n(e){return Array.from(e).map(e=>`"${e}"`).join(", ")}class o extends a.l{static lc_name(){return"SequentialChain"}get inputKeys(){return this.inputVariables}get outputKeys(){return this.outputVariables}constructor(e){if(super(e),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chains=e.chains,this.inputVariables=e.inputVariables,this.outputVariables=e.outputVariables??[],this.outputVariables.length>0&&e.returnAll)throw Error("Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.");this.returnAll=e.returnAll??!1,this._validateChains()}_validateChains(){if(0===this.chains.length)throw Error("Sequential chain must have at least one chain.");let e=this.memory?.memoryKeys??[],t=new Set(this.inputKeys),r=new Set(e),a=s(t,r);if(a.size>0)throw Error(`The following keys: ${n(a)} are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap.`);let o=function(e,t){let r=new Set(e);for(let e of t)r.add(e);return r}(t,r);for(let e of this.chains){let t=i(new Set(e.inputKeys),o);if(e.memory&&(t=i(t,new Set(e.memory.memoryKeys))),t.size>0)throw Error(`Missing variables for chain "${e._chainType()}": ${n(t)}. Only got the following variables: ${n(o)}.`);let r=new Set(e.outputKeys),a=s(o,r);if(a.size>0)throw Error(`The following output variables for chain "${e._chainType()}" are overlapping: ${n(a)}. This can lead to unexpected behaviour.`);for(let e of r)o.add(e)}if(0===this.outputVariables.length){if(this.returnAll){let e=i(o,t);this.outputVariables=Array.from(e)}else this.outputVariables=this.chains[this.chains.length-1].outputKeys}else{let e=i(new Set(this.outputVariables),new Set(o));if(e.size>0)throw Error(`The following output variables were expected to be in the final chain output but were not found: ${n(e)}.`)}}async _call(e,t){let r={},a=0;for(let s of this.chains)for(let i of(a+=1,Object.keys(r=await s.call(e,t?.getChild(`step_${a}`)))))e[i]=r[i];let s={};for(let t of this.outputVariables)s[t]=e[t];return s}_chainType(){return"sequential_chain"}static async deserialize(e){let t=[],r=e.input_variables,s=e.output_variables,i=e.chains;for(let e of i){let r=await a.l.deserialize(e);t.push(r)}return new o({chains:t,inputVariables:r,outputVariables:s})}serialize(){let e=[];for(let t of this.chains)e.push(t.serialize());return{_type:this._chainType(),input_variables:this.inputVariables,output_variables:this.outputVariables,chains:e}}}class l extends a.l{static lc_name(){return"SimpleSequentialChain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),Object.defineProperty(this,"trimOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chains=e.chains,this.trimOutputs=e.trimOutputs??!1,this._validateChains()}_validateChains(){for(let e of this.chains){if(1!==e.inputKeys.filter(t=>!e.memory?.memoryKeys.includes(t)??!0).length)throw Error(`Chains used in SimpleSequentialChain should all have one input, got ${e.inputKeys.length} for ${e._chainType()}.`);if(1!==e.outputKeys.length)throw Error(`Chains used in SimpleSequentialChain should all have one output, got ${e.outputKeys.length} for ${e._chainType()}.`)}}async _call(e,t){let r=e[this.inputKey],a=0;for(let s of this.chains)a+=1,r=(await s.call({[s.inputKeys[0]]:r,signal:e.signal},t?.getChild(`step_${a}`)))[s.outputKeys[0]],this.trimOutputs&&(r=r.trim()),await t?.handleText(r);return{[this.outputKey]:r}}_chainType(){return"simple_sequential_chain"}static async deserialize(e){let t=[],r=e.chains;for(let e of r){let r=await a.l.deserialize(e);t.push(r)}return new l({chains:t})}serialize(){let e=[];for(let t of this.chains)e.push(t.serialize());return{_type:this._chainType(),chains:e}}}},31278:(e,t,r)=>{"use strict";r.d(t,{VectorDBQAChain:()=>i});var a=r(66249),s=r(34003);class i extends a.l{static lc_name(){return"VectorDBQAChain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"query"}),Object.defineProperty(this,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.vectorstore=e.vectorstore,this.combineDocumentsChain=e.combineDocumentsChain,this.inputKey=e.inputKey??this.inputKey,this.k=e.k??this.k,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}async _call(e,t){if(!(this.inputKey in e))throw Error(`Question key ${this.inputKey} not found.`);let r=e[this.inputKey],a=await this.vectorstore.similaritySearch(r,this.k,e.filter,t?.getChild("vectorstore")),s=await this.combineDocumentsChain.call({question:r,input_documents:a},t?.getChild("combine_documents"));return this.returnSourceDocuments?{...s,sourceDocuments:a}:s}_chainType(){return"vector_db_qa"}static async deserialize(e,t){if(!("vectorstore"in t))throw Error("Need to pass in a vectorstore to deserialize VectorDBQAChain");let{vectorstore:r}=t;if(!e.combine_documents_chain)throw Error("VectorDBQAChain must have combine_documents_chain in serialized data");return new i({combineDocumentsChain:await a.l.deserialize(e.combine_documents_chain),k:e.k,vectorstore:r})}serialize(){return{_type:this._chainType(),combine_documents_chain:this.combineDocumentsChain.serialize(),k:this.k}}static fromLLM(e,t,r){let a=(0,s.cf)(e);return new this({vectorstore:t,combineDocumentsChain:a,...r})}}},73368:(e,t,r)=>{"use strict";r.d(t,{dy:()=>a.dy});var a=r(58014);r(22879),r(22680)},91178:(e,t,r)=>{"use strict";r.d(t,{gc:()=>a.gc,kq:()=>a.kq,ks:()=>a.ks,ov:()=>a.ov});var a=r(58014);r(22879)},52234:(e,t,r)=>{"use strict";r.d(t,{P:()=>a.P8});var a=r(58014)},27831:(e,t,r)=>{"use strict";r.d(t,{gc:()=>s.gc,ks:()=>s.ks,kq:()=>s.kq,Pf:()=>a.P,ov:()=>s.ov}),r(73368),r(22680);var a=r(34707);r(58133),r(52234);var s=r(91178);r(57383),r(58014)},34707:(e,t,r)=>{"use strict";r.d(t,{P:()=>a.Pf});var a=r(58014)},58133:(e,t,r)=>{"use strict";r.d(t,{n3:()=>a.n3,s_:()=>a.s_});var a=r(22680)},57383:(e,t,r)=>{"use strict";r(58014)},73096:(e,t,r)=>{"use strict";r.d(t,{WH:()=>a.WH}),r(54519),r(57830);var a=r(40247);r(22879),r(1308),r(62281)},24075:(e,t,r)=>{"use strict";r.d(t,{bI:()=>i});var a=r(62299);class s extends a.eq{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}_baseMessageToString(e){return"string"==typeof e.content?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return"string"==typeof e?this._callWithConfig(async(e,t)=>this.parseResult([{text:e}],t?.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(e,t)=>this.parseResult([{message:e,text:this._baseMessageToString(e)}],t?.callbacks),e,{...t,runType:"parser"})}}class i extends s{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw Error("_type not implemented")}}r(1210),r(983),new URL("undefined"!=typeof self&&self.location&&"null"!==self.location.origin?self.location.origin+self.location.pathname+location.search:"https://github.com/cfworker");let n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31],l=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function E(e){return e.test.bind(e)}let u={date:c,time:T.bind(void 0,!1),"date-time":function(e){let t=e.split(d);return 2==t.length&&c(t[0])&&T(!0,t[1])},duration:e=>e.length>1&&e.length<80&&(/^P\d+([.,]\d+)?W$/.test(e)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(e)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(e)),uri:function(e){return h.test(e)&&A.test(e)},"uri-reference":E(/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i),"uri-template":E(/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i),url:E(/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu),email:e=>{if('"'===e[0])return!1;let[t,r,...a]=e.split("@");return!(!t||!r||0!==a.length||t.length>64||r.length>253||"."===t[0]||t.endsWith(".")||t.includes(".."))&&!!/^[a-z0-9.-]+$/i.test(r)&&!!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(t)&&r.split(".").every(e=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(e))},hostname:E(/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i),ipv4:E(/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/),ipv6:E(/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i),regex:function(e){if(p.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}},uuid:E(/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i),"json-pointer":E(/^(?:\/(?:[^~/]|~0|~1)*)*$/),"json-pointer-uri-fragment":E(/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i),"relative-json-pointer":E(/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/)};function c(e){var t;let r=e.match(n);if(!r)return!1;let a=+r[1],s=+r[2],i=+r[3];return s>=1&&s<=12&&i>=1&&i<=(2==s&&(t=a)%4==0&&(t%100!=0||t%400==0)?29:o[s])}function T(e,t){let r=t.match(l);if(!r)return!1;let a=+r[1],s=+r[2],i=+r[3],n=!!r[5];return(a<=23&&s<=59&&i<=59||23==a&&59==s&&60==i)&&(!e||n)}({...u,date:E(/^\d\d\d\d-[0-1]\d-[0-3]\d$/),time:E(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i),"date-time":E(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i),"uri-reference":E(/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i)});let d=/t|\s/i,h=/\/|:/,A=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,p=/[^\\]\\Z/;r(38066),r(71470);let R=e=>{if(0===Object.keys(e).length)return{};let t={};return e.children.length>0?t[e.name]=e.children.map(R):t[e.name]=e.text??void 0,t}},38066:(e,t,r)=>{"use strict";let a;r.d(t,{Y_:()=>U});let s=Symbol("Let zodToJsonSchema decide on which parser to use"),i={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},n=e=>"string"==typeof e?{...i,name:e}:{...i,...e},o=e=>{let t=n(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}};var l=r(68332);let E=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};function u(e){if("openAi"!==e.target)return{};let t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===e.$refStrategy?E(t,e.currentPath):t.join("/")}}function c(e,t,r,a){a?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function T(e,t,r,a,s){e[t]=r,c(e,t,a,s)}function d(e,t){return D(e.type._def,t)}let h=(e,t)=>D(e.innerType._def,t),A=(e,t)=>{let r={type:"integer",format:"unix-time"};if("openApi3"===t.target)return r;for(let a of e.checks)switch(a.kind){case"min":T(r,"minimum",a.value,a.message,t);break;case"max":T(r,"maximum",a.value,a.message,t)}return r},p=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,R={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===a&&(a=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),a),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function S(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":T(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t);break;case"max":T(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":I(r,"email",a.message,t);break;case"format:idn-email":I(r,"idn-email",a.message,t);break;case"pattern:zod":f(r,R.email,a.message,t)}break;case"url":I(r,"uri",a.message,t);break;case"uuid":I(r,"uuid",a.message,t);break;case"regex":f(r,a.regex,a.message,t);break;case"cuid":f(r,R.cuid,a.message,t);break;case"cuid2":f(r,R.cuid2,a.message,t);break;case"startsWith":f(r,RegExp(`^${_(a.value,t)}`),a.message,t);break;case"endsWith":f(r,RegExp(`${_(a.value,t)}$`),a.message,t);break;case"datetime":I(r,"date-time",a.message,t);break;case"date":I(r,"date",a.message,t);break;case"time":I(r,"time",a.message,t);break;case"duration":I(r,"duration",a.message,t);break;case"length":T(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t),T(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"includes":f(r,RegExp(_(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&I(r,"ipv4",a.message,t),"v4"!==a.version&&I(r,"ipv6",a.message,t);break;case"base64url":f(r,R.base64url,a.message,t);break;case"jwt":f(r,R.jwt,a.message,t);break;case"cidr":"v6"!==a.version&&f(r,R.ipv4Cidr,a.message,t),"v4"!==a.version&&f(r,R.ipv6Cidr,a.message,t);break;case"emoji":f(r,R.emoji(),a.message,t);break;case"ulid":f(r,R.ulid,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":I(r,"binary",a.message,t);break;case"contentEncoding:base64":T(r,"contentEncoding","base64",a.message,t);break;case"pattern:zod":f(r,R.base64,a.message,t)}break;case"nanoid":f(r,R.nanoid,a.message,t)}return r}function _(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)O.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}let O=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function I(e,t,r,a){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&a.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):T(e,"format",t,r,a)}function f(e,t,r,a){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&a.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:N(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):T(e,"pattern",N(t,a),r,a)}function N(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},a=r.i?e.source.toLowerCase():e.source,s="",i=!1,n=!1,o=!1;for(let e=0;e<a.length;e++){if(i){s+=a[e],i=!1;continue}if(r.i){if(n){if(a[e].match(/[a-z]/)){o?(s+=a[e]+`${a[e-2]}-${a[e]}`.toUpperCase(),o=!1):"-"===a[e+1]&&a[e+2]?.match(/[a-z]/)?(s+=a[e],o=!0):s+=`${a[e]}${a[e].toUpperCase()}`;continue}}else if(a[e].match(/[a-z]/)){s+=`[${a[e]}${a[e].toUpperCase()}]`;continue}}if(r.m){if("^"===a[e]){s+=`(^|(?<=[\r
]))`;continue}if("$"===a[e]){s+=`($|(?=[\r
]))`;continue}}if(r.s&&"."===a[e]){s+=n?`${a[e]}\r
`:`[${a[e]}\r
]`;continue}s+=a[e],"\\"===a[e]?i=!0:n&&"]"===a[e]?n=!1:n||"["!==a[e]||(n=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function m(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===l.pA.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,a)=>({...r,[a]:D(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",a]})??u(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};let r={type:"object",additionalProperties:D(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===l.pA.ZodString&&e.keyType._def.checks?.length){let{type:a,...s}=S(e.keyType._def,t);return{...r,propertyNames:s}}if(e.keyType?._def.typeName===l.pA.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===l.pA.ZodBranded&&e.keyType._def.type._def.typeName===l.pA.ZodString&&e.keyType._def.type._def.checks?.length){let{type:a,...s}=d(e.keyType._def,t);return{...r,propertyNames:s}}return r}let C={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},L=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>D(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},y=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return D(e.innerType._def,t);let r=D(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:u(t)},r]}:u(t)},g=(e,t)=>{if("input"===t.pipeStrategy)return D(e.in._def,t);if("output"===t.pipeStrategy)return D(e.out._def,t);let r=D(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),a=D(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(e=>void 0!==e)}},P=(e,t)=>D(e.innerType._def,t),b=(e,t,r)=>{switch(t){case l.pA.ZodString:return S(e,r);case l.pA.ZodNumber:return function(e,t){let r={type:"number"};if(!e.checks)return r;for(let a of e.checks)switch(a.kind){case"int":r.type="integer",c(r,"type",a.message,t);break;case"min":"jsonSchema7"===t.target?a.inclusive?T(r,"minimum",a.value,a.message,t):T(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),T(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?T(r,"maximum",a.value,a.message,t):T(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),T(r,"maximum",a.value,a.message,t));break;case"multipleOf":T(r,"multipleOf",a.value,a.message,t)}return r}(e,r);case l.pA.ZodObject:return function(e,t){let r="openAi"===t.target,a={type:"object",properties:{}},s=[],i=e.shape();for(let e in i){let n=i[e];if(void 0===n||void 0===n._def)continue;let o=function(e){try{return e.isOptional()}catch{return!0}}(n);o&&r&&("ZodOptional"===n._def.typeName&&(n=n._def.innerType),n.isNullable()||(n=n.nullable()),o=!1);let l=D(n._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==l&&(a.properties[e]=l,o||s.push(e))}s.length&&(a.required=s);let n=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return D(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==n&&(a.additionalProperties=n),a}(e,r);case l.pA.ZodBigInt:return function(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let a of e.checks)switch(a.kind){case"min":"jsonSchema7"===t.target?a.inclusive?T(r,"minimum",a.value,a.message,t):T(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),T(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?T(r,"maximum",a.value,a.message,t):T(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),T(r,"maximum",a.value,a.message,t));break;case"multipleOf":T(r,"multipleOf",a.value,a.message,t)}return r}(e,r);case l.pA.ZodBoolean:return{type:"boolean"};case l.pA.ZodDate:return function e(t,r,a){let s=a??r.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((a,s)=>e(t,r,a))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return A(t,r)}}(e,r);case l.pA.ZodUndefined:return{not:u(r)};case l.pA.ZodNull:return"openApi3"===r.target?{enum:["null"],nullable:!0}:{type:"null"};case l.pA.ZodArray:return function(e,t){let r={type:"array"};return e.type?._def&&e.type?._def?.typeName!==l.pA.ZodAny&&(r.items=D(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&T(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&T(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(T(r,"minItems",e.exactLength.value,e.exactLength.message,t),T(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}(e,r);case l.pA.ZodUnion:case l.pA.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return L(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in C&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=C[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return L(e,t)}(e,r);case l.pA.ZodIntersection:return function(e,t){let r=[D(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),D(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),a="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,s=[];return r.forEach(e=>{if(p(e))s.push(...e.allOf),void 0===e.unevaluatedProperties&&(a=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}else a=void 0;s.push(t)}}),s.length?{allOf:s,...a}:void 0}(e,r);case l.pA.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>D(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:D(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>D(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case l.pA.ZodRecord:return m(e,r);case l.pA.ZodLiteral:return function(e,t){let r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}(e,r);case l.pA.ZodEnum:return{type:"string",enum:Array.from(e.values)};case l.pA.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]),a=r.map(e=>t[e]),s=Array.from(new Set(a.map(e=>typeof e)));return{type:1===s.length?"string"===s[0]?"string":"number":["string","number"],enum:a}}(e);case l.pA.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:C[e.innerType._def.typeName],nullable:!0}:{type:[C[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let r=D(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}let r=D(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case l.pA.ZodOptional:return y(e,r);case l.pA.ZodMap:return function(e,t){if("record"===t.mapStrategy)return m(e,t);let r=D(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||u(t),a=D(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||u(t);return{type:"array",maxItems:125,items:{type:"array",items:[r,a],minItems:2,maxItems:2}}}(e,r);case l.pA.ZodSet:return function(e,t){let r=D(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]}),a={type:"array",uniqueItems:!0,items:r};return e.minSize&&T(a,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&T(a,"maxItems",e.maxSize.value,e.maxSize.message,t),a}(e,r);case l.pA.ZodLazy:return()=>e.getter()._def;case l.pA.ZodPromise:return D(e.type._def,r);case l.pA.ZodNaN:case l.pA.ZodNever:return function(e){return"openAi"===e.target?void 0:{not:u({...e,currentPath:[...e.currentPath,"not"]})}}(r);case l.pA.ZodEffects:return function(e,t){return"input"===t.effectStrategy?D(e.schema._def,t):u(t)}(e,r);case l.pA.ZodAny:case l.pA.ZodUnknown:return u(r);case l.pA.ZodDefault:return function(e,t){return{...D(e.innerType._def,t),default:e.defaultValue()}}(e,r);case l.pA.ZodBranded:return d(e,r);case l.pA.ZodReadonly:return P(e,r);case l.pA.ZodCatch:return h(e,r);case l.pA.ZodPipeline:return g(e,r);case l.pA.ZodFunction:case l.pA.ZodVoid:case l.pA.ZodSymbol:default:return}};function D(e,t,r=!1){let a=t.seen.get(e);if(t.override){let i=t.override?.(e,t,a,r);if(i!==s)return i}if(a&&!r){let e=v(a,t);if(void 0!==e)return e}let i={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,i);let n=b(e,e.typeName,t),o="function"==typeof n?D(n(),t):n;if(o&&M(e,t,o),t.postProcess){let r=t.postProcess(o,e,t);return i.jsonSchema=o,r}return i.jsonSchema=o,o}let v=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:E(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),u(t);return"seen"===t.$refStrategy?u(t):void 0}},M=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r),U=(e,t)=>{let r=o(t),a="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,a])=>({...e,[t]:D(a._def,{...r,currentPath:[...r.basePath,r.definitionPath,t]},!0)??u(r)}),{}):void 0,s="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,i=D(e._def,void 0===s?r:{...r,currentPath:[...r.basePath,r.definitionPath,s]},!1)??u(r),n="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==n&&(i.title=n),r.flags.hasReferencedOpenAiAnyType&&(a||(a={}),a[r.openAiAnyTypeName]||(a[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===r.$refStrategy?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let l=void 0===s?a?{...i,[r.definitionPath]:a}:i:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,s].join("/"),[r.definitionPath]:{...a,[s]:i}};return"jsonSchema7"===r.target?l.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===r.target||"openAi"===r.target)&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===r.target&&("anyOf"in l||"oneOf"in l||"allOf"in l||"type"in l&&Array.isArray(l.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),l}},68332:(e,t,r)=>{"use strict";var a,s,i,n;let o;r.d(t,{pA:()=>n,Yj:()=>eg}),function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),a={};for(let e of r)a[e]=t[e];return e.objectValues(a)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(a||(a={})),(s||(s={})).mergeShapes=(e,t)=>({...e,...t});let l=a.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),E=e=>{let t=typeof e;switch(t){case"undefined":return l.undefined;case"string":return l.string;case"number":return Number.isNaN(e)?l.nan:l.number;case"boolean":return l.boolean;case"function":return l.function;case"bigint":return l.bigint;case"symbol":return l.symbol;case"object":if(Array.isArray(e))return l.array;if(null===e)return l.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return l.promise;if("undefined"!=typeof Map&&e instanceof Map)return l.map;if("undefined"!=typeof Set&&e instanceof Set)return l.set;if("undefined"!=typeof Date&&e instanceof Date)return l.date;return l.object;default:return l.unknown}},u=a.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class c extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},a=e=>{for(let s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(a);else if("invalid_return_type"===s.code)a(s.returnTypeError);else if("invalid_arguments"===s.code)a(s.argumentsError);else if(0===s.path.length)r._errors.push(t(s));else{let e=r,a=0;for(;a<s.path.length;){let r=s.path[a],i=a===s.path.length-1;i?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(s))):e[r]=e[r]||{_errors:[]},e=e[r],a++}}};return a(this),r}static assert(e){if(!(e instanceof c))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,a.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let a of this.issues)if(a.path.length>0){let r=a.path[0];t[r]=t[r]||[],t[r].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}c.create=e=>{let t=new c(e);return t};let T=(e,t)=>{let r;switch(e.code){case u.invalid_type:r=e.received===l.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case u.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,a.jsonStringifyReplacer)}`;break;case u.unrecognized_keys:r=`Unrecognized key(s) in object: ${a.joinValues(e.keys,", ")}`;break;case u.invalid_union:r="Invalid input";break;case u.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${a.joinValues(e.options)}`;break;case u.invalid_enum_value:r=`Invalid enum value. Expected ${a.joinValues(e.options)}, received '${e.received}'`;break;case u.invalid_arguments:r="Invalid function arguments";break;case u.invalid_return_type:r="Invalid function return type";break;case u.invalid_date:r="Invalid date";break;case u.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:a.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case u.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case u.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case u.custom:r="Invalid input";break;case u.invalid_intersection_types:r="Intersection results could not be merged";break;case u.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case u.not_finite:r="Number must be finite";break;default:r=t.defaultError,a.assertNever(e)}return{message:r}};!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(i||(i={}));let d=e=>{let{data:t,path:r,errorMaps:a,issueData:s}=e,i=[...r,...s.path||[]],n={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let o="",l=a.filter(e=>!!e).slice().reverse();for(let e of l)o=e(n,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function h(e,t){let r=d({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,T,T==T?void 0:T].filter(e=>!!e)});e.common.issues.push(r)}class A{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let a of t){if("aborted"===a.status)return p;"dirty"===a.status&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,a=await e.value;r.push({key:t,value:a})}return A.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let a of t){let{key:t,value:s}=a;if("aborted"===t.status||"aborted"===s.status)return p;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==s.value||a.alwaysSet)&&(r[t.value]=s.value)}return{status:e.value,value:r}}}let p=Object.freeze({status:"aborted"}),R=e=>({status:"dirty",value:e}),S=e=>({status:"valid",value:e}),_=e=>"aborted"===e.status,O=e=>"dirty"===e.status,I=e=>"valid"===e.status,f=e=>"undefined"!=typeof Promise&&e instanceof Promise;class N{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let m=(e,t)=>{if(I(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new c(e.common.issues);return this._error=t,this._error}}};function C(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:a,description:s}=e;if(t&&(r||a))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:s}:{errorMap:(t,s)=>{let{message:i}=e;return"invalid_enum_value"===t.code?{message:i??s.defaultError}:void 0===s.data?{message:i??a??s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:i??r??s.defaultError}},description:s}}class L{get description(){return this._def.description}_getType(e){return E(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:E(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new A,ctx:{common:e.parent.common,data:e.data,parsedType:E(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(f(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:E(e)},a=this._parseSync({data:e,path:r.path,parent:r});return m(r,a)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:E(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return I(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>I(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:E(e)},a=this._parse({data:e,path:r.path,parent:r}),s=await (f(a)?a:Promise.resolve(a));return m(r,s)}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,a)=>{let s=e(t),i=()=>a.addIssue({code:u.custom,...r(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(e=>!!e||(i(),!1)):!!s||(i(),!1)})}refinement(e,t){return this._refinement((r,a)=>!!e(r)||(a.addIssue("function"==typeof t?t(r,a):t),!1))}_refinement(e){return new e_({schema:this,typeName:n.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return eO.create(this,this._def)}nullable(){return eI.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return er.create(this)}promise(){return eS.create(this,this._def)}or(e){return es.create([this,e],this._def)}and(e){return eo.create(this,e,this._def)}transform(e){return new e_({...C(this._def),schema:this,typeName:n.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ef({...C(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:n.ZodDefault})}brand(){return new eC({typeName:n.ZodBranded,type:this,...C(this._def)})}catch(e){return new eN({...C(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:n.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return eL.create(this,e)}readonly(){return ey.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let y=/^c[^\s-]{8,}$/i,g=/^[0-9a-z]+$/,P=/^[0-9A-HJKMNP-TV-Z]{26}$/i,b=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,D=/^[a-z0-9_-]{21}$/i,v=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,M=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,w=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,B=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,F=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,H=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,x=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,k="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Y=RegExp(`^${k}$`);function V(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}class $ extends L{_parse(e){var t,r,s,i;let n;this._def.coerce&&(e.data=String(e.data));let E=this._getType(e);if(E!==l.string){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.string,received:t.parsedType}),p}let c=new A;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(h(n=this._getOrReturnCtx(e,n),{code:u.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),c.dirty());else if("max"===l.kind)e.data.length>l.value&&(h(n=this._getOrReturnCtx(e,n),{code:u.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),c.dirty());else if("length"===l.kind){let t=e.data.length>l.value,r=e.data.length<l.value;(t||r)&&(n=this._getOrReturnCtx(e,n),t?h(n,{code:u.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):r&&h(n,{code:u.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),c.dirty())}else if("email"===l.kind)U.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"email",code:u.invalid_string,message:l.message}),c.dirty());else if("emoji"===l.kind)o||(o=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),o.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"emoji",code:u.invalid_string,message:l.message}),c.dirty());else if("uuid"===l.kind)b.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"uuid",code:u.invalid_string,message:l.message}),c.dirty());else if("nanoid"===l.kind)D.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"nanoid",code:u.invalid_string,message:l.message}),c.dirty());else if("cuid"===l.kind)y.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"cuid",code:u.invalid_string,message:l.message}),c.dirty());else if("cuid2"===l.kind)g.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"cuid2",code:u.invalid_string,message:l.message}),c.dirty());else if("ulid"===l.kind)P.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"ulid",code:u.invalid_string,message:l.message}),c.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{h(n=this._getOrReturnCtx(e,n),{validation:"url",code:u.invalid_string,message:l.message}),c.dirty()}else if("regex"===l.kind){l.regex.lastIndex=0;let t=l.regex.test(e.data);t||(h(n=this._getOrReturnCtx(e,n),{validation:"regex",code:u.invalid_string,message:l.message}),c.dirty())}else if("trim"===l.kind)e.data=e.data.trim();else if("includes"===l.kind)e.data.includes(l.value,l.position)||(h(n=this._getOrReturnCtx(e,n),{code:u.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),c.dirty());else if("toLowerCase"===l.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===l.kind)e.data=e.data.toUpperCase();else if("startsWith"===l.kind)e.data.startsWith(l.value)||(h(n=this._getOrReturnCtx(e,n),{code:u.invalid_string,validation:{startsWith:l.value},message:l.message}),c.dirty());else if("endsWith"===l.kind)e.data.endsWith(l.value)||(h(n=this._getOrReturnCtx(e,n),{code:u.invalid_string,validation:{endsWith:l.value},message:l.message}),c.dirty());else if("datetime"===l.kind){let t=function(e){let t=`${k}T${V(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}(l);t.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{code:u.invalid_string,validation:"datetime",message:l.message}),c.dirty())}else if("date"===l.kind)Y.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{code:u.invalid_string,validation:"date",message:l.message}),c.dirty());else if("time"===l.kind){let t=RegExp(`^${V(l)}$`);t.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{code:u.invalid_string,validation:"time",message:l.message}),c.dirty())}else"duration"===l.kind?M.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"duration",code:u.invalid_string,message:l.message}),c.dirty()):"ip"===l.kind?(t=e.data,("v4"===(r=l.version)||!r)&&w.test(t)||("v6"===r||!r)&&B.test(t)||(h(n=this._getOrReturnCtx(e,n),{validation:"ip",code:u.invalid_string,message:l.message}),c.dirty())):"jwt"===l.kind?!function(e,t){if(!v.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(a));if("object"!=typeof s||null===s||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(h(n=this._getOrReturnCtx(e,n),{validation:"jwt",code:u.invalid_string,message:l.message}),c.dirty()):"cidr"===l.kind?(s=e.data,("v4"===(i=l.version)||!i)&&G.test(s)||("v6"===i||!i)&&F.test(s)||(h(n=this._getOrReturnCtx(e,n),{validation:"cidr",code:u.invalid_string,message:l.message}),c.dirty())):"base64"===l.kind?H.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"base64",code:u.invalid_string,message:l.message}),c.dirty()):"base64url"===l.kind?x.test(e.data)||(h(n=this._getOrReturnCtx(e,n),{validation:"base64url",code:u.invalid_string,message:l.message}),c.dirty()):a.assertNever(l);return{status:c.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:u.invalid_string,...i.errToObj(r)})}_addCheck(e){return new $({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...i.errToObj(e)})}url(e){return this._addCheck({kind:"url",...i.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...i.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...i.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...i.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...i.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...i.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...i.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...i.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...i.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...i.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...i.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...i.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...i.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...i.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...i.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...i.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...i.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...i.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...i.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...i.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...i.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...i.errToObj(t)})}nonempty(e){return this.min(1,i.errToObj(e))}trim(){return new $({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new $({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new $({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}$.create=e=>new $({checks:[],typeName:n.ZodString,coerce:e?.coerce??!1,...C(e)});class W extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;this._def.coerce&&(e.data=Number(e.data));let r=this._getType(e);if(r!==l.number){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.number,received:t.parsedType}),p}let s=new A;for(let r of this._def.checks)if("int"===r.kind)a.isInteger(e.data)||(h(t=this._getOrReturnCtx(e,t),{code:u.invalid_type,expected:"integer",received:"float",message:r.message}),s.dirty());else if("min"===r.kind){let a=r.inclusive?e.data<r.value:e.data<=r.value;a&&(h(t=this._getOrReturnCtx(e,t),{code:u.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),s.dirty())}else if("max"===r.kind){let a=r.inclusive?e.data>r.value:e.data>=r.value;a&&(h(t=this._getOrReturnCtx(e,t),{code:u.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),s.dirty())}else"multipleOf"===r.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,s=r>a?r:a,i=Number.parseInt(e.toFixed(s).replace(".","")),n=Number.parseInt(t.toFixed(s).replace(".",""));return i%n/10**s}(e.data,r.value)&&(h(t=this._getOrReturnCtx(e,t),{code:u.not_multiple_of,multipleOf:r.value,message:r.message}),s.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(h(t=this._getOrReturnCtx(e,t),{code:u.not_finite,message:r.message}),s.dirty()):a.assertNever(r);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.toString(t))}setLimit(e,t,r,a){return new W({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.toString(a)}]})}_addCheck(e){return new W({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:i.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:i.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:i.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:i.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:i.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:i.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:i.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:i.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&a.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}W.create=e=>new W({checks:[],typeName:n.ZodNumber,coerce:e?.coerce||!1,...C(e)});class j extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}let r=this._getType(e);if(r!==l.bigint)return this._getInvalidInput(e);let s=new A;for(let r of this._def.checks)if("min"===r.kind){let a=r.inclusive?e.data<r.value:e.data<=r.value;a&&(h(t=this._getOrReturnCtx(e,t),{code:u.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),s.dirty())}else if("max"===r.kind){let a=r.inclusive?e.data>r.value:e.data>=r.value;a&&(h(t=this._getOrReturnCtx(e,t),{code:u.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),s.dirty())}else"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(h(t=this._getOrReturnCtx(e,t),{code:u.not_multiple_of,multipleOf:r.value,message:r.message}),s.dirty()):a.assertNever(r);return{status:s.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.bigint,received:t.parsedType}),p}gte(e,t){return this.setLimit("min",e,!0,i.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.toString(t))}setLimit(e,t,r,a){return new j({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.toString(a)}]})}_addCheck(e){return new j({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:i.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:i.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:i.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:i.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}j.create=e=>new j({checks:[],typeName:n.ZodBigInt,coerce:e?.coerce??!1,...C(e)});class X extends L{_parse(e){this._def.coerce&&(e.data=!!e.data);let t=this._getType(e);if(t!==l.boolean){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.boolean,received:t.parsedType}),p}return S(e.data)}}X.create=e=>new X({typeName:n.ZodBoolean,coerce:e?.coerce||!1,...C(e)});class K extends L{_parse(e){let t;this._def.coerce&&(e.data=new Date(e.data));let r=this._getType(e);if(r!==l.date){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.date,received:t.parsedType}),p}if(Number.isNaN(e.data.getTime())){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_date}),p}let s=new A;for(let r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(h(t=this._getOrReturnCtx(e,t),{code:u.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),s.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(h(t=this._getOrReturnCtx(e,t),{code:u.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),s.dirty()):a.assertNever(r);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new K({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:i.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:i.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}K.create=e=>new K({checks:[],coerce:e?.coerce||!1,typeName:n.ZodDate,...C(e)});class Z extends L{_parse(e){let t=this._getType(e);if(t!==l.symbol){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.symbol,received:t.parsedType}),p}return S(e.data)}}Z.create=e=>new Z({typeName:n.ZodSymbol,...C(e)});class q extends L{_parse(e){let t=this._getType(e);if(t!==l.undefined){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.undefined,received:t.parsedType}),p}return S(e.data)}}q.create=e=>new q({typeName:n.ZodUndefined,...C(e)});class J extends L{_parse(e){let t=this._getType(e);if(t!==l.null){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.null,received:t.parsedType}),p}return S(e.data)}}J.create=e=>new J({typeName:n.ZodNull,...C(e)});class z extends L{constructor(){super(...arguments),this._any=!0}_parse(e){return S(e.data)}}z.create=e=>new z({typeName:n.ZodAny,...C(e)});class Q extends L{constructor(){super(...arguments),this._unknown=!0}_parse(e){return S(e.data)}}Q.create=e=>new Q({typeName:n.ZodUnknown,...C(e)});class ee extends L{_parse(e){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.never,received:t.parsedType}),p}}ee.create=e=>new ee({typeName:n.ZodNever,...C(e)});class et extends L{_parse(e){let t=this._getType(e);if(t!==l.undefined){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.void,received:t.parsedType}),p}return S(e.data)}}et.create=e=>new et({typeName:n.ZodVoid,...C(e)});class er extends L{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==l.array)return h(t,{code:u.invalid_type,expected:l.array,received:t.parsedType}),p;if(null!==a.exactLength){let e=t.data.length>a.exactLength.value,s=t.data.length<a.exactLength.value;(e||s)&&(h(t,{code:e?u.too_big:u.too_small,minimum:s?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&(h(t,{code:u.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&(h(t,{code:u.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>a.type._parseAsync(new N(t,e,t.path,r)))).then(e=>A.mergeArray(r,e));let s=[...t.data].map((e,r)=>a.type._parseSync(new N(t,e,t.path,r)));return A.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new er({...this._def,minLength:{value:e,message:i.toString(t)}})}max(e,t){return new er({...this._def,maxLength:{value:e,message:i.toString(t)}})}length(e,t){return new er({...this._def,exactLength:{value:e,message:i.toString(t)}})}nonempty(e){return this.min(1,e)}}er.create=(e,t)=>new er({type:e,minLength:null,maxLength:null,exactLength:null,typeName:n.ZodArray,...C(t)});class ea extends L{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=a.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){let t=this._getType(e);if(t!==l.object){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.object,received:t.parsedType}),p}let{status:r,ctx:a}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),n=[];if(!(this._def.catchall instanceof ee&&"strip"===this._def.unknownKeys))for(let e in a.data)i.includes(e)||n.push(e);let o=[];for(let e of i){let t=s[e],r=a.data[e];o.push({key:{status:"valid",value:e},value:t._parse(new N(a,r,a.path,e)),alwaysSet:e in a.data})}if(this._def.catchall instanceof ee){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of n)o.push({key:{status:"valid",value:e},value:{status:"valid",value:a.data[e]}});else if("strict"===e)n.length>0&&(h(a,{code:u.unrecognized_keys,keys:n}),r.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of n){let r=a.data[t];o.push({key:{status:"valid",value:t},value:e._parse(new N(a,r,a.path,t)),alwaysSet:t in a.data})}}return a.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of o){let r=await t.key,a=await t.value;e.push({key:r,value:a,alwaysSet:t.alwaysSet})}return e}).then(e=>A.mergeObjectSync(r,e)):A.mergeObjectSync(r,o)}get shape(){return this._def.shape()}strict(e){return i.errToObj,new ea({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let a=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:i.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new ea({...this._def,unknownKeys:"strip"})}passthrough(){return new ea({...this._def,unknownKeys:"passthrough"})}extend(e){return new ea({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){let t=new ea({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:n.ZodObject});return t}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ea({...this._def,catchall:e})}pick(e){let t={};for(let r of a.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new ea({...this._def,shape:()=>t})}omit(e){let t={};for(let r of a.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new ea({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof ea){let r={};for(let a in t.shape){let s=t.shape[a];r[a]=eO.create(e(s))}return new ea({...t._def,shape:()=>r})}return t instanceof er?new er({...t._def,type:e(t.element)}):t instanceof eO?eO.create(e(t.unwrap())):t instanceof eI?eI.create(e(t.unwrap())):t instanceof el?el.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};for(let r of a.objectKeys(this.shape)){let a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new ea({...this._def,shape:()=>t})}required(e){let t={};for(let r of a.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r],a=e;for(;a instanceof eO;)a=a._def.innerType;t[r]=a}return new ea({...this._def,shape:()=>t})}keyof(){return eA(a.objectKeys(this.shape))}}ea.create=(e,t)=>new ea({shape:()=>e,unknownKeys:"strip",catchall:ee.create(),typeName:n.ZodObject,...C(t)}),ea.strictCreate=(e,t)=>new ea({shape:()=>e,unknownKeys:"strict",catchall:ee.create(),typeName:n.ZodObject,...C(t)}),ea.lazycreate=(e,t)=>new ea({shape:e,unknownKeys:"strip",catchall:ee.create(),typeName:n.ZodObject,...C(t)});class es extends L{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new c(e.ctx.common.issues));return h(t,{code:u.invalid_union,unionErrors:r}),p});{let e;let a=[];for(let s of r){let r={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&a.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let s=a.map(e=>new c(e));return h(t,{code:u.invalid_union,unionErrors:s}),p}}get options(){return this._def.options}}es.create=(e,t)=>new es({options:e,typeName:n.ZodUnion,...C(t)});let ei=e=>{if(e instanceof ed)return ei(e.schema);if(e instanceof e_)return ei(e.innerType());if(e instanceof eh)return[e.value];if(e instanceof ep)return e.options;if(e instanceof eR)return a.objectValues(e.enum);if(e instanceof ef)return ei(e._def.innerType);if(e instanceof q)return[void 0];else if(e instanceof J)return[null];else if(e instanceof eO)return[void 0,...ei(e.unwrap())];else if(e instanceof eI)return[null,...ei(e.unwrap())];else if(e instanceof eC)return ei(e.unwrap());else if(e instanceof ey)return ei(e.unwrap());else if(e instanceof eN)return ei(e._def.innerType);else return[]};class en extends L{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.object)return h(t,{code:u.invalid_type,expected:l.object,received:t.parsedType}),p;let r=this.discriminator,a=t.data[r],s=this.optionsMap.get(a);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(h(t,{code:u.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),p)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let a=new Map;for(let r of t){let t=ei(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let s of t){if(a.has(s))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);a.set(s,r)}}return new en({typeName:n.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...C(r)})}}class eo extends L{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),s=(e,s)=>{if(_(e)||_(s))return p;let i=function e(t,r){let s=E(t),i=E(r);if(t===r)return{valid:!0,data:t};if(s===l.object&&i===l.object){let s=a.objectKeys(r),i=a.objectKeys(t).filter(e=>-1!==s.indexOf(e)),n={...t,...r};for(let a of i){let s=e(t[a],r[a]);if(!s.valid)return{valid:!1};n[a]=s.data}return{valid:!0,data:n}}if(s===l.array&&i===l.array){if(t.length!==r.length)return{valid:!1};let a=[];for(let s=0;s<t.length;s++){let i=t[s],n=r[s],o=e(i,n);if(!o.valid)return{valid:!1};a.push(o.data)}return{valid:!0,data:a}}return s===l.date&&i===l.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}(e.value,s.value);return i.valid?((O(e)||O(s))&&t.dirty(),{status:t.value,value:i.data}):(h(r,{code:u.invalid_intersection_types}),p)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>s(e,t)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}eo.create=(e,t,r)=>new eo({left:e,right:t,typeName:n.ZodIntersection,...C(r)});class el extends L{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.array)return h(r,{code:u.invalid_type,expected:l.array,received:r.parsedType}),p;if(r.data.length<this._def.items.length)return h(r,{code:u.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),p;let a=this._def.rest;!a&&r.data.length>this._def.items.length&&(h(r,{code:u.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let s=[...r.data].map((e,t)=>{let a=this._def.items[t]||this._def.rest;return a?a._parse(new N(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(s).then(e=>A.mergeArray(t,e)):A.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new el({...this._def,rest:e})}}el.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new el({items:e,typeName:n.ZodTuple,rest:null,...C(t)})};class eE extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.object)return h(r,{code:u.invalid_type,expected:l.object,received:r.parsedType}),p;let a=[],s=this._def.keyType,i=this._def.valueType;for(let e in r.data)a.push({key:s._parse(new N(r,e,r.path,e)),value:i._parse(new N(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?A.mergeObjectAsync(t,a):A.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return new eE(t instanceof L?{keyType:e,valueType:t,typeName:n.ZodRecord,...C(r)}:{keyType:$.create(),valueType:e,typeName:n.ZodRecord,...C(t)})}}class eu extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.map)return h(r,{code:u.invalid_type,expected:l.map,received:r.parsedType}),p;let a=this._def.keyType,s=this._def.valueType,i=[...r.data.entries()].map(([e,t],i)=>({key:a._parse(new N(r,e,r.path,[i,"key"])),value:s._parse(new N(r,t,r.path,[i,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of i){let a=await r.key,s=await r.value;if("aborted"===a.status||"aborted"===s.status)return p;("dirty"===a.status||"dirty"===s.status)&&t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of i){let a=r.key,s=r.value;if("aborted"===a.status||"aborted"===s.status)return p;("dirty"===a.status||"dirty"===s.status)&&t.dirty(),e.set(a.value,s.value)}return{status:t.value,value:e}}}}eu.create=(e,t,r)=>new eu({valueType:t,keyType:e,typeName:n.ZodMap,...C(r)});class ec extends L{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.set)return h(r,{code:u.invalid_type,expected:l.set,received:r.parsedType}),p;let a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&(h(r,{code:u.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&(h(r,{code:u.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());let s=this._def.valueType;function i(e){let r=new Set;for(let a of e){if("aborted"===a.status)return p;"dirty"===a.status&&t.dirty(),r.add(a.value)}return{status:t.value,value:r}}let n=[...r.data.values()].map((e,t)=>s._parse(new N(r,e,r.path,t)));return r.common.async?Promise.all(n).then(e=>i(e)):i(n)}min(e,t){return new ec({...this._def,minSize:{value:e,message:i.toString(t)}})}max(e,t){return new ec({...this._def,maxSize:{value:e,message:i.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ec.create=(e,t)=>new ec({valueType:e,minSize:null,maxSize:null,typeName:n.ZodSet,...C(t)});class eT extends L{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.function)return h(t,{code:u.invalid_type,expected:l.function,received:t.parsedType}),p;function r(e,r){return d({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,T,T].filter(e=>!!e),issueData:{code:u.invalid_arguments,argumentsError:r}})}function a(e,r){return d({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,T,T].filter(e=>!!e),issueData:{code:u.invalid_return_type,returnTypeError:r}})}let s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof eS){let e=this;return S(async function(...t){let n=new c([]),o=await e._def.args.parseAsync(t,s).catch(e=>{throw n.addIssue(r(t,e)),n}),l=await Reflect.apply(i,this,o),E=await e._def.returns._def.type.parseAsync(l,s).catch(e=>{throw n.addIssue(a(l,e)),n});return E})}{let e=this;return S(function(...t){let n=e._def.args.safeParse(t,s);if(!n.success)throw new c([r(t,n.error)]);let o=Reflect.apply(i,this,n.data),l=e._def.returns.safeParse(o,s);if(!l.success)throw new c([a(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new eT({...this._def,args:el.create(e).rest(Q.create())})}returns(e){return new eT({...this._def,returns:e})}implement(e){let t=this.parse(e);return t}strictImplement(e){let t=this.parse(e);return t}static create(e,t,r){return new eT({args:e||el.create([]).rest(Q.create()),returns:t||Q.create(),typeName:n.ZodFunction,...C(r)})}}class ed extends L{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.getter();return r._parse({data:t.data,path:t.path,parent:t})}}ed.create=(e,t)=>new ed({getter:e,typeName:n.ZodLazy,...C(t)});class eh extends L{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return h(t,{received:t.data,code:u.invalid_literal,expected:this._def.value}),p}return{status:"valid",value:e.data}}get value(){return this._def.value}}function eA(e,t){return new ep({values:e,typeName:n.ZodEnum,...C(t)})}eh.create=(e,t)=>new eh({value:e,typeName:n.ZodLiteral,...C(t)});class ep extends L{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return h(t,{expected:a.joinValues(r),received:t.parsedType,code:u.invalid_type}),p}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return h(t,{received:t.data,code:u.invalid_enum_value,options:r}),p}return S(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ep.create(e,{...this._def,...t})}exclude(e,t=this._def){return ep.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}ep.create=eA;class eR extends L{_parse(e){let t=a.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==l.string&&r.parsedType!==l.number){let e=a.objectValues(t);return h(r,{expected:a.joinValues(e),received:r.parsedType,code:u.invalid_type}),p}if(this._cache||(this._cache=new Set(a.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=a.objectValues(t);return h(r,{received:r.data,code:u.invalid_enum_value,options:e}),p}return S(e.data)}get enum(){return this._def.values}}eR.create=(e,t)=>new eR({values:e,typeName:n.ZodNativeEnum,...C(t)});class eS extends L{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.promise&&!1===t.common.async)return h(t,{code:u.invalid_type,expected:l.promise,received:t.parsedType}),p;let r=t.parsedType===l.promise?t.data:Promise.resolve(t.data);return S(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}eS.create=(e,t)=>new eS({type:e,typeName:n.ZodPromise,...C(t)});class e_ extends L{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===n.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:e=>{h(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===s.type){let e=s.transform(r.data,i);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return p;let a=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===a.status?p:"dirty"===a.status||"dirty"===t.value?R(a.value):a});{if("aborted"===t.value)return p;let a=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===a.status?p:"dirty"===a.status||"dirty"===t.value?R(a.value):a}}if("refinement"===s.type){let e=e=>{let t=s.refinement(e,i);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?p:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?p:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}}if("transform"===s.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>I(e)?Promise.resolve(s.transform(e.value,i)).then(e=>({status:t.value,value:e})):p);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!I(e))return p;let a=s.transform(e.value,i);if(a instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}}a.assertNever(s)}}e_.create=(e,t,r)=>new e_({schema:e,typeName:n.ZodEffects,effect:t,...C(r)}),e_.createWithPreprocess=(e,t,r)=>new e_({schema:t,effect:{type:"preprocess",transform:e},typeName:n.ZodEffects,...C(r)});class eO extends L{_parse(e){let t=this._getType(e);return t===l.undefined?S(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eO.create=(e,t)=>new eO({innerType:e,typeName:n.ZodOptional,...C(t)});class eI extends L{_parse(e){let t=this._getType(e);return t===l.null?S(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eI.create=(e,t)=>new eI({innerType:e,typeName:n.ZodNullable,...C(t)});class ef extends L{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===l.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ef.create=(e,t)=>new ef({innerType:e,typeName:n.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...C(t)});class eN extends L{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return f(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new c(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new c(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}eN.create=(e,t)=>new eN({innerType:e,typeName:n.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...C(t)});class em extends L{_parse(e){let t=this._getType(e);if(t!==l.nan){let t=this._getOrReturnCtx(e);return h(t,{code:u.invalid_type,expected:l.nan,received:t.parsedType}),p}return{status:"valid",value:e.data}}}em.create=e=>new em({typeName:n.ZodNaN,...C(e)}),Symbol("zod_brand");class eC extends L{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class eL extends L{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){let e=async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?p:"dirty"===e.status?(t.dirty(),R(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})};return e()}{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?p:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new eL({in:e,out:t,typeName:n.ZodPipeline})}}class ey extends L{_parse(e){let t=this._def.innerType._parse(e),r=e=>(I(e)&&(e.value=Object.freeze(e.value)),e);return f(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}ey.create=(e,t)=>new ey({innerType:e,typeName:n.ZodReadonly,...C(t)}),ea.lazycreate,function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(n||(n={})),$.create,W.create,em.create,j.create,X.create,K.create,Z.create,q.create,J.create;let eg=z.create;Q.create,ee.create,et.create,er.create,ea.create,ea.strictCreate,es.create,en.create,eo.create,el.create,eE.create,eu.create,ec.create,eT.create,ed.create,eh.create,ep.create,eR.create,eS.create,e_.create,eO.create,eI.create,e_.createWithPreprocess,eL.create}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[271,107,556],()=>r(90119));module.exports=a})();